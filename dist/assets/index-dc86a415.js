function ED(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var bn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ua(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tH(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var RD={exports:{}},mx={},AD={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _d=Symbol.for("react.element"),nH=Symbol.for("react.portal"),sH=Symbol.for("react.fragment"),rH=Symbol.for("react.strict_mode"),iH=Symbol.for("react.profiler"),oH=Symbol.for("react.provider"),aH=Symbol.for("react.context"),lH=Symbol.for("react.forward_ref"),cH=Symbol.for("react.suspense"),uH=Symbol.for("react.memo"),hH=Symbol.for("react.lazy"),R$=Symbol.iterator;function dH(t){return t===null||typeof t!="object"?null:(t=R$&&t[R$]||t["@@iterator"],typeof t=="function"?t:null)}var DD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_D=Object.assign,PD={};function gu(t,e,n){this.props=t,this.context=e,this.refs=PD,this.updater=n||DD}gu.prototype.isReactComponent={};gu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function FD(){}FD.prototype=gu.prototype;function hC(t,e,n){this.props=t,this.context=e,this.refs=PD,this.updater=n||DD}var dC=hC.prototype=new FD;dC.constructor=hC;_D(dC,gu.prototype);dC.isPureReactComponent=!0;var A$=Array.isArray,OD=Object.prototype.hasOwnProperty,fC={current:null},MD={key:!0,ref:!0,__self:!0,__source:!0};function LD(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)OD.call(e,s)&&!MD.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:_d,type:t,key:i,ref:o,props:r,_owner:fC.current}}function fH(t,e){return{$$typeof:_d,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function pC(t){return typeof t=="object"&&t!==null&&t.$$typeof===_d}function pH(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var D$=/\/+/g;function Hv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pH(""+t.key):e.toString(36)}function bm(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case _d:case nH:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+Hv(o,0):s,A$(r)?(n="",t!=null&&(n=t.replace(D$,"$&/")+"/"),bm(r,e,n,"",function(c){return c})):r!=null&&(pC(r)&&(r=fH(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(D$,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",A$(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+Hv(i,a);o+=bm(i,e,n,l,r)}else if(l=dH(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+Hv(i,a++),o+=bm(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function xp(t,e,n){if(t==null)return t;var s=[],r=0;return bm(t,s,"","",function(i){return e.call(n,i,r++)}),s}function mH(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ps={current:null},wm={transition:null},gH={ReactCurrentDispatcher:ps,ReactCurrentBatchConfig:wm,ReactCurrentOwner:fC};function zD(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:xp,forEach:function(t,e,n){xp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xp(t,function(){e++}),e},toArray:function(t){return xp(t,function(e){return e})||[]},only:function(t){if(!pC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=gu;qe.Fragment=sH;qe.Profiler=iH;qe.PureComponent=hC;qe.StrictMode=rH;qe.Suspense=cH;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gH;qe.act=zD;qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=_D({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=fC.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)OD.call(e,l)&&!MD.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:_d,type:t.type,key:r,ref:i,props:s,_owner:o}};qe.createContext=function(t){return t={$$typeof:aH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:oH,_context:t},t.Consumer=t};qe.createElement=LD;qe.createFactory=function(t){var e=LD.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:lH,render:t}};qe.isValidElement=pC;qe.lazy=function(t){return{$$typeof:hH,_payload:{_status:-1,_result:t},_init:mH}};qe.memo=function(t,e){return{$$typeof:uH,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=wm.transition;wm.transition={};try{t()}finally{wm.transition=e}};qe.unstable_act=zD;qe.useCallback=function(t,e){return ps.current.useCallback(t,e)};qe.useContext=function(t){return ps.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return ps.current.useDeferredValue(t)};qe.useEffect=function(t,e){return ps.current.useEffect(t,e)};qe.useId=function(){return ps.current.useId()};qe.useImperativeHandle=function(t,e,n){return ps.current.useImperativeHandle(t,e,n)};qe.useInsertionEffect=function(t,e){return ps.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return ps.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return ps.current.useMemo(t,e)};qe.useReducer=function(t,e,n){return ps.current.useReducer(t,e,n)};qe.useRef=function(t){return ps.current.useRef(t)};qe.useState=function(t){return ps.current.useState(t)};qe.useSyncExternalStore=function(t,e,n){return ps.current.useSyncExternalStore(t,e,n)};qe.useTransition=function(){return ps.current.useTransition()};qe.version="18.3.1";AD.exports=qe;var k=AD.exports;const oe=ua(k),VD=ED({__proto__:null,default:oe},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xH=k,vH=Symbol.for("react.element"),yH=Symbol.for("react.fragment"),bH=Object.prototype.hasOwnProperty,wH=xH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CH={key:!0,ref:!0,__self:!0,__source:!0};function BD(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)bH.call(e,s)&&!CH.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:vH,type:t,key:i,ref:o,props:r,_owner:wH.current}}mx.Fragment=yH;mx.jsx=BD;mx.jsxs=BD;RD.exports=mx;var w=RD.exports,_b={},jD={exports:{}},Ks={},WD={exports:{}},UD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_,M){var U=_.length;_.push(M);e:for(;0<U;){var W=U-1>>>1,X=_[W];if(0<r(X,M))_[W]=M,_[U]=X,U=W;else break e}}function n(_){return _.length===0?null:_[0]}function s(_){if(_.length===0)return null;var M=_[0],U=_.pop();if(U!==M){_[0]=U;e:for(var W=0,X=_.length,J=X>>>1;W<J;){var Z=2*(W+1)-1,re=_[Z],Q=Z+1,te=_[Q];if(0>r(re,U))Q<X&&0>r(te,re)?(_[W]=te,_[Q]=U,W=Q):(_[W]=re,_[Z]=U,W=Z);else if(Q<X&&0>r(te,U))_[W]=te,_[Q]=U,W=Q;else break e}}return M}function r(_,M){var U=_.sortIndex-M.sortIndex;return U!==0?U:_.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(_){for(var M=n(c);M!==null;){if(M.callback===null)s(c);else if(M.startTime<=_)s(c),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(c)}}function b(_){if(m=!1,y(_),!p)if(n(l)!==null)p=!0,P(C);else{var M=n(c);M!==null&&z(b,M.startTime-_)}}function C(_,M){p=!1,m&&(m=!1,x(I),I=-1),f=!0;var U=d;try{for(y(M),h=n(l);h!==null&&(!(h.expirationTime>M)||_&&!A());){var W=h.callback;if(typeof W=="function"){h.callback=null,d=h.priorityLevel;var X=W(h.expirationTime<=M);M=t.unstable_now(),typeof X=="function"?h.callback=X:h===n(l)&&s(l),y(M)}else s(l);h=n(l)}if(h!==null)var J=!0;else{var Z=n(c);Z!==null&&z(b,Z.startTime-M),J=!1}return J}finally{h=null,d=U,f=!1}}var S=!1,T=null,I=-1,$=5,N=-1;function A(){return!(t.unstable_now()-N<$)}function F(){if(T!==null){var _=t.unstable_now();N=_;var M=!0;try{M=T(!0,_)}finally{M?E():(S=!1,T=null)}}else S=!1}var E;if(typeof g=="function")E=function(){g(F)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,O=R.port2;R.port1.onmessage=F,E=function(){O.postMessage(null)}}else E=function(){v(F,0)};function P(_){T=_,S||(S=!0,E())}function z(_,M){I=v(function(){_(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,P(C))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(_){switch(d){case 1:case 2:case 3:var M=3;break;default:M=d}var U=d;d=M;try{return _()}finally{d=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,M){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var U=d;d=_;try{return M()}finally{d=U}},t.unstable_scheduleCallback=function(_,M,U){var W=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?W+U:W):U=W,_){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=U+X,_={id:u++,callback:M,priorityLevel:_,startTime:U,expirationTime:X,sortIndex:-1},U>W?(_.sortIndex=U,e(c,_),n(l)===null&&_===n(c)&&(m?(x(I),I=-1):m=!0,z(b,U-W))):(_.sortIndex=X,e(l,_),p||f||(p=!0,P(C))),_},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(_){var M=d;return function(){var U=d;d=M;try{return _.apply(this,arguments)}finally{d=U}}}})(UD);WD.exports=UD;var SH=WD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kH=k,Ws=SH;function de(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GD=new Set,Uh={};function Dl(t,e){Wc(t,e),Wc(t+"Capture",e)}function Wc(t,e){for(Uh[t]=e,t=0;t<e.length;t++)GD.add(e[t])}var eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pb=Object.prototype.hasOwnProperty,TH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_$={},P$={};function IH(t){return Pb.call(P$,t)?!0:Pb.call(_$,t)?!1:TH.test(t)?P$[t]=!0:(_$[t]=!0,!1)}function $H(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function NH(t,e,n,s){if(e===null||typeof e>"u"||$H(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ms(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Mn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Mn[t]=new ms(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Mn[e]=new ms(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Mn[t]=new ms(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Mn[t]=new ms(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Mn[t]=new ms(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Mn[t]=new ms(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Mn[t]=new ms(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Mn[t]=new ms(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Mn[t]=new ms(t,5,!1,t.toLowerCase(),null,!1,!1)});var mC=/[\-:]([a-z])/g;function gC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(mC,gC);Mn[e]=new ms(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(mC,gC);Mn[e]=new ms(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(mC,gC);Mn[e]=new ms(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Mn[t]=new ms(t,1,!1,t.toLowerCase(),null,!1,!1)});Mn.xlinkHref=new ms("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Mn[t]=new ms(t,1,!1,t.toLowerCase(),null,!0,!0)});function xC(t,e,n,s){var r=Mn.hasOwnProperty(e)?Mn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NH(e,n,r,s)&&(n=null),s||r===null?IH(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var ho=kH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vp=Symbol.for("react.element"),lc=Symbol.for("react.portal"),cc=Symbol.for("react.fragment"),vC=Symbol.for("react.strict_mode"),Fb=Symbol.for("react.profiler"),HD=Symbol.for("react.provider"),KD=Symbol.for("react.context"),yC=Symbol.for("react.forward_ref"),Ob=Symbol.for("react.suspense"),Mb=Symbol.for("react.suspense_list"),bC=Symbol.for("react.memo"),ko=Symbol.for("react.lazy"),XD=Symbol.for("react.offscreen"),F$=Symbol.iterator;function Wu(t){return t===null||typeof t!="object"?null:(t=F$&&t[F$]||t["@@iterator"],typeof t=="function"?t:null)}var Wt=Object.assign,Kv;function dh(t){if(Kv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Kv=e&&e[1]||""}return`
`+Kv+t}var Xv=!1;function qv(t,e){if(!t||Xv)return"";Xv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Xv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?dh(t):""}function EH(t){switch(t.tag){case 5:return dh(t.type);case 16:return dh("Lazy");case 13:return dh("Suspense");case 19:return dh("SuspenseList");case 0:case 2:case 15:return t=qv(t.type,!1),t;case 11:return t=qv(t.type.render,!1),t;case 1:return t=qv(t.type,!0),t;default:return""}}function Lb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case cc:return"Fragment";case lc:return"Portal";case Fb:return"Profiler";case vC:return"StrictMode";case Ob:return"Suspense";case Mb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case KD:return(t.displayName||"Context")+".Consumer";case HD:return(t._context.displayName||"Context")+".Provider";case yC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bC:return e=t.displayName||null,e!==null?e:Lb(t.type)||"Memo";case ko:e=t._payload,t=t._init;try{return Lb(t(e))}catch{}}return null}function RH(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lb(e);case 8:return e===vC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qD(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AH(t){var e=qD(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yp(t){t._valueTracker||(t._valueTracker=AH(t))}function YD(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=qD(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Hm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zb(t,e){var n=e.checked;return Wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function O$(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Qo(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function QD(t,e){e=e.checked,e!=null&&xC(t,"checked",e,!1)}function Vb(t,e){QD(t,e);var n=Qo(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Bb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Bb(t,e.type,Qo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function M$(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Bb(t,e,n){(e!=="number"||Hm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fh=Array.isArray;function $c(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Qo(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function jb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(de(91));return Wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function L$(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(de(92));if(fh(n)){if(1<n.length)throw Error(de(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Qo(n)}}function ZD(t,e){var n=Qo(e.value),s=Qo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function z$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function JD(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?JD(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bp,e_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bp=bp||document.createElement("div"),bp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Th={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},DH=["Webkit","ms","Moz","O"];Object.keys(Th).forEach(function(t){DH.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Th[e]=Th[t]})});function t_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Th.hasOwnProperty(t)&&Th[t]?(""+e).trim():e+"px"}function n_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=t_(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var _H=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ub(t,e){if(e){if(_H[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(de(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(de(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(de(61))}if(e.style!=null&&typeof e.style!="object")throw Error(de(62))}}function Gb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hb=null;function wC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kb=null,Nc=null,Ec=null;function V$(t){if(t=Od(t)){if(typeof Kb!="function")throw Error(de(280));var e=t.stateNode;e&&(e=bx(e),Kb(t.stateNode,t.type,e))}}function s_(t){Nc?Ec?Ec.push(t):Ec=[t]:Nc=t}function r_(){if(Nc){var t=Nc,e=Ec;if(Ec=Nc=null,V$(t),e)for(t=0;t<e.length;t++)V$(e[t])}}function i_(t,e){return t(e)}function o_(){}var Yv=!1;function a_(t,e,n){if(Yv)return t(e,n);Yv=!0;try{return i_(t,e,n)}finally{Yv=!1,(Nc!==null||Ec!==null)&&(o_(),r_())}}function Hh(t,e){var n=t.stateNode;if(n===null)return null;var s=bx(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(de(231,e,typeof n));return n}var Xb=!1;if(eo)try{var Uu={};Object.defineProperty(Uu,"passive",{get:function(){Xb=!0}}),window.addEventListener("test",Uu,Uu),window.removeEventListener("test",Uu,Uu)}catch{Xb=!1}function PH(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Ih=!1,Km=null,Xm=!1,qb=null,FH={onError:function(t){Ih=!0,Km=t}};function OH(t,e,n,s,r,i,o,a,l){Ih=!1,Km=null,PH.apply(FH,arguments)}function MH(t,e,n,s,r,i,o,a,l){if(OH.apply(this,arguments),Ih){if(Ih){var c=Km;Ih=!1,Km=null}else throw Error(de(198));Xm||(Xm=!0,qb=c)}}function _l(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function l_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function B$(t){if(_l(t)!==t)throw Error(de(188))}function LH(t){var e=t.alternate;if(!e){if(e=_l(t),e===null)throw Error(de(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return B$(r),t;if(i===s)return B$(r),e;i=i.sibling}throw Error(de(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(de(189))}}if(n.alternate!==s)throw Error(de(190))}if(n.tag!==3)throw Error(de(188));return n.stateNode.current===n?t:e}function c_(t){return t=LH(t),t!==null?u_(t):null}function u_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=u_(t);if(e!==null)return e;t=t.sibling}return null}var h_=Ws.unstable_scheduleCallback,j$=Ws.unstable_cancelCallback,zH=Ws.unstable_shouldYield,VH=Ws.unstable_requestPaint,Jt=Ws.unstable_now,BH=Ws.unstable_getCurrentPriorityLevel,CC=Ws.unstable_ImmediatePriority,d_=Ws.unstable_UserBlockingPriority,qm=Ws.unstable_NormalPriority,jH=Ws.unstable_LowPriority,f_=Ws.unstable_IdlePriority,gx=null,vi=null;function WH(t){if(vi&&typeof vi.onCommitFiberRoot=="function")try{vi.onCommitFiberRoot(gx,t,void 0,(t.current.flags&128)===128)}catch{}}var Vr=Math.clz32?Math.clz32:HH,UH=Math.log,GH=Math.LN2;function HH(t){return t>>>=0,t===0?32:31-(UH(t)/GH|0)|0}var wp=64,Cp=4194304;function ph(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ym(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=ph(a):(i&=o,i!==0&&(s=ph(i)))}else o=n&~r,o!==0?s=ph(o):i!==0&&(s=ph(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Vr(e),r=1<<n,s|=t[n],e&=~r;return s}function KH(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XH(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Vr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=KH(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Yb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function p_(){var t=wp;return wp<<=1,!(wp&4194240)&&(wp=64),t}function Qv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Pd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vr(e),t[e]=n}function qH(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Vr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function SC(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Vr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var lt=0;function m_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var g_,kC,x_,v_,y_,Qb=!1,Sp=[],Oo=null,Mo=null,Lo=null,Kh=new Map,Xh=new Map,No=[],YH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function W$(t,e){switch(t){case"focusin":case"focusout":Oo=null;break;case"dragenter":case"dragleave":Mo=null;break;case"mouseover":case"mouseout":Lo=null;break;case"pointerover":case"pointerout":Kh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xh.delete(e.pointerId)}}function Gu(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=Od(e),e!==null&&kC(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function QH(t,e,n,s,r){switch(e){case"focusin":return Oo=Gu(Oo,t,e,n,s,r),!0;case"dragenter":return Mo=Gu(Mo,t,e,n,s,r),!0;case"mouseover":return Lo=Gu(Lo,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return Kh.set(i,Gu(Kh.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Xh.set(i,Gu(Xh.get(i)||null,t,e,n,s,r)),!0}return!1}function b_(t){var e=Wa(t.target);if(e!==null){var n=_l(e);if(n!==null){if(e=n.tag,e===13){if(e=l_(n),e!==null){t.blockedOn=e,y_(t.priority,function(){x_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Cm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Hb=s,n.target.dispatchEvent(s),Hb=null}else return e=Od(n),e!==null&&kC(e),t.blockedOn=n,!1;e.shift()}return!0}function U$(t,e,n){Cm(t)&&n.delete(e)}function ZH(){Qb=!1,Oo!==null&&Cm(Oo)&&(Oo=null),Mo!==null&&Cm(Mo)&&(Mo=null),Lo!==null&&Cm(Lo)&&(Lo=null),Kh.forEach(U$),Xh.forEach(U$)}function Hu(t,e){t.blockedOn===e&&(t.blockedOn=null,Qb||(Qb=!0,Ws.unstable_scheduleCallback(Ws.unstable_NormalPriority,ZH)))}function qh(t){function e(r){return Hu(r,t)}if(0<Sp.length){Hu(Sp[0],t);for(var n=1;n<Sp.length;n++){var s=Sp[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Oo!==null&&Hu(Oo,t),Mo!==null&&Hu(Mo,t),Lo!==null&&Hu(Lo,t),Kh.forEach(e),Xh.forEach(e),n=0;n<No.length;n++)s=No[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<No.length&&(n=No[0],n.blockedOn===null);)b_(n),n.blockedOn===null&&No.shift()}var Rc=ho.ReactCurrentBatchConfig,Qm=!0;function JH(t,e,n,s){var r=lt,i=Rc.transition;Rc.transition=null;try{lt=1,TC(t,e,n,s)}finally{lt=r,Rc.transition=i}}function e5(t,e,n,s){var r=lt,i=Rc.transition;Rc.transition=null;try{lt=4,TC(t,e,n,s)}finally{lt=r,Rc.transition=i}}function TC(t,e,n,s){if(Qm){var r=Zb(t,e,n,s);if(r===null)ay(t,e,s,Zm,n),W$(t,s);else if(QH(r,t,e,n,s))s.stopPropagation();else if(W$(t,s),e&4&&-1<YH.indexOf(t)){for(;r!==null;){var i=Od(r);if(i!==null&&g_(i),i=Zb(t,e,n,s),i===null&&ay(t,e,s,Zm,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else ay(t,e,s,null,n)}}var Zm=null;function Zb(t,e,n,s){if(Zm=null,t=wC(s),t=Wa(t),t!==null)if(e=_l(t),e===null)t=null;else if(n=e.tag,n===13){if(t=l_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zm=t,null}function w_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BH()){case CC:return 1;case d_:return 4;case qm:case jH:return 16;case f_:return 536870912;default:return 16}default:return 16}}var Ro=null,IC=null,Sm=null;function C_(){if(Sm)return Sm;var t,e=IC,n=e.length,s,r="value"in Ro?Ro.value:Ro.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return Sm=r.slice(t,1<s?1-s:void 0)}function km(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function kp(){return!0}function G$(){return!1}function Xs(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?kp:G$,this.isPropagationStopped=G$,this}return Wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kp)},persist:function(){},isPersistent:kp}),e}var xu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$C=Xs(xu),Fd=Wt({},xu,{view:0,detail:0}),t5=Xs(Fd),Zv,Jv,Ku,xx=Wt({},Fd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:NC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ku&&(Ku&&t.type==="mousemove"?(Zv=t.screenX-Ku.screenX,Jv=t.screenY-Ku.screenY):Jv=Zv=0,Ku=t),Zv)},movementY:function(t){return"movementY"in t?t.movementY:Jv}}),H$=Xs(xx),n5=Wt({},xx,{dataTransfer:0}),s5=Xs(n5),r5=Wt({},Fd,{relatedTarget:0}),ey=Xs(r5),i5=Wt({},xu,{animationName:0,elapsedTime:0,pseudoElement:0}),o5=Xs(i5),a5=Wt({},xu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),l5=Xs(a5),c5=Wt({},xu,{data:0}),K$=Xs(c5),u5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},d5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function f5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=d5[t])?!!e[t]:!1}function NC(){return f5}var p5=Wt({},Fd,{key:function(t){if(t.key){var e=u5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=km(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?h5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:NC,charCode:function(t){return t.type==="keypress"?km(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?km(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),m5=Xs(p5),g5=Wt({},xx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X$=Xs(g5),x5=Wt({},Fd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:NC}),v5=Xs(x5),y5=Wt({},xu,{propertyName:0,elapsedTime:0,pseudoElement:0}),b5=Xs(y5),w5=Wt({},xx,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),C5=Xs(w5),S5=[9,13,27,32],EC=eo&&"CompositionEvent"in window,$h=null;eo&&"documentMode"in document&&($h=document.documentMode);var k5=eo&&"TextEvent"in window&&!$h,S_=eo&&(!EC||$h&&8<$h&&11>=$h),q$=String.fromCharCode(32),Y$=!1;function k_(t,e){switch(t){case"keyup":return S5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var uc=!1;function T5(t,e){switch(t){case"compositionend":return T_(e);case"keypress":return e.which!==32?null:(Y$=!0,q$);case"textInput":return t=e.data,t===q$&&Y$?null:t;default:return null}}function I5(t,e){if(uc)return t==="compositionend"||!EC&&k_(t,e)?(t=C_(),Sm=IC=Ro=null,uc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return S_&&e.locale!=="ko"?null:e.data;default:return null}}var $5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Q$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$5[t.type]:e==="textarea"}function I_(t,e,n,s){s_(s),e=Jm(e,"onChange"),0<e.length&&(n=new $C("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Nh=null,Yh=null;function N5(t){M_(t,0)}function vx(t){var e=fc(t);if(YD(e))return t}function E5(t,e){if(t==="change")return e}var $_=!1;if(eo){var ty;if(eo){var ny="oninput"in document;if(!ny){var Z$=document.createElement("div");Z$.setAttribute("oninput","return;"),ny=typeof Z$.oninput=="function"}ty=ny}else ty=!1;$_=ty&&(!document.documentMode||9<document.documentMode)}function J$(){Nh&&(Nh.detachEvent("onpropertychange",N_),Yh=Nh=null)}function N_(t){if(t.propertyName==="value"&&vx(Yh)){var e=[];I_(e,Yh,t,wC(t)),a_(N5,e)}}function R5(t,e,n){t==="focusin"?(J$(),Nh=e,Yh=n,Nh.attachEvent("onpropertychange",N_)):t==="focusout"&&J$()}function A5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vx(Yh)}function D5(t,e){if(t==="click")return vx(e)}function _5(t,e){if(t==="input"||t==="change")return vx(e)}function P5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Gr=typeof Object.is=="function"?Object.is:P5;function Qh(t,e){if(Gr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Pb.call(e,r)||!Gr(t[r],e[r]))return!1}return!0}function eN(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tN(t,e){var n=eN(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=eN(n)}}function E_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?E_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function R_(){for(var t=window,e=Hm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Hm(t.document)}return e}function RC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function F5(t){var e=R_(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&E_(n.ownerDocument.documentElement,n)){if(s!==null&&RC(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=tN(n,i);var o=tN(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var O5=eo&&"documentMode"in document&&11>=document.documentMode,hc=null,Jb=null,Eh=null,ew=!1;function nN(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ew||hc==null||hc!==Hm(s)||(s=hc,"selectionStart"in s&&RC(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Eh&&Qh(Eh,s)||(Eh=s,s=Jm(Jb,"onSelect"),0<s.length&&(e=new $C("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=hc)))}function Tp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var dc={animationend:Tp("Animation","AnimationEnd"),animationiteration:Tp("Animation","AnimationIteration"),animationstart:Tp("Animation","AnimationStart"),transitionend:Tp("Transition","TransitionEnd")},sy={},A_={};eo&&(A_=document.createElement("div").style,"AnimationEvent"in window||(delete dc.animationend.animation,delete dc.animationiteration.animation,delete dc.animationstart.animation),"TransitionEvent"in window||delete dc.transitionend.transition);function yx(t){if(sy[t])return sy[t];if(!dc[t])return t;var e=dc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in A_)return sy[t]=e[n];return t}var D_=yx("animationend"),__=yx("animationiteration"),P_=yx("animationstart"),F_=yx("transitionend"),O_=new Map,sN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ha(t,e){O_.set(t,e),Dl(e,[t])}for(var ry=0;ry<sN.length;ry++){var iy=sN[ry],M5=iy.toLowerCase(),L5=iy[0].toUpperCase()+iy.slice(1);ha(M5,"on"+L5)}ha(D_,"onAnimationEnd");ha(__,"onAnimationIteration");ha(P_,"onAnimationStart");ha("dblclick","onDoubleClick");ha("focusin","onFocus");ha("focusout","onBlur");ha(F_,"onTransitionEnd");Wc("onMouseEnter",["mouseout","mouseover"]);Wc("onMouseLeave",["mouseout","mouseover"]);Wc("onPointerEnter",["pointerout","pointerover"]);Wc("onPointerLeave",["pointerout","pointerover"]);Dl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z5=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function rN(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,MH(s,e,void 0,t),t.currentTarget=null}function M_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;rN(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;rN(r,a,c),i=l}}}if(Xm)throw t=qb,Xm=!1,qb=null,t}function $t(t,e){var n=e[iw];n===void 0&&(n=e[iw]=new Set);var s=t+"__bubble";n.has(s)||(L_(e,t,2,!1),n.add(s))}function oy(t,e,n){var s=0;e&&(s|=4),L_(n,t,s,e)}var Ip="_reactListening"+Math.random().toString(36).slice(2);function Zh(t){if(!t[Ip]){t[Ip]=!0,GD.forEach(function(n){n!=="selectionchange"&&(z5.has(n)||oy(n,!1,t),oy(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ip]||(e[Ip]=!0,oy("selectionchange",!1,e))}}function L_(t,e,n,s){switch(w_(e)){case 1:var r=JH;break;case 4:r=e5;break;default:r=TC}n=r.bind(null,e,n,t),r=void 0,!Xb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function ay(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Wa(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}a_(function(){var c=i,u=wC(n),h=[];e:{var d=O_.get(t);if(d!==void 0){var f=$C,p=t;switch(t){case"keypress":if(km(n)===0)break e;case"keydown":case"keyup":f=m5;break;case"focusin":p="focus",f=ey;break;case"focusout":p="blur",f=ey;break;case"beforeblur":case"afterblur":f=ey;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=H$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=s5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=v5;break;case D_:case __:case P_:f=o5;break;case F_:f=b5;break;case"scroll":f=t5;break;case"wheel":f=C5;break;case"copy":case"cut":case"paste":f=l5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=X$}var m=(e&4)!==0,v=!m&&t==="scroll",x=m?d!==null?d+"Capture":null:d;m=[];for(var g=c,y;g!==null;){y=g;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,x!==null&&(b=Hh(g,x),b!=null&&m.push(Jh(g,b,y)))),v)break;g=g.return}0<m.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==Hb&&(p=n.relatedTarget||n.fromElement)&&(Wa(p)||p[to]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Wa(p):null,p!==null&&(v=_l(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=H$,b="onMouseLeave",x="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(m=X$,b="onPointerLeave",x="onPointerEnter",g="pointer"),v=f==null?d:fc(f),y=p==null?d:fc(p),d=new m(b,g+"leave",f,n,u),d.target=v,d.relatedTarget=y,b=null,Wa(u)===c&&(m=new m(x,g+"enter",p,n,u),m.target=y,m.relatedTarget=v,b=m),v=b,f&&p)t:{for(m=f,x=p,g=0,y=m;y;y=Yl(y))g++;for(y=0,b=x;b;b=Yl(b))y++;for(;0<g-y;)m=Yl(m),g--;for(;0<y-g;)x=Yl(x),y--;for(;g--;){if(m===x||x!==null&&m===x.alternate)break t;m=Yl(m),x=Yl(x)}m=null}else m=null;f!==null&&iN(h,d,f,m,!1),p!==null&&v!==null&&iN(h,v,p,m,!0)}}e:{if(d=c?fc(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var C=E5;else if(Q$(d))if($_)C=_5;else{C=A5;var S=R5}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(C=D5);if(C&&(C=C(t,c))){I_(h,C,n,u);break e}S&&S(t,d,c),t==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&Bb(d,"number",d.value)}switch(S=c?fc(c):window,t){case"focusin":(Q$(S)||S.contentEditable==="true")&&(hc=S,Jb=c,Eh=null);break;case"focusout":Eh=Jb=hc=null;break;case"mousedown":ew=!0;break;case"contextmenu":case"mouseup":case"dragend":ew=!1,nN(h,n,u);break;case"selectionchange":if(O5)break;case"keydown":case"keyup":nN(h,n,u)}var T;if(EC)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else uc?k_(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(S_&&n.locale!=="ko"&&(uc||I!=="onCompositionStart"?I==="onCompositionEnd"&&uc&&(T=C_()):(Ro=u,IC="value"in Ro?Ro.value:Ro.textContent,uc=!0)),S=Jm(c,I),0<S.length&&(I=new K$(I,t,null,n,u),h.push({event:I,listeners:S}),T?I.data=T:(T=T_(n),T!==null&&(I.data=T)))),(T=k5?T5(t,n):I5(t,n))&&(c=Jm(c,"onBeforeInput"),0<c.length&&(u=new K$("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=T))}M_(h,e)})}function Jh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Jm(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Hh(t,n),i!=null&&s.unshift(Jh(t,i,r)),i=Hh(t,e),i!=null&&s.push(Jh(t,i,r))),t=t.return}return s}function Yl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function iN(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=Hh(n,i),l!=null&&o.unshift(Jh(n,l,a))):r||(l=Hh(n,i),l!=null&&o.push(Jh(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var V5=/\r\n?/g,B5=/\u0000|\uFFFD/g;function oN(t){return(typeof t=="string"?t:""+t).replace(V5,`
`).replace(B5,"")}function $p(t,e,n){if(e=oN(e),oN(t)!==e&&n)throw Error(de(425))}function eg(){}var tw=null,nw=null;function sw(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rw=typeof setTimeout=="function"?setTimeout:void 0,j5=typeof clearTimeout=="function"?clearTimeout:void 0,aN=typeof Promise=="function"?Promise:void 0,W5=typeof queueMicrotask=="function"?queueMicrotask:typeof aN<"u"?function(t){return aN.resolve(null).then(t).catch(U5)}:rw;function U5(t){setTimeout(function(){throw t})}function ly(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),qh(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);qh(e)}function zo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lN(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vu=Math.random().toString(36).slice(2),di="__reactFiber$"+vu,ed="__reactProps$"+vu,to="__reactContainer$"+vu,iw="__reactEvents$"+vu,G5="__reactListeners$"+vu,H5="__reactHandles$"+vu;function Wa(t){var e=t[di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[to]||n[di]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lN(t);t!==null;){if(n=t[di])return n;t=lN(t)}return e}t=n,n=t.parentNode}return null}function Od(t){return t=t[di]||t[to],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function fc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(de(33))}function bx(t){return t[ed]||null}var ow=[],pc=-1;function da(t){return{current:t}}function Rt(t){0>pc||(t.current=ow[pc],ow[pc]=null,pc--)}function yt(t,e){pc++,ow[pc]=t.current,t.current=e}var Zo={},es=da(Zo),Ts=da(!1),rl=Zo;function Uc(t,e){var n=t.type.contextTypes;if(!n)return Zo;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Is(t){return t=t.childContextTypes,t!=null}function tg(){Rt(Ts),Rt(es)}function cN(t,e,n){if(es.current!==Zo)throw Error(de(168));yt(es,e),yt(Ts,n)}function z_(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(de(108,RH(t)||"Unknown",r));return Wt({},n,s)}function ng(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zo,rl=es.current,yt(es,t),yt(Ts,Ts.current),!0}function uN(t,e,n){var s=t.stateNode;if(!s)throw Error(de(169));n?(t=z_(t,e,rl),s.__reactInternalMemoizedMergedChildContext=t,Rt(Ts),Rt(es),yt(es,t)):Rt(Ts),yt(Ts,n)}var Bi=null,wx=!1,cy=!1;function V_(t){Bi===null?Bi=[t]:Bi.push(t)}function K5(t){wx=!0,V_(t)}function fa(){if(!cy&&Bi!==null){cy=!0;var t=0,e=lt;try{var n=Bi;for(lt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Bi=null,wx=!1}catch(r){throw Bi!==null&&(Bi=Bi.slice(t+1)),h_(CC,fa),r}finally{lt=e,cy=!1}}return null}var mc=[],gc=0,sg=null,rg=0,or=[],ar=0,il=null,Ui=1,Gi="";function Pa(t,e){mc[gc++]=rg,mc[gc++]=sg,sg=t,rg=e}function B_(t,e,n){or[ar++]=Ui,or[ar++]=Gi,or[ar++]=il,il=t;var s=Ui;t=Gi;var r=32-Vr(s)-1;s&=~(1<<r),n+=1;var i=32-Vr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Ui=1<<32-Vr(e)+r|n<<r|s,Gi=i+t}else Ui=1<<i|n<<r|s,Gi=t}function AC(t){t.return!==null&&(Pa(t,1),B_(t,1,0))}function DC(t){for(;t===sg;)sg=mc[--gc],mc[gc]=null,rg=mc[--gc],mc[gc]=null;for(;t===il;)il=or[--ar],or[ar]=null,Gi=or[--ar],or[ar]=null,Ui=or[--ar],or[ar]=null}var Vs=null,Ls=null,Ot=!1,Fr=null;function j_(t,e){var n=cr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function hN(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Vs=t,Ls=zo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Vs=t,Ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=il!==null?{id:Ui,overflow:Gi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Vs=t,Ls=null,!0):!1;default:return!1}}function aw(t){return(t.mode&1)!==0&&(t.flags&128)===0}function lw(t){if(Ot){var e=Ls;if(e){var n=e;if(!hN(t,e)){if(aw(t))throw Error(de(418));e=zo(n.nextSibling);var s=Vs;e&&hN(t,e)?j_(s,n):(t.flags=t.flags&-4097|2,Ot=!1,Vs=t)}}else{if(aw(t))throw Error(de(418));t.flags=t.flags&-4097|2,Ot=!1,Vs=t}}}function dN(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Vs=t}function Np(t){if(t!==Vs)return!1;if(!Ot)return dN(t),Ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sw(t.type,t.memoizedProps)),e&&(e=Ls)){if(aw(t))throw W_(),Error(de(418));for(;e;)j_(t,e),e=zo(e.nextSibling)}if(dN(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(de(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ls=zo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ls=null}}else Ls=Vs?zo(t.stateNode.nextSibling):null;return!0}function W_(){for(var t=Ls;t;)t=zo(t.nextSibling)}function Gc(){Ls=Vs=null,Ot=!1}function _C(t){Fr===null?Fr=[t]:Fr.push(t)}var X5=ho.ReactCurrentBatchConfig;function Xu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(de(309));var s=n.stateNode}if(!s)throw Error(de(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(de(284));if(!n._owner)throw Error(de(290,t))}return t}function Ep(t,e){throw t=Object.prototype.toString.call(e),Error(de(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fN(t){var e=t._init;return e(t._payload)}function U_(t){function e(x,g){if(t){var y=x.deletions;y===null?(x.deletions=[g],x.flags|=16):y.push(g)}}function n(x,g){if(!t)return null;for(;g!==null;)e(x,g),g=g.sibling;return null}function s(x,g){for(x=new Map;g!==null;)g.key!==null?x.set(g.key,g):x.set(g.index,g),g=g.sibling;return x}function r(x,g){return x=Wo(x,g),x.index=0,x.sibling=null,x}function i(x,g,y){return x.index=y,t?(y=x.alternate,y!==null?(y=y.index,y<g?(x.flags|=2,g):y):(x.flags|=2,g)):(x.flags|=1048576,g)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,g,y,b){return g===null||g.tag!==6?(g=gy(y,x.mode,b),g.return=x,g):(g=r(g,y),g.return=x,g)}function l(x,g,y,b){var C=y.type;return C===cc?u(x,g,y.props.children,b,y.key):g!==null&&(g.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ko&&fN(C)===g.type)?(b=r(g,y.props),b.ref=Xu(x,g,y),b.return=x,b):(b=Am(y.type,y.key,y.props,null,x.mode,b),b.ref=Xu(x,g,y),b.return=x,b)}function c(x,g,y,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=xy(y,x.mode,b),g.return=x,g):(g=r(g,y.children||[]),g.return=x,g)}function u(x,g,y,b,C){return g===null||g.tag!==7?(g=Za(y,x.mode,b,C),g.return=x,g):(g=r(g,y),g.return=x,g)}function h(x,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=gy(""+g,x.mode,y),g.return=x,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case vp:return y=Am(g.type,g.key,g.props,null,x.mode,y),y.ref=Xu(x,null,g),y.return=x,y;case lc:return g=xy(g,x.mode,y),g.return=x,g;case ko:var b=g._init;return h(x,b(g._payload),y)}if(fh(g)||Wu(g))return g=Za(g,x.mode,y,null),g.return=x,g;Ep(x,g)}return null}function d(x,g,y,b){var C=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return C!==null?null:a(x,g,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case vp:return y.key===C?l(x,g,y,b):null;case lc:return y.key===C?c(x,g,y,b):null;case ko:return C=y._init,d(x,g,C(y._payload),b)}if(fh(y)||Wu(y))return C!==null?null:u(x,g,y,b,null);Ep(x,y)}return null}function f(x,g,y,b,C){if(typeof b=="string"&&b!==""||typeof b=="number")return x=x.get(y)||null,a(g,x,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case vp:return x=x.get(b.key===null?y:b.key)||null,l(g,x,b,C);case lc:return x=x.get(b.key===null?y:b.key)||null,c(g,x,b,C);case ko:var S=b._init;return f(x,g,y,S(b._payload),C)}if(fh(b)||Wu(b))return x=x.get(y)||null,u(g,x,b,C,null);Ep(g,b)}return null}function p(x,g,y,b){for(var C=null,S=null,T=g,I=g=0,$=null;T!==null&&I<y.length;I++){T.index>I?($=T,T=null):$=T.sibling;var N=d(x,T,y[I],b);if(N===null){T===null&&(T=$);break}t&&T&&N.alternate===null&&e(x,T),g=i(N,g,I),S===null?C=N:S.sibling=N,S=N,T=$}if(I===y.length)return n(x,T),Ot&&Pa(x,I),C;if(T===null){for(;I<y.length;I++)T=h(x,y[I],b),T!==null&&(g=i(T,g,I),S===null?C=T:S.sibling=T,S=T);return Ot&&Pa(x,I),C}for(T=s(x,T);I<y.length;I++)$=f(T,x,I,y[I],b),$!==null&&(t&&$.alternate!==null&&T.delete($.key===null?I:$.key),g=i($,g,I),S===null?C=$:S.sibling=$,S=$);return t&&T.forEach(function(A){return e(x,A)}),Ot&&Pa(x,I),C}function m(x,g,y,b){var C=Wu(y);if(typeof C!="function")throw Error(de(150));if(y=C.call(y),y==null)throw Error(de(151));for(var S=C=null,T=g,I=g=0,$=null,N=y.next();T!==null&&!N.done;I++,N=y.next()){T.index>I?($=T,T=null):$=T.sibling;var A=d(x,T,N.value,b);if(A===null){T===null&&(T=$);break}t&&T&&A.alternate===null&&e(x,T),g=i(A,g,I),S===null?C=A:S.sibling=A,S=A,T=$}if(N.done)return n(x,T),Ot&&Pa(x,I),C;if(T===null){for(;!N.done;I++,N=y.next())N=h(x,N.value,b),N!==null&&(g=i(N,g,I),S===null?C=N:S.sibling=N,S=N);return Ot&&Pa(x,I),C}for(T=s(x,T);!N.done;I++,N=y.next())N=f(T,x,I,N.value,b),N!==null&&(t&&N.alternate!==null&&T.delete(N.key===null?I:N.key),g=i(N,g,I),S===null?C=N:S.sibling=N,S=N);return t&&T.forEach(function(F){return e(x,F)}),Ot&&Pa(x,I),C}function v(x,g,y,b){if(typeof y=="object"&&y!==null&&y.type===cc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case vp:e:{for(var C=y.key,S=g;S!==null;){if(S.key===C){if(C=y.type,C===cc){if(S.tag===7){n(x,S.sibling),g=r(S,y.props.children),g.return=x,x=g;break e}}else if(S.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ko&&fN(C)===S.type){n(x,S.sibling),g=r(S,y.props),g.ref=Xu(x,S,y),g.return=x,x=g;break e}n(x,S);break}else e(x,S);S=S.sibling}y.type===cc?(g=Za(y.props.children,x.mode,b,y.key),g.return=x,x=g):(b=Am(y.type,y.key,y.props,null,x.mode,b),b.ref=Xu(x,g,y),b.return=x,x=b)}return o(x);case lc:e:{for(S=y.key;g!==null;){if(g.key===S)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(x,g.sibling),g=r(g,y.children||[]),g.return=x,x=g;break e}else{n(x,g);break}else e(x,g);g=g.sibling}g=xy(y,x.mode,b),g.return=x,x=g}return o(x);case ko:return S=y._init,v(x,g,S(y._payload),b)}if(fh(y))return p(x,g,y,b);if(Wu(y))return m(x,g,y,b);Ep(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(x,g.sibling),g=r(g,y),g.return=x,x=g):(n(x,g),g=gy(y,x.mode,b),g.return=x,x=g),o(x)):n(x,g)}return v}var Hc=U_(!0),G_=U_(!1),ig=da(null),og=null,xc=null,PC=null;function FC(){PC=xc=og=null}function OC(t){var e=ig.current;Rt(ig),t._currentValue=e}function cw(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Ac(t,e){og=t,PC=xc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cs=!0),t.firstContext=null)}function xr(t){var e=t._currentValue;if(PC!==t)if(t={context:t,memoizedValue:e,next:null},xc===null){if(og===null)throw Error(de(308));xc=t,og.dependencies={lanes:0,firstContext:t}}else xc=xc.next=t;return e}var Ua=null;function MC(t){Ua===null?Ua=[t]:Ua.push(t)}function H_(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,MC(e)):(n.next=r.next,r.next=n),e.interleaved=n,no(t,s)}function no(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var To=!1;function LC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vo(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,tt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,no(t,n)}return r=s.interleaved,r===null?(e.next=e,MC(s)):(e.next=r.next,r.next=e),s.interleaved=e,no(t,n)}function Tm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,SC(t,n)}}function pN(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ag(t,e,n,s){var r=t.updateQueue;To=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,u=c=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((s&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(d=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Wt({},h,d);break e;case 2:To=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(u===null&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);al|=o,t.lanes=o,t.memoizedState=h}}function mN(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(de(191,r));r.call(s)}}}var Md={},yi=da(Md),td=da(Md),nd=da(Md);function Ga(t){if(t===Md)throw Error(de(174));return t}function zC(t,e){switch(yt(nd,e),yt(td,t),yt(yi,Md),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wb(e,t)}Rt(yi),yt(yi,e)}function Kc(){Rt(yi),Rt(td),Rt(nd)}function X_(t){Ga(nd.current);var e=Ga(yi.current),n=Wb(e,t.type);e!==n&&(yt(td,t),yt(yi,n))}function VC(t){td.current===t&&(Rt(yi),Rt(td))}var Vt=da(0);function lg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var uy=[];function BC(){for(var t=0;t<uy.length;t++)uy[t]._workInProgressVersionPrimary=null;uy.length=0}var Im=ho.ReactCurrentDispatcher,hy=ho.ReactCurrentBatchConfig,ol=0,jt=null,pn=null,Tn=null,cg=!1,Rh=!1,sd=0,q5=0;function Gn(){throw Error(de(321))}function jC(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Gr(t[n],e[n]))return!1;return!0}function WC(t,e,n,s,r,i){if(ol=i,jt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Im.current=t===null||t.memoizedState===null?J5:e6,t=n(s,r),Rh){i=0;do{if(Rh=!1,sd=0,25<=i)throw Error(de(301));i+=1,Tn=pn=null,e.updateQueue=null,Im.current=t6,t=n(s,r)}while(Rh)}if(Im.current=ug,e=pn!==null&&pn.next!==null,ol=0,Tn=pn=jt=null,cg=!1,e)throw Error(de(300));return t}function UC(){var t=sd!==0;return sd=0,t}function oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?jt.memoizedState=Tn=t:Tn=Tn.next=t,Tn}function vr(){if(pn===null){var t=jt.alternate;t=t!==null?t.memoizedState:null}else t=pn.next;var e=Tn===null?jt.memoizedState:Tn.next;if(e!==null)Tn=e,pn=t;else{if(t===null)throw Error(de(310));pn=t,t={memoizedState:pn.memoizedState,baseState:pn.baseState,baseQueue:pn.baseQueue,queue:pn.queue,next:null},Tn===null?jt.memoizedState=Tn=t:Tn=Tn.next=t}return Tn}function rd(t,e){return typeof e=="function"?e(t):e}function dy(t){var e=vr(),n=e.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=t;var s=pn,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((ol&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,jt.lanes|=u,al|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,Gr(s,e.memoizedState)||(Cs=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,jt.lanes|=i,al|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fy(t){var e=vr(),n=e.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);Gr(i,e.memoizedState)||(Cs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function q_(){}function Y_(t,e){var n=jt,s=vr(),r=e(),i=!Gr(s.memoizedState,r);if(i&&(s.memoizedState=r,Cs=!0),s=s.queue,GC(J_.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Tn!==null&&Tn.memoizedState.tag&1){if(n.flags|=2048,id(9,Z_.bind(null,n,s,r,e),void 0,null),$n===null)throw Error(de(349));ol&30||Q_(n,e,r)}return r}function Q_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=jt.updateQueue,e===null?(e={lastEffect:null,stores:null},jt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Z_(t,e,n,s){e.value=n,e.getSnapshot=s,eP(e)&&tP(t)}function J_(t,e,n){return n(function(){eP(e)&&tP(t)})}function eP(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Gr(t,n)}catch{return!0}}function tP(t){var e=no(t,1);e!==null&&Br(e,t,1,-1)}function gN(t){var e=oi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rd,lastRenderedState:t},e.queue=t,t=t.dispatch=Z5.bind(null,jt,t),[e.memoizedState,t]}function id(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=jt.updateQueue,e===null?(e={lastEffect:null,stores:null},jt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function nP(){return vr().memoizedState}function $m(t,e,n,s){var r=oi();jt.flags|=t,r.memoizedState=id(1|e,n,void 0,s===void 0?null:s)}function Cx(t,e,n,s){var r=vr();s=s===void 0?null:s;var i=void 0;if(pn!==null){var o=pn.memoizedState;if(i=o.destroy,s!==null&&jC(s,o.deps)){r.memoizedState=id(e,n,i,s);return}}jt.flags|=t,r.memoizedState=id(1|e,n,i,s)}function xN(t,e){return $m(8390656,8,t,e)}function GC(t,e){return Cx(2048,8,t,e)}function sP(t,e){return Cx(4,2,t,e)}function rP(t,e){return Cx(4,4,t,e)}function iP(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function oP(t,e,n){return n=n!=null?n.concat([t]):null,Cx(4,4,iP.bind(null,e,t),n)}function HC(){}function aP(t,e){var n=vr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&jC(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function lP(t,e){var n=vr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&jC(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function cP(t,e,n){return ol&21?(Gr(n,e)||(n=p_(),jt.lanes|=n,al|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cs=!0),t.memoizedState=n)}function Y5(t,e){var n=lt;lt=n!==0&&4>n?n:4,t(!0);var s=hy.transition;hy.transition={};try{t(!1),e()}finally{lt=n,hy.transition=s}}function uP(){return vr().memoizedState}function Q5(t,e,n){var s=jo(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},hP(t))dP(e,n);else if(n=H_(t,e,n,s),n!==null){var r=cs();Br(n,t,s,r),fP(n,e,s)}}function Z5(t,e,n){var s=jo(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(hP(t))dP(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,Gr(a,o)){var l=e.interleaved;l===null?(r.next=r,MC(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=H_(t,e,r,s),n!==null&&(r=cs(),Br(n,t,s,r),fP(n,e,s))}}function hP(t){var e=t.alternate;return t===jt||e!==null&&e===jt}function dP(t,e){Rh=cg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function fP(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,SC(t,n)}}var ug={readContext:xr,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},J5={readContext:xr,useCallback:function(t,e){return oi().memoizedState=[t,e===void 0?null:e],t},useContext:xr,useEffect:xN,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,$m(4194308,4,iP.bind(null,e,t),n)},useLayoutEffect:function(t,e){return $m(4194308,4,t,e)},useInsertionEffect:function(t,e){return $m(4,2,t,e)},useMemo:function(t,e){var n=oi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=oi();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=Q5.bind(null,jt,t),[s.memoizedState,t]},useRef:function(t){var e=oi();return t={current:t},e.memoizedState=t},useState:gN,useDebugValue:HC,useDeferredValue:function(t){return oi().memoizedState=t},useTransition:function(){var t=gN(!1),e=t[0];return t=Y5.bind(null,t[1]),oi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=jt,r=oi();if(Ot){if(n===void 0)throw Error(de(407));n=n()}else{if(n=e(),$n===null)throw Error(de(349));ol&30||Q_(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,xN(J_.bind(null,s,i,t),[t]),s.flags|=2048,id(9,Z_.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=oi(),e=$n.identifierPrefix;if(Ot){var n=Gi,s=Ui;n=(s&~(1<<32-Vr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=sd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=q5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},e6={readContext:xr,useCallback:aP,useContext:xr,useEffect:GC,useImperativeHandle:oP,useInsertionEffect:sP,useLayoutEffect:rP,useMemo:lP,useReducer:dy,useRef:nP,useState:function(){return dy(rd)},useDebugValue:HC,useDeferredValue:function(t){var e=vr();return cP(e,pn.memoizedState,t)},useTransition:function(){var t=dy(rd)[0],e=vr().memoizedState;return[t,e]},useMutableSource:q_,useSyncExternalStore:Y_,useId:uP,unstable_isNewReconciler:!1},t6={readContext:xr,useCallback:aP,useContext:xr,useEffect:GC,useImperativeHandle:oP,useInsertionEffect:sP,useLayoutEffect:rP,useMemo:lP,useReducer:fy,useRef:nP,useState:function(){return fy(rd)},useDebugValue:HC,useDeferredValue:function(t){var e=vr();return pn===null?e.memoizedState=t:cP(e,pn.memoizedState,t)},useTransition:function(){var t=fy(rd)[0],e=vr().memoizedState;return[t,e]},useMutableSource:q_,useSyncExternalStore:Y_,useId:uP,unstable_isNewReconciler:!1};function _r(t,e){if(t&&t.defaultProps){e=Wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function uw(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sx={isMounted:function(t){return(t=t._reactInternals)?_l(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=cs(),r=jo(t),i=Yi(s,r);i.payload=e,n!=null&&(i.callback=n),e=Vo(t,i,r),e!==null&&(Br(e,t,r,s),Tm(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=cs(),r=jo(t),i=Yi(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Vo(t,i,r),e!==null&&(Br(e,t,r,s),Tm(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=cs(),s=jo(t),r=Yi(n,s);r.tag=2,e!=null&&(r.callback=e),e=Vo(t,r,s),e!==null&&(Br(e,t,s,n),Tm(e,t,s))}};function vN(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Qh(n,s)||!Qh(r,i):!0}function pP(t,e,n){var s=!1,r=Zo,i=e.contextType;return typeof i=="object"&&i!==null?i=xr(i):(r=Is(e)?rl:es.current,s=e.contextTypes,i=(s=s!=null)?Uc(t,r):Zo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sx,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function yN(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Sx.enqueueReplaceState(e,e.state,null)}function hw(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},LC(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=xr(i):(i=Is(e)?rl:es.current,r.context=Uc(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(uw(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Sx.enqueueReplaceState(r,r.state,null),ag(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Xc(t,e){try{var n="",s=e;do n+=EH(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function py(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function dw(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var n6=typeof WeakMap=="function"?WeakMap:Map;function mP(t,e,n){n=Yi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){dg||(dg=!0,Cw=s),dw(t,e)},n}function gP(t,e,n){n=Yi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){dw(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){dw(t,e),typeof s!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function bN(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new n6;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=g6.bind(null,t,e,n),e.then(t,t))}function wN(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function CN(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yi(-1,1),e.tag=2,Vo(n,e,1))),n.lanes|=1),t)}var s6=ho.ReactCurrentOwner,Cs=!1;function is(t,e,n,s){e.child=t===null?G_(e,null,n,s):Hc(e,t.child,n,s)}function SN(t,e,n,s,r){n=n.render;var i=e.ref;return Ac(e,r),s=WC(t,e,n,s,i,r),n=UC(),t!==null&&!Cs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,so(t,e,r)):(Ot&&n&&AC(e),e.flags|=1,is(t,e,s,r),e.child)}function kN(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!eS(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,xP(t,e,i,s,r)):(t=Am(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Qh,n(o,s)&&t.ref===e.ref)return so(t,e,r)}return e.flags|=1,t=Wo(i,s),t.ref=e.ref,t.return=e,e.child=t}function xP(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Qh(i,s)&&t.ref===e.ref)if(Cs=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Cs=!0);else return e.lanes=t.lanes,so(t,e,r)}return fw(t,e,n,s,r)}function vP(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(yc,Fs),Fs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yt(yc,Fs),Fs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,yt(yc,Fs),Fs|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,yt(yc,Fs),Fs|=s;return is(t,e,r,n),e.child}function yP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function fw(t,e,n,s,r){var i=Is(n)?rl:es.current;return i=Uc(e,i),Ac(e,r),n=WC(t,e,n,s,i,r),s=UC(),t!==null&&!Cs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,so(t,e,r)):(Ot&&s&&AC(e),e.flags|=1,is(t,e,n,r),e.child)}function TN(t,e,n,s,r){if(Is(n)){var i=!0;ng(e)}else i=!1;if(Ac(e,r),e.stateNode===null)Nm(t,e),pP(e,n,s),hw(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=xr(c):(c=Is(n)?rl:es.current,c=Uc(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&yN(e,o,s,c),To=!1;var d=e.memoizedState;o.state=d,ag(e,s,o,r),l=e.memoizedState,a!==s||d!==l||Ts.current||To?(typeof u=="function"&&(uw(e,n,u,s),l=e.memoizedState),(a=To||vN(e,n,a,s,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,K_(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:_r(e.type,a),o.props=c,h=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=xr(l):(l=Is(n)?rl:es.current,l=Uc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&yN(e,o,s,l),To=!1,d=e.memoizedState,o.state=d,ag(e,s,o,r);var p=e.memoizedState;a!==h||d!==p||Ts.current||To?(typeof f=="function"&&(uw(e,n,f,s),p=e.memoizedState),(c=To||vN(e,n,c,s,d,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),s=!1)}return pw(t,e,n,s,i,r)}function pw(t,e,n,s,r,i){yP(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&uN(e,n,!1),so(t,e,i);s=e.stateNode,s6.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Hc(e,t.child,null,i),e.child=Hc(e,null,a,i)):is(t,e,a,i),e.memoizedState=s.state,r&&uN(e,n,!0),e.child}function bP(t){var e=t.stateNode;e.pendingContext?cN(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cN(t,e.context,!1),zC(t,e.containerInfo)}function IN(t,e,n,s,r){return Gc(),_C(r),e.flags|=256,is(t,e,n,s),e.child}var mw={dehydrated:null,treeContext:null,retryLane:0};function gw(t){return{baseLanes:t,cachePool:null,transitions:null}}function wP(t,e,n){var s=e.pendingProps,r=Vt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),yt(Vt,r&1),t===null)return lw(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ix(o,s,0,null),t=Za(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=gw(n),e.memoizedState=mw,t):KC(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return r6(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Wo(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=Wo(a,i):(i=Za(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?gw(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=mw,s}return i=t.child,t=i.sibling,s=Wo(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function KC(t,e){return e=Ix({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rp(t,e,n,s){return s!==null&&_C(s),Hc(e,t.child,null,n),t=KC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function r6(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=py(Error(de(422))),Rp(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Ix({mode:"visible",children:s.children},r,0,null),i=Za(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Hc(e,t.child,null,o),e.child.memoizedState=gw(o),e.memoizedState=mw,i);if(!(e.mode&1))return Rp(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(de(419)),s=py(i,s,void 0),Rp(t,e,o,s)}if(a=(o&t.childLanes)!==0,Cs||a){if(s=$n,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,no(t,r),Br(s,t,r,-1))}return JC(),s=py(Error(de(421))),Rp(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=x6.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Ls=zo(r.nextSibling),Vs=e,Ot=!0,Fr=null,t!==null&&(or[ar++]=Ui,or[ar++]=Gi,or[ar++]=il,Ui=t.id,Gi=t.overflow,il=e),e=KC(e,s.children),e.flags|=4096,e)}function $N(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),cw(t.return,e,n)}function my(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function CP(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(is(t,e,s.children,n),s=Vt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$N(t,n,e);else if(t.tag===19)$N(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(yt(Vt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&lg(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),my(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&lg(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}my(e,!0,n,null,i);break;case"together":my(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Nm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),al|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(de(153));if(e.child!==null){for(t=e.child,n=Wo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Wo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function i6(t,e,n){switch(e.tag){case 3:bP(e),Gc();break;case 5:X_(e);break;case 1:Is(e.type)&&ng(e);break;case 4:zC(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;yt(ig,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(yt(Vt,Vt.current&1),e.flags|=128,null):n&e.child.childLanes?wP(t,e,n):(yt(Vt,Vt.current&1),t=so(t,e,n),t!==null?t.sibling:null);yt(Vt,Vt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return CP(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),yt(Vt,Vt.current),s)break;return null;case 22:case 23:return e.lanes=0,vP(t,e,n)}return so(t,e,n)}var SP,xw,kP,TP;SP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xw=function(){};kP=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Ga(yi.current);var i=null;switch(n){case"input":r=zb(t,r),s=zb(t,s),i=[];break;case"select":r=Wt({},r,{value:void 0}),s=Wt({},s,{value:void 0}),i=[];break;case"textarea":r=jb(t,r),s=jb(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=eg)}Ub(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Uh.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Uh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&$t("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};TP=function(t,e,n,s){n!==s&&(e.flags|=4)};function qu(t,e){if(!Ot)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function o6(t,e,n){var s=e.pendingProps;switch(DC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(e),null;case 1:return Is(e.type)&&tg(),Hn(e),null;case 3:return s=e.stateNode,Kc(),Rt(Ts),Rt(es),BC(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Np(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Fr!==null&&(Tw(Fr),Fr=null))),xw(t,e),Hn(e),null;case 5:VC(e);var r=Ga(nd.current);if(n=e.type,t!==null&&e.stateNode!=null)kP(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(de(166));return Hn(e),null}if(t=Ga(yi.current),Np(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[di]=e,s[ed]=i,t=(e.mode&1)!==0,n){case"dialog":$t("cancel",s),$t("close",s);break;case"iframe":case"object":case"embed":$t("load",s);break;case"video":case"audio":for(r=0;r<mh.length;r++)$t(mh[r],s);break;case"source":$t("error",s);break;case"img":case"image":case"link":$t("error",s),$t("load",s);break;case"details":$t("toggle",s);break;case"input":O$(s,i),$t("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},$t("invalid",s);break;case"textarea":L$(s,i),$t("invalid",s)}Ub(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&$p(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&$p(s.textContent,a,t),r=["children",""+a]):Uh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&$t("scroll",s)}switch(n){case"input":yp(s),M$(s,i,!0);break;case"textarea":yp(s),z$(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=eg)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=JD(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[di]=e,t[ed]=s,SP(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gb(n,s),n){case"dialog":$t("cancel",t),$t("close",t),r=s;break;case"iframe":case"object":case"embed":$t("load",t),r=s;break;case"video":case"audio":for(r=0;r<mh.length;r++)$t(mh[r],t);r=s;break;case"source":$t("error",t),r=s;break;case"img":case"image":case"link":$t("error",t),$t("load",t),r=s;break;case"details":$t("toggle",t),r=s;break;case"input":O$(t,s),r=zb(t,s),$t("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Wt({},s,{value:void 0}),$t("invalid",t);break;case"textarea":L$(t,s),r=jb(t,s),$t("invalid",t);break;default:r=s}Ub(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?n_(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&e_(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Gh(t,l):typeof l=="number"&&Gh(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Uh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&$t("scroll",t):l!=null&&xC(t,i,l,o))}switch(n){case"input":yp(t),M$(t,s,!1);break;case"textarea":yp(t),z$(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Qo(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?$c(t,!!s.multiple,i,!1):s.defaultValue!=null&&$c(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=eg)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hn(e),null;case 6:if(t&&e.stateNode!=null)TP(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(de(166));if(n=Ga(nd.current),Ga(yi.current),Np(e)){if(s=e.stateNode,n=e.memoizedProps,s[di]=e,(i=s.nodeValue!==n)&&(t=Vs,t!==null))switch(t.tag){case 3:$p(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$p(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[di]=e,e.stateNode=s}return Hn(e),null;case 13:if(Rt(Vt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ot&&Ls!==null&&e.mode&1&&!(e.flags&128))W_(),Gc(),e.flags|=98560,i=!1;else if(i=Np(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(de(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(de(317));i[di]=e}else Gc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hn(e),i=!1}else Fr!==null&&(Tw(Fr),Fr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Vt.current&1?vn===0&&(vn=3):JC())),e.updateQueue!==null&&(e.flags|=4),Hn(e),null);case 4:return Kc(),xw(t,e),t===null&&Zh(e.stateNode.containerInfo),Hn(e),null;case 10:return OC(e.type._context),Hn(e),null;case 17:return Is(e.type)&&tg(),Hn(e),null;case 19:if(Rt(Vt),i=e.memoizedState,i===null)return Hn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)qu(i,!1);else{if(vn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lg(t),o!==null){for(e.flags|=128,qu(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return yt(Vt,Vt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Jt()>qc&&(e.flags|=128,s=!0,qu(i,!1),e.lanes=4194304)}else{if(!s)if(t=lg(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),qu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ot)return Hn(e),null}else 2*Jt()-i.renderingStartTime>qc&&n!==1073741824&&(e.flags|=128,s=!0,qu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Jt(),e.sibling=null,n=Vt.current,yt(Vt,s?n&1|2:n&1),e):(Hn(e),null);case 22:case 23:return ZC(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Fs&1073741824&&(Hn(e),e.subtreeFlags&6&&(e.flags|=8192)):Hn(e),null;case 24:return null;case 25:return null}throw Error(de(156,e.tag))}function a6(t,e){switch(DC(e),e.tag){case 1:return Is(e.type)&&tg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Kc(),Rt(Ts),Rt(es),BC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return VC(e),null;case 13:if(Rt(Vt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(de(340));Gc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(Vt),null;case 4:return Kc(),null;case 10:return OC(e.type._context),null;case 22:case 23:return ZC(),null;case 24:return null;default:return null}}var Ap=!1,Yn=!1,l6=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function vc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Gt(t,e,s)}else n.current=null}function vw(t,e,n){try{n()}catch(s){Gt(t,e,s)}}var NN=!1;function c6(t,e){if(tw=Qm,t=R_(),RC(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++c===r&&(a=o),d===i&&++u===s&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(nw={focusedElem:t,selectionRange:n},Qm=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,x=e.stateNode,g=x.getSnapshotBeforeUpdate(e.elementType===e.type?m:_r(e.type,m),v);x.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(b){Gt(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return p=NN,NN=!1,p}function Ah(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&vw(e,n,i)}r=r.next}while(r!==s)}}function kx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function yw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function IP(t){var e=t.alternate;e!==null&&(t.alternate=null,IP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[di],delete e[ed],delete e[iw],delete e[G5],delete e[H5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $P(t){return t.tag===5||t.tag===3||t.tag===4}function EN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$P(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eg));else if(s!==4&&(t=t.child,t!==null))for(bw(t,e,n),t=t.sibling;t!==null;)bw(t,e,n),t=t.sibling}function ww(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(ww(t,e,n),t=t.sibling;t!==null;)ww(t,e,n),t=t.sibling}var Pn=null,Pr=!1;function xo(t,e,n){for(n=n.child;n!==null;)NP(t,e,n),n=n.sibling}function NP(t,e,n){if(vi&&typeof vi.onCommitFiberUnmount=="function")try{vi.onCommitFiberUnmount(gx,n)}catch{}switch(n.tag){case 5:Yn||vc(n,e);case 6:var s=Pn,r=Pr;Pn=null,xo(t,e,n),Pn=s,Pr=r,Pn!==null&&(Pr?(t=Pn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pn.removeChild(n.stateNode));break;case 18:Pn!==null&&(Pr?(t=Pn,n=n.stateNode,t.nodeType===8?ly(t.parentNode,n):t.nodeType===1&&ly(t,n),qh(t)):ly(Pn,n.stateNode));break;case 4:s=Pn,r=Pr,Pn=n.stateNode.containerInfo,Pr=!0,xo(t,e,n),Pn=s,Pr=r;break;case 0:case 11:case 14:case 15:if(!Yn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&vw(n,e,o),r=r.next}while(r!==s)}xo(t,e,n);break;case 1:if(!Yn&&(vc(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Gt(n,e,a)}xo(t,e,n);break;case 21:xo(t,e,n);break;case 22:n.mode&1?(Yn=(s=Yn)||n.memoizedState!==null,xo(t,e,n),Yn=s):xo(t,e,n);break;default:xo(t,e,n)}}function RN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new l6),e.forEach(function(s){var r=v6.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function $r(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Pn=a.stateNode,Pr=!1;break e;case 3:Pn=a.stateNode.containerInfo,Pr=!0;break e;case 4:Pn=a.stateNode.containerInfo,Pr=!0;break e}a=a.return}if(Pn===null)throw Error(de(160));NP(i,o,r),Pn=null,Pr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Gt(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)EP(e,t),e=e.sibling}function EP(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($r(e,t),ri(t),s&4){try{Ah(3,t,t.return),kx(3,t)}catch(m){Gt(t,t.return,m)}try{Ah(5,t,t.return)}catch(m){Gt(t,t.return,m)}}break;case 1:$r(e,t),ri(t),s&512&&n!==null&&vc(n,n.return);break;case 5:if($r(e,t),ri(t),s&512&&n!==null&&vc(n,n.return),t.flags&32){var r=t.stateNode;try{Gh(r,"")}catch(m){Gt(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&QD(r,i),Gb(a,o);var c=Gb(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?n_(r,h):u==="dangerouslySetInnerHTML"?e_(r,h):u==="children"?Gh(r,h):xC(r,u,h,c)}switch(a){case"input":Vb(r,i);break;case"textarea":ZD(r,i);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?$c(r,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?$c(r,!!i.multiple,i.defaultValue,!0):$c(r,!!i.multiple,i.multiple?[]:"",!1))}r[ed]=i}catch(m){Gt(t,t.return,m)}}break;case 6:if($r(e,t),ri(t),s&4){if(t.stateNode===null)throw Error(de(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(m){Gt(t,t.return,m)}}break;case 3:if($r(e,t),ri(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{qh(e.containerInfo)}catch(m){Gt(t,t.return,m)}break;case 4:$r(e,t),ri(t);break;case 13:$r(e,t),ri(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(YC=Jt())),s&4&&RN(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Yn=(c=Yn)||u,$r(e,t),Yn=c):$r(e,t),ri(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ce=t,u=t.child;u!==null;){for(h=Ce=u;Ce!==null;){switch(d=Ce,f=d.child,d.tag){case 0:case 11:case 14:case 15:Ah(4,d,d.return);break;case 1:vc(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){s=d,n=d.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Gt(s,n,m)}}break;case 5:vc(d,d.return);break;case 22:if(d.memoizedState!==null){DN(h);continue}}f!==null?(f.return=d,Ce=f):DN(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=t_("display",o))}catch(m){Gt(t,t.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Gt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:$r(e,t),ri(t),s&4&&RN(t);break;case 21:break;default:$r(e,t),ri(t)}}function ri(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($P(n)){var s=n;break e}n=n.return}throw Error(de(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Gh(r,""),s.flags&=-33);var i=EN(t);ww(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=EN(t);bw(t,a,o);break;default:throw Error(de(161))}}catch(l){Gt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function u6(t,e,n){Ce=t,RP(t)}function RP(t,e,n){for(var s=(t.mode&1)!==0;Ce!==null;){var r=Ce,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||Ap;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Yn;a=Ap;var c=Yn;if(Ap=o,(Yn=l)&&!c)for(Ce=r;Ce!==null;)o=Ce,l=o.child,o.tag===22&&o.memoizedState!==null?_N(r):l!==null?(l.return=o,Ce=l):_N(r);for(;i!==null;)Ce=i,RP(i),i=i.sibling;Ce=r,Ap=a,Yn=c}AN(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Ce=i):AN(t)}}function AN(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yn||kx(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Yn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:_r(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&mN(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}mN(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&qh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}Yn||e.flags&512&&yw(e)}catch(d){Gt(e,e.return,d)}}if(e===t){Ce=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function DN(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function _N(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{kx(4,e)}catch(l){Gt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Gt(e,r,l)}}var i=e.return;try{yw(e)}catch(l){Gt(e,i,l)}break;case 5:var o=e.return;try{yw(e)}catch(l){Gt(e,o,l)}}}catch(l){Gt(e,e.return,l)}if(e===t){Ce=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ce=a;break}Ce=e.return}}var h6=Math.ceil,hg=ho.ReactCurrentDispatcher,XC=ho.ReactCurrentOwner,mr=ho.ReactCurrentBatchConfig,tt=0,$n=null,an=null,On=0,Fs=0,yc=da(0),vn=0,od=null,al=0,Tx=0,qC=0,Dh=null,bs=null,YC=0,qc=1/0,Vi=null,dg=!1,Cw=null,Bo=null,Dp=!1,Ao=null,fg=0,_h=0,Sw=null,Em=-1,Rm=0;function cs(){return tt&6?Jt():Em!==-1?Em:Em=Jt()}function jo(t){return t.mode&1?tt&2&&On!==0?On&-On:X5.transition!==null?(Rm===0&&(Rm=p_()),Rm):(t=lt,t!==0||(t=window.event,t=t===void 0?16:w_(t.type)),t):1}function Br(t,e,n,s){if(50<_h)throw _h=0,Sw=null,Error(de(185));Pd(t,n,s),(!(tt&2)||t!==$n)&&(t===$n&&(!(tt&2)&&(Tx|=n),vn===4&&Eo(t,On)),$s(t,s),n===1&&tt===0&&!(e.mode&1)&&(qc=Jt()+500,wx&&fa()))}function $s(t,e){var n=t.callbackNode;XH(t,e);var s=Ym(t,t===$n?On:0);if(s===0)n!==null&&j$(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&j$(n),e===1)t.tag===0?K5(PN.bind(null,t)):V_(PN.bind(null,t)),W5(function(){!(tt&6)&&fa()}),n=null;else{switch(m_(s)){case 1:n=CC;break;case 4:n=d_;break;case 16:n=qm;break;case 536870912:n=f_;break;default:n=qm}n=LP(n,AP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function AP(t,e){if(Em=-1,Rm=0,tt&6)throw Error(de(327));var n=t.callbackNode;if(Dc()&&t.callbackNode!==n)return null;var s=Ym(t,t===$n?On:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=pg(t,s);else{e=s;var r=tt;tt|=2;var i=_P();($n!==t||On!==e)&&(Vi=null,qc=Jt()+500,Qa(t,e));do try{p6();break}catch(a){DP(t,a)}while(1);FC(),hg.current=i,tt=r,an!==null?e=0:($n=null,On=0,e=vn)}if(e!==0){if(e===2&&(r=Yb(t),r!==0&&(s=r,e=kw(t,r))),e===1)throw n=od,Qa(t,0),Eo(t,s),$s(t,Jt()),n;if(e===6)Eo(t,s);else{if(r=t.current.alternate,!(s&30)&&!d6(r)&&(e=pg(t,s),e===2&&(i=Yb(t),i!==0&&(s=i,e=kw(t,i))),e===1))throw n=od,Qa(t,0),Eo(t,s),$s(t,Jt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(de(345));case 2:Fa(t,bs,Vi);break;case 3:if(Eo(t,s),(s&130023424)===s&&(e=YC+500-Jt(),10<e)){if(Ym(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){cs(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=rw(Fa.bind(null,t,bs,Vi),e);break}Fa(t,bs,Vi);break;case 4:if(Eo(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Vr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Jt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*h6(s/1960))-s,10<s){t.timeoutHandle=rw(Fa.bind(null,t,bs,Vi),s);break}Fa(t,bs,Vi);break;case 5:Fa(t,bs,Vi);break;default:throw Error(de(329))}}}return $s(t,Jt()),t.callbackNode===n?AP.bind(null,t):null}function kw(t,e){var n=Dh;return t.current.memoizedState.isDehydrated&&(Qa(t,e).flags|=256),t=pg(t,e),t!==2&&(e=bs,bs=n,e!==null&&Tw(e)),t}function Tw(t){bs===null?bs=t:bs.push.apply(bs,t)}function d6(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Gr(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Eo(t,e){for(e&=~qC,e&=~Tx,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vr(e),s=1<<n;t[n]=-1,e&=~s}}function PN(t){if(tt&6)throw Error(de(327));Dc();var e=Ym(t,0);if(!(e&1))return $s(t,Jt()),null;var n=pg(t,e);if(t.tag!==0&&n===2){var s=Yb(t);s!==0&&(e=s,n=kw(t,s))}if(n===1)throw n=od,Qa(t,0),Eo(t,e),$s(t,Jt()),n;if(n===6)throw Error(de(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fa(t,bs,Vi),$s(t,Jt()),null}function QC(t,e){var n=tt;tt|=1;try{return t(e)}finally{tt=n,tt===0&&(qc=Jt()+500,wx&&fa())}}function ll(t){Ao!==null&&Ao.tag===0&&!(tt&6)&&Dc();var e=tt;tt|=1;var n=mr.transition,s=lt;try{if(mr.transition=null,lt=1,t)return t()}finally{lt=s,mr.transition=n,tt=e,!(tt&6)&&fa()}}function ZC(){Fs=yc.current,Rt(yc)}function Qa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,j5(n)),an!==null)for(n=an.return;n!==null;){var s=n;switch(DC(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&tg();break;case 3:Kc(),Rt(Ts),Rt(es),BC();break;case 5:VC(s);break;case 4:Kc();break;case 13:Rt(Vt);break;case 19:Rt(Vt);break;case 10:OC(s.type._context);break;case 22:case 23:ZC()}n=n.return}if($n=t,an=t=Wo(t.current,null),On=Fs=e,vn=0,od=null,qC=Tx=al=0,bs=Dh=null,Ua!==null){for(e=0;e<Ua.length;e++)if(n=Ua[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Ua=null}return t}function DP(t,e){do{var n=an;try{if(FC(),Im.current=ug,cg){for(var s=jt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}cg=!1}if(ol=0,Tn=pn=jt=null,Rh=!1,sd=0,XC.current=null,n===null||n.return===null){vn=1,od=e,an=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=On,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=wN(o);if(f!==null){f.flags&=-257,CN(f,o,a,i,e),f.mode&1&&bN(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){bN(i,c,e),JC();break e}l=Error(de(426))}}else if(Ot&&a.mode&1){var v=wN(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),CN(v,o,a,i,e),_C(Xc(l,a));break e}}i=l=Xc(l,a),vn!==4&&(vn=2),Dh===null?Dh=[i]:Dh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=mP(i,l,e);pN(i,x);break e;case 1:a=l;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Bo===null||!Bo.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=gP(i,a,e);pN(i,b);break e}}i=i.return}while(i!==null)}FP(n)}catch(C){e=C,an===n&&n!==null&&(an=n=n.return);continue}break}while(1)}function _P(){var t=hg.current;return hg.current=ug,t===null?ug:t}function JC(){(vn===0||vn===3||vn===2)&&(vn=4),$n===null||!(al&268435455)&&!(Tx&268435455)||Eo($n,On)}function pg(t,e){var n=tt;tt|=2;var s=_P();($n!==t||On!==e)&&(Vi=null,Qa(t,e));do try{f6();break}catch(r){DP(t,r)}while(1);if(FC(),tt=n,hg.current=s,an!==null)throw Error(de(261));return $n=null,On=0,vn}function f6(){for(;an!==null;)PP(an)}function p6(){for(;an!==null&&!zH();)PP(an)}function PP(t){var e=MP(t.alternate,t,Fs);t.memoizedProps=t.pendingProps,e===null?FP(t):an=e,XC.current=null}function FP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=a6(n,e),n!==null){n.flags&=32767,an=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vn=6,an=null;return}}else if(n=o6(n,e,Fs),n!==null){an=n;return}if(e=e.sibling,e!==null){an=e;return}an=e=t}while(e!==null);vn===0&&(vn=5)}function Fa(t,e,n){var s=lt,r=mr.transition;try{mr.transition=null,lt=1,m6(t,e,n,s)}finally{mr.transition=r,lt=s}return null}function m6(t,e,n,s){do Dc();while(Ao!==null);if(tt&6)throw Error(de(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(de(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(qH(t,i),t===$n&&(an=$n=null,On=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Dp||(Dp=!0,LP(qm,function(){return Dc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=mr.transition,mr.transition=null;var o=lt;lt=1;var a=tt;tt|=4,XC.current=null,c6(t,n),EP(n,t),F5(nw),Qm=!!tw,nw=tw=null,t.current=n,u6(n),VH(),tt=a,lt=o,mr.transition=i}else t.current=n;if(Dp&&(Dp=!1,Ao=t,fg=r),i=t.pendingLanes,i===0&&(Bo=null),WH(n.stateNode),$s(t,Jt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(dg)throw dg=!1,t=Cw,Cw=null,t;return fg&1&&t.tag!==0&&Dc(),i=t.pendingLanes,i&1?t===Sw?_h++:(_h=0,Sw=t):_h=0,fa(),null}function Dc(){if(Ao!==null){var t=m_(fg),e=mr.transition,n=lt;try{if(mr.transition=null,lt=16>t?16:t,Ao===null)var s=!1;else{if(t=Ao,Ao=null,fg=0,tt&6)throw Error(de(331));var r=tt;for(tt|=4,Ce=t.current;Ce!==null;){var i=Ce,o=i.child;if(Ce.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Ce=c;Ce!==null;){var u=Ce;switch(u.tag){case 0:case 11:case 15:Ah(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ce=h;else for(;Ce!==null;){u=Ce;var d=u.sibling,f=u.return;if(IP(u),u===c){Ce=null;break}if(d!==null){d.return=f,Ce=d;break}Ce=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Ce=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ce=o;else e:for(;Ce!==null;){if(i=Ce,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ah(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Ce=x;break e}Ce=i.return}}var g=t.current;for(Ce=g;Ce!==null;){o=Ce;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Ce=y;else e:for(o=g;Ce!==null;){if(a=Ce,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:kx(9,a)}}catch(C){Gt(a,a.return,C)}if(a===o){Ce=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,Ce=b;break e}Ce=a.return}}if(tt=r,fa(),vi&&typeof vi.onPostCommitFiberRoot=="function")try{vi.onPostCommitFiberRoot(gx,t)}catch{}s=!0}return s}finally{lt=n,mr.transition=e}}return!1}function FN(t,e,n){e=Xc(n,e),e=mP(t,e,1),t=Vo(t,e,1),e=cs(),t!==null&&(Pd(t,1,e),$s(t,e))}function Gt(t,e,n){if(t.tag===3)FN(t,t,n);else for(;e!==null;){if(e.tag===3){FN(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Bo===null||!Bo.has(s))){t=Xc(n,t),t=gP(e,t,1),e=Vo(e,t,1),t=cs(),e!==null&&(Pd(e,1,t),$s(e,t));break}}e=e.return}}function g6(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=cs(),t.pingedLanes|=t.suspendedLanes&n,$n===t&&(On&n)===n&&(vn===4||vn===3&&(On&130023424)===On&&500>Jt()-YC?Qa(t,0):qC|=n),$s(t,e)}function OP(t,e){e===0&&(t.mode&1?(e=Cp,Cp<<=1,!(Cp&130023424)&&(Cp=4194304)):e=1);var n=cs();t=no(t,e),t!==null&&(Pd(t,e,n),$s(t,n))}function x6(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),OP(t,n)}function v6(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(de(314))}s!==null&&s.delete(e),OP(t,n)}var MP;MP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ts.current)Cs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Cs=!1,i6(t,e,n);Cs=!!(t.flags&131072)}else Cs=!1,Ot&&e.flags&1048576&&B_(e,rg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Nm(t,e),t=e.pendingProps;var r=Uc(e,es.current);Ac(e,n),r=WC(null,e,s,t,r,n);var i=UC();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Is(s)?(i=!0,ng(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,LC(e),r.updater=Sx,e.stateNode=r,r._reactInternals=e,hw(e,s,t,n),e=pw(null,e,s,!0,i,n)):(e.tag=0,Ot&&i&&AC(e),is(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Nm(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=b6(s),t=_r(s,t),r){case 0:e=fw(null,e,s,t,n);break e;case 1:e=TN(null,e,s,t,n);break e;case 11:e=SN(null,e,s,t,n);break e;case 14:e=kN(null,e,s,_r(s.type,t),n);break e}throw Error(de(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:_r(s,r),fw(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:_r(s,r),TN(t,e,s,r,n);case 3:e:{if(bP(e),t===null)throw Error(de(387));s=e.pendingProps,i=e.memoizedState,r=i.element,K_(t,e),ag(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Xc(Error(de(423)),e),e=IN(t,e,s,n,r);break e}else if(s!==r){r=Xc(Error(de(424)),e),e=IN(t,e,s,n,r);break e}else for(Ls=zo(e.stateNode.containerInfo.firstChild),Vs=e,Ot=!0,Fr=null,n=G_(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gc(),s===r){e=so(t,e,n);break e}is(t,e,s,n)}e=e.child}return e;case 5:return X_(e),t===null&&lw(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,sw(s,r)?o=null:i!==null&&sw(s,i)&&(e.flags|=32),yP(t,e),is(t,e,o,n),e.child;case 6:return t===null&&lw(e),null;case 13:return wP(t,e,n);case 4:return zC(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Hc(e,null,s,n):is(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:_r(s,r),SN(t,e,s,r,n);case 7:return is(t,e,e.pendingProps,n),e.child;case 8:return is(t,e,e.pendingProps.children,n),e.child;case 12:return is(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,yt(ig,s._currentValue),s._currentValue=o,i!==null)if(Gr(i.value,o)){if(i.children===r.children&&!Ts.current){e=so(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=Yi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),cw(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(de(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),cw(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}is(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Ac(e,n),r=xr(r),s=s(r),e.flags|=1,is(t,e,s,n),e.child;case 14:return s=e.type,r=_r(s,e.pendingProps),r=_r(s.type,r),kN(t,e,s,r,n);case 15:return xP(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:_r(s,r),Nm(t,e),e.tag=1,Is(s)?(t=!0,ng(e)):t=!1,Ac(e,n),pP(e,s,r),hw(e,s,r,n),pw(null,e,s,!0,t,n);case 19:return CP(t,e,n);case 22:return vP(t,e,n)}throw Error(de(156,e.tag))};function LP(t,e){return h_(t,e)}function y6(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(t,e,n,s){return new y6(t,e,n,s)}function eS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function b6(t){if(typeof t=="function")return eS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===yC)return 11;if(t===bC)return 14}return 2}function Wo(t,e){var n=t.alternate;return n===null?(n=cr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Am(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")eS(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case cc:return Za(n.children,r,i,e);case vC:o=8,r|=8;break;case Fb:return t=cr(12,n,e,r|2),t.elementType=Fb,t.lanes=i,t;case Ob:return t=cr(13,n,e,r),t.elementType=Ob,t.lanes=i,t;case Mb:return t=cr(19,n,e,r),t.elementType=Mb,t.lanes=i,t;case XD:return Ix(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case HD:o=10;break e;case KD:o=9;break e;case yC:o=11;break e;case bC:o=14;break e;case ko:o=16,s=null;break e}throw Error(de(130,t==null?t:typeof t,""))}return e=cr(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Za(t,e,n,s){return t=cr(7,t,s,e),t.lanes=n,t}function Ix(t,e,n,s){return t=cr(22,t,s,e),t.elementType=XD,t.lanes=n,t.stateNode={isHidden:!1},t}function gy(t,e,n){return t=cr(6,t,null,e),t.lanes=n,t}function xy(t,e,n){return e=cr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function w6(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qv(0),this.expirationTimes=Qv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qv(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function tS(t,e,n,s,r,i,o,a,l){return t=new w6(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},LC(i),t}function C6(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:lc,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function zP(t){if(!t)return Zo;t=t._reactInternals;e:{if(_l(t)!==t||t.tag!==1)throw Error(de(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Is(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(de(171))}if(t.tag===1){var n=t.type;if(Is(n))return z_(t,n,e)}return e}function VP(t,e,n,s,r,i,o,a,l){return t=tS(n,s,!0,t,r,i,o,a,l),t.context=zP(null),n=t.current,s=cs(),r=jo(n),i=Yi(s,r),i.callback=e??null,Vo(n,i,r),t.current.lanes=r,Pd(t,r,s),$s(t,s),t}function $x(t,e,n,s){var r=e.current,i=cs(),o=jo(r);return n=zP(n),e.context===null?e.context=n:e.pendingContext=n,e=Yi(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Vo(r,e,o),t!==null&&(Br(t,r,o,i),Tm(t,r,o)),o}function mg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ON(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function nS(t,e){ON(t,e),(t=t.alternate)&&ON(t,e)}function S6(){return null}var BP=typeof reportError=="function"?reportError:function(t){console.error(t)};function sS(t){this._internalRoot=t}Nx.prototype.render=sS.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(de(409));$x(t,e,null,null)};Nx.prototype.unmount=sS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ll(function(){$x(null,t,null,null)}),e[to]=null}};function Nx(t){this._internalRoot=t}Nx.prototype.unstable_scheduleHydration=function(t){if(t){var e=v_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<No.length&&e!==0&&e<No[n].priority;n++);No.splice(n,0,t),n===0&&b_(t)}};function rS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ex(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function MN(){}function k6(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=mg(o);i.call(c)}}var o=VP(e,s,t,0,null,!1,!1,"",MN);return t._reactRootContainer=o,t[to]=o.current,Zh(t.nodeType===8?t.parentNode:t),ll(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=mg(l);a.call(c)}}var l=tS(t,0,!1,null,null,!1,!1,"",MN);return t._reactRootContainer=l,t[to]=l.current,Zh(t.nodeType===8?t.parentNode:t),ll(function(){$x(e,l,n,s)}),l}function Rx(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=mg(o);a.call(l)}}$x(e,o,t,r)}else o=k6(n,e,t,r,s);return mg(o)}g_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ph(e.pendingLanes);n!==0&&(SC(e,n|1),$s(e,Jt()),!(tt&6)&&(qc=Jt()+500,fa()))}break;case 13:ll(function(){var s=no(t,1);if(s!==null){var r=cs();Br(s,t,1,r)}}),nS(t,1)}};kC=function(t){if(t.tag===13){var e=no(t,134217728);if(e!==null){var n=cs();Br(e,t,134217728,n)}nS(t,134217728)}};x_=function(t){if(t.tag===13){var e=jo(t),n=no(t,e);if(n!==null){var s=cs();Br(n,t,e,s)}nS(t,e)}};v_=function(){return lt};y_=function(t,e){var n=lt;try{return lt=t,e()}finally{lt=n}};Kb=function(t,e,n){switch(e){case"input":if(Vb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=bx(s);if(!r)throw Error(de(90));YD(s),Vb(s,r)}}}break;case"textarea":ZD(t,n);break;case"select":e=n.value,e!=null&&$c(t,!!n.multiple,e,!1)}};i_=QC;o_=ll;var T6={usingClientEntryPoint:!1,Events:[Od,fc,bx,s_,r_,QC]},Yu={findFiberByHostInstance:Wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},I6={bundleType:Yu.bundleType,version:Yu.version,rendererPackageName:Yu.rendererPackageName,rendererConfig:Yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=c_(t),t===null?null:t.stateNode},findFiberByHostInstance:Yu.findFiberByHostInstance||S6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _p=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_p.isDisabled&&_p.supportsFiber)try{gx=_p.inject(I6),vi=_p}catch{}}Ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T6;Ks.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rS(e))throw Error(de(200));return C6(t,e,null,n)};Ks.createRoot=function(t,e){if(!rS(t))throw Error(de(299));var n=!1,s="",r=BP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=tS(t,1,!1,null,null,n,!1,s,r),t[to]=e.current,Zh(t.nodeType===8?t.parentNode:t),new sS(e)};Ks.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(de(188)):(t=Object.keys(t).join(","),Error(de(268,t)));return t=c_(e),t=t===null?null:t.stateNode,t};Ks.flushSync=function(t){return ll(t)};Ks.hydrate=function(t,e,n){if(!Ex(e))throw Error(de(200));return Rx(null,t,e,!0,n)};Ks.hydrateRoot=function(t,e,n){if(!rS(t))throw Error(de(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=BP;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=VP(e,null,t,1,n??null,r,!1,i,o),t[to]=e.current,Zh(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Nx(e)};Ks.render=function(t,e,n){if(!Ex(e))throw Error(de(200));return Rx(null,t,e,!1,n)};Ks.unmountComponentAtNode=function(t){if(!Ex(t))throw Error(de(40));return t._reactRootContainer?(ll(function(){Rx(null,null,t,!1,function(){t._reactRootContainer=null,t[to]=null})}),!0):!1};Ks.unstable_batchedUpdates=QC;Ks.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Ex(n))throw Error(de(200));if(t==null||t._reactInternals===void 0)throw Error(de(38));return Rx(t,e,n,!1,s)};Ks.version="18.3.1-next-f1338f8080-20240426";function jP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jP)}catch(t){console.error(t)}}jP(),jD.exports=Ks;var Pl=jD.exports;const $6=ua(Pl);var LN=Pl;_b.createRoot=LN.createRoot,_b.hydrateRoot=LN.hydrateRoot;var WP={exports:{}},N6="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",E6=N6,R6=E6;function UP(){}function GP(){}GP.resetWarningCache=UP;var A6=function(){function t(s,r,i,o,a,l){if(l!==R6){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:GP,resetWarningCache:UP};return n.PropTypes=n,n};WP.exports=A6();var D6=WP.exports;const _t=ua(D6);function _6(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var HP=k,P6=_6(HP);function zN(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var O6=!!(typeof window<"u"&&window.document&&window.document.createElement);function M6(t,e,n){if(typeof t!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof e!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof n<"u"&&typeof n!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function s(r){return r.displayName||r.name||"Component"}return function(i){if(typeof i!="function")throw new Error("Expected WrappedComponent to be a React component.");var o=[],a;function l(){a=t(o.map(function(u){return u.props})),c.canUseDOM?e(a):n&&(a=n(a))}var c=function(u){F6(h,u);function h(){return u.apply(this,arguments)||this}h.peek=function(){return a},h.rewind=function(){if(h.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var p=a;return a=void 0,o=[],p};var d=h.prototype;return d.UNSAFE_componentWillMount=function(){o.push(this),l()},d.componentDidUpdate=function(){l()},d.componentWillUnmount=function(){var p=o.indexOf(this);o.splice(p,1),l()},d.render=function(){return P6.createElement(i,this.props)},h}(HP.PureComponent);return zN(c,"displayName","SideEffect("+s(i)+")"),zN(c,"canUseDOM",O6),c}}var L6=M6;const z6=ua(L6);var V6=typeof Element<"u",B6=typeof Map=="function",j6=typeof Set=="function",W6=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Dm(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,s,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(!Dm(t[s],e[s]))return!1;return!0}var i;if(B6&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(i=t.entries();!(s=i.next()).done;)if(!e.has(s.value[0]))return!1;for(i=t.entries();!(s=i.next()).done;)if(!Dm(s.value[1],e.get(s.value[0])))return!1;return!0}if(j6&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(i=t.entries();!(s=i.next()).done;)if(!e.has(s.value[0]))return!1;return!0}if(W6&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(t[s]!==e[s])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[s]))return!1;if(V6&&t instanceof Element)return!1;for(s=n;s--!==0;)if(!((r[s]==="_owner"||r[s]==="__v"||r[s]==="__o")&&t.$$typeof)&&!Dm(t[r[s]],e[r[s]]))return!1;return!0}return t!==t&&e!==e}var U6=function(e,n){try{return Dm(e,n)}catch(s){if((s.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw s}};const G6=ua(U6);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var VN=Object.getOwnPropertySymbols,H6=Object.prototype.hasOwnProperty,K6=Object.prototype.propertyIsEnumerable;function X6(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function q6(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var s=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(s.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(i){r[i]=i}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Y6=q6()?Object.assign:function(t,e){for(var n,s=X6(t),r,i=1;i<arguments.length;i++){n=Object(arguments[i]);for(var o in n)H6.call(n,o)&&(s[o]=n[o]);if(VN){r=VN(n);for(var a=0;a<r.length;a++)K6.call(n,r[a])&&(s[r[a]]=n[r[a]])}}return s};const Q6=ua(Y6);var Ja={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},ze={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(ze).map(function(t){return ze[t]});var Ft={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},gg={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},ad={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},Z6=Object.keys(gg).reduce(function(t,e){return t[gg[e]]=e,t},{}),J6=[ze.NOSCRIPT,ze.SCRIPT,ze.STYLE],Lr="data-react-helmet",eK=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tK=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},nK=function(){function t(e,n){for(var s=0;s<n.length;s++){var r=n[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),e}}(),ys=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},sK=function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},BN=function(t,e){var n={};for(var s in t)e.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s]);return n},rK=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t},Iw=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n===!1?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},iK=function(e){var n=_c(e,ze.TITLE),s=_c(e,ad.TITLE_TEMPLATE);if(s&&n)return s.replace(/%s/g,function(){return Array.isArray(n)?n.join(""):n});var r=_c(e,ad.DEFAULT_TITLE);return n||r||void 0},oK=function(e){return _c(e,ad.ON_CHANGE_CLIENT_STATE)||function(){}},vy=function(e,n){return n.filter(function(s){return typeof s[e]<"u"}).map(function(s){return s[e]}).reduce(function(s,r){return ys({},s,r)},{})},aK=function(e,n){return n.filter(function(s){return typeof s[ze.BASE]<"u"}).map(function(s){return s[ze.BASE]}).reverse().reduce(function(s,r){if(!s.length)for(var i=Object.keys(r),o=0;o<i.length;o++){var a=i[o],l=a.toLowerCase();if(e.indexOf(l)!==-1&&r[l])return s.concat(r)}return s},[])},Qu=function(e,n,s){var r={};return s.filter(function(i){return Array.isArray(i[e])?!0:(typeof i[e]<"u"&&hK("Helmet: "+e+' should be of type "Array". Instead found type "'+eK(i[e])+'"'),!1)}).map(function(i){return i[e]}).reverse().reduce(function(i,o){var a={};o.filter(function(d){for(var f=void 0,p=Object.keys(d),m=0;m<p.length;m++){var v=p[m],x=v.toLowerCase();n.indexOf(x)!==-1&&!(f===Ft.REL&&d[f].toLowerCase()==="canonical")&&!(x===Ft.REL&&d[x].toLowerCase()==="stylesheet")&&(f=x),n.indexOf(v)!==-1&&(v===Ft.INNER_HTML||v===Ft.CSS_TEXT||v===Ft.ITEM_PROP)&&(f=v)}if(!f||!d[f])return!1;var g=d[f].toLowerCase();return r[f]||(r[f]={}),a[f]||(a[f]={}),r[f][g]?!1:(a[f][g]=!0,!0)}).reverse().forEach(function(d){return i.push(d)});for(var l=Object.keys(a),c=0;c<l.length;c++){var u=l[c],h=Q6({},r[u],a[u]);r[u]=h}return i},[]).reverse()},_c=function(e,n){for(var s=e.length-1;s>=0;s--){var r=e[s];if(r.hasOwnProperty(n))return r[n]}return null},lK=function(e){return{baseTag:aK([Ft.HREF,Ft.TARGET],e),bodyAttributes:vy(Ja.BODY,e),defer:_c(e,ad.DEFER),encode:_c(e,ad.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:vy(Ja.HTML,e),linkTags:Qu(ze.LINK,[Ft.REL,Ft.HREF],e),metaTags:Qu(ze.META,[Ft.NAME,Ft.CHARSET,Ft.HTTPEQUIV,Ft.PROPERTY,Ft.ITEM_PROP],e),noscriptTags:Qu(ze.NOSCRIPT,[Ft.INNER_HTML],e),onChangeClientState:oK(e),scriptTags:Qu(ze.SCRIPT,[Ft.SRC,Ft.INNER_HTML],e),styleTags:Qu(ze.STYLE,[Ft.CSS_TEXT],e),title:iK(e),titleAttributes:vy(Ja.TITLE,e)}},$w=function(){var t=Date.now();return function(e){var n=Date.now();n-t>16?(t=n,e(n)):setTimeout(function(){$w(e)},0)}}(),jN=function(e){return clearTimeout(e)},cK=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||$w:global.requestAnimationFrame||$w,uK=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||jN:global.cancelAnimationFrame||jN,hK=function(e){return console&&typeof console.warn=="function"&&console.warn(e)},Zu=null,dK=function(e){Zu&&uK(Zu),e.defer?Zu=cK(function(){WN(e,function(){Zu=null})}):(WN(e),Zu=null)},WN=function(e,n){var s=e.baseTag,r=e.bodyAttributes,i=e.htmlAttributes,o=e.linkTags,a=e.metaTags,l=e.noscriptTags,c=e.onChangeClientState,u=e.scriptTags,h=e.styleTags,d=e.title,f=e.titleAttributes;Nw(ze.BODY,r),Nw(ze.HTML,i),fK(d,f);var p={baseTag:Ql(ze.BASE,s),linkTags:Ql(ze.LINK,o),metaTags:Ql(ze.META,a),noscriptTags:Ql(ze.NOSCRIPT,l),scriptTags:Ql(ze.SCRIPT,u),styleTags:Ql(ze.STYLE,h)},m={},v={};Object.keys(p).forEach(function(x){var g=p[x],y=g.newTags,b=g.oldTags;y.length&&(m[x]=y),b.length&&(v[x]=p[x].oldTags)}),n&&n(),c(e,m,v)},KP=function(e){return Array.isArray(e)?e.join(""):e},fK=function(e,n){typeof e<"u"&&document.title!==e&&(document.title=KP(e)),Nw(ze.TITLE,n)},Nw=function(e,n){var s=document.getElementsByTagName(e)[0];if(s){for(var r=s.getAttribute(Lr),i=r?r.split(","):[],o=[].concat(i),a=Object.keys(n),l=0;l<a.length;l++){var c=a[l],u=n[c]||"";s.getAttribute(c)!==u&&s.setAttribute(c,u),i.indexOf(c)===-1&&i.push(c);var h=o.indexOf(c);h!==-1&&o.splice(h,1)}for(var d=o.length-1;d>=0;d--)s.removeAttribute(o[d]);i.length===o.length?s.removeAttribute(Lr):s.getAttribute(Lr)!==a.join(",")&&s.setAttribute(Lr,a.join(","))}},Ql=function(e,n){var s=document.head||document.querySelector(ze.HEAD),r=s.querySelectorAll(e+"["+Lr+"]"),i=Array.prototype.slice.call(r),o=[],a=void 0;return n&&n.length&&n.forEach(function(l){var c=document.createElement(e);for(var u in l)if(l.hasOwnProperty(u))if(u===Ft.INNER_HTML)c.innerHTML=l.innerHTML;else if(u===Ft.CSS_TEXT)c.styleSheet?c.styleSheet.cssText=l.cssText:c.appendChild(document.createTextNode(l.cssText));else{var h=typeof l[u]>"u"?"":l[u];c.setAttribute(u,h)}c.setAttribute(Lr,"true"),i.some(function(d,f){return a=f,c.isEqualNode(d)})?i.splice(a,1):o.push(c)}),i.forEach(function(l){return l.parentNode.removeChild(l)}),o.forEach(function(l){return s.appendChild(l)}),{oldTags:i,newTags:o}},XP=function(e){return Object.keys(e).reduce(function(n,s){var r=typeof e[s]<"u"?s+'="'+e[s]+'"':""+s;return n?n+" "+r:r},"")},pK=function(e,n,s,r){var i=XP(s),o=KP(n);return i?"<"+e+" "+Lr+'="true" '+i+">"+Iw(o,r)+"</"+e+">":"<"+e+" "+Lr+'="true">'+Iw(o,r)+"</"+e+">"},mK=function(e,n,s){return n.reduce(function(r,i){var o=Object.keys(i).filter(function(c){return!(c===Ft.INNER_HTML||c===Ft.CSS_TEXT)}).reduce(function(c,u){var h=typeof i[u]>"u"?u:u+'="'+Iw(i[u],s)+'"';return c?c+" "+h:h},""),a=i.innerHTML||i.cssText||"",l=J6.indexOf(e)===-1;return r+"<"+e+" "+Lr+'="true" '+o+(l?"/>":">"+a+"</"+e+">")},"")},qP=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(e).reduce(function(s,r){return s[gg[r]||r]=e[r],s},n)},gK=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(e).reduce(function(s,r){return s[Z6[r]||r]=e[r],s},n)},xK=function(e,n,s){var r,i=(r={key:n},r[Lr]=!0,r),o=qP(s,i);return[oe.createElement(ze.TITLE,o,n)]},vK=function(e,n){return n.map(function(s,r){var i,o=(i={key:r},i[Lr]=!0,i);return Object.keys(s).forEach(function(a){var l=gg[a]||a;if(l===Ft.INNER_HTML||l===Ft.CSS_TEXT){var c=s.innerHTML||s.cssText;o.dangerouslySetInnerHTML={__html:c}}else o[l]=s[a]}),oe.createElement(e,o)})},zi=function(e,n,s){switch(e){case ze.TITLE:return{toComponent:function(){return xK(e,n.title,n.titleAttributes)},toString:function(){return pK(e,n.title,n.titleAttributes,s)}};case Ja.BODY:case Ja.HTML:return{toComponent:function(){return qP(n)},toString:function(){return XP(n)}};default:return{toComponent:function(){return vK(e,n)},toString:function(){return mK(e,n,s)}}}},YP=function(e){var n=e.baseTag,s=e.bodyAttributes,r=e.encode,i=e.htmlAttributes,o=e.linkTags,a=e.metaTags,l=e.noscriptTags,c=e.scriptTags,u=e.styleTags,h=e.title,d=h===void 0?"":h,f=e.titleAttributes;return{base:zi(ze.BASE,n,r),bodyAttributes:zi(Ja.BODY,s,r),htmlAttributes:zi(Ja.HTML,i,r),link:zi(ze.LINK,o,r),meta:zi(ze.META,a,r),noscript:zi(ze.NOSCRIPT,l,r),script:zi(ze.SCRIPT,c,r),style:zi(ze.STYLE,u,r),title:zi(ze.TITLE,{title:d,titleAttributes:f},r)}},yK=function(e){var n,s;return s=n=function(r){sK(i,r);function i(){return tK(this,i),rK(this,r.apply(this,arguments))}return i.prototype.shouldComponentUpdate=function(a){return!G6(this.props,a)},i.prototype.mapNestedChildrenToProps=function(a,l){if(!l)return null;switch(a.type){case ze.SCRIPT:case ze.NOSCRIPT:return{innerHTML:l};case ze.STYLE:return{cssText:l}}throw new Error("<"+a.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},i.prototype.flattenArrayTypeChildren=function(a){var l,c=a.child,u=a.arrayTypeChildren,h=a.newChildProps,d=a.nestedChildren;return ys({},u,(l={},l[c.type]=[].concat(u[c.type]||[],[ys({},h,this.mapNestedChildrenToProps(c,d))]),l))},i.prototype.mapObjectTypeChildren=function(a){var l,c,u=a.child,h=a.newProps,d=a.newChildProps,f=a.nestedChildren;switch(u.type){case ze.TITLE:return ys({},h,(l={},l[u.type]=f,l.titleAttributes=ys({},d),l));case ze.BODY:return ys({},h,{bodyAttributes:ys({},d)});case ze.HTML:return ys({},h,{htmlAttributes:ys({},d)})}return ys({},h,(c={},c[u.type]=ys({},d),c))},i.prototype.mapArrayTypeChildrenToProps=function(a,l){var c=ys({},l);return Object.keys(a).forEach(function(u){var h;c=ys({},c,(h={},h[u]=a[u],h))}),c},i.prototype.warnOnInvalidChildren=function(a,l){return!0},i.prototype.mapChildrenToProps=function(a,l){var c=this,u={};return oe.Children.forEach(a,function(h){if(!(!h||!h.props)){var d=h.props,f=d.children,p=BN(d,["children"]),m=gK(p);switch(c.warnOnInvalidChildren(h,f),h.type){case ze.LINK:case ze.META:case ze.NOSCRIPT:case ze.SCRIPT:case ze.STYLE:u=c.flattenArrayTypeChildren({child:h,arrayTypeChildren:u,newChildProps:m,nestedChildren:f});break;default:l=c.mapObjectTypeChildren({child:h,newProps:l,newChildProps:m,nestedChildren:f});break}}}),l=this.mapArrayTypeChildrenToProps(u,l),l},i.prototype.render=function(){var a=this.props,l=a.children,c=BN(a,["children"]),u=ys({},c);return l&&(u=this.mapChildrenToProps(l,u)),oe.createElement(e,u)},nK(i,null,[{key:"canUseDOM",set:function(a){e.canUseDOM=a}}]),i}(oe.Component),n.propTypes={base:_t.object,bodyAttributes:_t.object,children:_t.oneOfType([_t.arrayOf(_t.node),_t.node]),defaultTitle:_t.string,defer:_t.bool,encodeSpecialCharacters:_t.bool,htmlAttributes:_t.object,link:_t.arrayOf(_t.object),meta:_t.arrayOf(_t.object),noscript:_t.arrayOf(_t.object),onChangeClientState:_t.func,script:_t.arrayOf(_t.object),style:_t.arrayOf(_t.object),title:_t.string,titleAttributes:_t.object,titleTemplate:_t.string},n.defaultProps={defer:!0,encodeSpecialCharacters:!0},n.peek=e.peek,n.rewind=function(){var r=e.rewind();return r||(r=YP({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),r},s},bK=function(){return null},wK=z6(lK,dK,YP)(bK),Ew=yK(wK);Ew.renderStatic=Ew.rewind;const QP=k.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Ax=k.createContext({}),Dx=k.createContext(null),_x=typeof document<"u",iS=_x?k.useLayoutEffect:k.useEffect,ZP=k.createContext({strict:!1}),oS=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),CK="framerAppearId",JP="data-"+oS(CK);function SK(t,e,n,s){const{visualElement:r}=k.useContext(Ax),i=k.useContext(ZP),o=k.useContext(Dx),a=k.useContext(QP).reducedMotion,l=k.useRef();s=s||i.renderer,!l.current&&s&&(l.current=s(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;k.useInsertionEffect(()=>{c&&c.update(n,o)});const u=k.useRef(!!(n[JP]&&!window.HandoffComplete));return iS(()=>{c&&(c.render(),u.current&&c.animationState&&c.animationState.animateChanges())}),k.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),c}function bc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function kK(t,e,n){return k.useCallback(s=>{s&&t.mount&&t.mount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):bc(n)&&(n.current=s))},[e])}function ld(t){return typeof t=="string"||Array.isArray(t)}function Px(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const aS=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],lS=["initial",...aS];function Fx(t){return Px(t.animate)||lS.some(e=>ld(t[e]))}function eF(t){return!!(Fx(t)||t.variants)}function TK(t,e){if(Fx(t)){const{initial:n,animate:s}=t;return{initial:n===!1||ld(n)?n:void 0,animate:ld(s)?s:void 0}}return t.inherit!==!1?e:{}}function IK(t){const{initial:e,animate:n}=TK(t,k.useContext(Ax));return k.useMemo(()=>({initial:e,animate:n}),[UN(e),UN(n)])}function UN(t){return Array.isArray(t)?t.join(" "):t}const GN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},cd={};for(const t in GN)cd[t]={isEnabled:e=>GN[t].some(n=>!!e[n])};function $K(t){for(const e in t)cd[e]={...cd[e],...t[e]}}const cS=k.createContext({}),tF=k.createContext({}),NK=Symbol.for("motionComponentSymbol");function EK({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){t&&$K(t);function i(a,l){let c;const u={...k.useContext(QP),...a,layoutId:RK(a)},{isStatic:h}=u,d=IK(a),f=s(a,h);if(!h&&_x){d.visualElement=SK(r,f,u,e);const p=k.useContext(tF),m=k.useContext(ZP).strict;d.visualElement&&(c=d.visualElement.loadFeatures(u,m,t,p))}return k.createElement(Ax.Provider,{value:d},c&&d.visualElement?k.createElement(c,{visualElement:d.visualElement,...u}):null,n(r,a,kK(f,d.visualElement,l),f,h,d.visualElement))}const o=k.forwardRef(i);return o[NK]=r,o}function RK({layoutId:t}){const e=k.useContext(cS).id;return e&&t!==void 0?e+"-"+t:t}function AK(t){function e(s,r={}){return EK(t(s,r))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(s,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const DK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function uS(t){return typeof t!="string"||t.includes("-")?!1:!!(DK.indexOf(t)>-1||/[A-Z]/.test(t))}const xg={};function _K(t){Object.assign(xg,t)}const Ld=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fl=new Set(Ld);function nF(t,{layout:e,layoutId:n}){return Fl.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!xg[t]||t==="opacity")}const Es=t=>!!(t&&t.getVelocity),PK={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},FK=Ld.length;function OK(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},s,r){let i="";for(let o=0;o<FK;o++){const a=Ld[o];if(t[a]!==void 0){const l=PK[a]||a;i+=`${l}(${t[a]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),r?i=r(t,s?"":i):n&&s&&(i="none"),i}const sF=t=>e=>typeof e=="string"&&e.startsWith(t),rF=sF("--"),Rw=sF("var(--"),MK=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,LK=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Jo=(t,e,n)=>Math.min(Math.max(n,t),e),Ol={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ph={...Ol,transform:t=>Jo(0,1,t)},Pp={...Ol,default:1},Fh=t=>Math.round(t*1e5)/1e5,Ox=/(-)?([\d]*\.?[\d])+/g,iF=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,zK=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function zd(t){return typeof t=="string"}const Vd=t=>({test:e=>zd(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Co=Vd("deg"),bi=Vd("%"),Pe=Vd("px"),VK=Vd("vh"),BK=Vd("vw"),HN={...bi,parse:t=>bi.parse(t)/100,transform:t=>bi.transform(t*100)},KN={...Ol,transform:Math.round},oF={borderWidth:Pe,borderTopWidth:Pe,borderRightWidth:Pe,borderBottomWidth:Pe,borderLeftWidth:Pe,borderRadius:Pe,radius:Pe,borderTopLeftRadius:Pe,borderTopRightRadius:Pe,borderBottomRightRadius:Pe,borderBottomLeftRadius:Pe,width:Pe,maxWidth:Pe,height:Pe,maxHeight:Pe,size:Pe,top:Pe,right:Pe,bottom:Pe,left:Pe,padding:Pe,paddingTop:Pe,paddingRight:Pe,paddingBottom:Pe,paddingLeft:Pe,margin:Pe,marginTop:Pe,marginRight:Pe,marginBottom:Pe,marginLeft:Pe,rotate:Co,rotateX:Co,rotateY:Co,rotateZ:Co,scale:Pp,scaleX:Pp,scaleY:Pp,scaleZ:Pp,skew:Co,skewX:Co,skewY:Co,distance:Pe,translateX:Pe,translateY:Pe,translateZ:Pe,x:Pe,y:Pe,z:Pe,perspective:Pe,transformPerspective:Pe,opacity:Ph,originX:HN,originY:HN,originZ:Pe,zIndex:KN,fillOpacity:Ph,strokeOpacity:Ph,numOctaves:KN};function hS(t,e,n,s){const{style:r,vars:i,transform:o,transformOrigin:a}=t;let l=!1,c=!1,u=!0;for(const h in e){const d=e[h];if(rF(h)){i[h]=d;continue}const f=oF[h],p=LK(d,f);if(Fl.has(h)){if(l=!0,o[h]=p,!u)continue;d!==(f.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,a[h]=p):r[h]=p}if(e.transform||(l||s?r.transform=OK(t.transform,n,u,s):r.transform&&(r.transform="none")),c){const{originX:h="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${h} ${d} ${f}`}}const dS=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function aF(t,e,n){for(const s in e)!Es(e[s])&&!nF(s,n)&&(t[s]=e[s])}function jK({transformTemplate:t},e,n){return k.useMemo(()=>{const s=dS();return hS(s,e,{enableHardwareAcceleration:!n},t),Object.assign({},s.vars,s.style)},[e])}function WK(t,e,n){const s=t.style||{},r={};return aF(r,s,t),Object.assign(r,jK(t,e,n)),t.transformValues?t.transformValues(r):r}function UK(t,e,n){const s={},r=WK(t,e,n);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=r,s}const GK=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vg(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||GK.has(t)}let lF=t=>!vg(t);function HK(t){t&&(lF=e=>e.startsWith("on")?!vg(e):t(e))}try{HK(require("@emotion/is-prop-valid").default)}catch{}function KK(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(lF(r)||n===!0&&vg(r)||!e&&!vg(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function XN(t,e,n){return typeof t=="string"?t:Pe.transform(e+n*t)}function XK(t,e,n){const s=XN(e,t.x,t.width),r=XN(n,t.y,t.height);return`${s} ${r}`}const qK={offset:"stroke-dashoffset",array:"stroke-dasharray"},YK={offset:"strokeDashoffset",array:"strokeDasharray"};function QK(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?qK:YK;t[i.offset]=Pe.transform(-s);const o=Pe.transform(e),a=Pe.transform(n);t[i.array]=`${o} ${a}`}function fS(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h,d){if(hS(t,c,u,d),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:p,dimensions:m}=t;f.transform&&(m&&(p.transform=f.transform),delete f.transform),m&&(r!==void 0||i!==void 0||p.transform)&&(p.transformOrigin=XK(m,r!==void 0?r:.5,i!==void 0?i:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),s!==void 0&&(f.scale=s),o!==void 0&&QK(f,o,a,l,!1)}const cF=()=>({...dS(),attrs:{}}),pS=t=>typeof t=="string"&&t.toLowerCase()==="svg";function ZK(t,e,n,s){const r=k.useMemo(()=>{const i=cF();return fS(i,e,{enableHardwareAcceleration:!1},pS(s),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};aF(i,t.style,t),r.style={...i,...r.style}}return r}function JK(t=!1){return(n,s,r,{latestValues:i},o)=>{const l=(uS(n)?ZK:UK)(s,i,o,n),u={...KK(s,typeof n=="string",t),...l,ref:r},{children:h}=s,d=k.useMemo(()=>Es(h)?h.get():h,[h]);return k.createElement(n,{...u,children:d})}}function uF(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const i in n)t.style.setProperty(i,n[i])}const hF=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function dF(t,e,n,s){uF(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(hF.has(r)?r:oS(r),e.attrs[r])}function mS(t,e){const{style:n}=t,s={};for(const r in n)(Es(n[r])||e.style&&Es(e.style[r])||nF(r,t))&&(s[r]=n[r]);return s}function fF(t,e){const n=mS(t,e);for(const s in t)if(Es(t[s])||Es(e[s])){const r=Ld.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[r]=t[s]}return n}function gS(t,e,n,s={},r={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,s,r)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,s,r)),e}function pF(t){const e=k.useRef(null);return e.current===null&&(e.current=t()),e.current}const yg=t=>Array.isArray(t),eX=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),tX=t=>yg(t)?t[t.length-1]||0:t;function _m(t){const e=Es(t)?t.get():t;return eX(e)?e.toValue():e}function nX({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},s,r,i){const o={latestValues:sX(s,r,i,t),renderState:e()};return n&&(o.mount=a=>n(s,a,o)),o}const mF=t=>(e,n)=>{const s=k.useContext(Ax),r=k.useContext(Dx),i=()=>nX(t,e,s,r);return n?i():pF(i)};function sX(t,e,n,s){const r={},i=s(t,{});for(const d in i)r[d]=_m(i[d]);let{initial:o,animate:a}=t;const l=Fx(t),c=eF(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;return h&&typeof h!="boolean"&&!Px(h)&&(Array.isArray(h)?h:[h]).forEach(f=>{const p=gS(t,f);if(!p)return;const{transitionEnd:m,transition:v,...x}=p;for(const g in x){let y=x[g];if(Array.isArray(y)){const b=u?y.length-1:0;y=y[b]}y!==null&&(r[g]=y)}for(const g in m)r[g]=m[g]}),r}const Ht=t=>t;class qN{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function rX(t){let e=new qN,n=new qN,s=0,r=!1,i=!1;const o=new WeakSet,a={schedule:(l,c=!1,u=!1)=>{const h=u&&r,d=h?e:n;return c&&o.add(l),d.add(l)&&h&&r&&(s=e.order.length),l},cancel:l=>{n.remove(l),o.delete(l)},process:l=>{if(r){i=!0;return}if(r=!0,[e,n]=[n,e],n.clear(),s=e.order.length,s)for(let c=0;c<s;c++){const u=e.order[c];u(l),o.has(u)&&(a.schedule(u),t())}r=!1,i&&(i=!1,a.process(l))}};return a}const Fp=["prepare","read","update","preRender","render","postRender"],iX=40;function oX(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=Fp.reduce((h,d)=>(h[d]=rX(()=>n=!0),h),{}),o=h=>i[h].process(r),a=()=>{const h=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(h-r.timestamp,iX),1),r.timestamp=h,r.isProcessing=!0,Fp.forEach(o),r.isProcessing=!1,n&&e&&(s=!1,t(a))},l=()=>{n=!0,s=!0,r.isProcessing||t(a)};return{schedule:Fp.reduce((h,d)=>{const f=i[d];return h[d]=(p,m=!1,v=!1)=>(n||l(),f.schedule(p,m,v)),h},{}),cancel:h=>Fp.forEach(d=>i[d].cancel(h)),state:r,steps:i}}const{schedule:bt,cancel:ro,state:Kn,steps:yy}=oX(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ht,!0),aX={useVisualState:mF({scrapeMotionValuesFromProps:fF,createRenderState:cF,onMount:(t,e,{renderState:n,latestValues:s})=>{bt.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),bt.render(()=>{fS(n,s,{enableHardwareAcceleration:!1},pS(e.tagName),t.transformTemplate),dF(e,n)})}})},lX={useVisualState:mF({scrapeMotionValuesFromProps:mS,createRenderState:dS})};function cX(t,{forwardMotionProps:e=!1},n,s){return{...uS(t)?aX:lX,preloadedFeatures:n,useRender:JK(e),createVisualElement:s,Component:t}}function Hi(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}const gF=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Mx(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const uX=t=>e=>gF(e)&&t(e,Mx(e));function Qi(t,e,n,s){return Hi(t,e,uX(n),s)}const hX=(t,e)=>n=>e(t(n)),Uo=(...t)=>t.reduce(hX);function xF(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const YN=xF("dragHorizontal"),QN=xF("dragVertical");function vF(t){let e=!1;if(t==="y")e=QN();else if(t==="x")e=YN();else{const n=YN(),s=QN();n&&s?e=()=>{n(),s()}:(n&&n(),s&&s())}return e}function yF(){const t=vF(!0);return t?(t(),!1):!0}class pa{constructor(e){this.isMounted=!1,this.node=e}update(){}}function ZN(t,e){const n="pointer"+(e?"enter":"leave"),s="onHover"+(e?"Start":"End"),r=(i,o)=>{if(i.pointerType==="touch"||yF())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[s]&&bt.update(()=>a[s](i,o))};return Qi(t.current,n,r,{passive:!t.getProps()[s]})}class dX extends pa{mount(){this.unmount=Uo(ZN(this.node,!0),ZN(this.node,!1))}unmount(){}}class fX extends pa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Uo(Hi(this.node.current,"focus",()=>this.onFocus()),Hi(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const bF=(t,e)=>e?t===e?!0:bF(t,e.parentElement):!1;function by(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,Mx(n))}class pX extends pa{constructor(){super(...arguments),this.removeStartListeners=Ht,this.removeEndListeners=Ht,this.removeAccessibleListeners=Ht,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),i=Qi(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:h}=this.node.getProps();bt.update(()=>{!h&&!bF(this.node.current,a.target)?u&&u(a,l):c&&c(a,l)})},{passive:!(s.onTap||s.onPointerUp)}),o=Qi(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=Uo(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||by("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&bt.update(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=Hi(this.node.current,"keyup",o),by("down",(a,l)=>{this.startPress(a,l)})},n=Hi(this.node.current,"keydown",e),s=()=>{this.isPressing&&by("cancel",(i,o)=>this.cancelPress(i,o))},r=Hi(this.node.current,"blur",s);this.removeAccessibleListeners=Uo(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:s,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&bt.update(()=>s(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!yF()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&bt.update(()=>s(e,n))}mount(){const e=this.node.getProps(),n=Qi(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),s=Hi(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Uo(n,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Aw=new WeakMap,wy=new WeakMap,mX=t=>{const e=Aw.get(t.target);e&&e(t)},gX=t=>{t.forEach(mX)};function xX({root:t,...e}){const n=t||document;wy.has(n)||wy.set(n,{});const s=wy.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(gX,{root:t,...e})),s[r]}function vX(t,e,n){const s=xX(e);return Aw.set(t,n),s.observe(t),()=>{Aw.delete(t),s.unobserve(t)}}const yX={some:0,all:1};class bX extends pa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:yX[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return vX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(wX(e,n))&&this.startObserver()}unmount(){}}function wX({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const CX={inView:{Feature:bX},tap:{Feature:pX},focus:{Feature:fX},hover:{Feature:dX}};function wF(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function SX(t){const e={};return t.values.forEach((n,s)=>e[s]=n.get()),e}function kX(t){const e={};return t.values.forEach((n,s)=>e[s]=n.getVelocity()),e}function Lx(t,e,n){const s=t.getProps();return gS(s,e,n!==void 0?n:s.custom,SX(t),kX(t))}let TX=Ht,xS=Ht;const Go=t=>t*1e3,Zi=t=>t/1e3,IX={current:!1},CF=t=>Array.isArray(t)&&typeof t[0]=="number";function SF(t){return!!(!t||typeof t=="string"&&kF[t]||CF(t)||Array.isArray(t)&&t.every(SF))}const gh=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,kF={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gh([0,.65,.55,1]),circOut:gh([.55,0,1,.45]),backIn:gh([.31,.01,.66,-.59]),backOut:gh([.33,1.53,.69,.99])};function TF(t){if(t)return CF(t)?gh(t):Array.isArray(t)?t.map(TF):kF[t]}function $X(t,e,n,{delay:s=0,duration:r,repeat:i=0,repeatType:o="loop",ease:a,times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=TF(a);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function NX(t,{repeat:e,repeatType:n="loop"}){const s=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[s]}const IF=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,EX=1e-7,RX=12;function AX(t,e,n,s,r){let i,o,a=0;do o=e+(n-e)/2,i=IF(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>EX&&++a<RX);return o}function Bd(t,e,n,s){if(t===e&&n===s)return Ht;const r=i=>AX(i,0,1,t,n);return i=>i===0||i===1?i:IF(r(i),e,s)}const DX=Bd(.42,0,1,1),_X=Bd(0,0,.58,1),$F=Bd(.42,0,.58,1),PX=t=>Array.isArray(t)&&typeof t[0]!="number",NF=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,EF=t=>e=>1-t(1-e),vS=t=>1-Math.sin(Math.acos(t)),RF=EF(vS),FX=NF(vS),AF=Bd(.33,1.53,.69,.99),yS=EF(AF),OX=NF(yS),MX=t=>(t*=2)<1?.5*yS(t):.5*(2-Math.pow(2,-10*(t-1))),LX={linear:Ht,easeIn:DX,easeInOut:$F,easeOut:_X,circIn:vS,circInOut:FX,circOut:RF,backIn:yS,backInOut:OX,backOut:AF,anticipate:MX},JN=t=>{if(Array.isArray(t)){xS(t.length===4);const[e,n,s,r]=t;return Bd(e,n,s,r)}else if(typeof t=="string")return LX[t];return t},bS=(t,e)=>n=>!!(zd(n)&&zK.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),DF=(t,e,n)=>s=>{if(!zd(s))return s;const[r,i,o,a]=s.match(Ox);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},zX=t=>Jo(0,255,t),Cy={...Ol,transform:t=>Math.round(zX(t))},Ha={test:bS("rgb","red"),parse:DF("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Cy.transform(t)+", "+Cy.transform(e)+", "+Cy.transform(n)+", "+Fh(Ph.transform(s))+")"};function VX(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const Dw={test:bS("#"),parse:VX,transform:Ha.transform},wc={test:bS("hsl","hue"),parse:DF("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+bi.transform(Fh(e))+", "+bi.transform(Fh(n))+", "+Fh(Ph.transform(s))+")"},ss={test:t=>Ha.test(t)||Dw.test(t)||wc.test(t),parse:t=>Ha.test(t)?Ha.parse(t):wc.test(t)?wc.parse(t):Dw.parse(t),transform:t=>zd(t)?t:t.hasOwnProperty("red")?Ha.transform(t):wc.transform(t)},Bt=(t,e,n)=>-n*t+n*e+t;function Sy(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function BX({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=Sy(l,a,t+1/3),i=Sy(l,a,t),o=Sy(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}const ky=(t,e,n)=>{const s=t*t;return Math.sqrt(Math.max(0,n*(e*e-s)+s))},jX=[Dw,Ha,wc],WX=t=>jX.find(e=>e.test(t));function eE(t){const e=WX(t);let n=e.parse(t);return e===wc&&(n=BX(n)),n}const _F=(t,e)=>{const n=eE(t),s=eE(e),r={...n};return i=>(r.red=ky(n.red,s.red,i),r.green=ky(n.green,s.green,i),r.blue=ky(n.blue,s.blue,i),r.alpha=Bt(n.alpha,s.alpha,i),Ha.transform(r))};function UX(t){var e,n;return isNaN(t)&&zd(t)&&(((e=t.match(Ox))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(iF))===null||n===void 0?void 0:n.length)||0)>0}const PF={regex:MK,countKey:"Vars",token:"${v}",parse:Ht},FF={regex:iF,countKey:"Colors",token:"${c}",parse:ss.parse},OF={regex:Ox,countKey:"Numbers",token:"${n}",parse:Ol.parse};function Ty(t,{regex:e,countKey:n,token:s,parse:r}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,s),t.values.push(...i.map(r)))}function bg(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&Ty(n,PF),Ty(n,FF),Ty(n,OF),n}function MF(t){return bg(t).values}function LF(t){const{values:e,numColors:n,numVars:s,tokenised:r}=bg(t),i=e.length;return o=>{let a=r;for(let l=0;l<i;l++)l<s?a=a.replace(PF.token,o[l]):l<s+n?a=a.replace(FF.token,ss.transform(o[l])):a=a.replace(OF.token,Fh(o[l]));return a}}const GX=t=>typeof t=="number"?0:t;function HX(t){const e=MF(t);return LF(t)(e.map(GX))}const ea={test:UX,parse:MF,createTransformer:LF,getAnimatableNone:HX},zF=(t,e)=>n=>`${n>0?e:t}`;function VF(t,e){return typeof t=="number"?n=>Bt(t,e,n):ss.test(t)?_F(t,e):t.startsWith("var(")?zF(t,e):jF(t,e)}const BF=(t,e)=>{const n=[...t],s=n.length,r=t.map((i,o)=>VF(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}},KX=(t,e)=>{const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=VF(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}},jF=(t,e)=>{const n=ea.createTransformer(e),s=bg(t),r=bg(e);return s.numVars===r.numVars&&s.numColors===r.numColors&&s.numNumbers>=r.numNumbers?Uo(BF(s.values,r.values),n):zF(t,e)},ud=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},tE=(t,e)=>n=>Bt(t,e,n);function XX(t){return typeof t=="number"?tE:typeof t=="string"?ss.test(t)?_F:jF:Array.isArray(t)?BF:typeof t=="object"?KX:tE}function qX(t,e,n){const s=[],r=n||XX(t[0]),i=t.length-1;for(let o=0;o<i;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Ht:e;a=Uo(l,a)}s.push(a)}return s}function WF(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(xS(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=qX(e,s,r),a=o.length,l=c=>{let u=0;if(a>1)for(;u<t.length-2&&!(c<t[u+1]);u++);const h=ud(t[u],t[u+1],c);return o[u](h)};return n?c=>l(Jo(t[0],t[i-1],c)):l}function YX(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=ud(0,e,s);t.push(Bt(n,1,r))}}function QX(t){const e=[0];return YX(e,t.length-1),e}function ZX(t,e){return t.map(n=>n*e)}function JX(t,e){return t.map(()=>e||$F).splice(0,t.length-1)}function wg({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=PX(s)?s.map(JN):JN(s),i={done:!1,value:e[0]},o=ZX(n&&n.length===e.length?n:QX(e),t),a=WF(o,e,{ease:Array.isArray(r)?r:JX(e,r)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}function UF(t,e){return e?t*(1e3/e):0}const e8=5;function GF(t,e,n){const s=Math.max(e-e8,0);return UF(n-t(s),e-s)}const Iy=.001,t8=.01,nE=10,n8=.05,s8=1;function r8({duration:t=800,bounce:e=.25,velocity:n=0,mass:s=1}){let r,i;TX(t<=Go(nE));let o=1-e;o=Jo(n8,s8,o),t=Jo(t8,nE,Zi(t)),o<1?(r=c=>{const u=c*o,h=u*t,d=u-n,f=_w(c,o),p=Math.exp(-h);return Iy-d/f*p},i=c=>{const h=c*o*t,d=h*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-h),m=_w(Math.pow(c,2),o);return(-r(c)+Iy>0?-1:1)*((d-f)*p)/m}):(r=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-Iy+u*h},i=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=o8(r,i,a);if(t=Go(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const i8=12;function o8(t,e,n){let s=n;for(let r=1;r<i8;r++)s=s-t(s)/e(s);return s}function _w(t,e){return t*Math.sqrt(1-e*e)}const a8=["duration","bounce"],l8=["stiffness","damping","mass"];function sE(t,e){return e.some(n=>t[n]!==void 0)}function c8(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!sE(t,l8)&&sE(t,a8)){const n=r8(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function HF({keyframes:t,restDelta:e,restSpeed:n,...s}){const r=t[0],i=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,duration:u,velocity:h,isResolvedFromDuration:d}=c8({...s,velocity:-Zi(s.velocity||0)}),f=h||0,p=l/(2*Math.sqrt(a*c)),m=i-r,v=Zi(Math.sqrt(a/c)),x=Math.abs(m)<5;n||(n=x?.01:2),e||(e=x?.005:.5);let g;if(p<1){const y=_w(v,p);g=b=>{const C=Math.exp(-p*v*b);return i-C*((f+p*v*m)/y*Math.sin(y*b)+m*Math.cos(y*b))}}else if(p===1)g=y=>i-Math.exp(-v*y)*(m+(f+v*m)*y);else{const y=v*Math.sqrt(p*p-1);g=b=>{const C=Math.exp(-p*v*b),S=Math.min(y*b,300);return i-C*((f+p*v*m)*Math.sinh(S)+y*m*Math.cosh(S))/y}}return{calculatedDuration:d&&u||null,next:y=>{const b=g(y);if(d)o.done=y>=u;else{let C=f;y!==0&&(p<1?C=GF(g,y,b):C=0);const S=Math.abs(C)<=n,T=Math.abs(i-b)<=e;o.done=S&&T}return o.value=o.done?i:b,o}}}function rE({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],d={done:!1,value:h},f=I=>a!==void 0&&I<a||l!==void 0&&I>l,p=I=>a===void 0?l:l===void 0||Math.abs(a-I)<Math.abs(l-I)?a:l;let m=n*e;const v=h+m,x=o===void 0?v:o(v);x!==v&&(m=x-h);const g=I=>-m*Math.exp(-I/s),y=I=>x+g(I),b=I=>{const $=g(I),N=y(I);d.done=Math.abs($)<=c,d.value=d.done?x:N};let C,S;const T=I=>{f(d.value)&&(C=I,S=HF({keyframes:[d.value,p(d.value)],velocity:GF(y,I,d.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return T(0),{calculatedDuration:null,next:I=>{let $=!1;return!S&&C===void 0&&($=!0,b(I),T(I)),C!==void 0&&I>C?S.next(I-C):(!$&&b(I),d)}}}const u8=t=>{const e=({timestamp:n})=>t(n);return{start:()=>bt.update(e,!0),stop:()=>ro(e),now:()=>Kn.isProcessing?Kn.timestamp:performance.now()}},iE=2e4;function oE(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<iE;)e+=n,s=t.next(e);return e>=iE?1/0:e}const h8={decay:rE,inertia:rE,tween:wg,keyframes:wg,spring:HF};function Cg({autoplay:t=!0,delay:e=0,driver:n=u8,keyframes:s,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:c,onComplete:u,onUpdate:h,...d}){let f=1,p=!1,m,v;const x=()=>{v=new Promise(W=>{m=W})};x();let g;const y=h8[r]||wg;let b;y!==wg&&typeof s[0]!="number"&&(b=WF([0,100],s,{clamp:!1}),s=[0,100]);const C=y({...d,keyframes:s});let S;a==="mirror"&&(S=y({...d,keyframes:[...s].reverse(),velocity:-(d.velocity||0)}));let T="idle",I=null,$=null,N=null;C.calculatedDuration===null&&i&&(C.calculatedDuration=oE(C));const{calculatedDuration:A}=C;let F=1/0,E=1/0;A!==null&&(F=A+o,E=F*(i+1)-o);let R=0;const O=W=>{if($===null)return;f>0&&($=Math.min($,W)),f<0&&($=Math.min(W-E/f,$)),I!==null?R=I:R=Math.round(W-$)*f;const X=R-e*(f>=0?1:-1),J=f>=0?X<0:X>E;R=Math.max(X,0),T==="finished"&&I===null&&(R=E);let Z=R,re=C;if(i){const q=Math.min(R,E)/F;let ie=Math.floor(q),ce=q%1;!ce&&q>=1&&(ce=1),ce===1&&ie--,ie=Math.min(ie,i+1),!!(ie%2)&&(a==="reverse"?(ce=1-ce,o&&(ce-=o/F)):a==="mirror"&&(re=S)),Z=Jo(0,1,ce)*F}const Q=J?{done:!1,value:s[0]}:re.next(Z);b&&(Q.value=b(Q.value));let{done:te}=Q;!J&&A!==null&&(te=f>=0?R>=E:R<=0);const le=I===null&&(T==="finished"||T==="running"&&te);return h&&h(Q.value),le&&_(),Q},P=()=>{g&&g.stop(),g=void 0},z=()=>{T="idle",P(),m(),x(),$=N=null},_=()=>{T="finished",u&&u(),P(),m()},M=()=>{if(p)return;g||(g=n(O));const W=g.now();l&&l(),I!==null?$=W-I:(!$||T==="finished")&&($=W),T==="finished"&&x(),N=$,I=null,T="running",g.start()};t&&M();const U={then(W,X){return v.then(W,X)},get time(){return Zi(R)},set time(W){W=Go(W),R=W,I!==null||!g||f===0?I=W:$=g.now()-W/f},get duration(){const W=C.calculatedDuration===null?oE(C):C.calculatedDuration;return Zi(W)},get speed(){return f},set speed(W){W===f||!g||(f=W,U.time=Zi(R))},get state(){return T},play:M,pause:()=>{T="paused",I=R},stop:()=>{p=!0,T!=="idle"&&(T="idle",c&&c(),z())},cancel:()=>{N!==null&&O(N),z()},complete:()=>{T="finished"},sample:W=>($=0,O(W))};return U}function d8(t){let e;return()=>(e===void 0&&(e=t()),e)}const f8=d8(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),p8=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Op=10,m8=2e4,g8=(t,e)=>e.type==="spring"||t==="backgroundColor"||!SF(e.ease);function x8(t,e,{onUpdate:n,onComplete:s,...r}){if(!(f8()&&p8.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let o=!1,a,l,c=!1;const u=()=>{l=new Promise(y=>{a=y})};u();let{keyframes:h,duration:d=300,ease:f,times:p}=r;if(g8(e,r)){const y=Cg({...r,repeat:0,delay:0});let b={done:!1,value:h[0]};const C=[];let S=0;for(;!b.done&&S<m8;)b=y.sample(S),C.push(b.value),S+=Op;p=void 0,h=C,d=S-Op,f="linear"}const m=$X(t.owner.current,e,h,{...r,duration:d,ease:f,times:p}),v=()=>{c=!1,m.cancel()},x=()=>{c=!0,bt.update(v),a(),u()};return m.onfinish=()=>{c||(t.set(NX(h,r)),s&&s(),x())},{then(y,b){return l.then(y,b)},attachTimeline(y){return m.timeline=y,m.onfinish=null,Ht},get time(){return Zi(m.currentTime||0)},set time(y){m.currentTime=Go(y)},get speed(){return m.playbackRate},set speed(y){m.playbackRate=y},get duration(){return Zi(d)},play:()=>{o||(m.play(),ro(v))},pause:()=>m.pause(),stop:()=>{if(o=!0,m.playState==="idle")return;const{currentTime:y}=m;if(y){const b=Cg({...r,autoplay:!1});t.setWithVelocity(b.sample(y-Op).value,b.sample(y).value,Op)}x()},complete:()=>{c||m.finish()},cancel:x}}function v8({keyframes:t,delay:e,onUpdate:n,onComplete:s}){const r=()=>(n&&n(t[t.length-1]),s&&s(),{time:0,speed:1,duration:0,play:Ht,pause:Ht,stop:Ht,then:i=>(i(),Promise.resolve()),cancel:Ht,complete:Ht});return e?Cg({keyframes:[0,1],duration:0,delay:e,onComplete:r}):r()}const y8={type:"spring",stiffness:500,damping:25,restSpeed:10},b8=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),w8={type:"keyframes",duration:.8},C8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},S8=(t,{keyframes:e})=>e.length>2?w8:Fl.has(t)?t.startsWith("scale")?b8(e[1]):y8:C8,Pw=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ea.test(e)||e==="0")&&!e.startsWith("url(")),k8=new Set(["brightness","contrast","saturate","opacity"]);function T8(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(Ox)||[];if(!s)return t;const r=n.replace(s,"");let i=k8.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const I8=/([a-z-]*)\(.*?\)/g,Fw={...ea,getAnimatableNone:t=>{const e=t.match(I8);return e?e.map(T8).join(" "):t}},$8={...oF,color:ss,backgroundColor:ss,outlineColor:ss,fill:ss,stroke:ss,borderColor:ss,borderTopColor:ss,borderRightColor:ss,borderBottomColor:ss,borderLeftColor:ss,filter:Fw,WebkitFilter:Fw},wS=t=>$8[t];function KF(t,e){let n=wS(t);return n!==Fw&&(n=ea),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const XF=t=>/^0[^.\s]+$/.test(t);function N8(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||XF(t)}function E8(t,e,n,s){const r=Pw(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=s.from!==void 0?s.from:t.get();let a;const l=[];for(let c=0;c<i.length;c++)i[c]===null&&(i[c]=c===0?o:i[c-1]),N8(i[c])&&l.push(c),typeof i[c]=="string"&&i[c]!=="none"&&i[c]!=="0"&&(a=i[c]);if(r&&l.length&&a)for(let c=0;c<l.length;c++){const u=l[c];i[u]=KF(e,a)}return i}function R8({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function CS(t,e){return t[e]||t.default||t}const A8={skipAnimations:!1},SS=(t,e,n,s={})=>r=>{const i=CS(s,t)||{},o=i.delay||s.delay||0;let{elapsed:a=0}=s;a=a-Go(o);const l=E8(e,t,n,i),c=l[0],u=l[l.length-1],h=Pw(t,c),d=Pw(t,u);let f={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-a,onUpdate:p=>{e.set(p),i.onUpdate&&i.onUpdate(p)},onComplete:()=>{r(),i.onComplete&&i.onComplete()}};if(R8(i)||(f={...f,...S8(t,f)}),f.duration&&(f.duration=Go(f.duration)),f.repeatDelay&&(f.repeatDelay=Go(f.repeatDelay)),!h||!d||IX.current||i.type===!1||A8.skipAnimations)return v8(f);if(!s.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const p=x8(e,t,f);if(p)return p}return Cg(f)};function Sg(t){return!!(Es(t)&&t.add)}const qF=t=>/^\-?\d*\.?\d+$/.test(t);function kS(t,e){t.indexOf(e)===-1&&t.push(e)}function TS(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class IS{constructor(){this.subscriptions=[]}add(e){return kS(this.subscriptions,e),()=>TS(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const D8=t=>!isNaN(parseFloat(t));class _8{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(s,r=!0)=>{this.prev=this.current,this.current=s;const{delta:i,timestamp:o}=Kn;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,bt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>bt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:s})=>{s!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=D8(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new IS);const s=this.events[e].add(n);return e==="change"?()=>{s(),bt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=e,this.timeDelta=s}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?UF(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Yc(t,e){return new _8(t,e)}const YF=t=>e=>e.test(t),P8={test:t=>t==="auto",parse:t=>t},QF=[Ol,Pe,bi,Co,BK,VK,P8],Ju=t=>QF.find(YF(t)),F8=[...QF,ss,ea],O8=t=>F8.find(YF(t));function M8(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Yc(n))}function L8(t,e){const n=Lx(t,e);let{transitionEnd:s={},transition:r={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...s};for(const o in i){const a=tX(i[o]);M8(t,o,a)}}function z8(t,e,n){var s,r;const i=Object.keys(e).filter(a=>!t.hasValue(a)),o=i.length;if(o)for(let a=0;a<o;a++){const l=i[a],c=e[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(r=(s=n[l])!==null&&s!==void 0?s:t.readValue(l))!==null&&r!==void 0?r:e[l]),u!=null&&(typeof u=="string"&&(qF(u)||XF(u))?u=parseFloat(u):!O8(u)&&ea.test(c)&&(u=KF(l,c)),t.addValue(l,Yc(u,{owner:t})),n[l]===void 0&&(n[l]=u),u!==null&&t.setBaseTarget(l,u))}}function V8(t,e){return e?(e[t]||e.default||e).from:void 0}function B8(t,e,n){const s={};for(const r in t){const i=V8(r,e);if(i!==void 0)s[r]=i;else{const o=n.getValue(r);o&&(s[r]=o.get())}}return s}function j8({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function W8(t,e){const n=t.get();if(Array.isArray(e)){for(let s=0;s<e.length;s++)if(e[s]!==n)return!0}else return n!==e}function ZF(t,e,{delay:n=0,transitionOverride:s,type:r}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");s&&(i=s);const c=[],u=r&&t.animationState&&t.animationState.getState()[r];for(const h in a){const d=t.getValue(h),f=a[h];if(!d||f===void 0||u&&j8(u,h))continue;const p={delay:n,elapsed:0,...CS(i||{},h)};if(window.HandoffAppearAnimations){const x=t.getProps()[JP];if(x){const g=window.HandoffAppearAnimations(x,h,d,bt);g!==null&&(p.elapsed=g,p.isHandoff=!0)}}let m=!p.isHandoff&&!W8(d,f);if(p.type==="spring"&&(d.getVelocity()||p.velocity)&&(m=!1),d.animation&&(m=!1),m)continue;d.start(SS(h,d,f,t.shouldReduceMotion&&Fl.has(h)?{type:!1}:p));const v=d.animation;Sg(l)&&(l.add(h),v.then(()=>l.remove(h))),c.push(v)}return o&&Promise.all(c).then(()=>{o&&L8(t,o)}),c}function Ow(t,e,n={}){const s=Lx(t,e,n.custom);let{transition:r=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(r=n.transitionOverride);const i=s?()=>Promise.all(ZF(t,s,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:h}=r;return U8(t,e,c+l,u,h,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[i,o]:[o,i];return l().then(()=>c())}else return Promise.all([i(),o(n.delay)])}function U8(t,e,n=0,s=0,r=1,i){const o=[],a=(t.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(G8).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(Ow(c,e,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function G8(t,e){return t.sortNodePosition(e)}function H8(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>Ow(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=Ow(t,e,n);else{const r=typeof e=="function"?Lx(t,e,n.custom):e;s=Promise.all(ZF(t,r,n))}return s.then(()=>t.notify("AnimationComplete",e))}const K8=[...aS].reverse(),X8=aS.length;function q8(t){return e=>Promise.all(e.map(({animation:n,options:s})=>H8(t,n,s)))}function Y8(t){let e=q8(t);const n=Z8();let s=!0;const r=(l,c)=>{const u=Lx(t,c);if(u){const{transition:h,transitionEnd:d,...f}=u;l={...l,...f,...d}}return l};function i(l){e=l(t)}function o(l,c){const u=t.getProps(),h=t.getVariantContext(!0)||{},d=[],f=new Set;let p={},m=1/0;for(let x=0;x<X8;x++){const g=K8[x],y=n[g],b=u[g]!==void 0?u[g]:h[g],C=ld(b),S=g===c?y.isActive:null;S===!1&&(m=x);let T=b===h[g]&&b!==u[g]&&C;if(T&&s&&t.manuallyAnimateOnMount&&(T=!1),y.protectedKeys={...p},!y.isActive&&S===null||!b&&!y.prevProp||Px(b)||typeof b=="boolean")continue;let $=Q8(y.prevProp,b)||g===c&&y.isActive&&!T&&C||x>m&&C,N=!1;const A=Array.isArray(b)?b:[b];let F=A.reduce(r,{});S===!1&&(F={});const{prevResolvedValues:E={}}=y,R={...E,...F},O=P=>{$=!0,f.has(P)&&(N=!0,f.delete(P)),y.needsAnimating[P]=!0};for(const P in R){const z=F[P],_=E[P];if(p.hasOwnProperty(P))continue;let M=!1;yg(z)&&yg(_)?M=!wF(z,_):M=z!==_,M?z!==void 0?O(P):f.add(P):z!==void 0&&f.has(P)?O(P):y.protectedKeys[P]=!0}y.prevProp=b,y.prevResolvedValues=F,y.isActive&&(p={...p,...F}),s&&t.blockInitialAnimation&&($=!1),$&&(!T||N)&&d.push(...A.map(P=>({animation:P,options:{type:g,...l}})))}if(f.size){const x={};f.forEach(g=>{const y=t.getBaseTarget(g);y!==void 0&&(x[g]=y)}),d.push({animation:x})}let v=!!d.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),s=!1,v?e(d):Promise.resolve()}function a(l,c,u){var h;if(n[l].isActive===c)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),n[l].isActive=c;const d=o(u,l);for(const f in n)n[f].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n}}function Q8(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!wF(e,t):!1}function Ea(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Z8(){return{animate:Ea(!0),whileInView:Ea(),whileHover:Ea(),whileTap:Ea(),whileDrag:Ea(),whileFocus:Ea(),exit:Ea()}}class J8 extends pa{constructor(e){super(e),e.animationState||(e.animationState=Y8(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Px(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let eq=0;class tq extends pa{constructor(){super(...arguments),this.id=eq++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:s}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e,{custom:s??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const nq={animation:{Feature:J8},exit:{Feature:tq}},aE=(t,e)=>Math.abs(t-e);function sq(t,e){const n=aE(t.x,e.x),s=aE(t.y,e.y);return Math.sqrt(n**2+s**2)}class JF{constructor(e,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ny(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=sq(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:p}=h,{timestamp:m}=Kn;this.history.push({...p,timestamp:m});const{onStart:v,onMove:x}=this.handlers;d||(v&&v(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=$y(d,this.transformPagePoint),bt.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Ny(h.type==="pointercancel"?this.lastMoveEventInfo:$y(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,v),p&&p(h,v)},!gF(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=Mx(e),a=$y(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Kn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,Ny(a,this.history)),this.removeListeners=Uo(Qi(this.contextWindow,"pointermove",this.handlePointerMove),Qi(this.contextWindow,"pointerup",this.handlePointerUp),Qi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ro(this.updatePoint)}}function $y(t,e){return e?{point:e(t.point)}:t}function lE(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Ny({point:t},e){return{point:t,delta:lE(t,eO(e)),offset:lE(t,rq(e)),velocity:iq(e,.1)}}function rq(t){return t[0]}function eO(t){return t[t.length-1]}function iq(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=eO(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>Go(e)));)n--;if(!s)return{x:0,y:0};const i=Zi(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Us(t){return t.max-t.min}function Mw(t,e=0,n=.01){return Math.abs(t-e)<=n}function cE(t,e,n,s=.5){t.origin=s,t.originPoint=Bt(e.min,e.max,t.origin),t.scale=Us(n)/Us(e),(Mw(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=Bt(n.min,n.max,t.origin)-t.originPoint,(Mw(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Oh(t,e,n,s){cE(t.x,e.x,n.x,s?s.originX:void 0),cE(t.y,e.y,n.y,s?s.originY:void 0)}function uE(t,e,n){t.min=n.min+e.min,t.max=t.min+Us(e)}function oq(t,e,n){uE(t.x,e.x,n.x),uE(t.y,e.y,n.y)}function hE(t,e,n){t.min=e.min-n.min,t.max=t.min+Us(e)}function Mh(t,e,n){hE(t.x,e.x,n.x),hE(t.y,e.y,n.y)}function aq(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Bt(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Bt(n,t,s.max):Math.min(t,n)),t}function dE(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function lq(t,{top:e,left:n,bottom:s,right:r}){return{x:dE(t.x,n,r),y:dE(t.y,e,s)}}function fE(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function cq(t,e){return{x:fE(t.x,e.x),y:fE(t.y,e.y)}}function uq(t,e){let n=.5;const s=Us(t),r=Us(e);return r>s?n=ud(e.min,e.max-s,t.min):s>r&&(n=ud(t.min,t.max-r,e.min)),Jo(0,1,n)}function hq(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Lw=.35;function dq(t=Lw){return t===!1?t=0:t===!0&&(t=Lw),{x:pE(t,"left","right"),y:pE(t,"top","bottom")}}function pE(t,e,n){return{min:mE(t,e),max:mE(t,n)}}function mE(t,e){return typeof t=="number"?t:t[e]||0}const gE=()=>({translate:0,scale:1,origin:0,originPoint:0}),Cc=()=>({x:gE(),y:gE()}),xE=()=>({min:0,max:0}),sn=()=>({x:xE(),y:xE()});function nr(t){return[t("x"),t("y")]}function tO({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function fq({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function pq(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Ey(t){return t===void 0||t===1}function zw({scale:t,scaleX:e,scaleY:n}){return!Ey(t)||!Ey(e)||!Ey(n)}function Oa(t){return zw(t)||nO(t)||t.z||t.rotate||t.rotateX||t.rotateY}function nO(t){return vE(t.x)||vE(t.y)}function vE(t){return t&&t!=="0%"}function kg(t,e,n){const s=t-n,r=e*s;return n+r}function yE(t,e,n,s,r){return r!==void 0&&(t=kg(t,r,s)),kg(t,n,s)+e}function Vw(t,e=0,n=1,s,r){t.min=yE(t.min,e,n,s,r),t.max=yE(t.max,e,n,s,r)}function sO(t,{x:e,y:n}){Vw(t.x,e.translate,e.scale,e.originPoint),Vw(t.y,n.translate,n.scale,n.originPoint)}function mq(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const l=i.instance;l&&l.style&&l.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Sc(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,sO(t,o)),s&&Oa(i.latestValues)&&Sc(t,i.latestValues))}e.x=bE(e.x),e.y=bE(e.y)}function bE(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Io(t,e){t.min=t.min+e,t.max=t.max+e}function wE(t,e,[n,s,r]){const i=e[r]!==void 0?e[r]:.5,o=Bt(t.min,t.max,i);Vw(t,e[n],e[s],o,e.scale)}const gq=["x","scaleX","originX"],xq=["y","scaleY","originY"];function Sc(t,e){wE(t.x,e,gq),wE(t.y,e,xq)}function rO(t,e){return tO(pq(t.getBoundingClientRect(),e))}function vq(t,e,n){const s=rO(t,n),{scroll:r}=e;return r&&(Io(s.x,r.offset.x),Io(s.y,r.offset.y)),s}const iO=({current:t})=>t?t.ownerDocument.defaultView:null,yq=new WeakMap;class bq{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=sn(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Mx(u,"page").point)},i=(u,h)=>{const{drag:d,dragPropagation:f,onDragStart:p}=this.getProps();if(d&&!f&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=vF(d),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),nr(v=>{let x=this.getAxisMotionValue(v).get()||0;if(bi.test(x)){const{projection:g}=this.visualElement;if(g&&g.layout){const y=g.layout.layoutBox[v];y&&(x=Us(y)*(parseFloat(x)/100))}}this.originPoint[v]=x}),p&&bt.update(()=>p(u,h),!1,!0);const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:p,onDrag:m}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:v}=h;if(f&&this.currentDirection===null){this.currentDirection=wq(v),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,v),this.updateAxis("y",h.point,v),this.visualElement.render(),m&&m(u,h)},a=(u,h)=>this.stop(u,h),l=()=>nr(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new JF(e,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:iO(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&bt.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!Mp(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=aq(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&bc(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=lq(r.layoutBox,n):this.constraints=!1,this.elastic=dq(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&nr(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=hq(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!bc(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=vq(s,r.root,this.visualElement.getTransformPagePoint());let o=cq(r.layout.layoutBox,i);if(n){const a=n(fq(o));this.hasMutatedConstraints=!!a,a&&(o=tO(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=nr(u=>{if(!Mp(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return s.start(SS(e,s,0,n))}stopAnimation(){nr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){nr(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){nr(n=>{const{drag:s}=this.getProps();if(!Mp(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(e[n]-Bt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!bc(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};nr(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=uq({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),nr(o=>{if(!Mp(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Bt(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;yq.set(this.visualElement,this);const e=this.visualElement.current,n=Qi(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();bc(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),s();const o=Hi(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(nr(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=Lw,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function Mp(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function wq(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Cq extends pa{constructor(e){super(e),this.removeGroupControls=Ht,this.removeListeners=Ht,this.controls=new bq(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ht}unmount(){this.removeGroupControls(),this.removeListeners()}}const CE=t=>(e,n)=>{t&&bt.update(()=>t(e,n))};class Sq extends pa{constructor(){super(...arguments),this.removePointerDownListener=Ht}onPointerDown(e){this.session=new JF(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iO(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:CE(e),onStart:CE(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&bt.update(()=>r(i,o))}}}mount(){this.removePointerDownListener=Qi(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function kq(){const t=k.useContext(Dx);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:s}=t,r=k.useId();return k.useEffect(()=>s(r),[]),!e&&n?[!1,()=>n&&n(r)]:[!0]}const Pm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function SE(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const eh={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Pe.test(t))t=parseFloat(t);else return t;const n=SE(t,e.target.x),s=SE(t,e.target.y);return`${n}% ${s}%`}},Tq={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=ea.parse(t);if(r.length>5)return s;const i=ea.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=Bt(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}};class Iq extends oe.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;_K($q),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Pm.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||bt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function oO(t){const[e,n]=kq(),s=k.useContext(cS);return oe.createElement(Iq,{...t,layoutGroup:s,switchLayoutGroup:k.useContext(tF),isPresent:e,safeToRemove:n})}const $q={borderRadius:{...eh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:eh,borderTopRightRadius:eh,borderBottomLeftRadius:eh,borderBottomRightRadius:eh,boxShadow:Tq},aO=["TopLeft","TopRight","BottomLeft","BottomRight"],Nq=aO.length,kE=t=>typeof t=="string"?parseFloat(t):t,TE=t=>typeof t=="number"||Pe.test(t);function Eq(t,e,n,s,r,i){r?(t.opacity=Bt(0,n.opacity!==void 0?n.opacity:1,Rq(s)),t.opacityExit=Bt(e.opacity!==void 0?e.opacity:1,0,Aq(s))):i&&(t.opacity=Bt(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<Nq;o++){const a=`border${aO[o]}Radius`;let l=IE(e,a),c=IE(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||TE(l)===TE(c)?(t[a]=Math.max(Bt(kE(l),kE(c),s),0),(bi.test(c)||bi.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Bt(e.rotate||0,n.rotate||0,s))}function IE(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Rq=lO(0,.5,RF),Aq=lO(.5,.95,Ht);function lO(t,e,n){return s=>s<t?0:s>e?1:n(ud(t,e,s))}function $E(t,e){t.min=e.min,t.max=e.max}function Zs(t,e){$E(t.x,e.x),$E(t.y,e.y)}function NE(t,e,n,s,r){return t-=e,t=kg(t,1/n,s),r!==void 0&&(t=kg(t,1/r,s)),t}function Dq(t,e=0,n=1,s=.5,r,i=t,o=t){if(bi.test(e)&&(e=parseFloat(e),e=Bt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Bt(i.min,i.max,s);t===i&&(a-=e),t.min=NE(t.min,e,n,a,r),t.max=NE(t.max,e,n,a,r)}function EE(t,e,[n,s,r],i,o){Dq(t,e[n],e[s],e[r],e.scale,i,o)}const _q=["x","scaleX","originX"],Pq=["y","scaleY","originY"];function RE(t,e,n,s){EE(t.x,e,_q,n?n.x:void 0,s?s.x:void 0),EE(t.y,e,Pq,n?n.y:void 0,s?s.y:void 0)}function AE(t){return t.translate===0&&t.scale===1}function cO(t){return AE(t.x)&&AE(t.y)}function Fq(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function uO(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function DE(t){return Us(t.x)/Us(t.y)}class Oq{constructor(){this.members=[]}add(e){kS(this.members,e),e.scheduleRender()}remove(e){if(TS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function _E(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y;if((r||i)&&(s=`translate3d(${r}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:c,rotateY:u}=n;l&&(s+=`rotate(${l}deg) `),c&&(s+=`rotateX(${c}deg) `),u&&(s+=`rotateY(${u}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(s+=`scale(${o}, ${a})`),s||"none"}const Mq=(t,e)=>t.depth-e.depth;class Lq{constructor(){this.children=[],this.isDirty=!1}add(e){kS(this.children,e),this.isDirty=!0}remove(e){TS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Mq),this.isDirty=!1,this.children.forEach(e)}}function zq(t,e){const n=performance.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(ro(s),t(i-e))};return bt.read(s,!0),()=>ro(s)}function Vq(t){window.MotionDebug&&window.MotionDebug.record(t)}function Bq(t){return t instanceof SVGElement&&t.tagName!=="svg"}function jq(t,e,n){const s=Es(t)?t:Yc(t);return s.start(SS("",s,e,n)),s.animation}const PE=["","X","Y","Z"],Wq={visibility:"hidden"},FE=1e3;let Uq=0;const Ma={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function hO({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=Uq++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ma.totalNodes=Ma.resolvedTargetDeltas=Ma.recalculatedProjection=0,this.nodes.forEach(Kq),this.nodes.forEach(Zq),this.nodes.forEach(Jq),this.nodes.forEach(Xq),Vq(Ma)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Lq)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new IS),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Bq(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=zq(d,250),Pm.hasAnimatedSinceResize&&(Pm.hasAnimatedSinceResize=!1,this.nodes.forEach(ME))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||r9,{onLayoutAnimationStart:v,onLayoutAnimationComplete:x}=u.getProps(),g=!this.targetLayout||!uO(this.targetLayout,p)||f,y=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||y||d&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,y);const b={...CS(m,"layout"),onPlay:v,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else d||ME(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ro(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(e9),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(OE);return}this.isUpdating||this.nodes.forEach(Yq),this.isUpdating=!1,this.nodes.forEach(Qq),this.nodes.forEach(Gq),this.nodes.forEach(Hq),this.clearAllSnapshots();const a=performance.now();Kn.delta=Jo(0,1e3/60,a-Kn.timestamp),Kn.timestamp=a,Kn.isProcessing=!0,yy.update.process(Kn),yy.preRender.process(Kn),yy.render.process(Kn),Kn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(qq),this.sharedNodes.forEach(t9)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,bt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){bt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=sn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:s(this.instance),offset:n(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!cO(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||Oa(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),i9(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return sn();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Io(a.x,l.offset.x),Io(a.y,l.offset.y)),a}removeElementScroll(o){const a=sn();Zs(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:h}=c;if(c!==this.root&&u&&h.layoutScroll){if(u.isRoot){Zs(a,o);const{scroll:d}=this.root;d&&(Io(a.x,-d.offset.x),Io(a.y,-d.offset.y))}Io(a.x,u.offset.x),Io(a.y,u.offset.y)}}return a}applyTransform(o,a=!1){const l=sn();Zs(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Sc(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Oa(u.latestValues)&&Sc(l,u.latestValues)}return Oa(this.latestValues)&&Sc(l,this.latestValues),l}removeTransform(o){const a=sn();Zs(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Oa(c.latestValues))continue;zw(c.latestValues)&&c.updateSnapshot();const u=sn(),h=c.measurePageBox();Zs(u,h),RE(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Oa(this.latestValues)&&RE(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Kn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=Kn.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sn(),this.relativeTargetOrigin=sn(),Mh(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Zs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=sn(),this.targetWithTransforms=sn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),oq(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Zs(this.target,this.layout.layoutBox),sO(this.target,this.targetDelta)):Zs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sn(),this.relativeTargetOrigin=sn(),Mh(this.relativeTargetOrigin,this.target,f.target),Zs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ma.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||zw(this.parent.latestValues)||nO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Kn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Zs(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;mq(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:p}=a;if(!p){this.projectionTransform&&(this.projectionDelta=Cc(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Cc(),this.projectionDeltaWithTransform=Cc());const m=this.projectionTransform;Oh(this.projectionDelta,this.layoutCorrected,p,this.latestValues),this.projectionTransform=_E(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==d||this.treeScale.y!==f)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),Ma.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=Cc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=sn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,v=this.getStack(),x=!v||v.members.length<=1,g=!!(m&&!x&&this.options.crossfade===!0&&!this.path.some(s9));this.animationProgress=0;let y;this.mixTargetDelta=b=>{const C=b/1e3;LE(h.x,o.x,C),LE(h.y,o.y,C),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Mh(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),n9(this.relativeTarget,this.relativeTargetOrigin,d,C),y&&Fq(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=sn()),Zs(y,this.relativeTarget)),m&&(this.animationValues=u,Eq(u,c,this.latestValues,C,g,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ro(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=bt.update(()=>{Pm.hasAnimatedSinceResize=!0,this.currentAnimation=jq(0,FE,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(FE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&dO(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||sn();const h=Us(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=Us(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Zs(a,l),Sc(a,u),Oh(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Oq),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const c={};for(let u=0;u<PE.length;u++){const h="rotate"+PE[u];l[h]&&(c[h]=l[h],o.setStaticValue(h,0))}o.render();for(const u in c)o.setStaticValue(u,c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Wq;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=_m(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=_m(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Oa(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=_E(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in xg){if(d[m]===void 0)continue;const{correct:v,applyTo:x}=xg[m],g=c.transform==="none"?d[m]:v(d[m],h);if(x){const y=x.length;for(let b=0;b<y;b++)c[x[b]]=g}else c[m]=g}return this.options.layoutId&&(c.pointerEvents=h===this?_m(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(OE),this.root.sharedNodes.clear()}}}function Gq(t){t.updateLayout()}function Hq(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?nr(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=Us(d);d.min=s[h].min,d.max=d.min+f}):dO(i,n.layoutBox,s)&&nr(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=Us(s[h]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+f)});const a=Cc();Oh(a,s,n.layoutBox);const l=Cc();o?Oh(l,t.applyTransform(r,!0),n.measuredBox):Oh(l,s,n.layoutBox);const c=!cO(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=sn();Mh(p,n.layoutBox,d.layoutBox);const m=sn();Mh(m,s,f.layoutBox),uO(p,m)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function Kq(t){Ma.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Xq(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function qq(t){t.clearSnapshot()}function OE(t){t.clearMeasurements()}function Yq(t){t.isLayoutDirty=!1}function Qq(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function ME(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Zq(t){t.resolveTargetDelta()}function Jq(t){t.calcProjection()}function e9(t){t.resetRotation()}function t9(t){t.removeLeadSnapshot()}function LE(t,e,n){t.translate=Bt(e.translate,0,n),t.scale=Bt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function zE(t,e,n,s){t.min=Bt(e.min,n.min,s),t.max=Bt(e.max,n.max,s)}function n9(t,e,n,s){zE(t.x,e.x,n.x,s),zE(t.y,e.y,n.y,s)}function s9(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const r9={duration:.45,ease:[.4,0,.1,1]},VE=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),BE=VE("applewebkit/")&&!VE("chrome/")?Math.round:Ht;function jE(t){t.min=BE(t.min),t.max=BE(t.max)}function i9(t){jE(t.x),jE(t.y)}function dO(t,e,n){return t==="position"||t==="preserve-aspect"&&!Mw(DE(e),DE(n),.2)}const o9=hO({attachResizeListener:(t,e)=>Hi(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ry={current:void 0},fO=hO({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Ry.current){const t=new o9({});t.mount(window),t.setOptions({layoutScroll:!0}),Ry.current=t}return Ry.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),a9={pan:{Feature:Sq},drag:{Feature:Cq,ProjectionNode:fO,MeasureLayout:oO}},l9=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function c9(t){const e=l9.exec(t);if(!e)return[,];const[,n,s]=e;return[n,s]}function Bw(t,e,n=1){const[s,r]=c9(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return qF(o)?parseFloat(o):o}else return Rw(r)?Bw(r,e,n+1):r}function u9(t,{...e},n){const s=t.current;if(!(s instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(r=>{const i=r.get();if(!Rw(i))return;const o=Bw(i,s);o&&r.set(o)});for(const r in e){const i=e[r];if(!Rw(i))continue;const o=Bw(i,s);o&&(e[r]=o,n||(n={}),n[r]===void 0&&(n[r]=i))}return{target:e,transitionEnd:n}}const h9=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),pO=t=>h9.has(t),d9=t=>Object.keys(t).some(pO),WE=t=>t===Ol||t===Pe,UE=(t,e)=>parseFloat(t.split(", ")[e]),GE=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/);if(r)return UE(r[1],e);{const i=s.match(/^matrix\((.+)\)$/);return i?UE(i[1],t):0}},f9=new Set(["x","y","z"]),p9=Ld.filter(t=>!f9.has(t));function m9(t){const e=[];return p9.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Qc={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:GE(4,13),y:GE(5,14)};Qc.translateX=Qc.x;Qc.translateY=Qc.y;const g9=(t,e,n)=>{const s=e.measureViewportBox(),r=e.current,i=getComputedStyle(r),{display:o}=i,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(c=>{a[c]=Qc[c](s,i)}),e.render();const l=e.measureViewportBox();return n.forEach(c=>{const u=e.getValue(c);u&&u.jump(a[c]),t[c]=Qc[c](l,i)}),t},x9=(t,e,n={},s={})=>{e={...e},s={...s};const r=Object.keys(e).filter(pO);let i=[],o=!1;const a=[];if(r.forEach(l=>{const c=t.getValue(l);if(!t.hasValue(l))return;let u=n[l],h=Ju(u);const d=e[l];let f;if(yg(d)){const p=d.length,m=d[0]===null?1:0;u=d[m],h=Ju(u);for(let v=m;v<p&&d[v]!==null;v++)f?xS(Ju(d[v])===f):f=Ju(d[v])}else f=Ju(d);if(h!==f)if(WE(h)&&WE(f)){const p=c.get();typeof p=="string"&&c.set(parseFloat(p)),typeof d=="string"?e[l]=parseFloat(d):Array.isArray(d)&&f===Pe&&(e[l]=d.map(parseFloat))}else h!=null&&h.transform&&(f!=null&&f.transform)&&(u===0||d===0)?u===0?c.set(f.transform(u)):e[l]=h.transform(d):(o||(i=m9(t),o=!0),a.push(l),s[l]=s[l]!==void 0?s[l]:e[l],c.jump(d))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,c=g9(e,t,a);return i.length&&i.forEach(([u,h])=>{t.getValue(u).set(h)}),t.render(),_x&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:s}}else return{target:e,transitionEnd:s}};function v9(t,e,n,s){return d9(e)?x9(t,e,n,s):{target:e,transitionEnd:s}}const y9=(t,e,n,s)=>{const r=u9(t,e,s);return e=r.target,s=r.transitionEnd,v9(t,e,n,s)},jw={current:null},mO={current:!1};function b9(){if(mO.current=!0,!!_x)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>jw.current=t.matches;t.addListener(e),e()}else jw.current=!1}function w9(t,e,n){const{willChange:s}=e;for(const r in e){const i=e[r],o=n[r];if(Es(i))t.addValue(r,i),Sg(s)&&s.add(r);else if(Es(o))t.addValue(r,Yc(i,{owner:t})),Sg(s)&&s.remove(r);else if(o!==i)if(t.hasValue(r)){const a=t.getValue(r);!a.hasAnimated&&a.set(i)}else{const a=t.getStaticValue(r);t.addValue(r,Yc(a!==void 0?a:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const HE=new WeakMap,gO=Object.keys(cd),C9=gO.length,KE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],S9=lS.length;class k9{constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>bt.render(this.render,!1,!0);const{latestValues:a,renderState:l}=i;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=Fx(n),this.isVariantNode=eF(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(n,{});for(const h in u){const d=u[h];a[h]!==void 0&&Es(d)&&(d.set(a[h],!1),Sg(c)&&c.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,HE.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),mO.current||b9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:jw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){HE.delete(this.current),this.projection&&this.projection.unmount(),ro(this.notifyUpdate),ro(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const s=Fl.has(e),r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&bt.update(this.notifyUpdate,!1,!0),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},s,r,i){let o,a;for(let l=0;l<C9;l++){const c=gO[l],{isEnabled:u,Feature:h,ProjectionNode:d,MeasureLayout:f}=cd[c];d&&(o=d),u(n)&&(!this.features[c]&&h&&(this.features[c]=new h(this)),f&&(a=f))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:u,dragConstraints:h,layoutScroll:d,layoutRoot:f}=n;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||h&&bc(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:i,layoutScroll:d,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):sn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<KE.length;s++){const r=KE[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i=e["on"+r];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=w9(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const n={};for(let s=0;s<S9;s++){const r=lS[s],i=this.props[r];(ld(i)||i===!1)&&(n[r]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Yc(n,{owner:this}),this.addValue(e,s)),s}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props,r=typeof s=="string"||typeof s=="object"?(n=gS(this.props,s))===null||n===void 0?void 0:n[e]:void 0;if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Es(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new IS),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class xO extends k9{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...s},{transformValues:r},i){let o=B8(s,e||{},this);if(r&&(n&&(n=r(n)),s&&(s=r(s)),o&&(o=r(o))),i){z8(this,s,o);const a=y9(this,s,o,n);n=a.transitionEnd,s=a.target}return{transition:e,transitionEnd:n,...s}}}function T9(t){return window.getComputedStyle(t)}class I9 extends xO{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Fl.has(n)){const s=wS(n);return s&&s.default||0}else{const s=T9(e),r=(rF(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return rO(e,n)}build(e,n,s,r){hS(e,n,s,r.transformTemplate)}scrapeMotionValuesFromProps(e,n){return mS(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Es(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,s,r){uF(e,n,s,r)}}class $9 extends xO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Fl.has(n)){const s=wS(n);return s&&s.default||0}return n=hF.has(n)?n:oS(n),e.getAttribute(n)}measureInstanceViewportBox(){return sn()}scrapeMotionValuesFromProps(e,n){return fF(e,n)}build(e,n,s,r){fS(e,n,s,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,s,r){dF(e,n,s,r)}mount(e){this.isSVGTag=pS(e.tagName),super.mount(e)}}const N9=(t,e)=>uS(t)?new $9(e,{enableHardwareAcceleration:!1}):new I9(e,{enableHardwareAcceleration:!0}),E9={layout:{ProjectionNode:fO,MeasureLayout:oO}},R9={...nq,...CX,...a9,...E9},Nt=AK((t,e)=>cX(t,e,R9,N9));function vO(){const t=k.useRef(!1);return iS(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function A9(){const t=vO(),[e,n]=k.useState(0),s=k.useCallback(()=>{t.current&&n(e+1)},[e]);return[k.useCallback(()=>bt.postRender(s),[s]),e]}class D9 extends k.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function _9({children:t,isPresent:e}){const n=k.useId(),s=k.useRef(null),r=k.useRef({width:0,height:0,top:0,left:0});return k.useInsertionEffect(()=>{const{width:i,height:o,top:a,left:l}=r.current;if(e||!s.current||!i||!o)return;s.current.dataset.motionPopId=n;const c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${a}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[e]),k.createElement(D9,{isPresent:e,childRef:s,sizeRef:r},k.cloneElement(t,{ref:s}))}const Ay=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o})=>{const a=pF(P9),l=k.useId(),c=k.useMemo(()=>({id:l,initial:e,isPresent:n,custom:r,onExitComplete:u=>{a.set(u,!0);for(const h of a.values())if(!h)return;s&&s()},register:u=>(a.set(u,!1),()=>a.delete(u))}),i?void 0:[n]);return k.useMemo(()=>{a.forEach((u,h)=>a.set(h,!1))},[n]),k.useEffect(()=>{!n&&!a.size&&s&&s()},[n]),o==="popLayout"&&(t=k.createElement(_9,{isPresent:n},t)),k.createElement(Dx.Provider,{value:c},t)};function P9(){return new Map}function F9(t){return k.useEffect(()=>()=>t(),[])}const La=t=>t.key||"";function O9(t,e){t.forEach(n=>{const s=La(n);e.set(s,n)})}function M9(t){const e=[];return k.Children.forEach(t,n=>{k.isValidElement(n)&&e.push(n)}),e}const Pc=({children:t,custom:e,initial:n=!0,onExitComplete:s,exitBeforeEnter:r,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const a=k.useContext(cS).forceRender||A9()[0],l=vO(),c=M9(t);let u=c;const h=k.useRef(new Map).current,d=k.useRef(u),f=k.useRef(new Map).current,p=k.useRef(!0);if(iS(()=>{p.current=!1,O9(c,f),d.current=u}),F9(()=>{p.current=!0,f.clear(),h.clear()}),p.current)return k.createElement(k.Fragment,null,u.map(g=>k.createElement(Ay,{key:La(g),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},g)));u=[...u];const m=d.current.map(La),v=c.map(La),x=m.length;for(let g=0;g<x;g++){const y=m[g];v.indexOf(y)===-1&&!h.has(y)&&h.set(y,void 0)}return o==="wait"&&h.size&&(u=[]),h.forEach((g,y)=>{if(v.indexOf(y)!==-1)return;const b=f.get(y);if(!b)return;const C=m.indexOf(y);let S=g;if(!S){const T=()=>{h.delete(y);const I=Array.from(f.keys()).filter($=>!v.includes($));if(I.forEach($=>f.delete($)),d.current=c.filter($=>{const N=La($);return N===y||I.includes(N)}),!h.size){if(l.current===!1)return;a(),s&&s()}};S=k.createElement(Ay,{key:La(b),isPresent:!1,onExitComplete:T,custom:e,presenceAffectsLayout:i,mode:o},b),h.set(y,S)}u.splice(C,0,S)}),u=u.map(g=>{const y=g.key;return h.has(y)?g:k.createElement(Ay,{key:La(g),isPresent:!0,presenceAffectsLayout:i,mode:o},g)}),k.createElement(k.Fragment,null,h.size?u:u.map(g=>k.cloneElement(g)))};var L9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const z9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),We=(t,e)=>{const n=k.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...l},c)=>k.createElement("svg",{ref:c,...L9,width:r,height:r,stroke:s,strokeWidth:o?Number(i)*24/Number(r):i,className:`lucide lucide-${z9(t)}`,...l},[...e.map(([u,h])=>k.createElement(u,h)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n},V9=We("AreaChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M7 12v5h12V8l-5 5-4-4Z",key:"zxz28u"}]]),Lp=We("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),B9=We("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),j9=We("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),zp=We("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Tg=We("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Ww=We("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Uw=We("CandlestickChart",[["path",{d:"M9 5v4",key:"14uxtq"}],["rect",{width:"4",height:"6",x:"7",y:"9",rx:"1",key:"f4fvz0"}],["path",{d:"M9 15v2",key:"r5rk32"}],["path",{d:"M17 3v2",key:"1l2re6"}],["rect",{width:"4",height:"8",x:"15",y:"5",rx:"1",key:"z38je5"}],["path",{d:"M17 13v3",key:"5l0wba"}],["path",{d:"M3 3v18h18",key:"1s2lah"}]]),yO=We("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),$S=We("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Gw=We("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),W9=We("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),U9=We("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),G9=We("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),XE=We("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),qE=We("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),H9=We("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]),YE=We("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),K9=We("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Hw=We("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),X9=We("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Dy=We("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),QE=We("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Kw=We("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ZE=We("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),bO=We("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),wO=We("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),JE=We("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),NS=We("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),q9=We("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Ig=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),CO=We("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),xh=We("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Y9=We("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Q9=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ES=We("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),wi=We("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Z9=We("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]),J9=We("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),e7=We("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ci=We("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Et(t){var e=t.width,n=t.height;if(e<0)throw new Error("Negative width is not allowed for Size");if(n<0)throw new Error("Negative height is not allowed for Size");return{width:e,height:n}}function el(t,e){return t.width===e.width&&t.height===e.height}var t7=function(){function t(e){var n=this;this._resolutionListener=function(){return n._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=e,this._installResolutionListener()}return t.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(t.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e){var n=this,s={next:e};return this._observers.push(s),{unsubscribe:function(){n._observers=n._observers.filter(function(r){return r!==s})}}},t.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var e=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(e,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){var e=this;this._observers.forEach(function(n){return n.next(e._window.devicePixelRatio)}),this._reinstallResolutionListener()},t}();function n7(t){return new t7(t)}var s7=function(){function t(e,n,s){var r;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=e,this._canvasElementClientSize=Et({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=n??function(i){return i},this._allowResizeObserver=(r=s==null?void 0:s.allowResizeObserver)!==null&&r!==void 0?r:!0,this._chooseAndInitObserver()}return t.prototype.dispose=function(){var e,n;if(this._canvasElement===null)throw new Error("Object is disposed");(e=this._canvasElementResizeObserver)===null||e===void 0||e.disconnect(),this._canvasElementResizeObserver=null,(n=this._devicePixelRatioObservable)===null||n===void 0||n.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(t.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bitmapSize",{get:function(){return Et({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),t.prototype.resizeCanvasElement=function(e){this._canvasElementClientSize=Et(e),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},t.prototype.subscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners.push(e)},t.prototype.unsubscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(n){return n!==e})},Object.defineProperty(t.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),t.prototype.subscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners.push(e)},t.prototype.unsubscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(n){return n!==e})},t.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var e=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(e),this._emitSuggestedBitmapSizeChanged(e,this._suggestedBitmapSize)}},t.prototype._resizeBitmap=function(e){var n=this.bitmapSize;el(n,e)||(this.canvasElement.width=e.width,this.canvasElement.height=e.height,this._emitBitmapSizeChanged(n,e))},t.prototype._emitBitmapSizeChanged=function(e,n){var s=this;this._bitmapSizeChangedListeners.forEach(function(r){return r.call(s,e,n)})},t.prototype._suggestNewBitmapSize=function(e){var n=this._suggestedBitmapSize,s=Et(this._transformBitmapSize(e,this._canvasElementClientSize)),r=el(this.bitmapSize,s)?null:s;n===null&&r===null||n!==null&&r!==null&&el(n,r)||(this._suggestedBitmapSize=r,this._emitSuggestedBitmapSizeChanged(n,r))},t.prototype._emitSuggestedBitmapSizeChanged=function(e,n){var s=this;this._suggestedBitmapSizeChangedListeners.forEach(function(r){return r.call(s,e,n)})},t.prototype._chooseAndInitObserver=function(){var e=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}i7().then(function(n){return n?e._initResizeObserver():e._initDevicePixelRatioObservable()})},t.prototype._initDevicePixelRatioObservable=function(){var e=this;if(this._canvasElement!==null){var n=e2(this._canvasElement);if(n===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=n7(n),this._devicePixelRatioObservable.subscribe(function(){return e._invalidateBitmapSize()}),this._invalidateBitmapSize()}},t.prototype._invalidateBitmapSize=function(){var e,n;if(this._canvasElement!==null){var s=e2(this._canvasElement);if(s!==null){var r=(n=(e=this._devicePixelRatioObservable)===null||e===void 0?void 0:e.value)!==null&&n!==void 0?n:s.devicePixelRatio,i=this._canvasElement.getClientRects(),o=i[0]!==void 0?o7(i[0],r):Et({width:this._canvasElementClientSize.width*r,height:this._canvasElementClientSize.height*r});this._suggestNewBitmapSize(o)}}},t.prototype._initResizeObserver=function(){var e=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(n){var s=n.find(function(o){return o.target===e._canvasElement});if(!(!s||!s.devicePixelContentBoxSize||!s.devicePixelContentBoxSize[0])){var r=s.devicePixelContentBoxSize[0],i=Et({width:r.inlineSize,height:r.blockSize});e._suggestNewBitmapSize(i)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},t}();function r7(t,e){if(e.type==="device-pixel-content-box")return new s7(t,e.transform,e.options);throw new Error("Unsupported binding target")}function e2(t){return t.ownerDocument.defaultView}function i7(){return new Promise(function(t){var e=new ResizeObserver(function(n){t(n.every(function(s){return"devicePixelContentBoxSize"in s})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function o7(t,e){return Et({width:Math.round(t.left*e+t.width*e)-Math.round(t.left*e),height:Math.round(t.top*e+t.height*e)-Math.round(t.top*e)})}var a7=function(){function t(e,n,s){if(n.width===0||n.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=n,s.width===0||s.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=s,this._context=e}return t.prototype.useMediaCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),e({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},t.prototype.useBitmapCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),e({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(t.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),t}();function cl(t,e){var n=t.canvasElementClientSize;if(n.width===0||n.height===0)return null;var s=t.bitmapSize;if(s.width===0||s.height===0)return null;var r=t.canvasElement.getContext("2d",e);return r===null?null:new a7(r,n,s)}/*!
 * @license
 * TradingView Lightweight Charts v4.2.3
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const l7={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},c7={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},u7={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},h7={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},d7={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},f7={color:"#26a69a",base:0},SO={color:"#2196f3"},kO={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var t2,$g;function ul(t,e){const n={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[e];t.setLineDash(n)}function TO(t,e,n,s){t.beginPath();const r=t.lineWidth%2?.5:0;t.moveTo(n,e+r),t.lineTo(s,e+r),t.stroke()}function ta(t,e){if(!t)throw new Error("Assertion failed"+(e?": "+e:""))}function hs(t){if(t===void 0)throw new Error("Value is undefined");return t}function he(t){if(t===null)throw new Error("Value is null");return t}function kc(t){return he(hs(t))}(function(t){t[t.Simple=0]="Simple",t[t.WithSteps=1]="WithSteps",t[t.Curved=2]="Curved"})(t2||(t2={})),function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}($g||($g={}));const n2={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function sr(t){return t<0?0:t>255?255:Math.round(t)||0}function IO(t){return t<=0||t>1?Math.min(Math.max(t,0),1):Math.round(1e4*t)/1e4}const p7=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,m7=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,g7=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,x7=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;function hd(t){(t=t.toLowerCase())in n2&&(t=n2[t]);{const e=x7.exec(t)||g7.exec(t);if(e)return[sr(parseInt(e[1],10)),sr(parseInt(e[2],10)),sr(parseInt(e[3],10)),IO(e.length<5?1:parseFloat(e[4]))]}{const e=m7.exec(t);if(e)return[sr(parseInt(e[1],16)),sr(parseInt(e[2],16)),sr(parseInt(e[3],16)),1]}{const e=p7.exec(t);if(e)return[sr(17*parseInt(e[1],16)),sr(17*parseInt(e[2],16)),sr(17*parseInt(e[3],16)),1]}throw new Error(`Cannot parse color: ${t}`)}function $O(t){return .199*t[0]+.687*t[1]+.114*t[2]}function zx(t){const e=hd(t);return{t:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,i:$O(e)>160?"black":"white"}}class tn{constructor(){this.h=[]}l(e,n,s){const r={o:e,_:n,u:s===!0};this.h.push(r)}v(e){const n=this.h.findIndex(s=>e===s.o);n>-1&&this.h.splice(n,1)}p(e){this.h=this.h.filter(n=>n._!==e)}m(e,n,s){const r=[...this.h];this.h=this.h.filter(i=>!i.u),r.forEach(i=>i.o(e,n,s))}M(){return this.h.length>0}S(){this.h=[]}}function Hr(t,...e){for(const n of e)for(const s in n)n[s]!==void 0&&Object.prototype.hasOwnProperty.call(n,s)&&!["__proto__","constructor","prototype"].includes(s)&&(typeof n[s]!="object"||t[s]===void 0||Array.isArray(n[s])?t[s]=n[s]:Hr(t[s],n[s]));return t}function pi(t){return typeof t=="number"&&isFinite(t)}function dd(t){return typeof t=="number"&&t%1==0}function jd(t){return typeof t=="string"}function Vp(t){return typeof t=="boolean"}function Ki(t){const e=t;if(!e||typeof e!="object")return e;let n,s,r;for(s in n=Array.isArray(e)?[]:{},e)e.hasOwnProperty(s)&&(r=e[s],n[s]=r&&typeof r=="object"?Ki(r):r);return n}function v7(t){return t!==null}function fd(t){return t===null?void 0:t}const RS="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function Zc(t,e,n){return e===void 0&&(e=RS),`${n=n!==void 0?`${n} `:""}${t}px ${e}`}class y7{constructor(e){this.k={C:1,T:5,P:NaN,R:"",D:"",V:"",O:"",B:0,A:0,I:0,L:0,N:0},this.F=e}W(){const e=this.k,n=this.j(),s=this.H();return e.P===n&&e.D===s||(e.P=n,e.D=s,e.R=Zc(n,s),e.L=2.5/12*n,e.B=e.L,e.A=n/12*e.T,e.I=n/12*e.T,e.N=0),e.V=this.$(),e.O=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class AS{constructor(){this.Y=[]}Z(e){this.Y=e}X(e,n,s){this.Y.forEach(r=>{r.X(e,n,s)})}}class Zr{X(e,n,s){e.useBitmapCoordinateSpace(r=>this.K(r,n,s))}}class b7 extends Zr{constructor(){super(...arguments),this.G=null}J(e){this.G=e}K({context:e,horizontalPixelRatio:n,verticalPixelRatio:s}){if(this.G===null||this.G.tt===null)return;const r=this.G.tt,i=this.G,o=Math.max(1,Math.floor(n))%2/2,a=l=>{e.beginPath();for(let c=r.to-1;c>=r.from;--c){const u=i.it[c],h=Math.round(u.nt*n)+o,d=u.st*s,f=l*s+o;e.moveTo(h,d),e.arc(h,d,f,0,2*Math.PI)}e.fill()};i.et>0&&(e.fillStyle=i.rt,a(i.ht+i.et)),e.fillStyle=i.lt,a(i.ht)}}function w7(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}const C7={from:0,to:1};class S7{constructor(e,n){this.ut=new AS,this.ct=[],this.dt=[],this.ft=!0,this.F=e,this.vt=n,this.ut.Z(this.ct)}bt(e){const n=this.F.wt();n.length!==this.ct.length&&(this.dt=n.map(w7),this.ct=this.dt.map(s=>{const r=new b7;return r.J(s),r}),this.ut.Z(this.ct)),this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){const e=this.vt.W().mode===2,n=this.F.wt(),s=this.vt.xt(),r=this.F.St();n.forEach((i,o)=>{var a;const l=this.dt[o],c=i.kt(s);if(e||c===null||!i.yt())return void(l.tt=null);const u=he(i.Ct());l.lt=c.Tt,l.ht=c.ht,l.et=c.Pt,l.it[0]._t=c._t,l.it[0].st=i.Dt().Rt(c._t,u.Vt),l.rt=(a=c.Ot)!==null&&a!==void 0?a:this.F.Bt(l.it[0].st/i.Dt().At()),l.it[0].ot=s,l.it[0].nt=r.It(s),l.tt=C7})}}class k7 extends Zr{constructor(e){super(),this.zt=e}K({context:e,bitmapSize:n,horizontalPixelRatio:s,verticalPixelRatio:r}){if(this.zt===null)return;const i=this.zt.Lt.yt,o=this.zt.Et.yt;if(!i&&!o)return;const a=Math.round(this.zt.nt*s),l=Math.round(this.zt.st*r);e.lineCap="butt",i&&a>=0&&(e.lineWidth=Math.floor(this.zt.Lt.et*s),e.strokeStyle=this.zt.Lt.V,e.fillStyle=this.zt.Lt.V,ul(e,this.zt.Lt.Nt),function(c,u,h,d){c.beginPath();const f=c.lineWidth%2?.5:0;c.moveTo(u+f,h),c.lineTo(u+f,d),c.stroke()}(e,a,0,n.height)),o&&l>=0&&(e.lineWidth=Math.floor(this.zt.Et.et*r),e.strokeStyle=this.zt.Et.V,e.fillStyle=this.zt.Et.V,ul(e,this.zt.Et.Nt),TO(e,l,0,n.width))}}class T7{constructor(e){this.ft=!0,this.Ft={Lt:{et:1,Nt:0,V:"",yt:!1},Et:{et:1,Nt:0,V:"",yt:!1},nt:0,st:0},this.Wt=new k7(this.Ft),this.jt=e}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const e=this.jt.yt(),n=he(this.jt.Ht()),s=n.$t().W().crosshair,r=this.Ft;if(s.mode===2)return r.Et.yt=!1,void(r.Lt.yt=!1);r.Et.yt=e&&this.jt.Ut(n),r.Lt.yt=e&&this.jt.qt(),r.Et.et=s.horzLine.width,r.Et.Nt=s.horzLine.style,r.Et.V=s.horzLine.color,r.Lt.et=s.vertLine.width,r.Lt.Nt=s.vertLine.style,r.Lt.V=s.vertLine.color,r.nt=this.jt.Yt(),r.st=this.jt.Zt()}}function I7(t,e,n,s,r,i){t.fillRect(e+i,n,s-2*i,i),t.fillRect(e+i,n+r-i,s-2*i,i),t.fillRect(e,n,i,r),t.fillRect(e+s-i,n,i,r)}function Vx(t,e,n,s,r,i){t.save(),t.globalCompositeOperation="copy",t.fillStyle=i,t.fillRect(e,n,s,r),t.restore()}function s2(t,e,n,s,r,i){t.beginPath(),t.roundRect?t.roundRect(e,n,s,r,i):(t.lineTo(e+s-i[1],n),i[1]!==0&&t.arcTo(e+s,n,e+s,n+i[1],i[1]),t.lineTo(e+s,n+r-i[2]),i[2]!==0&&t.arcTo(e+s,n+r,e+s-i[2],n+r,i[2]),t.lineTo(e+i[3],n+r),i[3]!==0&&t.arcTo(e,n+r,e,n+r-i[3],i[3]),t.lineTo(e,n+i[0]),i[0]!==0&&t.arcTo(e,n,e+i[0],n,i[0]))}function r2(t,e,n,s,r,i,o=0,a=[0,0,0,0],l=""){if(t.save(),!o||!l||l===i)return s2(t,e,n,s,r,a),t.fillStyle=i,t.fill(),void t.restore();const c=o/2;var u;s2(t,e+c,n+c,s-o,r-o,(u=-c,a.map(h=>h===0?h:h+u))),i!=="transparent"&&(t.fillStyle=i,t.fill()),l!=="transparent"&&(t.lineWidth=o,t.strokeStyle=l,t.closePath(),t.stroke()),t.restore()}function NO(t,e,n,s,r,i,o){t.save(),t.globalCompositeOperation="copy";const a=t.createLinearGradient(0,0,0,r);a.addColorStop(0,i),a.addColorStop(1,o),t.fillStyle=a,t.fillRect(e,n,s,r),t.restore()}class i2{constructor(e,n){this.J(e,n)}J(e,n){this.zt=e,this.Xt=n}At(e,n){return this.zt.yt?e.P+e.L+e.B:0}X(e,n,s,r){if(!this.zt.yt||this.zt.Kt.length===0)return;const i=this.zt.V,o=this.Xt.t,a=e.useBitmapCoordinateSpace(l=>{const c=l.context;c.font=n.R;const u=this.Gt(l,n,s,r),h=u.Jt;return u.Qt?r2(c,h.ti,h.ii,h.ni,h.si,o,h.ei,[h.ht,0,0,h.ht],o):r2(c,h.ri,h.ii,h.ni,h.si,o,h.ei,[0,h.ht,h.ht,0],o),this.zt.hi&&(c.fillStyle=i,c.fillRect(h.ri,h.li,h.ai-h.ri,h.oi)),this.zt._i&&(c.fillStyle=n.O,c.fillRect(u.Qt?h.ui-h.ei:0,h.ii,h.ei,h.ci-h.ii)),u});e.useMediaCoordinateSpace(({context:l})=>{const c=a.di;l.font=n.R,l.textAlign=a.Qt?"right":"left",l.textBaseline="middle",l.fillStyle=i,l.fillText(this.zt.Kt,c.fi,(c.ii+c.ci)/2+c.pi)})}Gt(e,n,s,r){var i;const{context:o,bitmapSize:a,mediaSize:l,horizontalPixelRatio:c,verticalPixelRatio:u}=e,h=this.zt.hi||!this.zt.mi?n.T:0,d=this.zt.bi?n.C:0,f=n.L+this.Xt.wi,p=n.B+this.Xt.gi,m=n.A,v=n.I,x=this.zt.Kt,g=n.P,y=s.Mi(o,x),b=Math.ceil(s.xi(o,x)),C=g+f+p,S=n.C+m+v+b+h,T=Math.max(1,Math.floor(u));let I=Math.round(C*u);I%2!=T%2&&(I+=1);const $=d>0?Math.max(1,Math.floor(d*c)):0,N=Math.round(S*c),A=Math.round(h*c),F=(i=this.Xt.Si)!==null&&i!==void 0?i:this.Xt.ki,E=Math.round(F*u)-Math.floor(.5*u),R=Math.floor(E+T/2-I/2),O=R+I,P=r==="right",z=P?l.width-d:d,_=P?a.width-$:$;let M,U,W;return P?(M=_-N,U=_-A,W=z-h-m-d):(M=_+N,U=_+A,W=z+h+m),{Qt:P,Jt:{ii:R,li:E,ci:O,ni:N,si:I,ht:2*c,ei:$,ti:M,ri:_,ai:U,oi:T,ui:a.width},di:{ii:R/u,ci:O/u,fi:W,pi:y}}}}class Bx{constructor(e){this.yi={ki:0,t:"#000",gi:0,wi:0},this.Ci={Kt:"",yt:!1,hi:!0,mi:!1,Ot:"",V:"#FFF",_i:!1,bi:!1},this.Ti={Kt:"",yt:!1,hi:!1,mi:!0,Ot:"",V:"#FFF",_i:!0,bi:!0},this.ft=!0,this.Pi=new(e||i2)(this.Ci,this.yi),this.Ri=new(e||i2)(this.Ti,this.yi)}Kt(){return this.Di(),this.Ci.Kt}ki(){return this.Di(),this.yi.ki}bt(){this.ft=!0}At(e,n=!1){return Math.max(this.Pi.At(e,n),this.Ri.At(e,n))}Vi(){return this.yi.Si||0}Oi(e){this.yi.Si=e}Bi(){return this.Di(),this.Ci.yt||this.Ti.yt}Ai(){return this.Di(),this.Ci.yt}gt(e){return this.Di(),this.Ci.hi=this.Ci.hi&&e.W().ticksVisible,this.Ti.hi=this.Ti.hi&&e.W().ticksVisible,this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Pi}Ii(){return this.Di(),this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Ri}Di(){this.ft&&(this.Ci.hi=!0,this.Ti.hi=!1,this.zi(this.Ci,this.Ti,this.yi))}}class $7 extends Bx{constructor(e,n,s){super(),this.jt=e,this.Li=n,this.Ei=s}zi(e,n,s){if(e.yt=!1,this.jt.W().mode===2)return;const r=this.jt.W().horzLine;if(!r.labelVisible)return;const i=this.Li.Ct();if(!this.jt.yt()||this.Li.Ni()||i===null)return;const o=zx(r.labelBackgroundColor);s.t=o.t,e.V=o.i;const a=2/12*this.Li.P();s.wi=a,s.gi=a;const l=this.Ei(this.Li);s.ki=l.ki,e.Kt=this.Li.Fi(l._t,i),e.yt=!0}}const N7=/[1-9]/g;class EO{constructor(){this.zt=null}J(e){this.zt=e}X(e,n){if(this.zt===null||this.zt.yt===!1||this.zt.Kt.length===0)return;const s=e.useMediaCoordinateSpace(({context:d})=>(d.font=n.R,Math.round(n.Wi.xi(d,he(this.zt).Kt,N7))));if(s<=0)return;const r=n.ji,i=s+2*r,o=i/2,a=this.zt.Hi;let l=this.zt.ki,c=Math.floor(l-o)+.5;c<0?(l+=Math.abs(0-c),c=Math.floor(l-o)+.5):c+i>a&&(l-=Math.abs(a-(c+i)),c=Math.floor(l-o)+.5);const u=c+i,h=Math.ceil(0+n.C+n.T+n.L+n.P+n.B);e.useBitmapCoordinateSpace(({context:d,horizontalPixelRatio:f,verticalPixelRatio:p})=>{const m=he(this.zt);d.fillStyle=m.t;const v=Math.round(c*f),x=Math.round(0*p),g=Math.round(u*f),y=Math.round(h*p),b=Math.round(2*f);if(d.beginPath(),d.moveTo(v,x),d.lineTo(v,y-b),d.arcTo(v,y,v+b,y,b),d.lineTo(g-b,y),d.arcTo(g,y,g,y-b,b),d.lineTo(g,x),d.fill(),m.hi){const C=Math.round(m.ki*f),S=x,T=Math.round((S+n.T)*p);d.fillStyle=m.V;const I=Math.max(1,Math.floor(f)),$=Math.floor(.5*f);d.fillRect(C-$,S,I,T-S)}}),e.useMediaCoordinateSpace(({context:d})=>{const f=he(this.zt),p=0+n.C+n.T+n.L+n.P/2;d.font=n.R,d.textAlign="left",d.textBaseline="middle",d.fillStyle=f.V;const m=n.Wi.Mi(d,"Apr0");d.translate(c+r,p+m),d.fillText(f.Kt,0,0)})}}let E7=class{constructor(e,n,s){this.ft=!0,this.Wt=new EO,this.Ft={yt:!1,t:"#4c525e",V:"white",Kt:"",Hi:0,ki:NaN,hi:!0},this.vt=e,this.$i=n,this.Ei=s}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){const e=this.Ft;if(e.yt=!1,this.vt.W().mode===2)return;const n=this.vt.W().vertLine;if(!n.labelVisible)return;const s=this.$i.St();if(s.Ni())return;e.Hi=s.Hi();const r=this.Ei();if(r===null)return;e.ki=r.ki;const i=s.Ui(this.vt.xt());e.Kt=s.qi(he(i)),e.yt=!0;const o=zx(n.labelBackgroundColor);e.t=o.t,e.V=o.i,e.hi=s.W().ticksVisible}};class DS{constructor(){this.Yi=null,this.Zi=0}Xi(){return this.Zi}Ki(e){this.Zi=e}Dt(){return this.Yi}Gi(e){this.Yi=e}Ji(e){return[]}Qi(){return[]}yt(){return!0}}var o2;(function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet",t[t.Hidden=2]="Hidden"})(o2||(o2={}));class R7 extends DS{constructor(e,n){super(),this.tn=null,this.nn=NaN,this.sn=0,this.en=!0,this.rn=new Map,this.hn=!1,this.ln=NaN,this.an=NaN,this._n=NaN,this.un=NaN,this.$i=e,this.cn=n,this.dn=new S7(e,this),this.fn=((r,i)=>o=>{const a=i(),l=r();if(o===he(this.tn).vn())return{_t:l,ki:a};{const c=he(o.Ct());return{_t:o.pn(a,c),ki:a}}})(()=>this.nn,()=>this.an);const s=((r,i)=>()=>{const o=this.$i.St().mn(r()),a=i();return o&&Number.isFinite(a)?{ot:o,ki:a}:null})(()=>this.sn,()=>this.Yt());this.bn=new E7(this,e,s),this.wn=new T7(this)}W(){return this.cn}gn(e,n){this._n=e,this.un=n}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(e,n,s){this.hn||(this.hn=!0),this.en=!0,this.yn(e,n,s)}xt(){return this.sn}Yt(){return this.ln}Zt(){return this.an}yt(){return this.en}Cn(){this.en=!1,this.Tn(),this.nn=NaN,this.ln=NaN,this.an=NaN,this.tn=null,this.Mn()}Pn(e){return this.tn!==null?[this.wn,this.dn]:[]}Ut(e){return e===this.tn&&this.cn.horzLine.visible}qt(){return this.cn.vertLine.visible}Rn(e,n){this.en&&this.tn===e||this.rn.clear();const s=[];return this.tn===e&&s.push(this.Dn(this.rn,n,this.fn)),s}Qi(){return this.en?[this.bn]:[]}Ht(){return this.tn}Vn(){this.wn.bt(),this.rn.forEach(e=>e.bt()),this.bn.bt(),this.dn.bt()}On(e){return e&&!e.vn().Ni()?e.vn():null}yn(e,n,s){this.Bn(e,n,s)&&this.Vn()}Bn(e,n,s){const r=this.ln,i=this.an,o=this.nn,a=this.sn,l=this.tn,c=this.On(s);this.sn=e,this.ln=isNaN(e)?NaN:this.$i.St().It(e),this.tn=s;const u=c!==null?c.Ct():null;return c!==null&&u!==null?(this.nn=n,this.an=c.Rt(n,u)):(this.nn=NaN,this.an=NaN),r!==this.ln||i!==this.an||a!==this.sn||o!==this.nn||l!==this.tn}Tn(){const e=this.$i.wt().map(s=>s.In().An()).filter(v7),n=e.length===0?null:Math.max(...e);this.sn=n!==null?n:NaN}Dn(e,n,s){let r=e.get(n);return r===void 0&&(r=new $7(this,n,s),e.set(n,r)),r}}function jx(t){return t==="left"||t==="right"}class Fn{constructor(e){this.zn=new Map,this.Ln=[],this.En=e}Nn(e,n){const s=function(r,i){return r===void 0?i:{Fn:Math.max(r.Fn,i.Fn),Wn:r.Wn||i.Wn}}(this.zn.get(e),n);this.zn.set(e,s)}jn(){return this.En}Hn(e){const n=this.zn.get(e);return n===void 0?{Fn:this.En}:{Fn:Math.max(this.En,n.Fn),Wn:n.Wn}}$n(){this.Un(),this.Ln=[{qn:0}]}Yn(e){this.Un(),this.Ln=[{qn:1,Vt:e}]}Zn(e){this.Xn(),this.Ln.push({qn:5,Vt:e})}Un(){this.Xn(),this.Ln.push({qn:6})}Kn(){this.Un(),this.Ln=[{qn:4}]}Gn(e){this.Un(),this.Ln.push({qn:2,Vt:e})}Jn(e){this.Un(),this.Ln.push({qn:3,Vt:e})}Qn(){return this.Ln}ts(e){for(const n of e.Ln)this.ns(n);this.En=Math.max(this.En,e.En),e.zn.forEach((n,s)=>{this.Nn(s,n)})}static ss(){return new Fn(2)}static es(){return new Fn(3)}ns(e){switch(e.qn){case 0:this.$n();break;case 1:this.Yn(e.Vt);break;case 2:this.Gn(e.Vt);break;case 3:this.Jn(e.Vt);break;case 4:this.Kn();break;case 5:this.Zn(e.Vt);break;case 6:this.Xn()}}Xn(){const e=this.Ln.findIndex(n=>n.qn===5);e!==-1&&this.Ln.splice(e,1)}}const a2=".";function Xi(t,e){if(!pi(t))return"n/a";if(!dd(e))throw new TypeError("invalid length");if(e<0||e>16)throw new TypeError("invalid length");return e===0?t.toString():("0000000000000000"+t.toString()).slice(-e)}class Wx{constructor(e,n){if(n||(n=1),pi(e)&&dd(e)||(e=100),e<0)throw new TypeError("invalid base");this.Li=e,this.rs=n,this.hs()}format(e){const n=e<0?"":"";return e=Math.abs(e),n+this.ls(e)}hs(){if(this._s=0,this.Li>0&&this.rs>0){let e=this.Li;for(;e>1;)e/=10,this._s++}}ls(e){const n=this.Li/this.rs;let s=Math.floor(e),r="";const i=this._s!==void 0?this._s:NaN;if(n>1){let o=+(Math.round(e*n)-s*n).toFixed(this._s);o>=n&&(o-=n,s+=1),r=a2+Xi(+o.toFixed(this._s)*this.rs,i)}else s=Math.round(s*n)/n,i>0&&(r=a2+Xi(0,i));return s.toFixed(0)+r}}let RO=class extends Wx{constructor(e=100){super(e)}format(e){return`${super.format(e)}%`}};class A7{constructor(e){this.us=e}format(e){let n="";return e<0&&(n="-",e=-e),e<995?n+this.cs(e):e<999995?n+this.cs(e/1e3)+"K":e<999999995?(e=1e3*Math.round(e/1e3),n+this.cs(e/1e6)+"M"):(e=1e6*Math.round(e/1e6),n+this.cs(e/1e9)+"B")}cs(e){let n;const s=Math.pow(10,this.us);return n=(e=Math.round(e*s)/s)>=1e-15&&e<1?e.toFixed(this.us).replace(/\.?0+$/,""):String(e),n.replace(/(\.[1-9]*)0+$/,(r,i)=>i)}}function AO(t,e,n,s,r,i,o){if(e.length===0||s.from>=e.length||s.to<=0)return;const{context:a,horizontalPixelRatio:l,verticalPixelRatio:c}=t,u=e[s.from];let h=i(t,u),d=u;if(s.to-s.from<2){const f=r/2;a.beginPath();const p={nt:u.nt-f,st:u.st},m={nt:u.nt+f,st:u.st};a.moveTo(p.nt*l,p.st*c),a.lineTo(m.nt*l,m.st*c),o(t,h,p,m)}else{const f=(m,v)=>{o(t,h,d,v),a.beginPath(),h=m,d=v};let p=d;a.beginPath(),a.moveTo(u.nt*l,u.st*c);for(let m=s.from+1;m<s.to;++m){p=e[m];const v=i(t,p);switch(n){case 0:a.lineTo(p.nt*l,p.st*c);break;case 1:a.lineTo(p.nt*l,e[m-1].st*c),v!==h&&(f(v,p),a.lineTo(p.nt*l,e[m-1].st*c)),a.lineTo(p.nt*l,p.st*c);break;case 2:{const[x,g]=D7(e,m-1,m);a.bezierCurveTo(x.nt*l,x.st*c,g.nt*l,g.st*c,p.nt*l,p.st*c);break}}n!==1&&v!==h&&(f(v,p),a.moveTo(p.nt*l,p.st*c))}(d!==p||d===p&&n===1)&&o(t,h,d,p)}}const l2=6;function _y(t,e){return{nt:t.nt-e.nt,st:t.st-e.st}}function c2(t,e){return{nt:t.nt/e,st:t.st/e}}function D7(t,e,n){const s=Math.max(0,e-1),r=Math.min(t.length-1,n+1);var i,o;return[(i=t[e],o=c2(_y(t[n],t[s]),l2),{nt:i.nt+o.nt,st:i.st+o.st}),_y(t[n],c2(_y(t[r],t[e]),l2))]}function _7(t,e,n,s,r){const{context:i,horizontalPixelRatio:o,verticalPixelRatio:a}=e;i.lineTo(r.nt*o,t*a),i.lineTo(s.nt*o,t*a),i.closePath(),i.fillStyle=n,i.fill()}let DO=class extends Zr{constructor(){super(...arguments),this.G=null}J(e){this.G=e}K(e){var n;if(this.G===null)return;const{it:s,tt:r,ds:i,et:o,Nt:a,fs:l}=this.G,c=(n=this.G.vs)!==null&&n!==void 0?n:this.G.ps?0:e.mediaSize.height;if(r===null)return;const u=e.context;u.lineCap="butt",u.lineJoin="round",u.lineWidth=o,ul(u,a),u.lineWidth=1,AO(e,s,l,r,i,this.bs.bind(this),_7.bind(null,c))}};function Xw(t,e,n){return Math.min(Math.max(t,e),n)}function Bp(t,e,n){return e-t<=n}function _O(t){const e=Math.ceil(t);return e%2==0?e-1:e}let _S=class{ws(e,n){const s=this.gs,{Ms:r,xs:i,Ss:o,ks:a,ys:l,vs:c}=n;if(this.Cs===void 0||s===void 0||s.Ms!==r||s.xs!==i||s.Ss!==o||s.ks!==a||s.vs!==c||s.ys!==l){const u=e.context.createLinearGradient(0,0,0,l);if(u.addColorStop(0,r),c!=null){const h=Xw(c*e.verticalPixelRatio/l,0,1);u.addColorStop(h,i),u.addColorStop(h,o)}u.addColorStop(1,a),this.Cs=u,this.gs=n}return this.Cs}};class P7 extends DO{constructor(){super(...arguments),this.Ts=new _S}bs(e,n){return this.Ts.ws(e,{Ms:n.Ps,xs:"",Ss:"",ks:n.Rs,ys:e.bitmapSize.height})}}function F7(t,e){const n=t.context;n.strokeStyle=e,n.stroke()}let PO=class extends Zr{constructor(){super(...arguments),this.G=null}J(e){this.G=e}K(e){if(this.G===null)return;const{it:n,tt:s,ds:r,fs:i,et:o,Nt:a,Ds:l}=this.G;if(s===null)return;const c=e.context;c.lineCap="butt",c.lineWidth=o*e.verticalPixelRatio,ul(c,a),c.lineJoin="round";const u=this.Vs.bind(this);i!==void 0&&AO(e,n,i,s,r,u,F7),l&&function(h,d,f,p,m){const{horizontalPixelRatio:v,verticalPixelRatio:x,context:g}=h;let y=null;const b=Math.max(1,Math.floor(v))%2/2,C=f*x+b;for(let S=p.to-1;S>=p.from;--S){const T=d[S];if(T){const I=m(h,T);I!==y&&(g.beginPath(),y!==null&&g.fill(),g.fillStyle=I,y=I);const $=Math.round(T.nt*v)+b,N=T.st*x;g.moveTo($,N),g.arc($,N,C,0,2*Math.PI)}}g.fill()}(e,n,l,s,u)}};class FO extends PO{Vs(e,n){return n.lt}}function OO(t,e,n,s,r=0,i=e.length){let o=i-r;for(;0<o;){const a=o>>1,l=r+a;s(e[l],n)===t?(r=l+1,o-=a+1):o=a}return r}const Wd=OO.bind(null,!0),MO=OO.bind(null,!1);function O7(t,e){return t.ot<e}function M7(t,e){return e<t.ot}function LO(t,e,n){const s=e.Os(),r=e.ui(),i=Wd(t,s,O7),o=MO(t,r,M7);if(!n)return{from:i,to:o};let a=i,l=o;return i>0&&i<t.length&&t[i].ot>=s&&(a=i-1),o>0&&o<t.length&&t[o-1].ot<=r&&(l=o+1),{from:a,to:l}}let PS=class{constructor(e,n,s){this.Bs=!0,this.As=!0,this.Is=!0,this.zs=[],this.Ls=null,this.Es=e,this.Ns=n,this.Fs=s}bt(e){this.Bs=!0,e==="data"&&(this.As=!0),e==="options"&&(this.Is=!0)}gt(){return this.Es.yt()?(this.Ws(),this.Ls===null?null:this.js):null}Hs(){this.zs=this.zs.map(e=>Object.assign(Object.assign({},e),this.Es.Us().$s(e.ot)))}qs(){this.Ls=null}Ws(){this.As&&(this.Ys(),this.As=!1),this.Is&&(this.Hs(),this.Is=!1),this.Bs&&(this.Zs(),this.Bs=!1)}Zs(){const e=this.Es.Dt(),n=this.Ns.St();if(this.qs(),n.Ni()||e.Ni())return;const s=n.Xs();if(s===null||this.Es.In().Ks()===0)return;const r=this.Es.Ct();r!==null&&(this.Ls=LO(this.zs,s,this.Fs),this.Gs(e,n,r.Vt),this.Js())}};class Ux extends PS{constructor(e,n){super(e,n,!0)}Gs(e,n,s){n.Qs(this.zs,fd(this.Ls)),e.te(this.zs,s,fd(this.Ls))}ie(e,n){return{ot:e,_t:n,nt:NaN,st:NaN}}Ys(){const e=this.Es.Us();this.zs=this.Es.In().ne().map(n=>{const s=n.Vt[3];return this.se(n.ee,s,e)})}}class L7 extends Ux{constructor(e,n){super(e,n),this.js=new AS,this.re=new P7,this.he=new FO,this.js.Z([this.re,this.he])}se(e,n,s){return Object.assign(Object.assign({},this.ie(e,n)),s.$s(e))}Js(){const e=this.Es.W();this.re.J({fs:e.lineType,it:this.zs,Nt:e.lineStyle,et:e.lineWidth,vs:null,ps:e.invertFilledArea,tt:this.Ls,ds:this.Ns.St().le()}),this.he.J({fs:e.lineVisible?e.lineType:void 0,it:this.zs,Nt:e.lineStyle,et:e.lineWidth,tt:this.Ls,ds:this.Ns.St().le(),Ds:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0})}}class z7 extends Zr{constructor(){super(...arguments),this.zt=null,this.ae=0,this.oe=0}J(e){this.zt=e}K({context:e,horizontalPixelRatio:n,verticalPixelRatio:s}){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;this.ae=this._e(n),this.ae>=2&&Math.max(1,Math.floor(n))%2!=this.ae%2&&this.ae--,this.oe=this.zt.ue?Math.min(this.ae,Math.floor(n)):this.ae;let r=null;const i=this.oe<=this.ae&&this.zt.le>=Math.floor(1.5*n);for(let o=this.zt.tt.from;o<this.zt.tt.to;++o){const a=this.zt.In[o];r!==a.ce&&(e.fillStyle=a.ce,r=a.ce);const l=Math.floor(.5*this.oe),c=Math.round(a.nt*n),u=c-l,h=this.oe,d=u+h-1,f=Math.min(a.de,a.fe),p=Math.max(a.de,a.fe),m=Math.round(f*s)-l,v=Math.round(p*s)+l,x=Math.max(v-m,this.oe);e.fillRect(u,m,h,x);const g=Math.ceil(1.5*this.ae);if(i){if(this.zt.ve){const S=c-g;let T=Math.max(m,Math.round(a.pe*s)-l),I=T+h-1;I>m+x-1&&(I=m+x-1,T=I-h+1),e.fillRect(S,T,u-S,I-T+1)}const y=c+g;let b=Math.max(m,Math.round(a.me*s)-l),C=b+h-1;C>m+x-1&&(C=m+x-1,b=C-h+1),e.fillRect(d+1,b,y-d,C-b+1)}}}_e(e){const n=Math.floor(e);return Math.max(n,Math.floor(function(s,r){return Math.floor(.3*s*r)}(he(this.zt).le,e)))}}class zO extends PS{constructor(e,n){super(e,n,!1)}Gs(e,n,s){n.Qs(this.zs,fd(this.Ls)),e.be(this.zs,s,fd(this.Ls))}we(e,n,s){return{ot:e,ge:n.Vt[0],Me:n.Vt[1],xe:n.Vt[2],Se:n.Vt[3],nt:NaN,pe:NaN,de:NaN,fe:NaN,me:NaN}}Ys(){const e=this.Es.Us();this.zs=this.Es.In().ne().map(n=>this.se(n.ee,n,e))}}let V7=class extends zO{constructor(){super(...arguments),this.js=new z7}se(e,n,s){return Object.assign(Object.assign({},this.we(e,n,s)),s.$s(e))}Js(){const e=this.Es.W();this.js.J({In:this.zs,le:this.Ns.St().le(),ve:e.openVisible,ue:e.thinBars,tt:this.Ls})}};class B7 extends DO{constructor(){super(...arguments),this.Ts=new _S}bs(e,n){const s=this.G;return this.Ts.ws(e,{Ms:n.ke,xs:n.ye,Ss:n.Ce,ks:n.Te,ys:e.bitmapSize.height,vs:s.vs})}}class j7 extends PO{constructor(){super(...arguments),this.Pe=new _S}Vs(e,n){const s=this.G;return this.Pe.ws(e,{Ms:n.Re,xs:n.Re,Ss:n.De,ks:n.De,ys:e.bitmapSize.height,vs:s.vs})}}class W7 extends Ux{constructor(e,n){super(e,n),this.js=new AS,this.Ve=new B7,this.Oe=new j7,this.js.Z([this.Ve,this.Oe])}se(e,n,s){return Object.assign(Object.assign({},this.ie(e,n)),s.$s(e))}Js(){const e=this.Es.Ct();if(e===null)return;const n=this.Es.W(),s=this.Es.Dt().Rt(n.baseValue.price,e.Vt),r=this.Ns.St().le();this.Ve.J({it:this.zs,et:n.lineWidth,Nt:n.lineStyle,fs:n.lineType,vs:s,ps:!1,tt:this.Ls,ds:r}),this.Oe.J({it:this.zs,et:n.lineWidth,Nt:n.lineStyle,fs:n.lineVisible?n.lineType:void 0,Ds:n.pointMarkersVisible?n.pointMarkersRadius||n.lineWidth/2+2:void 0,vs:s,tt:this.Ls,ds:r})}}class U7 extends Zr{constructor(){super(...arguments),this.zt=null,this.ae=0}J(e){this.zt=e}K(e){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;const{horizontalPixelRatio:n}=e;this.ae=function(i,o){if(i>=2.5&&i<=4)return Math.floor(3*o);const a=1-.2*Math.atan(Math.max(4,i)-4)/(.5*Math.PI),l=Math.floor(i*a*o),c=Math.floor(i*o),u=Math.min(l,c);return Math.max(Math.floor(o),u)}(this.zt.le,n),this.ae>=2&&Math.floor(n)%2!=this.ae%2&&this.ae--;const s=this.zt.In;this.zt.Be&&this.Ae(e,s,this.zt.tt),this.zt._i&&this.Ie(e,s,this.zt.tt);const r=this.ze(n);(!this.zt._i||this.ae>2*r)&&this.Le(e,s,this.zt.tt)}Ae(e,n,s){if(this.zt===null)return;const{context:r,horizontalPixelRatio:i,verticalPixelRatio:o}=e;let a="",l=Math.min(Math.floor(i),Math.floor(this.zt.le*i));l=Math.max(Math.floor(i),Math.min(l,this.ae));const c=Math.floor(.5*l);let u=null;for(let h=s.from;h<s.to;h++){const d=n[h];d.Ee!==a&&(r.fillStyle=d.Ee,a=d.Ee);const f=Math.round(Math.min(d.pe,d.me)*o),p=Math.round(Math.max(d.pe,d.me)*o),m=Math.round(d.de*o),v=Math.round(d.fe*o);let x=Math.round(i*d.nt)-c;const g=x+l-1;u!==null&&(x=Math.max(u+1,x),x=Math.min(x,g));const y=g-x+1;r.fillRect(x,m,y,f-m),r.fillRect(x,p+1,y,v-p),u=g}}ze(e){let n=Math.floor(1*e);this.ae<=2*n&&(n=Math.floor(.5*(this.ae-1)));const s=Math.max(Math.floor(e),n);return this.ae<=2*s?Math.max(Math.floor(e),Math.floor(1*e)):s}Ie(e,n,s){if(this.zt===null)return;const{context:r,horizontalPixelRatio:i,verticalPixelRatio:o}=e;let a="";const l=this.ze(i);let c=null;for(let u=s.from;u<s.to;u++){const h=n[u];h.Ne!==a&&(r.fillStyle=h.Ne,a=h.Ne);let d=Math.round(h.nt*i)-Math.floor(.5*this.ae);const f=d+this.ae-1,p=Math.round(Math.min(h.pe,h.me)*o),m=Math.round(Math.max(h.pe,h.me)*o);if(c!==null&&(d=Math.max(c+1,d),d=Math.min(d,f)),this.zt.le*i>2*l)I7(r,d,p,f-d+1,m-p+1,l);else{const v=f-d+1;r.fillRect(d,p,v,m-p+1)}c=f}}Le(e,n,s){if(this.zt===null)return;const{context:r,horizontalPixelRatio:i,verticalPixelRatio:o}=e;let a="";const l=this.ze(i);for(let c=s.from;c<s.to;c++){const u=n[c];let h=Math.round(Math.min(u.pe,u.me)*o),d=Math.round(Math.max(u.pe,u.me)*o),f=Math.round(u.nt*i)-Math.floor(.5*this.ae),p=f+this.ae-1;if(u.ce!==a){const m=u.ce;r.fillStyle=m,a=m}this.zt._i&&(f+=l,h+=l,p-=l,d-=l),h>d||r.fillRect(f,h,p-f+1,d-h+1)}}}class G7 extends zO{constructor(){super(...arguments),this.js=new U7}se(e,n,s){return Object.assign(Object.assign({},this.we(e,n,s)),s.$s(e))}Js(){const e=this.Es.W();this.js.J({In:this.zs,le:this.Ns.St().le(),Be:e.wickVisible,_i:e.borderVisible,tt:this.Ls})}}class H7{constructor(e,n){this.Fe=e,this.Li=n}X(e,n,s){this.Fe.draw(e,this.Li,n,s)}}class Py extends PS{constructor(e,n,s){super(e,n,!1),this.wn=s,this.js=new H7(this.wn.renderer(),r=>{const i=e.Ct();return i===null?null:e.Dt().Rt(r,i.Vt)})}We(e){return this.wn.priceValueBuilder(e)}je(e){return this.wn.isWhitespace(e)}Ys(){const e=this.Es.Us();this.zs=this.Es.In().ne().map(n=>Object.assign(Object.assign({ot:n.ee,nt:NaN},e.$s(n.ee)),{He:n.$e}))}Gs(e,n){n.Qs(this.zs,fd(this.Ls))}Js(){this.wn.update({bars:this.zs.map(K7),barSpacing:this.Ns.St().le(),visibleRange:this.Ls},this.Es.W())}}function K7(t){return{x:t.nt,time:t.ot,originalData:t.He,barColor:t.ce}}class X7 extends Zr{constructor(){super(...arguments),this.zt=null,this.Ue=[]}J(e){this.zt=e,this.Ue=[]}K({context:e,horizontalPixelRatio:n,verticalPixelRatio:s}){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return;this.Ue.length||this.qe(n);const r=Math.max(1,Math.floor(s)),i=Math.round(this.zt.Ye*s)-Math.floor(r/2),o=i+r;for(let a=this.zt.tt.from;a<this.zt.tt.to;a++){const l=this.zt.it[a],c=this.Ue[a-this.zt.tt.from],u=Math.round(l.st*s);let h,d;e.fillStyle=l.ce,u<=i?(h=u,d=o):(h=i,d=u-Math.floor(r/2)+r),e.fillRect(c.Os,h,c.ui-c.Os+1,d-h)}}qe(e){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return void(this.Ue=[]);const n=Math.ceil(this.zt.le*e)<=1?0:Math.max(1,Math.floor(e)),s=Math.round(this.zt.le*e)-n;this.Ue=new Array(this.zt.tt.to-this.zt.tt.from);for(let i=this.zt.tt.from;i<this.zt.tt.to;i++){const o=this.zt.it[i],a=Math.round(o.nt*e);let l,c;if(s%2){const u=(s-1)/2;l=a-u,c=a+u}else{const u=s/2;l=a-u,c=a+u-1}this.Ue[i-this.zt.tt.from]={Os:l,ui:c,Ze:a,Xe:o.nt*e,ot:o.ot}}for(let i=this.zt.tt.from+1;i<this.zt.tt.to;i++){const o=this.Ue[i-this.zt.tt.from],a=this.Ue[i-this.zt.tt.from-1];o.ot===a.ot+1&&o.Os-a.ui!==n+1&&(a.Ze>a.Xe?a.ui=o.Os-n-1:o.Os=a.ui+n+1)}let r=Math.ceil(this.zt.le*e);for(let i=this.zt.tt.from;i<this.zt.tt.to;i++){const o=this.Ue[i-this.zt.tt.from];o.ui<o.Os&&(o.ui=o.Os);const a=o.ui-o.Os+1;r=Math.min(a,r)}if(n>0&&r<4)for(let i=this.zt.tt.from;i<this.zt.tt.to;i++){const o=this.Ue[i-this.zt.tt.from];o.ui-o.Os+1>r&&(o.Ze>o.Xe?o.ui-=1:o.Os+=1)}}}class q7 extends Ux{constructor(){super(...arguments),this.js=new X7}se(e,n,s){return Object.assign(Object.assign({},this.ie(e,n)),s.$s(e))}Js(){const e={it:this.zs,le:this.Ns.St().le(),tt:this.Ls,Ye:this.Es.Dt().Rt(this.Es.W().base,he(this.Es.Ct()).Vt)};this.js.J(e)}}class Y7 extends Ux{constructor(){super(...arguments),this.js=new FO}se(e,n,s){return Object.assign(Object.assign({},this.ie(e,n)),s.$s(e))}Js(){const e=this.Es.W(),n={it:this.zs,Nt:e.lineStyle,fs:e.lineVisible?e.lineType:void 0,et:e.lineWidth,Ds:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,tt:this.Ls,ds:this.Ns.St().le()};this.js.J(n)}}const Q7=/[2-9]/g;class pd{constructor(e=50){this.Ke=0,this.Ge=1,this.Je=1,this.Qe={},this.tr=new Map,this.ir=e}nr(){this.Ke=0,this.tr.clear(),this.Ge=1,this.Je=1,this.Qe={}}xi(e,n,s){return this.sr(e,n,s).width}Mi(e,n,s){const r=this.sr(e,n,s);return((r.actualBoundingBoxAscent||0)-(r.actualBoundingBoxDescent||0))/2}sr(e,n,s){const r=s||Q7,i=String(n).replace(r,"0");if(this.tr.has(i))return hs(this.tr.get(i)).er;if(this.Ke===this.ir){const a=this.Qe[this.Je];delete this.Qe[this.Je],this.tr.delete(a),this.Je++,this.Ke--}e.save(),e.textBaseline="middle";const o=e.measureText(i);return e.restore(),o.width===0&&n.length||(this.tr.set(i,{er:o,rr:this.Ge}),this.Qe[this.Ge]=i,this.Ke++,this.Ge++),o}}class Z7{constructor(e){this.hr=null,this.k=null,this.lr="right",this.ar=e}_r(e,n,s){this.hr=e,this.k=n,this.lr=s}X(e){this.k!==null&&this.hr!==null&&this.hr.X(e,this.k,this.ar,this.lr)}}class VO{constructor(e,n,s){this.ur=e,this.ar=new pd(50),this.cr=n,this.F=s,this.j=-1,this.Wt=new Z7(this.ar)}gt(){const e=this.F.dr(this.cr);if(e===null)return null;const n=e.vr(this.cr)?e.pr():this.cr.Dt();if(n===null)return null;const s=e.mr(n);if(s==="overlay")return null;const r=this.F.br();return r.P!==this.j&&(this.j=r.P,this.ar.nr()),this.Wt._r(this.ur.Ii(),r,s),this.Wt}}class J7 extends Zr{constructor(){super(...arguments),this.zt=null}J(e){this.zt=e}wr(e,n){var s;if(!(!((s=this.zt)===null||s===void 0)&&s.yt))return null;const{st:r,et:i,gr:o}=this.zt;return n>=r-i-7&&n<=r+i+7?{Mr:this.zt,gr:o}:null}K({context:e,bitmapSize:n,horizontalPixelRatio:s,verticalPixelRatio:r}){if(this.zt===null||this.zt.yt===!1)return;const i=Math.round(this.zt.st*r);i<0||i>n.height||(e.lineCap="butt",e.strokeStyle=this.zt.V,e.lineWidth=Math.floor(this.zt.et*s),ul(e,this.zt.Nt),TO(e,i,0,n.width))}}class FS{constructor(e){this.Sr={st:0,V:"rgba(0, 0, 0, 0)",et:1,Nt:0,yt:!1},this.kr=new J7,this.ft=!0,this.Es=e,this.Ns=e.$t(),this.kr.J(this.Sr)}bt(){this.ft=!0}gt(){return this.Es.yt()?(this.ft&&(this.yr(),this.ft=!1),this.kr):null}}class eY extends FS{constructor(e){super(e)}yr(){this.Sr.yt=!1;const e=this.Es.Dt(),n=e.Cr().Cr;if(n!==2&&n!==3)return;const s=this.Es.W();if(!s.baseLineVisible||!this.Es.yt())return;const r=this.Es.Ct();r!==null&&(this.Sr.yt=!0,this.Sr.st=e.Rt(r.Vt,r.Vt),this.Sr.V=s.baseLineColor,this.Sr.et=s.baseLineWidth,this.Sr.Nt=s.baseLineStyle)}}class tY extends Zr{constructor(){super(...arguments),this.zt=null}J(e){this.zt=e}$e(){return this.zt}K({context:e,horizontalPixelRatio:n,verticalPixelRatio:s}){const r=this.zt;if(r===null)return;const i=Math.max(1,Math.floor(n)),o=i%2/2,a=Math.round(r.Xe.x*n)+o,l=r.Xe.y*s;e.fillStyle=r.Tr,e.beginPath();const c=Math.max(2,1.5*r.Pr)*n;e.arc(a,l,c,0,2*Math.PI,!1),e.fill(),e.fillStyle=r.Rr,e.beginPath(),e.arc(a,l,r.ht*n,0,2*Math.PI,!1),e.fill(),e.lineWidth=i,e.strokeStyle=r.Dr,e.beginPath(),e.arc(a,l,r.ht*n+i/2,0,2*Math.PI,!1),e.stroke()}}const nY=[{Vr:0,Or:.25,Br:4,Ar:10,Ir:.25,zr:0,Lr:.4,Er:.8},{Vr:.25,Or:.525,Br:10,Ar:14,Ir:0,zr:0,Lr:.8,Er:0},{Vr:.525,Or:1,Br:14,Ar:14,Ir:0,zr:0,Lr:0,Er:0}];function u2(t,e,n,s){return function(r,i){if(r==="transparent")return r;const o=hd(r),a=o[3];return`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${i*a})`}(t,n+(s-n)*e)}function h2(t,e){const n=t%2600/2600;let s;for(const l of nY)if(n>=l.Vr&&n<=l.Or){s=l;break}ta(s!==void 0,"Last price animation internal logic error");const r=(n-s.Vr)/(s.Or-s.Vr);return{Rr:u2(e,r,s.Ir,s.zr),Dr:u2(e,r,s.Lr,s.Er),ht:(i=r,o=s.Br,a=s.Ar,o+(a-o)*i)};var i,o,a}class sY{constructor(e){this.Wt=new tY,this.ft=!0,this.Nr=!0,this.Fr=performance.now(),this.Wr=this.Fr-1,this.jr=e}Hr(){this.Wr=this.Fr-1,this.bt()}$r(){if(this.bt(),this.jr.W().lastPriceAnimation===2){const e=performance.now(),n=this.Wr-e;if(n>0)return void(n<650&&(this.Wr+=2600));this.Fr=e,this.Wr=e+2600}}bt(){this.ft=!0}Ur(){this.Nr=!0}yt(){return this.jr.W().lastPriceAnimation!==0}qr(){switch(this.jr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Wr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Nr=!1):this.Nr&&(this.Yr(),this.Nr=!1),this.Wt}Mt(){this.Wt.J(null);const e=this.jr.$t().St(),n=e.Xs(),s=this.jr.Ct();if(n===null||s===null)return;const r=this.jr.Zr(!0);if(r.Xr||!n.Kr(r.ee))return;const i={x:e.It(r.ee),y:this.jr.Dt().Rt(r._t,s.Vt)},o=r.V,a=this.jr.W().lineWidth,l=h2(this.Gr(),o);this.Wt.J({Tr:o,Pr:a,Rr:l.Rr,Dr:l.Dr,ht:l.ht,Xe:i})}Yr(){const e=this.Wt.$e();if(e!==null){const n=h2(this.Gr(),e.Tr);e.Rr=n.Rr,e.Dr=n.Dr,e.ht=n.ht}}Gr(){return this.qr()?performance.now()-this.Fr:2599}}function Lh(t,e){return _O(Math.min(Math.max(t,12),30)*e)}function md(t,e){switch(t){case"arrowDown":case"arrowUp":return Lh(e,1);case"circle":return Lh(e,.8);case"square":return Lh(e,.7)}}function BO(t){return function(e){const n=Math.ceil(e);return n%2!=0?n-1:n}(Lh(t,1))}function d2(t){return Math.max(Lh(t,.1),3)}function f2(t,e,n){return e?t:n?Math.ceil(t/2):0}function jO(t,e,n,s,r){const i=md("square",n),o=(i-1)/2,a=t-o,l=e-o;return s>=a&&s<=a+i&&r>=l&&r<=l+i}function p2(t,e,n,s){const r=(md("arrowUp",s)-1)/2*n.Jr,i=(_O(s/2)-1)/2*n.Jr;e.beginPath(),t?(e.moveTo(n.nt-r,n.st),e.lineTo(n.nt,n.st-r),e.lineTo(n.nt+r,n.st),e.lineTo(n.nt+i,n.st),e.lineTo(n.nt+i,n.st+r),e.lineTo(n.nt-i,n.st+r),e.lineTo(n.nt-i,n.st)):(e.moveTo(n.nt-r,n.st),e.lineTo(n.nt,n.st+r),e.lineTo(n.nt+r,n.st),e.lineTo(n.nt+i,n.st),e.lineTo(n.nt+i,n.st-r),e.lineTo(n.nt-i,n.st-r),e.lineTo(n.nt-i,n.st)),e.fill()}function rY(t,e,n,s,r,i){return jO(e,n,s,r,i)}class iY extends Zr{constructor(){super(...arguments),this.zt=null,this.ar=new pd,this.j=-1,this.H="",this.Qr=""}J(e){this.zt=e}_r(e,n){this.j===e&&this.H===n||(this.j=e,this.H=n,this.Qr=Zc(e,n),this.ar.nr())}wr(e,n){if(this.zt===null||this.zt.tt===null)return null;for(let s=this.zt.tt.from;s<this.zt.tt.to;s++){const r=this.zt.it[s];if(aY(r,e,n))return{Mr:r.th,gr:r.gr}}return null}K({context:e,horizontalPixelRatio:n,verticalPixelRatio:s},r,i){if(this.zt!==null&&this.zt.tt!==null){e.textBaseline="middle",e.font=this.Qr;for(let o=this.zt.tt.from;o<this.zt.tt.to;o++){const a=this.zt.it[o];a.Kt!==void 0&&(a.Kt.Hi=this.ar.xi(e,a.Kt.ih),a.Kt.At=this.j,a.Kt.nt=a.nt-a.Kt.Hi/2),oY(a,e,n,s)}}}}function oY(t,e,n,s){e.fillStyle=t.V,t.Kt!==void 0&&function(r,i,o,a,l,c){r.save(),r.scale(l,c),r.fillText(i,o,a),r.restore()}(e,t.Kt.ih,t.Kt.nt,t.Kt.st,n,s),function(r,i,o){if(r.Ks!==0){switch(r.nh){case"arrowDown":return void p2(!1,i,o,r.Ks);case"arrowUp":return void p2(!0,i,o,r.Ks);case"circle":return void function(a,l,c){const u=(md("circle",c)-1)/2;a.beginPath(),a.arc(l.nt,l.st,u*l.Jr,0,2*Math.PI,!1),a.fill()}(i,o,r.Ks);case"square":return void function(a,l,c){const u=md("square",c),h=(u-1)*l.Jr/2,d=l.nt-h,f=l.st-h;a.fillRect(d,f,u*l.Jr,u*l.Jr)}(i,o,r.Ks)}r.nh}}(t,e,function(r,i,o){const a=Math.max(1,Math.floor(i))%2/2;return{nt:Math.round(r.nt*i)+a,st:r.st*o,Jr:i}}(t,n,s))}function aY(t,e,n){return!(t.Kt===void 0||!function(s,r,i,o,a,l){const c=o/2;return a>=s&&a<=s+i&&l>=r-c&&l<=r+c}(t.Kt.nt,t.Kt.st,t.Kt.Hi,t.Kt.At,e,n))||function(s,r,i){if(s.Ks===0)return!1;switch(s.nh){case"arrowDown":case"arrowUp":return rY(0,s.nt,s.st,s.Ks,r,i);case"circle":return function(o,a,l,c,u){const h=2+md("circle",l)/2,d=o-c,f=a-u;return Math.sqrt(d*d+f*f)<=h}(s.nt,s.st,s.Ks,r,i);case"square":return jO(s.nt,s.st,s.Ks,r,i)}}(t,e,n)}function lY(t,e,n,s,r,i,o,a,l){const c=pi(n)?n:n.Se,u=pi(n)?n:n.Me,h=pi(n)?n:n.xe,d=pi(e.size)?Math.max(e.size,0):1,f=BO(a.le())*d,p=f/2;switch(t.Ks=f,e.position){case"inBar":return t.st=o.Rt(c,l),void(t.Kt!==void 0&&(t.Kt.st=t.st+p+i+.6*r));case"aboveBar":return t.st=o.Rt(u,l)-p-s.sh,t.Kt!==void 0&&(t.Kt.st=t.st-p-.6*r,s.sh+=1.2*r),void(s.sh+=f+i);case"belowBar":return t.st=o.Rt(h,l)+p+s.eh,t.Kt!==void 0&&(t.Kt.st=t.st+p+i+.6*r,s.eh+=1.2*r),void(s.eh+=f+i)}e.position}class cY{constructor(e,n){this.ft=!0,this.rh=!0,this.hh=!0,this.ah=null,this.oh=null,this.Wt=new iY,this.jr=e,this.$i=n,this.zt={it:[],tt:null}}bt(e){this.ft=!0,this.hh=!0,e==="data"&&(this.rh=!0,this.oh=null)}gt(e){if(!this.jr.yt())return null;this.ft&&this._h();const n=this.$i.W().layout;return this.Wt._r(n.fontSize,n.fontFamily),this.Wt.J(this.zt),this.Wt}uh(){if(this.hh){if(this.jr.dh().length>0){const e=this.$i.St().le(),n=d2(e),s=1.5*BO(e)+2*n,r=this.fh();this.ah={above:f2(s,r.aboveBar,r.inBar),below:f2(s,r.belowBar,r.inBar)}}else this.ah=null;this.hh=!1}return this.ah}fh(){return this.oh===null&&(this.oh=this.jr.dh().reduce((e,n)=>(e[n.position]||(e[n.position]=!0),e),{inBar:!1,aboveBar:!1,belowBar:!1})),this.oh}_h(){const e=this.jr.Dt(),n=this.$i.St(),s=this.jr.dh();this.rh&&(this.zt.it=s.map(u=>({ot:u.time,nt:0,st:0,Ks:0,nh:u.shape,V:u.color,th:u.th,gr:u.id,Kt:void 0})),this.rh=!1);const r=this.$i.W().layout;this.zt.tt=null;const i=n.Xs();if(i===null)return;const o=this.jr.Ct();if(o===null||this.zt.it.length===0)return;let a=NaN;const l=d2(n.le()),c={sh:l,eh:l};this.zt.tt=LO(this.zt.it,i,!0);for(let u=this.zt.tt.from;u<this.zt.tt.to;u++){const h=s[u];h.time!==a&&(c.sh=l,c.eh=l,a=h.time);const d=this.zt.it[u];d.nt=n.It(h.time),h.text!==void 0&&h.text.length>0&&(d.Kt={ih:h.text,nt:0,st:0,Hi:0,At:0});const f=this.jr.ph(h.time);f!==null&&lY(d,h,f,c,r.fontSize,l,e,n,o.Vt)}this.ft=!1}}class uY extends FS{constructor(e){super(e)}yr(){const e=this.Sr;e.yt=!1;const n=this.Es.W();if(!n.priceLineVisible||!this.Es.yt())return;const s=this.Es.Zr(n.priceLineSource===0);s.Xr||(e.yt=!0,e.st=s.ki,e.V=this.Es.mh(s.V),e.et=n.priceLineWidth,e.Nt=n.priceLineStyle)}}class hY extends Bx{constructor(e){super(),this.jt=e}zi(e,n,s){e.yt=!1,n.yt=!1;const r=this.jt;if(!r.yt())return;const i=r.W(),o=i.lastValueVisible,a=r.bh()!=="",l=i.seriesLastValueMode===0,c=r.Zr(!1);if(c.Xr)return;o&&(e.Kt=this.wh(c,o,l),e.yt=e.Kt.length!==0),(a||l)&&(n.Kt=this.gh(c,o,a,l),n.yt=n.Kt.length>0);const u=r.mh(c.V),h=zx(u);s.t=h.t,s.ki=c.ki,n.Ot=r.$t().Bt(c.ki/r.Dt().At()),e.Ot=u,e.V=h.i,n.V=h.i}gh(e,n,s,r){let i="";const o=this.jt.bh();return s&&o.length!==0&&(i+=`${o} `),n&&r&&(i+=this.jt.Dt().Mh()?e.xh:e.Sh),i.trim()}wh(e,n,s){return n?s?this.jt.Dt().Mh()?e.Sh:e.xh:e.Kt:""}}function m2(t,e,n,s){const r=Number.isFinite(e),i=Number.isFinite(n);return r&&i?t(e,n):r||i?r?e:n:s}class Ns{constructor(e,n){this.kh=e,this.yh=n}Ch(e){return e!==null&&this.kh===e.kh&&this.yh===e.yh}Th(){return new Ns(this.kh,this.yh)}Ph(){return this.kh}Rh(){return this.yh}Dh(){return this.yh-this.kh}Ni(){return this.yh===this.kh||Number.isNaN(this.yh)||Number.isNaN(this.kh)}ts(e){return e===null?this:new Ns(m2(Math.min,this.Ph(),e.Ph(),-1/0),m2(Math.max,this.Rh(),e.Rh(),1/0))}Vh(e){if(!pi(e)||this.yh-this.kh===0)return;const n=.5*(this.yh+this.kh);let s=this.yh-n,r=this.kh-n;s*=e,r*=e,this.yh=n+s,this.kh=n+r}Oh(e){pi(e)&&(this.yh+=e,this.kh+=e)}Bh(){return{minValue:this.kh,maxValue:this.yh}}static Ah(e){return e===null?null:new Ns(e.minValue,e.maxValue)}}class Ng{constructor(e,n){this.Ih=e,this.zh=n||null}Lh(){return this.Ih}Eh(){return this.zh}Bh(){return this.Ih===null?null:{priceRange:this.Ih.Bh(),margins:this.zh||void 0}}static Ah(e){return e===null?null:new Ng(Ns.Ah(e.priceRange),e.margins)}}class dY extends FS{constructor(e,n){super(e),this.Nh=n}yr(){const e=this.Sr;e.yt=!1;const n=this.Nh.W();if(!this.Es.yt()||!n.lineVisible)return;const s=this.Nh.Fh();s!==null&&(e.yt=!0,e.st=s,e.V=n.color,e.et=n.lineWidth,e.Nt=n.lineStyle,e.gr=this.Nh.W().id)}}class fY extends Bx{constructor(e,n){super(),this.jr=e,this.Nh=n}zi(e,n,s){e.yt=!1,n.yt=!1;const r=this.Nh.W(),i=r.axisLabelVisible,o=r.title!=="",a=this.jr;if(!i||!a.yt())return;const l=this.Nh.Fh();if(l===null)return;o&&(n.Kt=r.title,n.yt=!0),n.Ot=a.$t().Bt(l/a.Dt().At()),e.Kt=this.Wh(r.price),e.yt=!0;const c=zx(r.axisLabelColor||r.color);s.t=c.t;const u=r.axisLabelTextColor||c.i;e.V=u,n.V=u,s.ki=l}Wh(e){const n=this.jr.Ct();return n===null?"":this.jr.Dt().Fi(e,n.Vt)}}class pY{constructor(e,n){this.jr=e,this.cn=n,this.jh=new dY(e,this),this.ur=new fY(e,this),this.Hh=new VO(this.ur,e,e.$t())}$h(e){Hr(this.cn,e),this.bt(),this.jr.$t().Uh()}W(){return this.cn}qh(){return this.jh}Yh(){return this.Hh}Zh(){return this.ur}bt(){this.jh.bt(),this.ur.bt()}Fh(){const e=this.jr,n=e.Dt();if(e.$t().St().Ni()||n.Ni())return null;const s=e.Ct();return s===null?null:n.Rt(this.cn.price,s.Vt)}}class mY extends DS{constructor(e){super(),this.$i=e}$t(){return this.$i}}const gY={Bar:(t,e,n,s)=>{var r;const i=e.upColor,o=e.downColor,a=he(t(n,s)),l=kc(a.Vt[0])<=kc(a.Vt[3]);return{ce:(r=a.V)!==null&&r!==void 0?r:l?i:o}},Candlestick:(t,e,n,s)=>{var r,i,o;const a=e.upColor,l=e.downColor,c=e.borderUpColor,u=e.borderDownColor,h=e.wickUpColor,d=e.wickDownColor,f=he(t(n,s)),p=kc(f.Vt[0])<=kc(f.Vt[3]);return{ce:(r=f.V)!==null&&r!==void 0?r:p?a:l,Ne:(i=f.Ot)!==null&&i!==void 0?i:p?c:u,Ee:(o=f.Xh)!==null&&o!==void 0?o:p?h:d}},Custom:(t,e,n,s)=>{var r;return{ce:(r=he(t(n,s)).V)!==null&&r!==void 0?r:e.color}},Area:(t,e,n,s)=>{var r,i,o,a;const l=he(t(n,s));return{ce:(r=l.lt)!==null&&r!==void 0?r:e.lineColor,lt:(i=l.lt)!==null&&i!==void 0?i:e.lineColor,Ps:(o=l.Ps)!==null&&o!==void 0?o:e.topColor,Rs:(a=l.Rs)!==null&&a!==void 0?a:e.bottomColor}},Baseline:(t,e,n,s)=>{var r,i,o,a,l,c;const u=he(t(n,s));return{ce:u.Vt[3]>=e.baseValue.price?e.topLineColor:e.bottomLineColor,Re:(r=u.Re)!==null&&r!==void 0?r:e.topLineColor,De:(i=u.De)!==null&&i!==void 0?i:e.bottomLineColor,ke:(o=u.ke)!==null&&o!==void 0?o:e.topFillColor1,ye:(a=u.ye)!==null&&a!==void 0?a:e.topFillColor2,Ce:(l=u.Ce)!==null&&l!==void 0?l:e.bottomFillColor1,Te:(c=u.Te)!==null&&c!==void 0?c:e.bottomFillColor2}},Line:(t,e,n,s)=>{var r,i;const o=he(t(n,s));return{ce:(r=o.V)!==null&&r!==void 0?r:e.color,lt:(i=o.V)!==null&&i!==void 0?i:e.color}},Histogram:(t,e,n,s)=>{var r;return{ce:(r=he(t(n,s)).V)!==null&&r!==void 0?r:e.color}}};class xY{constructor(e){this.Kh=(n,s)=>s!==void 0?s.Vt:this.jr.In().Gh(n),this.jr=e,this.Jh=gY[e.Qh()]}$s(e,n){return this.Jh(this.Kh,this.jr.W(),e,n)}}var g2;(function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.None=0]="None",t[t.NearestRight=1]="NearestRight"})(g2||(g2={}));const vo=30;class vY{constructor(){this.tl=[],this.il=new Map,this.nl=new Map}sl(){return this.Ks()>0?this.tl[this.tl.length-1]:null}el(){return this.Ks()>0?this.rl(0):null}An(){return this.Ks()>0?this.rl(this.tl.length-1):null}Ks(){return this.tl.length}Ni(){return this.Ks()===0}Kr(e){return this.hl(e,0)!==null}Gh(e){return this.ll(e)}ll(e,n=0){const s=this.hl(e,n);return s===null?null:Object.assign(Object.assign({},this.al(s)),{ee:this.rl(s)})}ne(){return this.tl}ol(e,n,s){if(this.Ni())return null;let r=null;for(const i of s)r=jp(r,this._l(e,n,i));return r}J(e){this.nl.clear(),this.il.clear(),this.tl=e}rl(e){return this.tl[e].ee}al(e){return this.tl[e]}hl(e,n){const s=this.ul(e);if(s===null&&n!==0)switch(n){case-1:return this.cl(e);case 1:return this.dl(e);default:throw new TypeError("Unknown search mode")}return s}cl(e){let n=this.fl(e);return n>0&&(n-=1),n!==this.tl.length&&this.rl(n)<e?n:null}dl(e){const n=this.vl(e);return n!==this.tl.length&&e<this.rl(n)?n:null}ul(e){const n=this.fl(e);return n===this.tl.length||e<this.tl[n].ee?null:n}fl(e){return Wd(this.tl,e,(n,s)=>n.ee<s)}vl(e){return MO(this.tl,e,(n,s)=>n.ee>s)}pl(e,n,s){let r=null;for(let i=e;i<n;i++){const o=this.tl[i].Vt[s];Number.isNaN(o)||(r===null?r={ml:o,bl:o}:(o<r.ml&&(r.ml=o),o>r.bl&&(r.bl=o)))}return r}_l(e,n,s){if(this.Ni())return null;let r=null;const i=he(this.el()),o=he(this.An()),a=Math.max(e,i),l=Math.min(n,o),c=Math.ceil(a/vo)*vo,u=Math.max(c,Math.floor(l/vo)*vo);{const d=this.fl(a),f=this.vl(Math.min(l,c,n));r=jp(r,this.pl(d,f,s))}let h=this.il.get(s);h===void 0&&(h=new Map,this.il.set(s,h));for(let d=Math.max(c+1,a);d<u;d+=vo){const f=Math.floor(d/vo);let p=h.get(f);if(p===void 0){const m=this.fl(f*vo),v=this.vl((f+1)*vo-1);p=this.pl(m,v,s),h.set(f,p)}r=jp(r,p)}{const d=this.fl(u),f=this.vl(l);r=jp(r,this.pl(d,f,s))}return r}}function jp(t,e){return t===null?e:e===null?t:{ml:Math.min(t.ml,e.ml),bl:Math.max(t.bl,e.bl)}}class yY{constructor(e){this.wl=e}X(e,n,s){this.wl.draw(e)}gl(e,n,s){var r,i;(i=(r=this.wl).drawBackground)===null||i===void 0||i.call(r,e)}}class Fy{constructor(e){this.tr=null,this.wn=e}gt(){var e;const n=this.wn.renderer();if(n===null)return null;if(((e=this.tr)===null||e===void 0?void 0:e.Ml)===n)return this.tr.xl;const s=new yY(n);return this.tr={Ml:n,xl:s},s}Sl(){var e,n,s;return(s=(n=(e=this.wn).zOrder)===null||n===void 0?void 0:n.call(e))!==null&&s!==void 0?s:"normal"}}function WO(t){var e,n,s,r,i;return{Kt:t.text(),ki:t.coordinate(),Si:(e=t.fixedCoordinate)===null||e===void 0?void 0:e.call(t),V:t.textColor(),t:t.backColor(),yt:(s=(n=t.visible)===null||n===void 0?void 0:n.call(t))===null||s===void 0||s,hi:(i=(r=t.tickVisible)===null||r===void 0?void 0:r.call(t))===null||i===void 0||i}}class bY{constructor(e,n){this.Wt=new EO,this.kl=e,this.yl=n}gt(){return this.Wt.J(Object.assign({Hi:this.yl.Hi()},WO(this.kl))),this.Wt}}class wY extends Bx{constructor(e,n){super(),this.kl=e,this.Li=n}zi(e,n,s){const r=WO(this.kl);s.t=r.t,e.V=r.V;const i=2/12*this.Li.P();s.wi=i,s.gi=i,s.ki=r.ki,s.Si=r.Si,e.Kt=r.Kt,e.yt=r.yt,e.hi=r.hi}}class CY{constructor(e,n){this.Cl=null,this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=null,this.Vl=e,this.jr=n}Ol(){return this.Vl}Vn(){var e,n;(n=(e=this.Vl).updateAllViews)===null||n===void 0||n.call(e)}Pn(){var e,n,s,r;const i=(s=(n=(e=this.Vl).paneViews)===null||n===void 0?void 0:n.call(e))!==null&&s!==void 0?s:[];if(((r=this.Cl)===null||r===void 0?void 0:r.Ml)===i)return this.Cl.xl;const o=i.map(a=>new Fy(a));return this.Cl={Ml:i,xl:o},o}Qi(){var e,n,s,r;const i=(s=(n=(e=this.Vl).timeAxisViews)===null||n===void 0?void 0:n.call(e))!==null&&s!==void 0?s:[];if(((r=this.Tl)===null||r===void 0?void 0:r.Ml)===i)return this.Tl.xl;const o=this.jr.$t().St(),a=i.map(l=>new bY(l,o));return this.Tl={Ml:i,xl:a},a}Rn(){var e,n,s,r;const i=(s=(n=(e=this.Vl).priceAxisViews)===null||n===void 0?void 0:n.call(e))!==null&&s!==void 0?s:[];if(((r=this.Pl)===null||r===void 0?void 0:r.Ml)===i)return this.Pl.xl;const o=this.jr.Dt(),a=i.map(l=>new wY(l,o));return this.Pl={Ml:i,xl:a},a}Bl(){var e,n,s,r;const i=(s=(n=(e=this.Vl).priceAxisPaneViews)===null||n===void 0?void 0:n.call(e))!==null&&s!==void 0?s:[];if(((r=this.Rl)===null||r===void 0?void 0:r.Ml)===i)return this.Rl.xl;const o=i.map(a=>new Fy(a));return this.Rl={Ml:i,xl:o},o}Al(){var e,n,s,r;const i=(s=(n=(e=this.Vl).timeAxisPaneViews)===null||n===void 0?void 0:n.call(e))!==null&&s!==void 0?s:[];if(((r=this.Dl)===null||r===void 0?void 0:r.Ml)===i)return this.Dl.xl;const o=i.map(a=>new Fy(a));return this.Dl={Ml:i,xl:o},o}Il(e,n){var s,r,i;return(i=(r=(s=this.Vl).autoscaleInfo)===null||r===void 0?void 0:r.call(s,e,n))!==null&&i!==void 0?i:null}wr(e,n){var s,r,i;return(i=(r=(s=this.Vl).hitTest)===null||r===void 0?void 0:r.call(s,e,n))!==null&&i!==void 0?i:null}}function Oy(t,e,n,s){t.forEach(r=>{e(r).forEach(i=>{i.Sl()===n&&s.push(i)})})}function My(t){return t.Pn()}function SY(t){return t.Bl()}function kY(t){return t.Al()}class OS extends mY{constructor(e,n,s,r,i){super(e),this.zt=new vY,this.jh=new uY(this),this.zl=[],this.Ll=new eY(this),this.El=null,this.Nl=null,this.Fl=[],this.Wl=[],this.jl=null,this.Hl=[],this.cn=n,this.$l=s;const o=new hY(this);this.rn=[o],this.Hh=new VO(o,this,e),s!=="Area"&&s!=="Line"&&s!=="Baseline"||(this.El=new sY(this)),this.Ul(),this.ql(i)}S(){this.jl!==null&&clearTimeout(this.jl)}mh(e){return this.cn.priceLineColor||e}Zr(e){const n={Xr:!0},s=this.Dt();if(this.$t().St().Ni()||s.Ni()||this.zt.Ni())return n;const r=this.$t().St().Xs(),i=this.Ct();if(r===null||i===null)return n;let o,a;if(e){const h=this.zt.sl();if(h===null)return n;o=h,a=h.ee}else{const h=this.zt.ll(r.ui(),-1);if(h===null||(o=this.zt.Gh(h.ee),o===null))return n;a=h.ee}const l=o.Vt[3],c=this.Us().$s(a,{Vt:o}),u=s.Rt(l,i.Vt);return{Xr:!1,_t:l,Kt:s.Fi(l,i.Vt),xh:s.Yl(l),Sh:s.Zl(l,i.Vt),V:c.ce,ki:u,ee:a}}Us(){return this.Nl!==null||(this.Nl=new xY(this)),this.Nl}W(){return this.cn}$h(e){const n=e.priceScaleId;n!==void 0&&n!==this.cn.priceScaleId&&this.$t().Xl(this,n),Hr(this.cn,e),e.priceFormat!==void 0&&(this.Ul(),this.$t().Kl()),this.$t().Gl(this),this.$t().Jl(),this.wn.bt("options")}J(e,n){this.zt.J(e),this.Ql(),this.wn.bt("data"),this.dn.bt("data"),this.El!==null&&(n&&n.ta?this.El.$r():e.length===0&&this.El.Hr());const s=this.$t().dr(this);this.$t().ia(s),this.$t().Gl(this),this.$t().Jl(),this.$t().Uh()}na(e){this.Fl=e,this.Ql();const n=this.$t().dr(this);this.dn.bt("data"),this.$t().ia(n),this.$t().Gl(this),this.$t().Jl(),this.$t().Uh()}sa(){return this.Fl}dh(){return this.Wl}ea(e){const n=new pY(this,e);return this.zl.push(n),this.$t().Gl(this),n}ra(e){const n=this.zl.indexOf(e);n!==-1&&this.zl.splice(n,1),this.$t().Gl(this)}Qh(){return this.$l}Ct(){const e=this.ha();return e===null?null:{Vt:e.Vt[3],la:e.ot}}ha(){const e=this.$t().St().Xs();if(e===null)return null;const n=e.Os();return this.zt.ll(n,1)}In(){return this.zt}ph(e){const n=this.zt.Gh(e);return n===null?null:this.$l==="Bar"||this.$l==="Candlestick"||this.$l==="Custom"?{ge:n.Vt[0],Me:n.Vt[1],xe:n.Vt[2],Se:n.Vt[3]}:n.Vt[3]}aa(e){const n=[];Oy(this.Hl,My,"top",n);const s=this.El;return s!==null&&s.yt()&&(this.jl===null&&s.qr()&&(this.jl=setTimeout(()=>{this.jl=null,this.$t().oa()},0)),s.Ur(),n.unshift(s)),n}Pn(){const e=[];this._a()||e.push(this.Ll),e.push(this.wn,this.jh,this.dn);const n=this.zl.map(s=>s.qh());return e.push(...n),Oy(this.Hl,My,"normal",e),e}ua(){return this.ca(My,"bottom")}da(e){return this.ca(SY,e)}fa(e){return this.ca(kY,e)}va(e,n){return this.Hl.map(s=>s.wr(e,n)).filter(s=>s!==null)}Ji(e){return[this.Hh,...this.zl.map(n=>n.Yh())]}Rn(e,n){if(n!==this.Yi&&!this._a())return[];const s=[...this.rn];for(const r of this.zl)s.push(r.Zh());return this.Hl.forEach(r=>{s.push(...r.Rn())}),s}Qi(){const e=[];return this.Hl.forEach(n=>{e.push(...n.Qi())}),e}Il(e,n){if(this.cn.autoscaleInfoProvider!==void 0){const s=this.cn.autoscaleInfoProvider(()=>{const r=this.pa(e,n);return r===null?null:r.Bh()});return Ng.Ah(s)}return this.pa(e,n)}ma(){return this.cn.priceFormat.minMove}ba(){return this.wa}Vn(){var e;this.wn.bt(),this.dn.bt();for(const n of this.rn)n.bt();for(const n of this.zl)n.bt();this.jh.bt(),this.Ll.bt(),(e=this.El)===null||e===void 0||e.bt(),this.Hl.forEach(n=>n.Vn())}Dt(){return he(super.Dt())}kt(e){if(!((this.$l==="Line"||this.$l==="Area"||this.$l==="Baseline")&&this.cn.crosshairMarkerVisible))return null;const n=this.zt.Gh(e);return n===null?null:{_t:n.Vt[3],ht:this.ga(),Ot:this.Ma(),Pt:this.xa(),Tt:this.Sa(e)}}bh(){return this.cn.title}yt(){return this.cn.visible}ka(e){this.Hl.push(new CY(e,this))}ya(e){this.Hl=this.Hl.filter(n=>n.Ol()!==e)}Ca(){if(this.wn instanceof Py)return e=>this.wn.We(e)}Ta(){if(this.wn instanceof Py)return e=>this.wn.je(e)}_a(){return!jx(this.Dt().Pa())}pa(e,n){if(!dd(e)||!dd(n)||this.zt.Ni())return null;const s=this.$l==="Line"||this.$l==="Area"||this.$l==="Baseline"||this.$l==="Histogram"?[3]:[2,1],r=this.zt.ol(e,n,s);let i=r!==null?new Ns(r.ml,r.bl):null;if(this.Qh()==="Histogram"){const a=this.cn.base,l=new Ns(a,a);i=i!==null?i.ts(l):l}let o=this.dn.uh();return this.Hl.forEach(a=>{const l=a.Il(e,n);if(l!=null&&l.priceRange){const f=new Ns(l.priceRange.minValue,l.priceRange.maxValue);i=i!==null?i.ts(f):f}var c,u,h,d;l!=null&&l.margins&&(c=o,u=l.margins,o={above:Math.max((h=c==null?void 0:c.above)!==null&&h!==void 0?h:0,u.above),below:Math.max((d=c==null?void 0:c.below)!==null&&d!==void 0?d:0,u.below)})}),new Ng(i,o)}ga(){switch(this.$l){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}Ma(){switch(this.$l){case"Line":case"Area":case"Baseline":{const e=this.cn.crosshairMarkerBorderColor;if(e.length!==0)return e}}return null}xa(){switch(this.$l){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}Sa(e){switch(this.$l){case"Line":case"Area":case"Baseline":{const n=this.cn.crosshairMarkerBackgroundColor;if(n.length!==0)return n}}return this.Us().$s(e).ce}Ul(){switch(this.cn.priceFormat.type){case"custom":this.wa={format:this.cn.priceFormat.formatter};break;case"volume":this.wa=new A7(this.cn.priceFormat.precision);break;case"percent":this.wa=new RO(this.cn.priceFormat.precision);break;default:{const e=Math.pow(10,this.cn.priceFormat.precision);this.wa=new Wx(e,this.cn.priceFormat.minMove*e)}}this.Yi!==null&&this.Yi.Ra()}Ql(){const e=this.$t().St();if(!e.Da()||this.zt.Ni())return void(this.Wl=[]);const n=he(this.zt.el());this.Wl=this.Fl.map((s,r)=>{const i=he(e.Va(s.time,!0)),o=i<n?1:-1;return{time:he(this.zt.ll(i,o)).ee,position:s.position,shape:s.shape,color:s.color,id:s.id,th:r,text:s.text,size:s.size,originalTime:s.originalTime}})}ql(e){switch(this.dn=new cY(this,this.$t()),this.$l){case"Bar":this.wn=new V7(this,this.$t());break;case"Candlestick":this.wn=new G7(this,this.$t());break;case"Line":this.wn=new Y7(this,this.$t());break;case"Custom":this.wn=new Py(this,this.$t(),hs(e));break;case"Area":this.wn=new L7(this,this.$t());break;case"Baseline":this.wn=new W7(this,this.$t());break;case"Histogram":this.wn=new q7(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.$l)}}ca(e,n){const s=[];return Oy(this.Hl,e,n,s),s}}class TY{constructor(e){this.cn=e}Oa(e,n,s){let r=e;if(this.cn.mode===0)return r;const i=s.vn(),o=i.Ct();if(o===null)return r;const a=i.Rt(e,o),l=s.Ba().filter(u=>u instanceof OS).reduce((u,h)=>{if(s.vr(h)||!h.yt())return u;const d=h.Dt(),f=h.In();if(d.Ni()||!f.Kr(n))return u;const p=f.Gh(n);if(p===null)return u;const m=kc(h.Ct());return u.concat([d.Rt(p.Vt[3],m.Vt)])},[]);if(l.length===0)return r;l.sort((u,h)=>Math.abs(u-a)-Math.abs(h-a));const c=l[0];return r=i.pn(c,o),r}}class IY extends Zr{constructor(){super(...arguments),this.zt=null}J(e){this.zt=e}K({context:e,bitmapSize:n,horizontalPixelRatio:s,verticalPixelRatio:r}){if(this.zt===null)return;const i=Math.max(1,Math.floor(s));e.lineWidth=i,function(o,a){o.save(),o.lineWidth%2&&o.translate(.5,.5),a(),o.restore()}(e,()=>{const o=he(this.zt);if(o.Aa){e.strokeStyle=o.Ia,ul(e,o.za),e.beginPath();for(const a of o.La){const l=Math.round(a.Ea*s);e.moveTo(l,-i),e.lineTo(l,n.height+i)}e.stroke()}if(o.Na){e.strokeStyle=o.Fa,ul(e,o.Wa),e.beginPath();for(const a of o.ja){const l=Math.round(a.Ea*r);e.moveTo(-i,l),e.lineTo(n.width+i,l)}e.stroke()}})}}class $Y{constructor(e){this.Wt=new IY,this.ft=!0,this.tn=e}bt(){this.ft=!0}gt(){if(this.ft){const e=this.tn.$t().W().grid,n={Na:e.horzLines.visible,Aa:e.vertLines.visible,Fa:e.horzLines.color,Ia:e.vertLines.color,Wa:e.horzLines.style,za:e.vertLines.style,ja:this.tn.vn().Ha(),La:(this.tn.$t().St().Ha()||[]).map(s=>({Ea:s.coord}))};this.Wt.J(n),this.ft=!1}return this.Wt}}let NY=class{constructor(e){this.wn=new $Y(e)}qh(){return this.wn}};const Ly={$a:4,Ua:1e-4};function Tc(t,e){const n=100*(t-e)/e;return e<0?-n:n}function EY(t,e){const n=Tc(t.Ph(),e),s=Tc(t.Rh(),e);return new Ns(n,s)}function zh(t,e){const n=100*(t-e)/e+100;return e<0?-n:n}function RY(t,e){const n=zh(t.Ph(),e),s=zh(t.Rh(),e);return new Ns(n,s)}function Eg(t,e){const n=Math.abs(t);if(n<1e-15)return 0;const s=Math.log10(n+e.Ua)+e.$a;return t<0?-s:s}function Vh(t,e){const n=Math.abs(t);if(n<1e-15)return 0;const s=Math.pow(10,n-e.$a)-e.Ua;return t<0?-s:s}function th(t,e){if(t===null)return null;const n=Eg(t.Ph(),e),s=Eg(t.Rh(),e);return new Ns(n,s)}function Wp(t,e){if(t===null)return null;const n=Vh(t.Ph(),e),s=Vh(t.Rh(),e);return new Ns(n,s)}function zy(t){if(t===null)return Ly;const e=Math.abs(t.Rh()-t.Ph());if(e>=1||e<1e-15)return Ly;const n=Math.ceil(Math.abs(Math.log10(e))),s=Ly.$a+n;return{$a:s,Ua:1/Math.pow(10,s)}}class Vy{constructor(e,n){if(this.qa=e,this.Ya=n,function(s){if(s<0)return!1;for(let r=s;r>1;r/=10)if(r%10!=0)return!1;return!0}(this.qa))this.Za=[2,2.5,2];else{this.Za=[];for(let s=this.qa;s!==1;){if(s%2==0)this.Za.push(2),s/=2;else{if(s%5!=0)throw new Error("unexpected base");this.Za.push(2,2.5),s/=5}if(this.Za.length>100)throw new Error("something wrong with base")}}}Xa(e,n,s){const r=this.qa===0?0:1/this.qa;let i=Math.pow(10,Math.max(0,Math.ceil(Math.log10(e-n)))),o=0,a=this.Ya[0];for(;;){const h=Bp(i,r,1e-14)&&i>r+1e-14,d=Bp(i,s*a,1e-14),f=Bp(i,1,1e-14);if(!(h&&d&&f))break;i/=a,a=this.Ya[++o%this.Ya.length]}if(i<=r+1e-14&&(i=r),i=Math.max(1,i),this.Za.length>0&&(l=i,c=1,u=1e-14,Math.abs(l-c)<u))for(o=0,a=this.Za[0];Bp(i,s*a,1e-14)&&i>r+1e-14;)i/=a,a=this.Za[++o%this.Za.length];var l,c,u;return i}}class x2{constructor(e,n,s,r){this.Ka=[],this.Li=e,this.qa=n,this.Ga=s,this.Ja=r}Xa(e,n){if(e<n)throw new Error("high < low");const s=this.Li.At(),r=(e-n)*this.Qa()/s,i=new Vy(this.qa,[2,2.5,2]),o=new Vy(this.qa,[2,2,2.5]),a=new Vy(this.qa,[2.5,2,2]),l=[];return l.push(i.Xa(e,n,r),o.Xa(e,n,r),a.Xa(e,n,r)),function(c){if(c.length<1)throw Error("array is empty");let u=c[0];for(let h=1;h<c.length;++h)c[h]<u&&(u=c[h]);return u}(l)}io(){const e=this.Li,n=e.Ct();if(n===null)return void(this.Ka=[]);const s=e.At(),r=this.Ga(s-1,n),i=this.Ga(0,n),o=this.Li.W().entireTextOnly?this.no()/2:0,a=o,l=s-1-o,c=Math.max(r,i),u=Math.min(r,i);if(c===u)return void(this.Ka=[]);let h=this.Xa(c,u),d=c%h;d+=d<0?h:0;const f=c>=u?1:-1;let p=null,m=0;for(let v=c-d;v>u;v-=h){const x=this.Ja(v,n,!0);p!==null&&Math.abs(x-p)<this.Qa()||x<a||x>l||(m<this.Ka.length?(this.Ka[m].Ea=x,this.Ka[m].so=e.eo(v)):this.Ka.push({Ea:x,so:e.eo(v)}),m++,p=x,e.ro()&&(h=this.Xa(v*f,u)))}this.Ka.length=m}Ha(){return this.Ka}no(){return this.Li.P()}Qa(){return Math.ceil(2.5*this.no())}}function UO(t){return t.slice().sort((e,n)=>he(e.Xi())-he(n.Xi()))}var v2;(function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"})(v2||(v2={}));const y2=new RO,b2=new Wx(100,1);class AY{constructor(e,n,s,r){this.ho=0,this.lo=null,this.Ih=null,this.ao=null,this.oo={_o:!1,uo:null},this.co=0,this.do=0,this.fo=new tn,this.vo=new tn,this.po=[],this.mo=null,this.bo=null,this.wo=null,this.Mo=null,this.wa=b2,this.xo=zy(null),this.So=e,this.cn=n,this.ko=s,this.yo=r,this.Co=new x2(this,100,this.To.bind(this),this.Po.bind(this))}Pa(){return this.So}W(){return this.cn}$h(e){if(Hr(this.cn,e),this.Ra(),e.mode!==void 0&&this.Ro({Cr:e.mode}),e.scaleMargins!==void 0){const n=hs(e.scaleMargins.top),s=hs(e.scaleMargins.bottom);if(n<0||n>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${n}`);if(s<0||s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(n+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${n+s}`);this.Do(),this.bo=null}}Vo(){return this.cn.autoScale}ro(){return this.cn.mode===1}Mh(){return this.cn.mode===2}Oo(){return this.cn.mode===3}Cr(){return{Wn:this.cn.autoScale,Bo:this.cn.invertScale,Cr:this.cn.mode}}Ro(e){const n=this.Cr();let s=null;e.Wn!==void 0&&(this.cn.autoScale=e.Wn),e.Cr!==void 0&&(this.cn.mode=e.Cr,e.Cr!==2&&e.Cr!==3||(this.cn.autoScale=!0),this.oo._o=!1),n.Cr===1&&e.Cr!==n.Cr&&(function(i,o){if(i===null)return!1;const a=Vh(i.Ph(),o),l=Vh(i.Rh(),o);return isFinite(a)&&isFinite(l)}(this.Ih,this.xo)?(s=Wp(this.Ih,this.xo),s!==null&&this.Ao(s)):this.cn.autoScale=!0),e.Cr===1&&e.Cr!==n.Cr&&(s=th(this.Ih,this.xo),s!==null&&this.Ao(s));const r=n.Cr!==this.cn.mode;r&&(n.Cr===2||this.Mh())&&this.Ra(),r&&(n.Cr===3||this.Oo())&&this.Ra(),e.Bo!==void 0&&n.Bo!==e.Bo&&(this.cn.invertScale=e.Bo,this.Io()),this.vo.m(n,this.Cr())}zo(){return this.vo}P(){return this.ko.fontSize}At(){return this.ho}Lo(e){this.ho!==e&&(this.ho=e,this.Do(),this.bo=null)}Eo(){if(this.lo)return this.lo;const e=this.At()-this.No()-this.Fo();return this.lo=e,e}Lh(){return this.Wo(),this.Ih}Ao(e,n){const s=this.Ih;(n||s===null&&e!==null||s!==null&&!s.Ch(e))&&(this.bo=null,this.Ih=e)}Ni(){return this.Wo(),this.ho===0||!this.Ih||this.Ih.Ni()}jo(e){return this.Bo()?e:this.At()-1-e}Rt(e,n){return this.Mh()?e=Tc(e,n):this.Oo()&&(e=zh(e,n)),this.Po(e,n)}te(e,n,s){this.Wo();const r=this.Fo(),i=he(this.Lh()),o=i.Ph(),a=i.Rh(),l=this.Eo()-1,c=this.Bo(),u=l/(a-o),h=s===void 0?0:s.from,d=s===void 0?e.length:s.to,f=this.Ho();for(let p=h;p<d;p++){const m=e[p],v=m._t;if(isNaN(v))continue;let x=v;f!==null&&(x=f(m._t,n));const g=r+u*(x-o),y=c?g:this.ho-1-g;m.st=y}}be(e,n,s){this.Wo();const r=this.Fo(),i=he(this.Lh()),o=i.Ph(),a=i.Rh(),l=this.Eo()-1,c=this.Bo(),u=l/(a-o),h=s===void 0?0:s.from,d=s===void 0?e.length:s.to,f=this.Ho();for(let p=h;p<d;p++){const m=e[p];let v=m.ge,x=m.Me,g=m.xe,y=m.Se;f!==null&&(v=f(m.ge,n),x=f(m.Me,n),g=f(m.xe,n),y=f(m.Se,n));let b=r+u*(v-o),C=c?b:this.ho-1-b;m.pe=C,b=r+u*(x-o),C=c?b:this.ho-1-b,m.de=C,b=r+u*(g-o),C=c?b:this.ho-1-b,m.fe=C,b=r+u*(y-o),C=c?b:this.ho-1-b,m.me=C}}pn(e,n){const s=this.To(e,n);return this.$o(s,n)}$o(e,n){let s=e;return this.Mh()?s=function(r,i){return i<0&&(r=-r),r/100*i+i}(s,n):this.Oo()&&(s=function(r,i){return r-=100,i<0&&(r=-r),r/100*i+i}(s,n)),s}Ba(){return this.po}Uo(){if(this.mo)return this.mo;let e=[];for(let n=0;n<this.po.length;n++){const s=this.po[n];s.Xi()===null&&s.Ki(n+1),e.push(s)}return e=UO(e),this.mo=e,this.mo}qo(e){this.po.indexOf(e)===-1&&(this.po.push(e),this.Ra(),this.Yo())}Zo(e){const n=this.po.indexOf(e);if(n===-1)throw new Error("source is not attached to scale");this.po.splice(n,1),this.po.length===0&&(this.Ro({Wn:!0}),this.Ao(null)),this.Ra(),this.Yo()}Ct(){let e=null;for(const n of this.po){const s=n.Ct();s!==null&&(e===null||s.la<e.la)&&(e=s)}return e===null?null:e.Vt}Bo(){return this.cn.invertScale}Ha(){const e=this.Ct()===null;if(this.bo!==null&&(e||this.bo.Xo===e))return this.bo.Ha;this.Co.io();const n=this.Co.Ha();return this.bo={Ha:n,Xo:e},this.fo.m(),n}Ko(){return this.fo}Go(e){this.Mh()||this.Oo()||this.wo===null&&this.ao===null&&(this.Ni()||(this.wo=this.ho-e,this.ao=he(this.Lh()).Th()))}Jo(e){if(this.Mh()||this.Oo()||this.wo===null)return;this.Ro({Wn:!1}),(e=this.ho-e)<0&&(e=0);let n=(this.wo+.2*(this.ho-1))/(e+.2*(this.ho-1));const s=he(this.ao).Th();n=Math.max(n,.1),s.Vh(n),this.Ao(s)}Qo(){this.Mh()||this.Oo()||(this.wo=null,this.ao=null)}t_(e){this.Vo()||this.Mo===null&&this.ao===null&&(this.Ni()||(this.Mo=e,this.ao=he(this.Lh()).Th()))}i_(e){if(this.Vo()||this.Mo===null)return;const n=he(this.Lh()).Dh()/(this.Eo()-1);let s=e-this.Mo;this.Bo()&&(s*=-1);const r=s*n,i=he(this.ao).Th();i.Oh(r),this.Ao(i,!0),this.bo=null}n_(){this.Vo()||this.Mo!==null&&(this.Mo=null,this.ao=null)}ba(){return this.wa||this.Ra(),this.wa}Fi(e,n){switch(this.cn.mode){case 2:return this.s_(Tc(e,n));case 3:return this.ba().format(zh(e,n));default:return this.Wh(e)}}eo(e){switch(this.cn.mode){case 2:return this.s_(e);case 3:return this.ba().format(e);default:return this.Wh(e)}}Yl(e){return this.Wh(e,he(this.e_()).ba())}Zl(e,n){return e=Tc(e,n),this.s_(e,y2)}r_(){return this.po}h_(e){this.oo={uo:e,_o:!1}}Vn(){this.po.forEach(e=>e.Vn())}Ra(){this.bo=null;const e=this.e_();let n=100;e!==null&&(n=Math.round(1/e.ma())),this.wa=b2,this.Mh()?(this.wa=y2,n=100):this.Oo()?(this.wa=new Wx(100,1),n=100):e!==null&&(this.wa=e.ba()),this.Co=new x2(this,n,this.To.bind(this),this.Po.bind(this)),this.Co.io()}Yo(){this.mo=null}e_(){return this.po[0]||null}No(){return this.Bo()?this.cn.scaleMargins.bottom*this.At()+this.do:this.cn.scaleMargins.top*this.At()+this.co}Fo(){return this.Bo()?this.cn.scaleMargins.top*this.At()+this.co:this.cn.scaleMargins.bottom*this.At()+this.do}Wo(){this.oo._o||(this.oo._o=!0,this.l_())}Do(){this.lo=null}Po(e,n){if(this.Wo(),this.Ni())return 0;e=this.ro()&&e?Eg(e,this.xo):e;const s=he(this.Lh()),r=this.Fo()+(this.Eo()-1)*(e-s.Ph())/s.Dh();return this.jo(r)}To(e,n){if(this.Wo(),this.Ni())return 0;const s=this.jo(e),r=he(this.Lh()),i=r.Ph()+r.Dh()*((s-this.Fo())/(this.Eo()-1));return this.ro()?Vh(i,this.xo):i}Io(){this.bo=null,this.Co.io()}l_(){const e=this.oo.uo;if(e===null)return;let n=null;const s=this.r_();let r=0,i=0;for(const l of s){if(!l.yt())continue;const c=l.Ct();if(c===null)continue;const u=l.Il(e.Os(),e.ui());let h=u&&u.Lh();if(h!==null){switch(this.cn.mode){case 1:h=th(h,this.xo);break;case 2:h=EY(h,c.Vt);break;case 3:h=RY(h,c.Vt)}if(n=n===null?h:n.ts(he(h)),u!==null){const d=u.Eh();d!==null&&(r=Math.max(r,d.above),i=Math.max(i,d.below))}}}if(r===this.co&&i===this.do||(this.co=r,this.do=i,this.bo=null,this.Do()),n!==null){if(n.Ph()===n.Rh()){const l=this.e_(),c=5*(l===null||this.Mh()||this.Oo()?1:l.ma());this.ro()&&(n=Wp(n,this.xo)),n=new Ns(n.Ph()-c,n.Rh()+c),this.ro()&&(n=th(n,this.xo))}if(this.ro()){const l=Wp(n,this.xo),c=zy(l);if(o=c,a=this.xo,o.$a!==a.$a||o.Ua!==a.Ua){const u=this.ao!==null?Wp(this.ao,this.xo):null;this.xo=c,n=th(l,c),u!==null&&(this.ao=th(u,c))}}this.Ao(n)}else this.Ih===null&&(this.Ao(new Ns(-.5,.5)),this.xo=zy(null));var o,a;this.oo._o=!0}Ho(){return this.Mh()?Tc:this.Oo()?zh:this.ro()?e=>Eg(e,this.xo):null}a_(e,n,s){return n===void 0?(s===void 0&&(s=this.ba()),s.format(e)):n(e)}Wh(e,n){return this.a_(e,this.yo.priceFormatter,n)}s_(e,n){return this.a_(e,this.yo.percentageFormatter,n)}}class DY{constructor(e,n){this.po=[],this.o_=new Map,this.ho=0,this.__=0,this.u_=1e3,this.mo=null,this.c_=new tn,this.yl=e,this.$i=n,this.d_=new NY(this);const s=n.W();this.f_=this.v_("left",s.leftPriceScale),this.p_=this.v_("right",s.rightPriceScale),this.f_.zo().l(this.m_.bind(this,this.f_),this),this.p_.zo().l(this.m_.bind(this,this.p_),this),this.b_(s)}b_(e){if(e.leftPriceScale&&this.f_.$h(e.leftPriceScale),e.rightPriceScale&&this.p_.$h(e.rightPriceScale),e.localization&&(this.f_.Ra(),this.p_.Ra()),e.overlayPriceScales){const n=Array.from(this.o_.values());for(const s of n){const r=he(s[0].Dt());r.$h(e.overlayPriceScales),e.localization&&r.Ra()}}}w_(e){switch(e){case"left":return this.f_;case"right":return this.p_}return this.o_.has(e)?hs(this.o_.get(e))[0].Dt():null}S(){this.$t().g_().p(this),this.f_.zo().p(this),this.p_.zo().p(this),this.po.forEach(e=>{e.S&&e.S()}),this.c_.m()}M_(){return this.u_}x_(e){this.u_=e}$t(){return this.$i}Hi(){return this.__}At(){return this.ho}S_(e){this.__=e,this.k_()}Lo(e){this.ho=e,this.f_.Lo(e),this.p_.Lo(e),this.po.forEach(n=>{if(this.vr(n)){const s=n.Dt();s!==null&&s.Lo(e)}}),this.k_()}Ba(){return this.po}vr(e){const n=e.Dt();return n===null||this.f_!==n&&this.p_!==n}qo(e,n,s){const r=s!==void 0?s:this.C_().y_+1;this.T_(e,n,r)}Zo(e){const n=this.po.indexOf(e);ta(n!==-1,"removeDataSource: invalid data source"),this.po.splice(n,1);const s=he(e.Dt()).Pa();if(this.o_.has(s)){const i=hs(this.o_.get(s)),o=i.indexOf(e);o!==-1&&(i.splice(o,1),i.length===0&&this.o_.delete(s))}const r=e.Dt();r&&r.Ba().indexOf(e)>=0&&r.Zo(e),r!==null&&(r.Yo(),this.P_(r)),this.mo=null}mr(e){return e===this.f_?"left":e===this.p_?"right":"overlay"}R_(){return this.f_}D_(){return this.p_}V_(e,n){e.Go(n)}O_(e,n){e.Jo(n),this.k_()}B_(e){e.Qo()}A_(e,n){e.t_(n)}I_(e,n){e.i_(n),this.k_()}z_(e){e.n_()}k_(){this.po.forEach(e=>{e.Vn()})}vn(){let e=null;return this.$i.W().rightPriceScale.visible&&this.p_.Ba().length!==0?e=this.p_:this.$i.W().leftPriceScale.visible&&this.f_.Ba().length!==0?e=this.f_:this.po.length!==0&&(e=this.po[0].Dt()),e===null&&(e=this.p_),e}pr(){let e=null;return this.$i.W().rightPriceScale.visible?e=this.p_:this.$i.W().leftPriceScale.visible&&(e=this.f_),e}P_(e){e!==null&&e.Vo()&&this.L_(e)}E_(e){const n=this.yl.Xs();e.Ro({Wn:!0}),n!==null&&e.h_(n),this.k_()}N_(){this.L_(this.f_),this.L_(this.p_)}F_(){this.P_(this.f_),this.P_(this.p_),this.po.forEach(e=>{this.vr(e)&&this.P_(e.Dt())}),this.k_(),this.$i.Uh()}Uo(){return this.mo===null&&(this.mo=UO(this.po)),this.mo}W_(){return this.c_}j_(){return this.d_}L_(e){const n=e.r_();if(n&&n.length>0&&!this.yl.Ni()){const s=this.yl.Xs();s!==null&&e.h_(s)}e.Vn()}C_(){const e=this.Uo();if(e.length===0)return{H_:0,y_:0};let n=0,s=0;for(let r=0;r<e.length;r++){const i=e[r].Xi();i!==null&&(i<n&&(n=i),i>s&&(s=i))}return{H_:n,y_:s}}T_(e,n,s){let r=this.w_(n);if(r===null&&(r=this.v_(n,this.$i.W().overlayPriceScales)),this.po.push(e),!jx(n)){const i=this.o_.get(n)||[];i.push(e),this.o_.set(n,i)}r.qo(e),e.Gi(r),e.Ki(s),this.P_(r),this.mo=null}m_(e,n,s){n.Cr!==s.Cr&&this.L_(e)}v_(e,n){const s=Object.assign({visible:!0,autoScale:!0},Ki(n)),r=new AY(e,s,this.$i.W().layout,this.$i.W().localization);return r.Lo(this.At()),r}}class _Y{constructor(e,n,s=50){this.Ke=0,this.Ge=1,this.Je=1,this.tr=new Map,this.Qe=new Map,this.U_=e,this.q_=n,this.ir=s}Y_(e){const n=e.time,s=this.q_.cacheKey(n),r=this.tr.get(s);if(r!==void 0)return r.Z_;if(this.Ke===this.ir){const o=this.Qe.get(this.Je);this.Qe.delete(this.Je),this.tr.delete(hs(o)),this.Je++,this.Ke--}const i=this.U_(e);return this.tr.set(s,{Z_:i,rr:this.Ge}),this.Qe.set(this.Ge,s),this.Ke++,this.Ge++,i}}class Bh{constructor(e,n){ta(e<=n,"right should be >= left"),this.X_=e,this.K_=n}Os(){return this.X_}ui(){return this.K_}G_(){return this.K_-this.X_+1}Kr(e){return this.X_<=e&&e<=this.K_}Ch(e){return this.X_===e.Os()&&this.K_===e.ui()}}function w2(t,e){return t===null||e===null?t===e:t.Ch(e)}class PY{constructor(){this.J_=new Map,this.tr=null,this.Q_=!1}tu(e){this.Q_=e,this.tr=null}iu(e,n){this.nu(n),this.tr=null;for(let s=n;s<e.length;++s){const r=e[s];let i=this.J_.get(r.timeWeight);i===void 0&&(i=[],this.J_.set(r.timeWeight,i)),i.push({index:s,time:r.time,weight:r.timeWeight,originalTime:r.originalTime})}}su(e,n){const s=Math.ceil(n/e);return this.tr!==null&&this.tr.eu===s||(this.tr={Ha:this.ru(s),eu:s}),this.tr.Ha}nu(e){if(e===0)return void this.J_.clear();const n=[];this.J_.forEach((s,r)=>{e<=s[0].index?n.push(r):s.splice(Wd(s,e,i=>i.index<e),1/0)});for(const s of n)this.J_.delete(s)}ru(e){let n=[];for(const s of Array.from(this.J_.keys()).sort((r,i)=>i-r)){if(!this.J_.get(s))continue;const r=n;n=[];const i=r.length;let o=0;const a=hs(this.J_.get(s)),l=a.length;let c=1/0,u=-1/0;for(let h=0;h<l;h++){const d=a[h],f=d.index;for(;o<i;){const p=r[o],m=p.index;if(!(m<f)){c=m;break}o++,n.push(p),u=m,c=1/0}if(c-f>=e&&f-u>=e)n.push(d),u=f;else if(this.Q_)return r}for(;o<i;o++)n.push(r[o])}return n}}class Fc{constructor(e){this.hu=e}lu(){return this.hu===null?null:new Bh(Math.floor(this.hu.Os()),Math.ceil(this.hu.ui()))}au(){return this.hu}static ou(){return new Fc(null)}}function FY(t,e){return t.weight>e.weight?t:e}class OY{constructor(e,n,s,r){this.__=0,this._u=null,this.uu=[],this.Mo=null,this.wo=null,this.cu=new PY,this.du=new Map,this.fu=Fc.ou(),this.vu=!0,this.pu=new tn,this.mu=new tn,this.bu=new tn,this.wu=null,this.gu=null,this.Mu=[],this.cn=n,this.yo=s,this.xu=n.rightOffset,this.Su=n.barSpacing,this.$i=e,this.q_=r,this.ku(),this.cu.tu(n.uniformDistribution)}W(){return this.cn}yu(e){Hr(this.yo,e),this.Cu(),this.ku()}$h(e,n){var s;Hr(this.cn,e),this.cn.fixLeftEdge&&this.Tu(),this.cn.fixRightEdge&&this.Pu(),e.barSpacing!==void 0&&this.$i.Gn(e.barSpacing),e.rightOffset!==void 0&&this.$i.Jn(e.rightOffset),e.minBarSpacing!==void 0&&this.$i.Gn((s=e.barSpacing)!==null&&s!==void 0?s:this.Su),this.Cu(),this.ku(),this.bu.m()}mn(e){var n,s;return(s=(n=this.uu[e])===null||n===void 0?void 0:n.time)!==null&&s!==void 0?s:null}Ui(e){var n;return(n=this.uu[e])!==null&&n!==void 0?n:null}Va(e,n){if(this.uu.length<1)return null;if(this.q_.key(e)>this.q_.key(this.uu[this.uu.length-1].time))return n?this.uu.length-1:null;const s=Wd(this.uu,this.q_.key(e),(r,i)=>this.q_.key(r.time)<i);return this.q_.key(e)<this.q_.key(this.uu[s].time)?n?s:null:s}Ni(){return this.__===0||this.uu.length===0||this._u===null}Da(){return this.uu.length>0}Xs(){return this.Ru(),this.fu.lu()}Du(){return this.Ru(),this.fu.au()}Vu(){const e=this.Xs();if(e===null)return null;const n={from:e.Os(),to:e.ui()};return this.Ou(n)}Ou(e){const n=Math.round(e.from),s=Math.round(e.to),r=he(this.Bu()),i=he(this.Au());return{from:he(this.Ui(Math.max(r,n))),to:he(this.Ui(Math.min(i,s)))}}Iu(e){return{from:he(this.Va(e.from,!0)),to:he(this.Va(e.to,!0))}}Hi(){return this.__}S_(e){if(!isFinite(e)||e<=0||this.__===e)return;const n=this.Du(),s=this.__;if(this.__=e,this.vu=!0,this.cn.lockVisibleTimeRangeOnResize&&s!==0){const r=this.Su*e/s;this.Su=r}if(this.cn.fixLeftEdge&&n!==null&&n.Os()<=0){const r=s-e;this.xu-=Math.round(r/this.Su)+1,this.vu=!0}this.zu(),this.Lu()}It(e){if(this.Ni()||!dd(e))return 0;const n=this.Eu()+this.xu-e;return this.__-(n+.5)*this.Su-1}Qs(e,n){const s=this.Eu(),r=n===void 0?0:n.from,i=n===void 0?e.length:n.to;for(let o=r;o<i;o++){const a=e[o].ot,l=s+this.xu-a,c=this.__-(l+.5)*this.Su-1;e[o].nt=c}}Nu(e){return Math.ceil(this.Fu(e))}Jn(e){this.vu=!0,this.xu=e,this.Lu(),this.$i.Wu(),this.$i.Uh()}le(){return this.Su}Gn(e){this.ju(e),this.Lu(),this.$i.Wu(),this.$i.Uh()}Hu(){return this.xu}Ha(){if(this.Ni())return null;if(this.gu!==null)return this.gu;const e=this.Su,n=5*(this.$i.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),s=Math.round(n/e),r=he(this.Xs()),i=Math.max(r.Os(),r.Os()-s),o=Math.max(r.ui(),r.ui()-s),a=this.cu.su(e,n),l=this.Bu()+s,c=this.Au()-s,u=this.$u(),h=this.cn.fixLeftEdge||u,d=this.cn.fixRightEdge||u;let f=0;for(const p of a){if(!(i<=p.index&&p.index<=o))continue;let m;f<this.Mu.length?(m=this.Mu[f],m.coord=this.It(p.index),m.label=this.Uu(p),m.weight=p.weight):(m={needAlignCoordinate:!1,coord:this.It(p.index),label:this.Uu(p),weight:p.weight},this.Mu.push(m)),this.Su>n/2&&!u?m.needAlignCoordinate=!1:m.needAlignCoordinate=h&&p.index<=l||d&&p.index>=c,f++}return this.Mu.length=f,this.gu=this.Mu,this.Mu}qu(){this.vu=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}Yu(e){this.vu=!0,this._u=e,this.Lu(),this.Tu()}Zu(e,n){const s=this.Fu(e),r=this.le(),i=r+n*(r/10);this.Gn(i),this.cn.rightBarStaysOnScroll||this.Jn(this.Hu()+(s-this.Fu(e)))}Go(e){this.Mo&&this.n_(),this.wo===null&&this.wu===null&&(this.Ni()||(this.wo=e,this.Xu()))}Jo(e){if(this.wu===null)return;const n=Xw(this.__-e,0,this.__),s=Xw(this.__-he(this.wo),0,this.__);n!==0&&s!==0&&this.Gn(this.wu.le*n/s)}Qo(){this.wo!==null&&(this.wo=null,this.Ku())}t_(e){this.Mo===null&&this.wu===null&&(this.Ni()||(this.Mo=e,this.Xu()))}i_(e){if(this.Mo===null)return;const n=(this.Mo-e)/this.le();this.xu=he(this.wu).Hu+n,this.vu=!0,this.Lu()}n_(){this.Mo!==null&&(this.Mo=null,this.Ku())}Gu(){this.Ju(this.cn.rightOffset)}Ju(e,n=400){if(!isFinite(e))throw new RangeError("offset is required and must be finite number");if(!isFinite(n)||n<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.xu,r=performance.now();this.$i.Zn({Qu:i=>(i-r)/n>=1,tc:i=>{const o=(i-r)/n;return o>=1?e:s+(e-s)*o}})}bt(e,n){this.vu=!0,this.uu=e,this.cu.iu(e,n),this.Lu()}nc(){return this.pu}sc(){return this.mu}ec(){return this.bu}Eu(){return this._u||0}rc(e){const n=e.G_();this.ju(this.__/n),this.xu=e.ui()-this.Eu(),this.Lu(),this.vu=!0,this.$i.Wu(),this.$i.Uh()}hc(){const e=this.Bu(),n=this.Au();e!==null&&n!==null&&this.rc(new Bh(e,n+this.cn.rightOffset))}lc(e){const n=new Bh(e.from,e.to);this.rc(n)}qi(e){return this.yo.timeFormatter!==void 0?this.yo.timeFormatter(e.originalTime):this.q_.formatHorzItem(e.time)}$u(){const{handleScroll:e,handleScale:n}=this.$i.W();return!(e.horzTouchDrag||e.mouseWheel||e.pressedMouseMove||e.vertTouchDrag||n.axisDoubleClickReset.time||n.axisPressedMouseMove.time||n.mouseWheel||n.pinch)}Bu(){return this.uu.length===0?null:0}Au(){return this.uu.length===0?null:this.uu.length-1}ac(e){return(this.__-1-e)/this.Su}Fu(e){const n=this.ac(e),s=this.Eu()+this.xu-n;return Math.round(1e6*s)/1e6}ju(e){const n=this.Su;this.Su=e,this.zu(),n!==this.Su&&(this.vu=!0,this.oc())}Ru(){if(!this.vu)return;if(this.vu=!1,this.Ni())return void this._c(Fc.ou());const e=this.Eu(),n=this.__/this.Su,s=this.xu+e,r=new Bh(s-n+1,s);this._c(new Fc(r))}zu(){const e=this.uc();if(this.Su<e&&(this.Su=e,this.vu=!0),this.__!==0){const n=.5*this.__;this.Su>n&&(this.Su=n,this.vu=!0)}}uc(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&this.uu.length!==0?this.__/this.uu.length:this.cn.minBarSpacing}Lu(){const e=this.cc();e!==null&&this.xu<e&&(this.xu=e,this.vu=!0);const n=this.dc();this.xu>n&&(this.xu=n,this.vu=!0)}cc(){const e=this.Bu(),n=this._u;return e===null||n===null?null:e-n-1+(this.cn.fixLeftEdge?this.__/this.Su:Math.min(2,this.uu.length))}dc(){return this.cn.fixRightEdge?0:this.__/this.Su-Math.min(2,this.uu.length)}Xu(){this.wu={le:this.le(),Hu:this.Hu()}}Ku(){this.wu=null}Uu(e){let n=this.du.get(e.weight);return n===void 0&&(n=new _Y(s=>this.fc(s),this.q_),this.du.set(e.weight,n)),n.Y_(e)}fc(e){return this.q_.formatTickmark(e,this.yo)}_c(e){const n=this.fu;this.fu=e,w2(n.lu(),this.fu.lu())||this.pu.m(),w2(n.au(),this.fu.au())||this.mu.m(),this.oc()}oc(){this.gu=null}Cu(){this.oc(),this.du.clear()}ku(){this.q_.updateFormatter(this.yo)}Tu(){if(!this.cn.fixLeftEdge)return;const e=this.Bu();if(e===null)return;const n=this.Xs();if(n===null)return;const s=n.Os()-e;if(s<0){const r=this.xu-s-1;this.Jn(r)}this.zu()}Pu(){this.Lu(),this.zu()}}class MY{X(e,n,s){e.useMediaCoordinateSpace(r=>this.K(r,n,s))}gl(e,n,s){e.useMediaCoordinateSpace(r=>this.vc(r,n,s))}vc(e,n,s){}}class LY extends MY{constructor(e){super(),this.mc=new Map,this.zt=e}K(e){}vc(e){if(!this.zt.yt)return;const{context:n,mediaSize:s}=e;let r=0;for(const o of this.zt.bc){if(o.Kt.length===0)continue;n.font=o.R;const a=this.wc(n,o.Kt);a>s.width?o.Zu=s.width/a:o.Zu=1,r+=o.gc*o.Zu}let i=0;switch(this.zt.Mc){case"top":i=0;break;case"center":i=Math.max((s.height-r)/2,0);break;case"bottom":i=Math.max(s.height-r,0)}n.fillStyle=this.zt.V;for(const o of this.zt.bc){n.save();let a=0;switch(this.zt.xc){case"left":n.textAlign="left",a=o.gc/2;break;case"center":n.textAlign="center",a=s.width/2;break;case"right":n.textAlign="right",a=s.width-1-o.gc/2}n.translate(a,i),n.textBaseline="top",n.font=o.R,n.scale(o.Zu,o.Zu),n.fillText(o.Kt,0,o.Sc),n.restore(),i+=o.gc*o.Zu}}wc(e,n){const s=this.kc(e.font);let r=s.get(n);return r===void 0&&(r=e.measureText(n).width,s.set(n,r)),r}kc(e){let n=this.mc.get(e);return n===void 0&&(n=new Map,this.mc.set(e,n)),n}}class zY{constructor(e){this.ft=!0,this.Ft={yt:!1,V:"",bc:[],Mc:"center",xc:"center"},this.Wt=new LY(this.Ft),this.jt=e}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const e=this.jt.W(),n=this.Ft;n.yt=e.visible,n.yt&&(n.V=e.color,n.xc=e.horzAlign,n.Mc=e.vertAlign,n.bc=[{Kt:e.text,R:Zc(e.fontSize,e.fontFamily,e.fontStyle),gc:1.2*e.fontSize,Sc:0,Zu:0}])}}class VY extends DS{constructor(e,n){super(),this.cn=n,this.wn=new zY(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}Vn(){this.wn.bt()}}var C2,S2,k2,T2,I2;(function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"})(C2||(C2={}));class BY{constructor(e,n,s){this.yc=[],this.Cc=[],this.__=0,this.Tc=null,this.Pc=new tn,this.Rc=new tn,this.Dc=null,this.Vc=e,this.cn=n,this.q_=s,this.Oc=new y7(this),this.yl=new OY(this,n.timeScale,this.cn.localization,s),this.vt=new R7(this,n.crosshair),this.Bc=new TY(n.crosshair),this.Ac=new VY(this,n.watermark),this.Ic(),this.yc[0].x_(2e3),this.zc=this.Lc(0),this.Ec=this.Lc(1)}Kl(){this.Nc(Fn.es())}Uh(){this.Nc(Fn.ss())}oa(){this.Nc(new Fn(1))}Gl(e){const n=this.Fc(e);this.Nc(n)}Wc(){return this.Tc}jc(e){const n=this.Tc;this.Tc=e,n!==null&&this.Gl(n.Hc),e!==null&&this.Gl(e.Hc)}W(){return this.cn}$h(e){Hr(this.cn,e),this.yc.forEach(n=>n.b_(e)),e.timeScale!==void 0&&this.yl.$h(e.timeScale),e.localization!==void 0&&this.yl.yu(e.localization),(e.leftPriceScale||e.rightPriceScale)&&this.Pc.m(),this.zc=this.Lc(0),this.Ec=this.Lc(1),this.Kl()}$c(e,n){if(e==="left")return void this.$h({leftPriceScale:n});if(e==="right")return void this.$h({rightPriceScale:n});const s=this.Uc(e);s!==null&&(s.Dt.$h(n),this.Pc.m())}Uc(e){for(const n of this.yc){const s=n.w_(e);if(s!==null)return{Ht:n,Dt:s}}return null}St(){return this.yl}qc(){return this.yc}Yc(){return this.Ac}Zc(){return this.vt}Xc(){return this.Rc}Kc(e,n){e.Lo(n),this.Wu()}S_(e){this.__=e,this.yl.S_(this.__),this.yc.forEach(n=>n.S_(e)),this.Wu()}Ic(e){const n=new DY(this.yl,this);e!==void 0?this.yc.splice(e,0,n):this.yc.push(n);const s=e===void 0?this.yc.length-1:e,r=Fn.es();return r.Nn(s,{Fn:0,Wn:!0}),this.Nc(r),n}V_(e,n,s){e.V_(n,s)}O_(e,n,s){e.O_(n,s),this.Jl(),this.Nc(this.Gc(e,2))}B_(e,n){e.B_(n),this.Nc(this.Gc(e,2))}A_(e,n,s){n.Vo()||e.A_(n,s)}I_(e,n,s){n.Vo()||(e.I_(n,s),this.Jl(),this.Nc(this.Gc(e,2)))}z_(e,n){n.Vo()||(e.z_(n),this.Nc(this.Gc(e,2)))}E_(e,n){e.E_(n),this.Nc(this.Gc(e,2))}Jc(e){this.yl.Go(e)}Qc(e,n){const s=this.St();if(s.Ni()||n===0)return;const r=s.Hi();e=Math.max(1,Math.min(e,r)),s.Zu(e,n),this.Wu()}td(e){this.nd(0),this.sd(e),this.ed()}rd(e){this.yl.Jo(e),this.Wu()}hd(){this.yl.Qo(),this.Uh()}nd(e){this.yl.t_(e)}sd(e){this.yl.i_(e),this.Wu()}ed(){this.yl.n_(),this.Uh()}wt(){return this.Cc}ld(e,n,s,r,i){this.vt.gn(e,n);let o=NaN,a=this.yl.Nu(e);const l=this.yl.Xs();l!==null&&(a=Math.min(Math.max(l.Os(),a),l.ui()));const c=r.vn(),u=c.Ct();u!==null&&(o=c.pn(n,u)),o=this.Bc.Oa(o,a,r),this.vt.kn(a,o,r),this.oa(),i||this.Rc.m(this.vt.xt(),{x:e,y:n},s)}ad(e,n,s){const r=s.vn(),i=r.Ct(),o=r.Rt(e,he(i)),a=this.yl.Va(n,!0),l=this.yl.It(he(a));this.ld(l,o,null,s,!0)}od(e){this.Zc().Cn(),this.oa(),e||this.Rc.m(null,null,null)}Jl(){const e=this.vt.Ht();if(e!==null){const n=this.vt.xn(),s=this.vt.Sn();this.ld(n,s,null,e)}this.vt.Vn()}_d(e,n,s){const r=this.yl.mn(0);n!==void 0&&s!==void 0&&this.yl.bt(n,s);const i=this.yl.mn(0),o=this.yl.Eu(),a=this.yl.Xs();if(a!==null&&r!==null&&i!==null){const l=a.Kr(o),c=this.q_.key(r)>this.q_.key(i),u=e!==null&&e>o&&!c,h=this.yl.W().allowShiftVisibleRangeOnWhitespaceReplacement,d=l&&(s!==void 0||h)&&this.yl.W().shiftVisibleRangeOnNewBar;if(u&&!d){const f=e-o;this.yl.Jn(this.yl.Hu()-f)}}this.yl.Yu(e)}ia(e){e!==null&&e.F_()}dr(e){const n=this.yc.find(s=>s.Uo().includes(e));return n===void 0?null:n}Wu(){this.Ac.Vn(),this.yc.forEach(e=>e.F_()),this.Jl()}S(){this.yc.forEach(e=>e.S()),this.yc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}ud(){return this.Oc}br(){return this.Oc.W()}g_(){return this.Pc}dd(e,n,s){const r=this.yc[0],i=this.fd(n,e,r,s);return this.Cc.push(i),this.Cc.length===1?this.Kl():this.Uh(),i}vd(e){const n=this.dr(e),s=this.Cc.indexOf(e);ta(s!==-1,"Series not found"),this.Cc.splice(s,1),he(n).Zo(e),e.S&&e.S()}Xl(e,n){const s=he(this.dr(e));s.Zo(e);const r=this.Uc(n);if(r===null){const i=e.Xi();s.qo(e,n,i)}else{const i=r.Ht===s?e.Xi():void 0;r.Ht.qo(e,n,i)}}hc(){const e=Fn.ss();e.$n(),this.Nc(e)}pd(e){const n=Fn.ss();n.Yn(e),this.Nc(n)}Kn(){const e=Fn.ss();e.Kn(),this.Nc(e)}Gn(e){const n=Fn.ss();n.Gn(e),this.Nc(n)}Jn(e){const n=Fn.ss();n.Jn(e),this.Nc(n)}Zn(e){const n=Fn.ss();n.Zn(e),this.Nc(n)}Un(){const e=Fn.ss();e.Un(),this.Nc(e)}md(){return this.cn.rightPriceScale.visible?"right":"left"}bd(){return this.Ec}q(){return this.zc}Bt(e){const n=this.Ec,s=this.zc;if(n===s)return n;if(e=Math.max(0,Math.min(100,Math.round(100*e))),this.Dc===null||this.Dc.Ps!==s||this.Dc.Rs!==n)this.Dc={Ps:s,Rs:n,wd:new Map};else{const i=this.Dc.wd.get(e);if(i!==void 0)return i}const r=function(i,o,a){const[l,c,u,h]=hd(i),[d,f,p,m]=hd(o),v=[sr(l+a*(d-l)),sr(c+a*(f-c)),sr(u+a*(p-u)),IO(h+a*(m-h))];return`rgba(${v[0]}, ${v[1]}, ${v[2]}, ${v[3]})`}(s,n,e/100);return this.Dc.wd.set(e,r),r}Gc(e,n){const s=new Fn(n);if(e!==null){const r=this.yc.indexOf(e);s.Nn(r,{Fn:n})}return s}Fc(e,n){return n===void 0&&(n=2),this.Gc(this.dr(e),n)}Nc(e){this.Vc&&this.Vc(e),this.yc.forEach(n=>n.j_().qh().bt())}fd(e,n,s,r){const i=new OS(this,e,n,s,r),o=e.priceScaleId!==void 0?e.priceScaleId:this.md();return s.qo(i,o),jx(o)||i.$h(e),i}Lc(e){const n=this.cn.layout;return n.background.type==="gradient"?e===0?n.background.topColor:n.background.bottomColor:n.background.color}}function qw(t){return!pi(t)&&!jd(t)}function GO(t){return pi(t)}(function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"})(S2||(S2={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(k2||(k2={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(T2||(T2={})),function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(I2||(I2={}));const $2=t=>t.getUTCFullYear();function jY(t,e,n){return e.replace(/yyyy/g,(s=>Xi($2(s),4))(t)).replace(/yy/g,(s=>Xi($2(s)%100,2))(t)).replace(/MMMM/g,((s,r)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(r,{month:"long"}))(t,n)).replace(/MMM/g,((s,r)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(r,{month:"short"}))(t,n)).replace(/MM/g,(s=>Xi((r=>r.getUTCMonth()+1)(s),2))(t)).replace(/dd/g,(s=>Xi((r=>r.getUTCDate())(s),2))(t))}class HO{constructor(e="yyyy-MM-dd",n="default"){this.gd=e,this.Md=n}Y_(e){return jY(e,this.gd,this.Md)}}class WY{constructor(e){this.xd=e||"%h:%m:%s"}Y_(e){return this.xd.replace("%h",Xi(e.getUTCHours(),2)).replace("%m",Xi(e.getUTCMinutes(),2)).replace("%s",Xi(e.getUTCSeconds(),2))}}const UY={Sd:"yyyy-MM-dd",kd:"%h:%m:%s",yd:" ",Cd:"default"};class GY{constructor(e={}){const n=Object.assign(Object.assign({},UY),e);this.Td=new HO(n.Sd,n.Cd),this.Pd=new WY(n.kd),this.Rd=n.yd}Y_(e){return`${this.Td.Y_(e)}${this.Rd}${this.Pd.Y_(e)}`}}function Up(t){return 60*t*60*1e3}function By(t){return 60*t*1e3}const Gp=[{Dd:(N2=1,1e3*N2),Vd:10},{Dd:By(1),Vd:20},{Dd:By(5),Vd:21},{Dd:By(30),Vd:22},{Dd:Up(1),Vd:30},{Dd:Up(3),Vd:31},{Dd:Up(6),Vd:32},{Dd:Up(12),Vd:33}];var N2;function E2(t,e){if(t.getUTCFullYear()!==e.getUTCFullYear())return 70;if(t.getUTCMonth()!==e.getUTCMonth())return 60;if(t.getUTCDate()!==e.getUTCDate())return 50;for(let n=Gp.length-1;n>=0;--n)if(Math.floor(e.getTime()/Gp[n].Dd)!==Math.floor(t.getTime()/Gp[n].Dd))return Gp[n].Vd;return 0}function jy(t){let e=t;if(jd(t)&&(e=MS(t)),!qw(e))throw new Error("time must be of type BusinessDay");const n=new Date(Date.UTC(e.year,e.month-1,e.day,0,0,0,0));return{Od:Math.round(n.getTime()/1e3),Bd:e}}function R2(t){if(!GO(t))throw new Error("time must be of type isUTCTimestamp");return{Od:t}}function MS(t){const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:e.getUTCDate(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}}function A2(t){jd(t.time)&&(t.time=MS(t.time))}class D2{options(){return this.cn}setOptions(e){this.cn=e,this.updateFormatter(e.localization)}preprocessData(e){Array.isArray(e)?function(n){n.forEach(A2)}(e):A2(e)}createConverterToInternalObj(e){return he(function(n){return n.length===0?null:qw(n[0].time)||jd(n[0].time)?jy:R2}(e))}key(e){return typeof e=="object"&&"Od"in e?e.Od:this.key(this.convertHorzItemToInternal(e))}cacheKey(e){const n=e;return n.Bd===void 0?new Date(1e3*n.Od).getTime():new Date(Date.UTC(n.Bd.year,n.Bd.month-1,n.Bd.day)).getTime()}convertHorzItemToInternal(e){return GO(n=e)?R2(n):qw(n)?jy(n):jy(MS(n));var n}updateFormatter(e){if(!this.cn)return;const n=e.dateFormat;this.cn.timeScale.timeVisible?this.Ad=new GY({Sd:n,kd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",yd:"   ",Cd:e.locale}):this.Ad=new HO(n,e.locale)}formatHorzItem(e){const n=e;return this.Ad.Y_(new Date(1e3*n.Od))}formatTickmark(e,n){const s=function(i,o,a){switch(i){case 0:case 10:return o?a?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(e.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),r=this.cn.timeScale;if(r.tickMarkFormatter!==void 0){const i=r.tickMarkFormatter(e.originalTime,s,n.locale);if(i!==null)return i}return function(i,o,a){const l={};switch(o){case 0:l.year="numeric";break;case 1:l.month="short";break;case 2:l.day="numeric";break;case 3:l.hour12=!1,l.hour="2-digit",l.minute="2-digit";break;case 4:l.hour12=!1,l.hour="2-digit",l.minute="2-digit",l.second="2-digit"}const c=i.Bd===void 0?new Date(1e3*i.Od):new Date(Date.UTC(i.Bd.year,i.Bd.month-1,i.Bd.day));return new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()).toLocaleString(a,l)}(e.time,s,n.locale)}maxTickMarkWeight(e){let n=e.reduce(FY,e[0]).weight;return n>30&&n<50&&(n=30),n}fillWeightsForPoints(e,n){(function(s,r=0){if(s.length===0)return;let i=r===0?null:s[r-1].time.Od,o=i!==null?new Date(1e3*i):null,a=0;for(let l=r;l<s.length;++l){const c=s[l],u=new Date(1e3*c.time.Od);o!==null&&(c.timeWeight=E2(u,o)),a+=c.time.Od-(i||c.time.Od),i=c.time.Od,o=u}if(r===0&&s.length>1){const l=Math.ceil(a/(s.length-1)),c=new Date(1e3*(s[0].time.Od-l));s[0].timeWeight=E2(new Date(1e3*s[0].time.Od),c)}})(e,n)}static Id(e){return Hr({localization:{dateFormat:"dd MMM 'yy"}},e??{})}}const Jc=typeof window<"u";function _2(){return!!Jc&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Wy(){return!!Jc&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Yw(t){return t+t%2}function Uy(t,e){return t.zd-e.zd}function Gy(t,e,n){const s=(t.zd-e.zd)/(t.ot-e.ot);return Math.sign(s)*Math.min(Math.abs(s),n)}class HY{constructor(e,n,s,r){this.Ld=null,this.Ed=null,this.Nd=null,this.Fd=null,this.Wd=null,this.jd=0,this.Hd=0,this.$d=e,this.Ud=n,this.qd=s,this.rs=r}Yd(e,n){if(this.Ld!==null){if(this.Ld.ot===n)return void(this.Ld.zd=e);if(Math.abs(this.Ld.zd-e)<this.rs)return}this.Fd=this.Nd,this.Nd=this.Ed,this.Ed=this.Ld,this.Ld={ot:n,zd:e}}Vr(e,n){if(this.Ld===null||this.Ed===null||n-this.Ld.ot>50)return;let s=0;const r=Gy(this.Ld,this.Ed,this.Ud),i=Uy(this.Ld,this.Ed),o=[r],a=[i];if(s+=i,this.Nd!==null){const c=Gy(this.Ed,this.Nd,this.Ud);if(Math.sign(c)===Math.sign(r)){const u=Uy(this.Ed,this.Nd);if(o.push(c),a.push(u),s+=u,this.Fd!==null){const h=Gy(this.Nd,this.Fd,this.Ud);if(Math.sign(h)===Math.sign(r)){const d=Uy(this.Nd,this.Fd);o.push(h),a.push(d),s+=d}}}}let l=0;for(let c=0;c<o.length;++c)l+=a[c]/s*o[c];Math.abs(l)<this.$d||(this.Wd={zd:e,ot:n},this.Hd=l,this.jd=function(c,u){const h=Math.log(u);return Math.log(1*h/-c)/h}(Math.abs(l),this.qd))}tc(e){const n=he(this.Wd),s=e-n.ot;return n.zd+this.Hd*(Math.pow(this.qd,s)-1)/Math.log(this.qd)}Qu(e){return this.Wd===null||this.Zd(e)===this.jd}Zd(e){const n=e-he(this.Wd).ot;return Math.min(n,this.jd)}}class KY{constructor(e,n){this.Xd=void 0,this.Kd=void 0,this.Gd=void 0,this.en=!1,this.Jd=e,this.Qd=n,this.tf()}bt(){this.tf()}if(){this.Xd&&this.Jd.removeChild(this.Xd),this.Kd&&this.Jd.removeChild(this.Kd),this.Xd=void 0,this.Kd=void 0}nf(){return this.en!==this.sf()||this.Gd!==this.ef()}ef(){return $O(hd(this.Qd.W().layout.textColor))>160?"dark":"light"}sf(){return this.Qd.W().layout.attributionLogo}rf(){const e=new URL(location.href);return e.hostname?"&utm_source="+e.hostname+e.pathname:""}tf(){this.nf()&&(this.if(),this.en=this.sf(),this.en&&(this.Gd=this.ef(),this.Kd=document.createElement("style"),this.Kd.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Xd=document.createElement("a"),this.Xd.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.rf()}`,this.Xd.title="Charting by TradingView",this.Xd.id="tv-attr-logo",this.Xd.target="_blank",this.Xd.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 19" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Xd.toggleAttribute("data-dark",this.Gd==="dark"),this.Jd.appendChild(this.Kd),this.Jd.appendChild(this.Xd)))}}function hl(t,e){const n=he(t.ownerDocument).createElement("canvas");t.appendChild(n);const s=r7(n,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(r,i)=>({width:Math.max(r.width,i.width),height:Math.max(r.height,i.height)})});return s.resizeCanvasElement(e),s}function dl(t){var e;t.width=1,t.height=1,(e=t.getContext("2d"))===null||e===void 0||e.clearRect(0,0,1,1)}function Qw(t,e,n,s){t.gl&&t.gl(e,n,s)}function Fm(t,e,n,s){t.X(e,n,s)}function Zw(t,e,n,s){const r=t(n,s);for(const i of r){const o=i.gt();o!==null&&e(o)}}function XY(t){Jc&&window.chrome!==void 0&&t.addEventListener("mousedown",e=>{if(e.button===1)return e.preventDefault(),!1})}class LS{constructor(e,n,s){this.hf=0,this.lf=null,this.af={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this._f=0,this.uf=null,this.cf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.df=null,this.ff=!1,this.vf=null,this.pf=null,this.mf=!1,this.bf=!1,this.wf=!1,this.gf=null,this.Mf=null,this.xf=null,this.Sf=null,this.kf=null,this.yf=null,this.Cf=null,this.Tf=0,this.Pf=!1,this.Rf=!1,this.Df=!1,this.Vf=0,this.Of=null,this.Bf=!Wy(),this.Af=r=>{this.If(r)},this.zf=r=>{if(this.Lf(r)){const i=this.Ef(r);if(++this._f,this.uf&&this._f>1){const{Nf:o}=this.Ff(ii(r),this.cf);o<30&&!this.wf&&this.Wf(i,this.Hf.jf),this.$f()}}else{const i=this.Ef(r);if(++this.hf,this.lf&&this.hf>1){const{Nf:o}=this.Ff(ii(r),this.af);o<5&&!this.bf&&this.Uf(i,this.Hf.qf),this.Yf()}}},this.Zf=e,this.Hf=n,this.cn=s,this.Xf()}S(){this.gf!==null&&(this.gf(),this.gf=null),this.Mf!==null&&(this.Mf(),this.Mf=null),this.Sf!==null&&(this.Sf(),this.Sf=null),this.kf!==null&&(this.kf(),this.kf=null),this.yf!==null&&(this.yf(),this.yf=null),this.xf!==null&&(this.xf(),this.xf=null),this.Kf(),this.Yf()}Gf(e){this.Sf&&this.Sf();const n=this.Jf.bind(this);if(this.Sf=()=>{this.Zf.removeEventListener("mousemove",n)},this.Zf.addEventListener("mousemove",n),this.Lf(e))return;const s=this.Ef(e);this.Uf(s,this.Hf.Qf),this.Bf=!0}Yf(){this.lf!==null&&clearTimeout(this.lf),this.hf=0,this.lf=null,this.af={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}$f(){this.uf!==null&&clearTimeout(this.uf),this._f=0,this.uf=null,this.cf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Jf(e){if(this.Df||this.pf!==null||this.Lf(e))return;const n=this.Ef(e);this.Uf(n,this.Hf.tv),this.Bf=!0}iv(e){const n=Hy(e.changedTouches,he(this.Of));if(n===null||(this.Vf=Hp(e),this.Cf!==null)||this.Rf)return;this.Pf=!0;const s=this.Ff(ii(n),he(this.pf)),{nv:r,sv:i,Nf:o}=s;if(this.mf||!(o<5)){if(!this.mf){const a=.5*r,l=i>=a&&!this.cn.ev(),c=a>i&&!this.cn.rv();l||c||(this.Rf=!0),this.mf=!0,this.wf=!0,this.Kf(),this.$f()}if(!this.Rf){const a=this.Ef(e,n);this.Wf(a,this.Hf.hv),Zl(e)}}}lv(e){if(e.button!==0)return;const n=this.Ff(ii(e),he(this.vf)),{Nf:s}=n;if(s>=5&&(this.bf=!0,this.Yf()),this.bf){const r=this.Ef(e);this.Uf(r,this.Hf.av)}}Ff(e,n){const s=Math.abs(n.nt-e.nt),r=Math.abs(n.st-e.st);return{nv:s,sv:r,Nf:s+r}}ov(e){let n=Hy(e.changedTouches,he(this.Of));if(n===null&&e.touches.length===0&&(n=e.changedTouches[0]),n===null)return;this.Of=null,this.Vf=Hp(e),this.Kf(),this.pf=null,this.yf&&(this.yf(),this.yf=null);const s=this.Ef(e,n);if(this.Wf(s,this.Hf._v),++this._f,this.uf&&this._f>1){const{Nf:r}=this.Ff(ii(n),this.cf);r<30&&!this.wf&&this.Wf(s,this.Hf.jf),this.$f()}else this.wf||(this.Wf(s,this.Hf.uv),this.Hf.uv&&Zl(e));this._f===0&&Zl(e),e.touches.length===0&&this.ff&&(this.ff=!1,Zl(e))}If(e){if(e.button!==0)return;const n=this.Ef(e);if(this.vf=null,this.Df=!1,this.kf&&(this.kf(),this.kf=null),_2()&&this.Zf.ownerDocument.documentElement.removeEventListener("mouseleave",this.Af),!this.Lf(e))if(this.Uf(n,this.Hf.cv),++this.hf,this.lf&&this.hf>1){const{Nf:s}=this.Ff(ii(e),this.af);s<5&&!this.bf&&this.Uf(n,this.Hf.qf),this.Yf()}else this.bf||this.Uf(n,this.Hf.dv)}Kf(){this.df!==null&&(clearTimeout(this.df),this.df=null)}fv(e){if(this.Of!==null)return;const n=e.changedTouches[0];this.Of=n.identifier,this.Vf=Hp(e);const s=this.Zf.ownerDocument.documentElement;this.wf=!1,this.mf=!1,this.Rf=!1,this.pf=ii(n),this.yf&&(this.yf(),this.yf=null);{const i=this.iv.bind(this),o=this.ov.bind(this);this.yf=()=>{s.removeEventListener("touchmove",i),s.removeEventListener("touchend",o)},s.addEventListener("touchmove",i,{passive:!1}),s.addEventListener("touchend",o,{passive:!1}),this.Kf(),this.df=setTimeout(this.vv.bind(this,e),240)}const r=this.Ef(e,n);this.Wf(r,this.Hf.pv),this.uf||(this._f=0,this.uf=setTimeout(this.$f.bind(this),500),this.cf=ii(n))}mv(e){if(e.button!==0)return;const n=this.Zf.ownerDocument.documentElement;_2()&&n.addEventListener("mouseleave",this.Af),this.bf=!1,this.vf=ii(e),this.kf&&(this.kf(),this.kf=null);{const r=this.lv.bind(this),i=this.If.bind(this);this.kf=()=>{n.removeEventListener("mousemove",r),n.removeEventListener("mouseup",i)},n.addEventListener("mousemove",r),n.addEventListener("mouseup",i)}if(this.Df=!0,this.Lf(e))return;const s=this.Ef(e);this.Uf(s,this.Hf.bv),this.lf||(this.hf=0,this.lf=setTimeout(this.Yf.bind(this),500),this.af=ii(e))}Xf(){this.Zf.addEventListener("mouseenter",this.Gf.bind(this)),this.Zf.addEventListener("touchcancel",this.Kf.bind(this));{const e=this.Zf.ownerDocument,n=s=>{this.Hf.wv&&(s.composed&&this.Zf.contains(s.composedPath()[0])||s.target&&this.Zf.contains(s.target)||this.Hf.wv())};this.Mf=()=>{e.removeEventListener("touchstart",n)},this.gf=()=>{e.removeEventListener("mousedown",n)},e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!0})}Wy()&&(this.xf=()=>{this.Zf.removeEventListener("dblclick",this.zf)},this.Zf.addEventListener("dblclick",this.zf)),this.Zf.addEventListener("mouseleave",this.gv.bind(this)),this.Zf.addEventListener("touchstart",this.fv.bind(this),{passive:!0}),XY(this.Zf),this.Zf.addEventListener("mousedown",this.mv.bind(this)),this.Mv(),this.Zf.addEventListener("touchmove",()=>{},{passive:!1})}Mv(){this.Hf.xv===void 0&&this.Hf.Sv===void 0&&this.Hf.kv===void 0||(this.Zf.addEventListener("touchstart",e=>this.yv(e.touches),{passive:!0}),this.Zf.addEventListener("touchmove",e=>{if(e.touches.length===2&&this.Cf!==null&&this.Hf.Sv!==void 0){const n=P2(e.touches[0],e.touches[1])/this.Tf;this.Hf.Sv(this.Cf,n),Zl(e)}},{passive:!1}),this.Zf.addEventListener("touchend",e=>{this.yv(e.touches)}))}yv(e){e.length===1&&(this.Pf=!1),e.length!==2||this.Pf||this.ff?this.Cv():this.Tv(e)}Tv(e){const n=this.Zf.getBoundingClientRect()||{left:0,top:0};this.Cf={nt:(e[0].clientX-n.left+(e[1].clientX-n.left))/2,st:(e[0].clientY-n.top+(e[1].clientY-n.top))/2},this.Tf=P2(e[0],e[1]),this.Hf.xv!==void 0&&this.Hf.xv(),this.Kf()}Cv(){this.Cf!==null&&(this.Cf=null,this.Hf.kv!==void 0&&this.Hf.kv())}gv(e){if(this.Sf&&this.Sf(),this.Lf(e)||!this.Bf)return;const n=this.Ef(e);this.Uf(n,this.Hf.Pv),this.Bf=!Wy()}vv(e){const n=Hy(e.touches,he(this.Of));if(n===null)return;const s=this.Ef(e,n);this.Wf(s,this.Hf.Rv),this.wf=!0,this.ff=!0}Lf(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents!==void 0?e.sourceCapabilities.firesTouchEvents:Hp(e)<this.Vf+500}Wf(e,n){n&&n.call(this.Hf,e)}Uf(e,n){n&&n.call(this.Hf,e)}Ef(e,n){const s=n||e,r=this.Zf.getBoundingClientRect()||{left:0,top:0};return{clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,screenX:s.screenX,screenY:s.screenY,localX:s.clientX-r.left,localY:s.clientY-r.top,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,Dv:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click",Vv:e.type,Ov:s.target,Bv:e.view,Av:()=>{e.type!=="touchstart"&&Zl(e)}}}}function P2(t,e){const n=t.clientX-e.clientX,s=t.clientY-e.clientY;return Math.sqrt(n*n+s*s)}function Zl(t){t.cancelable&&t.preventDefault()}function ii(t){return{nt:t.pageX,st:t.pageY}}function Hp(t){return t.timeStamp||performance.now()}function Hy(t,e){for(let n=0;n<t.length;++n)if(t[n].identifier===e)return t[n];return null}function Kp(t){return{Hc:t.Hc,Iv:{gr:t.zv.externalId},Lv:t.zv.cursorStyle}}function qY(t,e,n){for(const s of t){const r=s.gt();if(r!==null&&r.wr){const i=r.wr(e,n);if(i!==null)return{Bv:s,Iv:i}}}return null}function Ky(t,e){return n=>{var s,r,i,o;return((r=(s=n.Dt())===null||s===void 0?void 0:s.Pa())!==null&&r!==void 0?r:"")!==e?[]:(o=(i=n.da)===null||i===void 0?void 0:i.call(n,t))!==null&&o!==void 0?o:[]}}function F2(t,e,n,s){if(!t.length)return;let r=0;const i=n/2,o=t[0].At(s,!0);let a=e===1?i-(t[0].Vi()-o/2):t[0].Vi()-o/2-i;a=Math.max(0,a);for(let l=1;l<t.length;l++){const c=t[l],u=t[l-1],h=u.At(s,!1),d=c.Vi(),f=u.Vi();if(e===1?d>f-h:d<f+h){const p=f-h*e;c.Oi(p);const m=p-e*h/2;if((e===1?m<0:m>n)&&a>0){const v=e===1?-1-m:m-n,x=Math.min(v,a);for(let g=r;g<t.length;g++)t[g].Oi(t[g].Vi()+e*x);a-=x}}else r=l,a=e===1?f-h-d:d-(f+h)}}class O2{constructor(e,n,s,r){this.Li=null,this.Ev=null,this.Nv=!1,this.Fv=new pd(200),this.Qr=null,this.Wv=0,this.jv=!1,this.Hv=()=>{this.jv||this.tn.$v().$t().Uh()},this.Uv=()=>{this.jv||this.tn.$v().$t().Uh()},this.tn=e,this.cn=n,this.ko=n.layout,this.Oc=s,this.qv=r==="left",this.Yv=Ky("normal",r),this.Zv=Ky("top",r),this.Xv=Ky("bottom",r),this.Kv=document.createElement("div"),this.Kv.style.height="100%",this.Kv.style.overflow="hidden",this.Kv.style.width="25px",this.Kv.style.left="0",this.Kv.style.position="relative",this.Gv=hl(this.Kv,Et({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);const i=this.Gv.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Jv=hl(this.Kv,Et({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);const o=this.Jv.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const a={bv:this.Qv.bind(this),pv:this.Qv.bind(this),av:this.tp.bind(this),hv:this.tp.bind(this),wv:this.ip.bind(this),cv:this.np.bind(this),_v:this.np.bind(this),qf:this.sp.bind(this),jf:this.sp.bind(this),Qf:this.ep.bind(this),Pv:this.rp.bind(this)};this.hp=new LS(this.Jv.canvasElement,a,{ev:()=>!this.cn.handleScroll.vertTouchDrag,rv:()=>!0})}S(){this.hp.S(),this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),dl(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),dl(this.Gv.canvasElement),this.Gv.dispose(),this.Li!==null&&this.Li.Ko().p(this),this.Li=null}lp(){return this.Kv}P(){return this.ko.fontSize}ap(){const e=this.Oc.W();return this.Qr!==e.R&&(this.Fv.nr(),this.Qr=e.R),e}op(){if(this.Li===null)return 0;let e=0;const n=this.ap(),s=he(this.Gv.canvasElement.getContext("2d"));s.save();const r=this.Li.Ha();s.font=this._p(),r.length>0&&(e=Math.max(this.Fv.xi(s,r[0].so),this.Fv.xi(s,r[r.length-1].so)));const i=this.up();for(let c=i.length;c--;){const u=this.Fv.xi(s,i[c].Kt());u>e&&(e=u)}const o=this.Li.Ct();if(o!==null&&this.Ev!==null&&(a=this.cn.crosshair).mode!==2&&a.horzLine.visible&&a.horzLine.labelVisible){const c=this.Li.pn(1,o),u=this.Li.pn(this.Ev.height-2,o);e=Math.max(e,this.Fv.xi(s,this.Li.Fi(Math.floor(Math.min(c,u))+.11111111111111,o)),this.Fv.xi(s,this.Li.Fi(Math.ceil(Math.max(c,u))-.11111111111111,o)))}var a;s.restore();const l=e||34;return Yw(Math.ceil(n.C+n.T+n.A+n.I+5+l))}cp(e){this.Ev!==null&&el(this.Ev,e)||(this.Ev=e,this.jv=!0,this.Gv.resizeCanvasElement(e),this.Jv.resizeCanvasElement(e),this.jv=!1,this.Kv.style.width=`${e.width}px`,this.Kv.style.height=`${e.height}px`)}dp(){return he(this.Ev).width}Gi(e){this.Li!==e&&(this.Li!==null&&this.Li.Ko().p(this),this.Li=e,e.Ko().l(this.fo.bind(this),this))}Dt(){return this.Li}nr(){const e=this.tn.fp();this.tn.$v().$t().E_(e,he(this.Dt()))}vp(e){if(this.Ev===null)return;if(e!==1){this.pp(),this.Gv.applySuggestedBitmapSize();const s=cl(this.Gv);s!==null&&(s.useBitmapCoordinateSpace(r=>{this.mp(r),this.Ie(r)}),this.tn.bp(s,this.Xv),this.wp(s),this.tn.bp(s,this.Yv),this.gp(s))}this.Jv.applySuggestedBitmapSize();const n=cl(this.Jv);n!==null&&(n.useBitmapCoordinateSpace(({context:s,bitmapSize:r})=>{s.clearRect(0,0,r.width,r.height)}),this.Mp(n),this.tn.bp(n,this.Zv))}xp(){return this.Gv.bitmapSize}Sp(e,n,s){const r=this.xp();r.width>0&&r.height>0&&e.drawImage(this.Gv.canvasElement,n,s)}bt(){var e;(e=this.Li)===null||e===void 0||e.Ha()}Qv(e){if(this.Li===null||this.Li.Ni()||!this.cn.handleScale.axisPressedMouseMove.price)return;const n=this.tn.$v().$t(),s=this.tn.fp();this.Nv=!0,n.V_(s,this.Li,e.localY)}tp(e){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const n=this.tn.$v().$t(),s=this.tn.fp(),r=this.Li;n.O_(s,r,e.localY)}ip(){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.$v().$t(),n=this.tn.fp(),s=this.Li;this.Nv&&(this.Nv=!1,e.B_(n,s))}np(e){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const n=this.tn.$v().$t(),s=this.tn.fp();this.Nv=!1,n.B_(s,this.Li)}sp(e){this.cn.handleScale.axisDoubleClickReset.price&&this.nr()}ep(e){this.Li!==null&&(!this.tn.$v().$t().W().handleScale.axisPressedMouseMove.price||this.Li.Mh()||this.Li.Oo()||this.kp(1))}rp(e){this.kp(0)}up(){const e=[],n=this.Li===null?void 0:this.Li;return(s=>{for(let r=0;r<s.length;++r){const i=s[r].Rn(this.tn.fp(),n);for(let o=0;o<i.length;o++)e.push(i[o])}})(this.tn.fp().Uo()),e}mp({context:e,bitmapSize:n}){const{width:s,height:r}=n,i=this.tn.fp().$t(),o=i.q(),a=i.bd();o===a?Vx(e,0,0,s,r,o):NO(e,0,0,s,r,o,a)}Ie({context:e,bitmapSize:n,horizontalPixelRatio:s}){if(this.Ev===null||this.Li===null||!this.Li.W().borderVisible)return;e.fillStyle=this.Li.W().borderColor;const r=Math.max(1,Math.floor(this.ap().C*s));let i;i=this.qv?n.width-r:0,e.fillRect(i,0,r,n.height)}wp(e){if(this.Ev===null||this.Li===null)return;const n=this.Li.Ha(),s=this.Li.W(),r=this.ap(),i=this.qv?this.Ev.width-r.T:0;s.borderVisible&&s.ticksVisible&&e.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:a,verticalPixelRatio:l})=>{o.fillStyle=s.borderColor;const c=Math.max(1,Math.floor(l)),u=Math.floor(.5*l),h=Math.round(r.T*a);o.beginPath();for(const d of n)o.rect(Math.floor(i*a),Math.round(d.Ea*l)-u,h,c);o.fill()}),e.useMediaCoordinateSpace(({context:o})=>{var a;o.font=this._p(),o.fillStyle=(a=s.textColor)!==null&&a!==void 0?a:this.ko.textColor,o.textAlign=this.qv?"right":"left",o.textBaseline="middle";const l=this.qv?Math.round(i-r.A):Math.round(i+r.T+r.A),c=n.map(u=>this.Fv.Mi(o,u.so));for(let u=n.length;u--;){const h=n[u];o.fillText(h.so,l,h.Ea+c[u])}})}pp(){if(this.Ev===null||this.Li===null)return;const e=[],n=this.Li.Uo().slice(),s=this.tn.fp(),r=this.ap();this.Li===s.pr()&&this.tn.fp().Uo().forEach(o=>{s.vr(o)&&n.push(o)});const i=this.Li;n.forEach(o=>{o.Rn(s,i).forEach(a=>{a.Oi(null),a.Bi()&&e.push(a)})}),e.forEach(o=>o.Oi(o.ki())),this.Li.W().alignLabels&&this.yp(e,r)}yp(e,n){if(this.Ev===null)return;const s=this.Ev.height/2,r=e.filter(o=>o.ki()<=s),i=e.filter(o=>o.ki()>s);r.sort((o,a)=>a.ki()-o.ki()),i.sort((o,a)=>o.ki()-a.ki());for(const o of e){const a=Math.floor(o.At(n)/2),l=o.ki();l>-a&&l<a&&o.Oi(a),l>this.Ev.height-a&&l<this.Ev.height+a&&o.Oi(this.Ev.height-a)}F2(r,1,this.Ev.height,n),F2(i,-1,this.Ev.height,n)}gp(e){if(this.Ev===null)return;const n=this.up(),s=this.ap(),r=this.qv?"right":"left";n.forEach(i=>{i.Ai()&&i.gt(he(this.Li)).X(e,s,this.Fv,r)})}Mp(e){if(this.Ev===null||this.Li===null)return;const n=this.tn.$v().$t(),s=[],r=this.tn.fp(),i=n.Zc().Rn(r,this.Li);i.length&&s.push(i);const o=this.ap(),a=this.qv?"right":"left";s.forEach(l=>{l.forEach(c=>{c.gt(he(this.Li)).X(e,o,this.Fv,a)})})}kp(e){this.Kv.style.cursor=e===1?"ns-resize":"default"}fo(){const e=this.op();this.Wv<e&&this.tn.$v().$t().Kl(),this.Wv=e}_p(){return Zc(this.ko.fontSize,this.ko.fontFamily)}}function YY(t,e){var n,s;return(s=(n=t.ua)===null||n===void 0?void 0:n.call(t,e))!==null&&s!==void 0?s:[]}function Xp(t,e){var n,s;return(s=(n=t.Pn)===null||n===void 0?void 0:n.call(t,e))!==null&&s!==void 0?s:[]}function QY(t,e){var n,s;return(s=(n=t.Ji)===null||n===void 0?void 0:n.call(t,e))!==null&&s!==void 0?s:[]}function ZY(t,e){var n,s;return(s=(n=t.aa)===null||n===void 0?void 0:n.call(t,e))!==null&&s!==void 0?s:[]}class zS{constructor(e,n){this.Ev=Et({width:0,height:0}),this.Cp=null,this.Tp=null,this.Pp=null,this.Rp=null,this.Dp=!1,this.Vp=new tn,this.Op=new tn,this.Bp=0,this.Ap=!1,this.Ip=null,this.zp=!1,this.Lp=null,this.Ep=null,this.jv=!1,this.Hv=()=>{this.jv||this.Np===null||this.$i().Uh()},this.Uv=()=>{this.jv||this.Np===null||this.$i().Uh()},this.Qd=e,this.Np=n,this.Np.W_().l(this.Fp.bind(this),this,!0),this.Wp=document.createElement("td"),this.Wp.style.padding="0",this.Wp.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.jp=document.createElement("td"),this.jp.style.padding="0",this.Hp=document.createElement("td"),this.Hp.style.padding="0",this.Wp.appendChild(s),this.Gv=hl(s,Et({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);const r=this.Gv.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Jv=hl(s,Et({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);const i=this.Jv.canvasElement;i.style.position="absolute",i.style.zIndex="2",i.style.left="0",i.style.top="0",this.$p=document.createElement("tr"),this.$p.appendChild(this.jp),this.$p.appendChild(this.Wp),this.$p.appendChild(this.Hp),this.Up(),this.hp=new LS(this.Jv.canvasElement,this,{ev:()=>this.Ip===null&&!this.Qd.W().handleScroll.vertTouchDrag,rv:()=>this.Ip===null&&!this.Qd.W().handleScroll.horzTouchDrag})}S(){this.Cp!==null&&this.Cp.S(),this.Tp!==null&&this.Tp.S(),this.Pp=null,this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),dl(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),dl(this.Gv.canvasElement),this.Gv.dispose(),this.Np!==null&&this.Np.W_().p(this),this.hp.S()}fp(){return he(this.Np)}qp(e){var n,s;this.Np!==null&&this.Np.W_().p(this),this.Np=e,this.Np!==null&&this.Np.W_().l(zS.prototype.Fp.bind(this),this,!0),this.Up(),this.Qd.Yp().indexOf(this)===this.Qd.Yp().length-1?(this.Pp=(n=this.Pp)!==null&&n!==void 0?n:new KY(this.Wp,this.Qd),this.Pp.bt()):((s=this.Pp)===null||s===void 0||s.if(),this.Pp=null)}$v(){return this.Qd}lp(){return this.$p}Up(){if(this.Np!==null&&(this.Zp(),this.$i().wt().length!==0)){if(this.Cp!==null){const e=this.Np.R_();this.Cp.Gi(he(e))}if(this.Tp!==null){const e=this.Np.D_();this.Tp.Gi(he(e))}}}Xp(){this.Cp!==null&&this.Cp.bt(),this.Tp!==null&&this.Tp.bt()}M_(){return this.Np!==null?this.Np.M_():0}x_(e){this.Np&&this.Np.x_(e)}Qf(e){if(!this.Np)return;this.Kp();const n=e.localX,s=e.localY;this.Gp(n,s,e)}bv(e){this.Kp(),this.Jp(),this.Gp(e.localX,e.localY,e)}tv(e){var n;if(!this.Np)return;this.Kp();const s=e.localX,r=e.localY;this.Gp(s,r,e);const i=this.wr(s,r);this.Qd.Qp((n=i==null?void 0:i.Lv)!==null&&n!==void 0?n:null),this.$i().jc(i&&{Hc:i.Hc,Iv:i.Iv})}dv(e){this.Np!==null&&(this.Kp(),this.tm(e))}qf(e){this.Np!==null&&this.im(this.Op,e)}jf(e){this.qf(e)}av(e){this.Kp(),this.nm(e),this.Gp(e.localX,e.localY,e)}cv(e){this.Np!==null&&(this.Kp(),this.Ap=!1,this.sm(e))}uv(e){this.Np!==null&&this.tm(e)}Rv(e){if(this.Ap=!0,this.Ip===null){const n={x:e.localX,y:e.localY};this.rm(n,n,e)}}Pv(e){this.Np!==null&&(this.Kp(),this.Np.$t().jc(null),this.hm())}lm(){return this.Vp}am(){return this.Op}xv(){this.Bp=1,this.$i().Un()}Sv(e,n){if(!this.Qd.W().handleScale.pinch)return;const s=5*(n-this.Bp);this.Bp=n,this.$i().Qc(e.nt,s)}pv(e){this.Ap=!1,this.zp=this.Ip!==null,this.Jp();const n=this.$i().Zc();this.Ip!==null&&n.yt()&&(this.Lp={x:n.Yt(),y:n.Zt()},this.Ip={x:e.localX,y:e.localY})}hv(e){if(this.Np===null)return;const n=e.localX,s=e.localY;if(this.Ip===null)this.nm(e);else{this.zp=!1;const r=he(this.Lp),i=r.x+(n-this.Ip.x),o=r.y+(s-this.Ip.y);this.Gp(i,o,e)}}_v(e){this.$v().W().trackingMode.exitMode===0&&(this.zp=!0),this.om(),this.sm(e)}wr(e,n){const s=this.Np;return s===null?null:function(r,i,o){const a=r.Uo(),l=function(c,u,h){var d,f;let p,m;for(const g of c){const y=(f=(d=g.va)===null||d===void 0?void 0:d.call(g,u,h))!==null&&f!==void 0?f:[];for(const b of y)v=b.zOrder,(!(x=p==null?void 0:p.zOrder)||v==="top"&&x!=="top"||v==="normal"&&x==="bottom")&&(p=b,m=g)}var v,x;return p&&m?{zv:p,Hc:m}:null}(a,i,o);if((l==null?void 0:l.zv.zOrder)==="top")return Kp(l);for(const c of a){if(l&&l.Hc===c&&l.zv.zOrder!=="bottom"&&!l.zv.isBackground)return Kp(l);const u=qY(c.Pn(r),i,o);if(u!==null)return{Hc:c,Bv:u.Bv,Iv:u.Iv};if(l&&l.Hc===c&&l.zv.zOrder!=="bottom"&&l.zv.isBackground)return Kp(l)}return l!=null&&l.zv?Kp(l):null}(s,e,n)}_m(e,n){he(n==="left"?this.Cp:this.Tp).cp(Et({width:e,height:this.Ev.height}))}um(){return this.Ev}cp(e){el(this.Ev,e)||(this.Ev=e,this.jv=!0,this.Gv.resizeCanvasElement(e),this.Jv.resizeCanvasElement(e),this.jv=!1,this.Wp.style.width=e.width+"px",this.Wp.style.height=e.height+"px")}dm(){const e=he(this.Np);e.P_(e.R_()),e.P_(e.D_());for(const n of e.Ba())if(e.vr(n)){const s=n.Dt();s!==null&&e.P_(s),n.Vn()}}xp(){return this.Gv.bitmapSize}Sp(e,n,s){const r=this.xp();r.width>0&&r.height>0&&e.drawImage(this.Gv.canvasElement,n,s)}vp(e){if(e===0||this.Np===null)return;if(e>1&&this.dm(),this.Cp!==null&&this.Cp.vp(e),this.Tp!==null&&this.Tp.vp(e),e!==1){this.Gv.applySuggestedBitmapSize();const s=cl(this.Gv);s!==null&&(s.useBitmapCoordinateSpace(r=>{this.mp(r)}),this.Np&&(this.fm(s,YY),this.vm(s),this.pm(s),this.fm(s,Xp),this.fm(s,QY)))}this.Jv.applySuggestedBitmapSize();const n=cl(this.Jv);n!==null&&(n.useBitmapCoordinateSpace(({context:s,bitmapSize:r})=>{s.clearRect(0,0,r.width,r.height)}),this.bm(n),this.fm(n,ZY))}wm(){return this.Cp}gm(){return this.Tp}bp(e,n){this.fm(e,n)}Fp(){this.Np!==null&&this.Np.W_().p(this),this.Np=null}tm(e){this.im(this.Vp,e)}im(e,n){const s=n.localX,r=n.localY;e.M()&&e.m(this.$i().St().Nu(s),{x:s,y:r},n)}mp({context:e,bitmapSize:n}){const{width:s,height:r}=n,i=this.$i(),o=i.q(),a=i.bd();o===a?Vx(e,0,0,s,r,a):NO(e,0,0,s,r,o,a)}vm(e){const n=he(this.Np).j_().qh().gt();n!==null&&n.X(e,!1)}pm(e){const n=this.$i().Yc();this.Mm(e,Xp,Qw,n),this.Mm(e,Xp,Fm,n)}bm(e){this.Mm(e,Xp,Fm,this.$i().Zc())}fm(e,n){const s=he(this.Np).Uo();for(const r of s)this.Mm(e,n,Qw,r);for(const r of s)this.Mm(e,n,Fm,r)}Mm(e,n,s,r){const i=he(this.Np),o=i.$t().Wc(),a=o!==null&&o.Hc===r,l=o!==null&&a&&o.Iv!==void 0?o.Iv.Mr:void 0;Zw(n,c=>s(c,e,a,l),r,i)}Zp(){if(this.Np===null)return;const e=this.Qd,n=this.Np.R_().W().visible,s=this.Np.D_().W().visible;n||this.Cp===null||(this.jp.removeChild(this.Cp.lp()),this.Cp.S(),this.Cp=null),s||this.Tp===null||(this.Hp.removeChild(this.Tp.lp()),this.Tp.S(),this.Tp=null);const r=e.$t().ud();n&&this.Cp===null&&(this.Cp=new O2(this,e.W(),r,"left"),this.jp.appendChild(this.Cp.lp())),s&&this.Tp===null&&(this.Tp=new O2(this,e.W(),r,"right"),this.Hp.appendChild(this.Tp.lp()))}xm(e){return e.Dv&&this.Ap||this.Ip!==null}Sm(e){return Math.max(0,Math.min(e,this.Ev.width-1))}km(e){return Math.max(0,Math.min(e,this.Ev.height-1))}Gp(e,n,s){this.$i().ld(this.Sm(e),this.km(n),s,he(this.Np))}hm(){this.$i().od()}om(){this.zp&&(this.Ip=null,this.hm())}rm(e,n,s){this.Ip=e,this.zp=!1,this.Gp(n.x,n.y,s);const r=this.$i().Zc();this.Lp={x:r.Yt(),y:r.Zt()}}$i(){return this.Qd.$t()}sm(e){if(!this.Dp)return;const n=this.$i(),s=this.fp();if(n.z_(s,s.vn()),this.Rp=null,this.Dp=!1,n.ed(),this.Ep!==null){const r=performance.now(),i=n.St();this.Ep.Vr(i.Hu(),r),this.Ep.Qu(r)||n.Zn(this.Ep)}}Kp(){this.Ip=null}Jp(){if(this.Np){if(this.$i().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)he(document.activeElement).blur();else{const e=document.getSelection();e!==null&&e.removeAllRanges()}!this.Np.vn().Ni()&&this.$i().St().Ni()}}nm(e){if(this.Np===null)return;const n=this.$i(),s=n.St();if(s.Ni())return;const r=this.Qd.W(),i=r.handleScroll,o=r.kineticScroll;if((!i.pressedMouseMove||e.Dv)&&(!i.horzTouchDrag&&!i.vertTouchDrag||!e.Dv))return;const a=this.Np.vn(),l=performance.now();if(this.Rp!==null||this.xm(e)||(this.Rp={x:e.clientX,y:e.clientY,Od:l,ym:e.localX,Cm:e.localY}),this.Rp!==null&&!this.Dp&&(this.Rp.x!==e.clientX||this.Rp.y!==e.clientY)){if(e.Dv&&o.touch||!e.Dv&&o.mouse){const c=s.le();this.Ep=new HY(.2/c,7/c,.997,15/c),this.Ep.Yd(s.Hu(),this.Rp.Od)}else this.Ep=null;a.Ni()||n.A_(this.Np,a,e.localY),n.nd(e.localX),this.Dp=!0}this.Dp&&(a.Ni()||n.I_(this.Np,a,e.localY),n.sd(e.localX),this.Ep!==null&&this.Ep.Yd(s.Hu(),l))}}class M2{constructor(e,n,s,r,i){this.ft=!0,this.Ev=Et({width:0,height:0}),this.Hv=()=>this.vp(3),this.qv=e==="left",this.Oc=s.ud,this.cn=n,this.Tm=r,this.Pm=i,this.Kv=document.createElement("div"),this.Kv.style.width="25px",this.Kv.style.height="100%",this.Kv.style.overflow="hidden",this.Gv=hl(this.Kv,Et({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv)}S(){this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),dl(this.Gv.canvasElement),this.Gv.dispose()}lp(){return this.Kv}um(){return this.Ev}cp(e){el(this.Ev,e)||(this.Ev=e,this.Gv.resizeCanvasElement(e),this.Kv.style.width=`${e.width}px`,this.Kv.style.height=`${e.height}px`,this.ft=!0)}vp(e){if(e<3&&!this.ft||this.Ev.width===0||this.Ev.height===0)return;this.ft=!1,this.Gv.applySuggestedBitmapSize();const n=cl(this.Gv);n!==null&&n.useBitmapCoordinateSpace(s=>{this.mp(s),this.Ie(s)})}xp(){return this.Gv.bitmapSize}Sp(e,n,s){const r=this.xp();r.width>0&&r.height>0&&e.drawImage(this.Gv.canvasElement,n,s)}Ie({context:e,bitmapSize:n,horizontalPixelRatio:s,verticalPixelRatio:r}){if(!this.Tm())return;e.fillStyle=this.cn.timeScale.borderColor;const i=Math.floor(this.Oc.W().C*s),o=Math.floor(this.Oc.W().C*r),a=this.qv?n.width-i:0;e.fillRect(a,0,i,o)}mp({context:e,bitmapSize:n}){Vx(e,0,0,n.width,n.height,this.Pm())}}function VS(t){return e=>{var n,s;return(s=(n=e.fa)===null||n===void 0?void 0:n.call(e,t))!==null&&s!==void 0?s:[]}}const JY=VS("normal"),eQ=VS("top"),tQ=VS("bottom");class nQ{constructor(e,n){this.Rm=null,this.Dm=null,this.k=null,this.Vm=!1,this.Ev=Et({width:0,height:0}),this.Om=new tn,this.Fv=new pd(5),this.jv=!1,this.Hv=()=>{this.jv||this.Qd.$t().Uh()},this.Uv=()=>{this.jv||this.Qd.$t().Uh()},this.Qd=e,this.q_=n,this.cn=e.W().layout,this.Xd=document.createElement("tr"),this.Bm=document.createElement("td"),this.Bm.style.padding="0",this.Am=document.createElement("td"),this.Am.style.padding="0",this.Kv=document.createElement("td"),this.Kv.style.height="25px",this.Kv.style.padding="0",this.Im=document.createElement("div"),this.Im.style.width="100%",this.Im.style.height="100%",this.Im.style.position="relative",this.Im.style.overflow="hidden",this.Kv.appendChild(this.Im),this.Gv=hl(this.Im,Et({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);const s=this.Gv.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Jv=hl(this.Im,Et({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);const r=this.Jv.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Xd.appendChild(this.Bm),this.Xd.appendChild(this.Kv),this.Xd.appendChild(this.Am),this.zm(),this.Qd.$t().g_().l(this.zm.bind(this),this),this.hp=new LS(this.Jv.canvasElement,this,{ev:()=>!0,rv:()=>!this.Qd.W().handleScroll.horzTouchDrag})}S(){this.hp.S(),this.Rm!==null&&this.Rm.S(),this.Dm!==null&&this.Dm.S(),this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),dl(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),dl(this.Gv.canvasElement),this.Gv.dispose()}lp(){return this.Xd}Lm(){return this.Rm}Em(){return this.Dm}bv(e){if(this.Vm)return;this.Vm=!0;const n=this.Qd.$t();!n.St().Ni()&&this.Qd.W().handleScale.axisPressedMouseMove.time&&n.Jc(e.localX)}pv(e){this.bv(e)}wv(){const e=this.Qd.$t();!e.St().Ni()&&this.Vm&&(this.Vm=!1,this.Qd.W().handleScale.axisPressedMouseMove.time&&e.hd())}av(e){const n=this.Qd.$t();!n.St().Ni()&&this.Qd.W().handleScale.axisPressedMouseMove.time&&n.rd(e.localX)}hv(e){this.av(e)}cv(){this.Vm=!1;const e=this.Qd.$t();e.St().Ni()&&!this.Qd.W().handleScale.axisPressedMouseMove.time||e.hd()}_v(){this.cv()}qf(){this.Qd.W().handleScale.axisDoubleClickReset.time&&this.Qd.$t().Kn()}jf(){this.qf()}Qf(){this.Qd.$t().W().handleScale.axisPressedMouseMove.time&&this.kp(1)}Pv(){this.kp(0)}um(){return this.Ev}Nm(){return this.Om}Fm(e,n,s){el(this.Ev,e)||(this.Ev=e,this.jv=!0,this.Gv.resizeCanvasElement(e),this.Jv.resizeCanvasElement(e),this.jv=!1,this.Kv.style.width=`${e.width}px`,this.Kv.style.height=`${e.height}px`,this.Om.m(e)),this.Rm!==null&&this.Rm.cp(Et({width:n,height:e.height})),this.Dm!==null&&this.Dm.cp(Et({width:s,height:e.height}))}Wm(){const e=this.jm();return Math.ceil(e.C+e.T+e.P+e.L+e.B+e.Hm)}bt(){this.Qd.$t().St().Ha()}xp(){return this.Gv.bitmapSize}Sp(e,n,s){const r=this.xp();r.width>0&&r.height>0&&e.drawImage(this.Gv.canvasElement,n,s)}vp(e){if(e===0)return;if(e!==1){this.Gv.applySuggestedBitmapSize();const s=cl(this.Gv);s!==null&&(s.useBitmapCoordinateSpace(r=>{this.mp(r),this.Ie(r),this.$m(s,tQ)}),this.wp(s),this.$m(s,JY)),this.Rm!==null&&this.Rm.vp(e),this.Dm!==null&&this.Dm.vp(e)}this.Jv.applySuggestedBitmapSize();const n=cl(this.Jv);n!==null&&(n.useBitmapCoordinateSpace(({context:s,bitmapSize:r})=>{s.clearRect(0,0,r.width,r.height)}),this.Um([...this.Qd.$t().wt(),this.Qd.$t().Zc()],n),this.$m(n,eQ))}$m(e,n){const s=this.Qd.$t().wt();for(const r of s)Zw(n,i=>Qw(i,e,!1,void 0),r,void 0);for(const r of s)Zw(n,i=>Fm(i,e,!1,void 0),r,void 0)}mp({context:e,bitmapSize:n}){Vx(e,0,0,n.width,n.height,this.Qd.$t().bd())}Ie({context:e,bitmapSize:n,verticalPixelRatio:s}){if(this.Qd.W().timeScale.borderVisible){e.fillStyle=this.qm();const r=Math.max(1,Math.floor(this.jm().C*s));e.fillRect(0,0,n.width,r)}}wp(e){const n=this.Qd.$t().St(),s=n.Ha();if(!s||s.length===0)return;const r=this.q_.maxTickMarkWeight(s),i=this.jm(),o=n.W();o.borderVisible&&o.ticksVisible&&e.useBitmapCoordinateSpace(({context:a,horizontalPixelRatio:l,verticalPixelRatio:c})=>{a.strokeStyle=this.qm(),a.fillStyle=this.qm();const u=Math.max(1,Math.floor(l)),h=Math.floor(.5*l);a.beginPath();const d=Math.round(i.T*c);for(let f=s.length;f--;){const p=Math.round(s[f].coord*l);a.rect(p-h,0,u,d)}a.fill()}),e.useMediaCoordinateSpace(({context:a})=>{const l=i.C+i.T+i.L+i.P/2;a.textAlign="center",a.textBaseline="middle",a.fillStyle=this.$(),a.font=this._p();for(const c of s)if(c.weight<r){const u=c.needAlignCoordinate?this.Ym(a,c.coord,c.label):c.coord;a.fillText(c.label,u,l)}this.Qd.W().timeScale.allowBoldLabels&&(a.font=this.Zm());for(const c of s)if(c.weight>=r){const u=c.needAlignCoordinate?this.Ym(a,c.coord,c.label):c.coord;a.fillText(c.label,u,l)}})}Ym(e,n,s){const r=this.Fv.xi(e,s),i=r/2,o=Math.floor(n-i)+.5;return o<0?n+=Math.abs(0-o):o+r>this.Ev.width&&(n-=Math.abs(this.Ev.width-(o+r))),n}Um(e,n){const s=this.jm();for(const r of e)for(const i of r.Qi())i.gt().X(n,s)}qm(){return this.Qd.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}_p(){return Zc(this.j(),this.cn.fontFamily)}Zm(){return Zc(this.j(),this.cn.fontFamily,"bold")}jm(){this.k===null&&(this.k={C:1,N:NaN,L:NaN,B:NaN,ji:NaN,T:5,P:NaN,R:"",Wi:new pd,Hm:0});const e=this.k,n=this._p();if(e.R!==n){const s=this.j();e.P=s,e.R=n,e.L=3*s/12,e.B=3*s/12,e.ji=9*s/12,e.N=0,e.Hm=4*s/12,e.Wi.nr()}return this.k}kp(e){this.Kv.style.cursor=e===1?"ew-resize":"default"}zm(){const e=this.Qd.$t(),n=e.W();n.leftPriceScale.visible||this.Rm===null||(this.Bm.removeChild(this.Rm.lp()),this.Rm.S(),this.Rm=null),n.rightPriceScale.visible||this.Dm===null||(this.Am.removeChild(this.Dm.lp()),this.Dm.S(),this.Dm=null);const s={ud:this.Qd.$t().ud()},r=()=>n.leftPriceScale.borderVisible&&e.St().W().borderVisible,i=()=>e.bd();n.leftPriceScale.visible&&this.Rm===null&&(this.Rm=new M2("left",n,s,r,i),this.Bm.appendChild(this.Rm.lp())),n.rightPriceScale.visible&&this.Dm===null&&(this.Dm=new M2("right",n,s,r,i),this.Am.appendChild(this.Dm.lp()))}}const sQ=!!Jc&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(t=>t.brand.includes("Chromium"))&&!!Jc&&(!((Xy=navigator==null?void 0:navigator.userAgentData)===null||Xy===void 0)&&Xy.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);var Xy;class rQ{constructor(e,n,s){var r;this.Xm=[],this.Km=0,this.ho=0,this.__=0,this.Gm=0,this.Jm=0,this.Qm=null,this.tb=!1,this.Vp=new tn,this.Op=new tn,this.Rc=new tn,this.ib=null,this.nb=null,this.Jd=e,this.cn=n,this.q_=s,this.Xd=document.createElement("div"),this.Xd.classList.add("tv-lightweight-charts"),this.Xd.style.overflow="hidden",this.Xd.style.direction="ltr",this.Xd.style.width="100%",this.Xd.style.height="100%",(r=this.Xd).style.userSelect="none",r.style.webkitUserSelect="none",r.style.msUserSelect="none",r.style.MozUserSelect="none",r.style.webkitTapHighlightColor="transparent",this.sb=document.createElement("table"),this.sb.setAttribute("cellspacing","0"),this.Xd.appendChild(this.sb),this.eb=this.rb.bind(this),qy(this.cn)&&this.hb(!0),this.$i=new BY(this.Vc.bind(this),this.cn,s),this.$t().Xc().l(this.lb.bind(this),this),this.ab=new nQ(this,this.q_),this.sb.appendChild(this.ab.lp());const i=n.autoSize&&this.ob();let o=this.cn.width,a=this.cn.height;if(i||o===0||a===0){const l=e.getBoundingClientRect();o=o||l.width,a=a||l.height}this._b(o,a),this.ub(),e.appendChild(this.Xd),this.cb(),this.$i.St().ec().l(this.$i.Kl.bind(this.$i),this),this.$i.g_().l(this.$i.Kl.bind(this.$i),this)}$t(){return this.$i}W(){return this.cn}Yp(){return this.Xm}fb(){return this.ab}S(){this.hb(!1),this.Km!==0&&window.cancelAnimationFrame(this.Km),this.$i.Xc().p(this),this.$i.St().ec().p(this),this.$i.g_().p(this),this.$i.S();for(const e of this.Xm)this.sb.removeChild(e.lp()),e.lm().p(this),e.am().p(this),e.S();this.Xm=[],he(this.ab).S(),this.Xd.parentElement!==null&&this.Xd.parentElement.removeChild(this.Xd),this.Rc.S(),this.Vp.S(),this.Op.S(),this.pb()}_b(e,n,s=!1){if(this.ho===n&&this.__===e)return;const r=function(a){const l=Math.floor(a.width),c=Math.floor(a.height);return Et({width:l-l%2,height:c-c%2})}(Et({width:e,height:n}));this.ho=r.height,this.__=r.width;const i=this.ho+"px",o=this.__+"px";he(this.Xd).style.height=i,he(this.Xd).style.width=o,this.sb.style.height=i,this.sb.style.width=o,s?this.mb(Fn.es(),performance.now()):this.$i.Kl()}vp(e){e===void 0&&(e=Fn.es());for(let n=0;n<this.Xm.length;n++)this.Xm[n].vp(e.Hn(n).Fn);this.cn.timeScale.visible&&this.ab.vp(e.jn())}$h(e){const n=qy(this.cn);this.$i.$h(e);const s=qy(this.cn);s!==n&&this.hb(s),this.cb(),this.bb(e)}lm(){return this.Vp}am(){return this.Op}Xc(){return this.Rc}wb(){this.Qm!==null&&(this.mb(this.Qm,performance.now()),this.Qm=null);const e=this.gb(null),n=document.createElement("canvas");n.width=e.width,n.height=e.height;const s=he(n.getContext("2d"));return this.gb(s),n}Mb(e){return e==="left"&&!this.xb()||e==="right"&&!this.Sb()||this.Xm.length===0?0:he(e==="left"?this.Xm[0].wm():this.Xm[0].gm()).dp()}kb(){return this.cn.autoSize&&this.ib!==null}yb(){return this.Xd}Qp(e){this.nb=e,this.nb?this.yb().style.setProperty("cursor",e):this.yb().style.removeProperty("cursor")}Cb(){return this.nb}Tb(){return hs(this.Xm[0]).um()}bb(e){(e.autoSize!==void 0||!this.ib||e.width===void 0&&e.height===void 0)&&(e.autoSize&&!this.ib&&this.ob(),e.autoSize===!1&&this.ib!==null&&this.pb(),e.autoSize||e.width===void 0&&e.height===void 0||this._b(e.width||this.__,e.height||this.ho))}gb(e){let n=0,s=0;const r=this.Xm[0],i=(a,l)=>{let c=0;for(let u=0;u<this.Xm.length;u++){const h=this.Xm[u],d=he(a==="left"?h.wm():h.gm()),f=d.xp();e!==null&&d.Sp(e,l,c),c+=f.height}};this.xb()&&(i("left",0),n+=he(r.wm()).xp().width);for(let a=0;a<this.Xm.length;a++){const l=this.Xm[a],c=l.xp();e!==null&&l.Sp(e,n,s),s+=c.height}n+=r.xp().width,this.Sb()&&(i("right",n),n+=he(r.gm()).xp().width);const o=(a,l,c)=>{he(a==="left"?this.ab.Lm():this.ab.Em()).Sp(he(e),l,c)};if(this.cn.timeScale.visible){const a=this.ab.xp();if(e!==null){let l=0;this.xb()&&(o("left",l,s),l=he(r.wm()).xp().width),this.ab.Sp(e,l,s),l+=a.width,this.Sb()&&o("right",l,s)}s+=a.height}return Et({width:n,height:s})}Pb(){let e=0,n=0,s=0;for(const p of this.Xm)this.xb()&&(n=Math.max(n,he(p.wm()).op(),this.cn.leftPriceScale.minimumWidth)),this.Sb()&&(s=Math.max(s,he(p.gm()).op(),this.cn.rightPriceScale.minimumWidth)),e+=p.M_();n=Yw(n),s=Yw(s);const r=this.__,i=this.ho,o=Math.max(r-n-s,0),a=this.cn.timeScale.visible;let l=a?Math.max(this.ab.Wm(),this.cn.timeScale.minimumHeight):0;var c;l=(c=l)+c%2;const u=0+l,h=i<u?0:i-u,d=h/e;let f=0;for(let p=0;p<this.Xm.length;++p){const m=this.Xm[p];m.qp(this.$i.qc()[p]);let v=0,x=0;x=p===this.Xm.length-1?h-f:Math.round(m.M_()*d),v=Math.max(x,2),f+=v,m.cp(Et({width:o,height:v})),this.xb()&&m._m(n,"left"),this.Sb()&&m._m(s,"right"),m.fp()&&this.$i.Kc(m.fp(),v)}this.ab.Fm(Et({width:a?o:0,height:l}),a?n:0,a?s:0),this.$i.S_(o),this.Gm!==n&&(this.Gm=n),this.Jm!==s&&(this.Jm=s)}hb(e){e?this.Xd.addEventListener("wheel",this.eb,{passive:!1}):this.Xd.removeEventListener("wheel",this.eb)}Rb(e){switch(e.deltaMode){case e.DOM_DELTA_PAGE:return 120;case e.DOM_DELTA_LINE:return 32}return sQ?1/window.devicePixelRatio:1}rb(e){if(!(e.deltaX!==0&&this.cn.handleScroll.mouseWheel||e.deltaY!==0&&this.cn.handleScale.mouseWheel))return;const n=this.Rb(e),s=n*e.deltaX/100,r=-n*e.deltaY/100;if(e.cancelable&&e.preventDefault(),r!==0&&this.cn.handleScale.mouseWheel){const i=Math.sign(r)*Math.min(1,Math.abs(r)),o=e.clientX-this.Xd.getBoundingClientRect().left;this.$t().Qc(o,i)}s!==0&&this.cn.handleScroll.mouseWheel&&this.$t().td(-80*s)}mb(e,n){var s;const r=e.jn();r===3&&this.Db(),r!==3&&r!==2||(this.Vb(e),this.Ob(e,n),this.ab.bt(),this.Xm.forEach(i=>{i.Xp()}),((s=this.Qm)===null||s===void 0?void 0:s.jn())===3&&(this.Qm.ts(e),this.Db(),this.Vb(this.Qm),this.Ob(this.Qm,n),e=this.Qm,this.Qm=null)),this.vp(e)}Ob(e,n){for(const s of e.Qn())this.ns(s,n)}Vb(e){const n=this.$i.qc();for(let s=0;s<n.length;s++)e.Hn(s).Wn&&n[s].N_()}ns(e,n){const s=this.$i.St();switch(e.qn){case 0:s.hc();break;case 1:s.lc(e.Vt);break;case 2:s.Gn(e.Vt);break;case 3:s.Jn(e.Vt);break;case 4:s.qu();break;case 5:e.Vt.Qu(n)||s.Jn(e.Vt.tc(n))}}Vc(e){this.Qm!==null?this.Qm.ts(e):this.Qm=e,this.tb||(this.tb=!0,this.Km=window.requestAnimationFrame(n=>{if(this.tb=!1,this.Km=0,this.Qm!==null){const s=this.Qm;this.Qm=null,this.mb(s,n);for(const r of s.Qn())if(r.qn===5&&!r.Vt.Qu(n)){this.$t().Zn(r.Vt);break}}}))}Db(){this.ub()}ub(){const e=this.$i.qc(),n=e.length,s=this.Xm.length;for(let r=n;r<s;r++){const i=hs(this.Xm.pop());this.sb.removeChild(i.lp()),i.lm().p(this),i.am().p(this),i.S()}for(let r=s;r<n;r++){const i=new zS(this,e[r]);i.lm().l(this.Bb.bind(this),this),i.am().l(this.Ab.bind(this),this),this.Xm.push(i),this.sb.insertBefore(i.lp(),this.ab.lp())}for(let r=0;r<n;r++){const i=e[r],o=this.Xm[r];o.fp()!==i?o.qp(i):o.Up()}this.cb(),this.Pb()}Ib(e,n,s){var r;const i=new Map;e!==null&&this.$i.wt().forEach(u=>{const h=u.In().ll(e);h!==null&&i.set(u,h)});let o;if(e!==null){const u=(r=this.$i.St().Ui(e))===null||r===void 0?void 0:r.originalTime;u!==void 0&&(o=u)}const a=this.$t().Wc(),l=a!==null&&a.Hc instanceof OS?a.Hc:void 0,c=a!==null&&a.Iv!==void 0?a.Iv.gr:void 0;return{zb:o,ee:e??void 0,Lb:n??void 0,Eb:l,Nb:i,Fb:c,Wb:s??void 0}}Bb(e,n,s){this.Vp.m(()=>this.Ib(e,n,s))}Ab(e,n,s){this.Op.m(()=>this.Ib(e,n,s))}lb(e,n,s){this.Rc.m(()=>this.Ib(e,n,s))}cb(){const e=this.cn.timeScale.visible?"":"none";this.ab.lp().style.display=e}xb(){return this.Xm[0].fp().R_().W().visible}Sb(){return this.Xm[0].fp().D_().W().visible}ob(){return"ResizeObserver"in window&&(this.ib=new ResizeObserver(e=>{const n=e.find(s=>s.target===this.Jd);n&&this._b(n.contentRect.width,n.contentRect.height)}),this.ib.observe(this.Jd,{box:"border-box"}),!0)}pb(){this.ib!==null&&this.ib.disconnect(),this.ib=null}}function qy(t){return!!(t.handleScroll.mouseWheel||t.handleScale.mouseWheel)}function iQ(t){return function(e){return e.open!==void 0}(t)||function(e){return e.value!==void 0}(t)}function KO(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]])}return n}function L2(t,e,n,s){const r=n.value,i={ee:e,ot:t,Vt:[r,r,r,r],zb:s};return n.color!==void 0&&(i.V=n.color),i}function oQ(t,e,n,s){const r=n.value,i={ee:e,ot:t,Vt:[r,r,r,r],zb:s};return n.lineColor!==void 0&&(i.lt=n.lineColor),n.topColor!==void 0&&(i.Ps=n.topColor),n.bottomColor!==void 0&&(i.Rs=n.bottomColor),i}function aQ(t,e,n,s){const r=n.value,i={ee:e,ot:t,Vt:[r,r,r,r],zb:s};return n.topLineColor!==void 0&&(i.Re=n.topLineColor),n.bottomLineColor!==void 0&&(i.De=n.bottomLineColor),n.topFillColor1!==void 0&&(i.ke=n.topFillColor1),n.topFillColor2!==void 0&&(i.ye=n.topFillColor2),n.bottomFillColor1!==void 0&&(i.Ce=n.bottomFillColor1),n.bottomFillColor2!==void 0&&(i.Te=n.bottomFillColor2),i}function lQ(t,e,n,s){const r={ee:e,ot:t,Vt:[n.open,n.high,n.low,n.close],zb:s};return n.color!==void 0&&(r.V=n.color),r}function cQ(t,e,n,s){const r={ee:e,ot:t,Vt:[n.open,n.high,n.low,n.close],zb:s};return n.color!==void 0&&(r.V=n.color),n.borderColor!==void 0&&(r.Ot=n.borderColor),n.wickColor!==void 0&&(r.Xh=n.wickColor),r}function uQ(t,e,n,s,r){const i=hs(r)(n),o=Math.max(...i),a=Math.min(...i),l=i[i.length-1],c=[l,o,a,l],u=n,{time:h,color:d}=u;return{ee:e,ot:t,Vt:c,zb:s,$e:KO(u,["time","color"]),V:d}}function qp(t){return t.Vt!==void 0}function z2(t,e){return e.customValues!==void 0&&(t.jb=e.customValues),t}function Ra(t){return(e,n,s,r,i,o)=>function(a,l){return l?l(a):(c=a).open===void 0&&c.value===void 0;var c}(s,o)?z2({ot:e,ee:n,zb:r},s):z2(t(e,n,s,r,i),s)}function V2(t){return{Candlestick:Ra(cQ),Bar:Ra(lQ),Area:Ra(oQ),Baseline:Ra(aQ),Histogram:Ra(L2),Line:Ra(L2),Custom:Ra(uQ)}[t]}function B2(t){return{ee:0,Hb:new Map,la:t}}function j2(t,e){if(t!==void 0&&t.length!==0)return{$b:e.key(t[0].ot),Ub:e.key(t[t.length-1].ot)}}function W2(t){let e;return t.forEach(n=>{e===void 0&&(e=n.zb)}),hs(e)}class hQ{constructor(e){this.qb=new Map,this.Yb=new Map,this.Zb=new Map,this.Xb=[],this.q_=e}S(){this.qb.clear(),this.Yb.clear(),this.Zb.clear(),this.Xb=[]}Kb(e,n){let s=this.qb.size!==0,r=!1;const i=this.Yb.get(e);if(i!==void 0)if(this.Yb.size===1)s=!1,r=!0,this.qb.clear();else for(const l of this.Xb)l.pointData.Hb.delete(e)&&(r=!0);let o=[];if(n.length!==0){const l=n.map(f=>f.time),c=this.q_.createConverterToInternalObj(n),u=V2(e.Qh()),h=e.Ca(),d=e.Ta();o=n.map((f,p)=>{const m=c(f.time),v=this.q_.key(m);let x=this.qb.get(v);x===void 0&&(x=B2(m),this.qb.set(v,x),r=!0);const g=u(m,x.ee,f,l[p],h,d);return x.Hb.set(e,g),g})}s&&this.Gb(),this.Jb(e,o);let a=-1;if(r){const l=[];this.qb.forEach(c=>{l.push({timeWeight:0,time:c.la,pointData:c,originalTime:W2(c.Hb)})}),l.sort((c,u)=>this.q_.key(c.time)-this.q_.key(u.time)),a=this.Qb(l)}return this.tw(e,a,function(l,c,u){const h=j2(l,u),d=j2(c,u);if(h!==void 0&&d!==void 0)return{ta:h.Ub>=d.Ub&&h.$b>=d.$b}}(this.Yb.get(e),i,this.q_))}vd(e){return this.Kb(e,[])}iw(e,n){const s=n;(function(m){m.zb===void 0&&(m.zb=m.time)})(s),this.q_.preprocessData(n);const r=this.q_.createConverterToInternalObj([n])(n.time),i=this.Zb.get(e);if(i!==void 0&&this.q_.key(r)<this.q_.key(i))throw new Error(`Cannot update oldest data, last time=${i}, new time=${r}`);let o=this.qb.get(this.q_.key(r));const a=o===void 0;o===void 0&&(o=B2(r),this.qb.set(this.q_.key(r),o));const l=V2(e.Qh()),c=e.Ca(),u=e.Ta(),h=l(r,o.ee,n,s.zb,c,u);o.Hb.set(e,h),this.nw(e,h);const d={ta:qp(h)};if(!a)return this.tw(e,-1,d);const f={timeWeight:0,time:o.la,pointData:o,originalTime:W2(o.Hb)},p=Wd(this.Xb,this.q_.key(f.time),(m,v)=>this.q_.key(m.time)<v);this.Xb.splice(p,0,f);for(let m=p;m<this.Xb.length;++m)Yy(this.Xb[m].pointData,m);return this.q_.fillWeightsForPoints(this.Xb,p),this.tw(e,p,d)}nw(e,n){let s=this.Yb.get(e);s===void 0&&(s=[],this.Yb.set(e,s));const r=s.length!==0?s[s.length-1]:null;r===null||this.q_.key(n.ot)>this.q_.key(r.ot)?qp(n)&&s.push(n):qp(n)?s[s.length-1]=n:s.splice(-1,1),this.Zb.set(e,n.ot)}Jb(e,n){n.length!==0?(this.Yb.set(e,n.filter(qp)),this.Zb.set(e,n[n.length-1].ot)):(this.Yb.delete(e),this.Zb.delete(e))}Gb(){for(const e of this.Xb)e.pointData.Hb.size===0&&this.qb.delete(this.q_.key(e.time))}Qb(e){let n=-1;for(let s=0;s<this.Xb.length&&s<e.length;++s){const r=this.Xb[s],i=e[s];if(this.q_.key(r.time)!==this.q_.key(i.time)){n=s;break}i.timeWeight=r.timeWeight,Yy(i.pointData,s)}if(n===-1&&this.Xb.length!==e.length&&(n=Math.min(this.Xb.length,e.length)),n===-1)return-1;for(let s=n;s<e.length;++s)Yy(e[s].pointData,s);return this.q_.fillWeightsForPoints(e,n),this.Xb=e,n}sw(){if(this.Yb.size===0)return null;let e=0;return this.Yb.forEach(n=>{n.length!==0&&(e=Math.max(e,n[n.length-1].ee))}),e}tw(e,n,s){const r={ew:new Map,St:{Eu:this.sw()}};if(n!==-1)this.Yb.forEach((i,o)=>{r.ew.set(o,{$e:i,rw:o===e?s:void 0})}),this.Yb.has(e)||r.ew.set(e,{$e:[],rw:s}),r.St.hw=this.Xb,r.St.lw=n;else{const i=this.Yb.get(e);r.ew.set(e,{$e:i||[],rw:s})}return r}}function Yy(t,e){t.ee=e,t.Hb.forEach(n=>{n.ee=e})}function BS(t){const e={value:t.Vt[3],time:t.zb};return t.jb!==void 0&&(e.customValues=t.jb),e}function U2(t){const e=BS(t);return t.V!==void 0&&(e.color=t.V),e}function dQ(t){const e=BS(t);return t.lt!==void 0&&(e.lineColor=t.lt),t.Ps!==void 0&&(e.topColor=t.Ps),t.Rs!==void 0&&(e.bottomColor=t.Rs),e}function fQ(t){const e=BS(t);return t.Re!==void 0&&(e.topLineColor=t.Re),t.De!==void 0&&(e.bottomLineColor=t.De),t.ke!==void 0&&(e.topFillColor1=t.ke),t.ye!==void 0&&(e.topFillColor2=t.ye),t.Ce!==void 0&&(e.bottomFillColor1=t.Ce),t.Te!==void 0&&(e.bottomFillColor2=t.Te),e}function XO(t){const e={open:t.Vt[0],high:t.Vt[1],low:t.Vt[2],close:t.Vt[3],time:t.zb};return t.jb!==void 0&&(e.customValues=t.jb),e}function pQ(t){const e=XO(t);return t.V!==void 0&&(e.color=t.V),e}function mQ(t){const e=XO(t),{V:n,Ot:s,Xh:r}=t;return n!==void 0&&(e.color=n),s!==void 0&&(e.borderColor=s),r!==void 0&&(e.wickColor=r),e}function Jw(t){return{Area:dQ,Line:U2,Baseline:fQ,Histogram:U2,Bar:pQ,Candlestick:mQ,Custom:gQ}[t]}function gQ(t){const e=t.zb;return Object.assign(Object.assign({},t.$e),{time:e})}const xQ={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},vQ={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},yQ={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:RS,attributionLogo:!0},Qy={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},bQ={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},wQ={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:RS,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function G2(){return{width:0,height:0,autoSize:!1,layout:yQ,crosshair:xQ,grid:vQ,overlayPriceScales:Object.assign({},Qy),leftPriceScale:Object.assign(Object.assign({},Qy),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},Qy),{visible:!0}),timeScale:bQ,watermark:wQ,localization:{locale:Jc?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class CQ{constructor(e,n){this.aw=e,this.ow=n}applyOptions(e){this.aw.$t().$c(this.ow,e)}options(){return this.Li().W()}width(){return jx(this.ow)?this.aw.Mb(this.ow):0}Li(){return he(this.aw.$t().Uc(this.ow)).Dt}}function H2(t,e,n){const s=KO(t,["time","originalTime"]),r=Object.assign({time:e},s);return n!==void 0&&(r.originalTime=n),r}const SQ={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class kQ{constructor(e){this.Nh=e}applyOptions(e){this.Nh.$h(e)}options(){return this.Nh.W()}_w(){return this.Nh}}let TQ=class{constructor(e,n,s,r,i){this.uw=new tn,this.Es=e,this.cw=n,this.dw=s,this.q_=i,this.fw=r}S(){this.uw.S()}priceFormatter(){return this.Es.ba()}priceToCoordinate(e){const n=this.Es.Ct();return n===null?null:this.Es.Dt().Rt(e,n.Vt)}coordinateToPrice(e){const n=this.Es.Ct();return n===null?null:this.Es.Dt().pn(e,n.Vt)}barsInLogicalRange(e){if(e===null)return null;const n=new Fc(new Bh(e.from,e.to)).lu(),s=this.Es.In();if(s.Ni())return null;const r=s.ll(n.Os(),1),i=s.ll(n.ui(),-1),o=he(s.el()),a=he(s.An());if(r!==null&&i!==null&&r.ee>i.ee)return{barsBefore:e.from-o,barsAfter:a-e.to};const l={barsBefore:r===null||r.ee===o?e.from-o:r.ee-o,barsAfter:i===null||i.ee===a?a-e.to:a-i.ee};return r!==null&&i!==null&&(l.from=r.zb,l.to=i.zb),l}setData(e){this.q_,this.Es.Qh(),this.cw.pw(this.Es,e),this.mw("full")}update(e){this.Es.Qh(),this.cw.bw(this.Es,e),this.mw("update")}dataByIndex(e,n){const s=this.Es.In().ll(e,n);return s===null?null:Jw(this.seriesType())(s)}data(){const e=Jw(this.seriesType());return this.Es.In().ne().map(n=>e(n))}subscribeDataChanged(e){this.uw.l(e)}unsubscribeDataChanged(e){this.uw.v(e)}setMarkers(e){this.q_;const n=e.map(s=>H2(s,this.q_.convertHorzItemToInternal(s.time),s.time));this.Es.na(n)}markers(){return this.Es.sa().map(e=>H2(e,e.originalTime,void 0))}applyOptions(e){this.Es.$h(e)}options(){return Ki(this.Es.W())}priceScale(){return this.dw.priceScale(this.Es.Dt().Pa())}createPriceLine(e){const n=Hr(Ki(SQ),e),s=this.Es.ea(n);return new kQ(s)}removePriceLine(e){this.Es.ra(e._w())}seriesType(){return this.Es.Qh()}attachPrimitive(e){this.Es.ka(e),e.attached&&e.attached({chart:this.fw,series:this,requestUpdate:()=>this.Es.$t().Kl()})}detachPrimitive(e){this.Es.ya(e),e.detached&&e.detached()}mw(e){this.uw.M()&&this.uw.m(e)}};class IQ{constructor(e,n,s){this.ww=new tn,this.mu=new tn,this.Om=new tn,this.$i=e,this.yl=e.St(),this.ab=n,this.yl.nc().l(this.gw.bind(this)),this.yl.sc().l(this.Mw.bind(this)),this.ab.Nm().l(this.xw.bind(this)),this.q_=s}S(){this.yl.nc().p(this),this.yl.sc().p(this),this.ab.Nm().p(this),this.ww.S(),this.mu.S(),this.Om.S()}scrollPosition(){return this.yl.Hu()}scrollToPosition(e,n){n?this.yl.Ju(e,1e3):this.$i.Jn(e)}scrollToRealTime(){this.yl.Gu()}getVisibleRange(){const e=this.yl.Vu();return e===null?null:{from:e.from.originalTime,to:e.to.originalTime}}setVisibleRange(e){const n={from:this.q_.convertHorzItemToInternal(e.from),to:this.q_.convertHorzItemToInternal(e.to)},s=this.yl.Iu(n);this.$i.pd(s)}getVisibleLogicalRange(){const e=this.yl.Du();return e===null?null:{from:e.Os(),to:e.ui()}}setVisibleLogicalRange(e){ta(e.from<=e.to,"The from index cannot be after the to index."),this.$i.pd(e)}resetTimeScale(){this.$i.Kn()}fitContent(){this.$i.hc()}logicalToCoordinate(e){const n=this.$i.St();return n.Ni()?null:n.It(e)}coordinateToLogical(e){return this.yl.Ni()?null:this.yl.Nu(e)}timeToCoordinate(e){const n=this.q_.convertHorzItemToInternal(e),s=this.yl.Va(n,!1);return s===null?null:this.yl.It(s)}coordinateToTime(e){const n=this.$i.St(),s=n.Nu(e),r=n.Ui(s);return r===null?null:r.originalTime}width(){return this.ab.um().width}height(){return this.ab.um().height}subscribeVisibleTimeRangeChange(e){this.ww.l(e)}unsubscribeVisibleTimeRangeChange(e){this.ww.v(e)}subscribeVisibleLogicalRangeChange(e){this.mu.l(e)}unsubscribeVisibleLogicalRangeChange(e){this.mu.v(e)}subscribeSizeChange(e){this.Om.l(e)}unsubscribeSizeChange(e){this.Om.v(e)}applyOptions(e){this.yl.$h(e)}options(){return Object.assign(Object.assign({},Ki(this.yl.W())),{barSpacing:this.yl.le()})}gw(){this.ww.M()&&this.ww.m(this.getVisibleRange())}Mw(){this.mu.M()&&this.mu.m(this.getVisibleLogicalRange())}xw(e){this.Om.m(e.width,e.height)}}function $Q(t){if(t===void 0||t.type==="custom")return;const e=t;e.minMove!==void 0&&e.precision===void 0&&(e.precision=function(n){if(n>=1)return 0;let s=0;for(;s<8;s++){const r=Math.round(n);if(Math.abs(r-n)<1e-8)return s;n*=10}return s}(e.minMove))}function K2(t){return function(e){if(Vp(e.handleScale)){const s=e.handleScale;e.handleScale={axisDoubleClickReset:{time:s,price:s},axisPressedMouseMove:{time:s,price:s},mouseWheel:s,pinch:s}}else if(e.handleScale!==void 0){const{axisPressedMouseMove:s,axisDoubleClickReset:r}=e.handleScale;Vp(s)&&(e.handleScale.axisPressedMouseMove={time:s,price:s}),Vp(r)&&(e.handleScale.axisDoubleClickReset={time:r,price:r})}const n=e.handleScroll;Vp(n)&&(e.handleScroll={horzTouchDrag:n,vertTouchDrag:n,mouseWheel:n,pressedMouseMove:n})}(t),t}let NQ=class{constructor(e,n,s){this.Sw=new Map,this.kw=new Map,this.yw=new tn,this.Cw=new tn,this.Tw=new tn,this.Pw=new hQ(n);const r=s===void 0?Ki(G2()):Hr(Ki(G2()),K2(s));this.q_=n,this.aw=new rQ(e,r,n),this.aw.lm().l(o=>{this.yw.M()&&this.yw.m(this.Rw(o()))},this),this.aw.am().l(o=>{this.Cw.M()&&this.Cw.m(this.Rw(o()))},this),this.aw.Xc().l(o=>{this.Tw.M()&&this.Tw.m(this.Rw(o()))},this);const i=this.aw.$t();this.Dw=new IQ(i,this.aw.fb(),this.q_)}remove(){this.aw.lm().p(this),this.aw.am().p(this),this.aw.Xc().p(this),this.Dw.S(),this.aw.S(),this.Sw.clear(),this.kw.clear(),this.yw.S(),this.Cw.S(),this.Tw.S(),this.Pw.S()}resize(e,n,s){this.autoSizeActive()||this.aw._b(e,n,s)}addCustomSeries(e,n){const s=kc(e),r=Object.assign(Object.assign({},SO),s.defaultOptions());return this.Vw("Custom",r,n,s)}addAreaSeries(e){return this.Vw("Area",h7,e)}addBaselineSeries(e){return this.Vw("Baseline",d7,e)}addBarSeries(e){return this.Vw("Bar",c7,e)}addCandlestickSeries(e={}){return function(n){n.borderColor!==void 0&&(n.borderUpColor=n.borderColor,n.borderDownColor=n.borderColor),n.wickColor!==void 0&&(n.wickUpColor=n.wickColor,n.wickDownColor=n.wickColor)}(e),this.Vw("Candlestick",l7,e)}addHistogramSeries(e){return this.Vw("Histogram",f7,e)}addLineSeries(e){return this.Vw("Line",u7,e)}removeSeries(e){const n=hs(this.Sw.get(e)),s=this.Pw.vd(n);this.aw.$t().vd(n),this.Ow(s),this.Sw.delete(e),this.kw.delete(n)}pw(e,n){this.Ow(this.Pw.Kb(e,n))}bw(e,n){this.Ow(this.Pw.iw(e,n))}subscribeClick(e){this.yw.l(e)}unsubscribeClick(e){this.yw.v(e)}subscribeCrosshairMove(e){this.Tw.l(e)}unsubscribeCrosshairMove(e){this.Tw.v(e)}subscribeDblClick(e){this.Cw.l(e)}unsubscribeDblClick(e){this.Cw.v(e)}priceScale(e){return new CQ(this.aw,e)}timeScale(){return this.Dw}applyOptions(e){this.aw.$h(K2(e))}options(){return this.aw.W()}takeScreenshot(){return this.aw.wb()}autoSizeActive(){return this.aw.kb()}chartElement(){return this.aw.yb()}paneSize(){const e=this.aw.Tb();return{height:e.height,width:e.width}}setCrosshairPosition(e,n,s){const r=this.Sw.get(s);if(r===void 0)return;const i=this.aw.$t().dr(r);i!==null&&this.aw.$t().ad(e,n,i)}clearCrosshairPosition(){this.aw.$t().od(!0)}Vw(e,n,s={},r){$Q(s.priceFormat);const i=Hr(Ki(kO),Ki(n),s),o=this.aw.$t().dd(e,i,r),a=new TQ(o,this,this,this,this.q_);return this.Sw.set(a,o),this.kw.set(o,a),a}Ow(e){const n=this.aw.$t();n._d(e.St.Eu,e.St.hw,e.St.lw),e.ew.forEach((s,r)=>r.J(s.$e,s.rw)),n.Wu()}Bw(e){return hs(this.kw.get(e))}Rw(e){const n=new Map;e.Nb.forEach((r,i)=>{const o=i.Qh(),a=Jw(o)(r);if(o!=="Custom")ta(iQ(a));else{const l=i.Ta();ta(!l||l(a)===!1)}n.set(this.Bw(i),a)});const s=e.Eb!==void 0&&this.kw.has(e.Eb)?this.Bw(e.Eb):void 0;return{time:e.zb,logical:e.ee,point:e.Lb,hoveredSeries:s,hoveredObjectId:e.Fb,seriesData:n,sourceEvent:e.Wb}}};function EQ(t,e,n){let s;if(jd(t)){const i=document.getElementById(t);ta(i!==null,`Cannot find element in DOM with id=${t}`),s=i}else s=t;const r=new NQ(s,e,n);return e.setOptions(r.options()),r}function RQ(t,e){return EQ(t,new D2,D2.Id(e))}Object.assign(Object.assign({},kO),SO);const AQ=1;let Zy=0;function DQ(){return Zy=(Zy+1)%Number.MAX_VALUE,Zy.toString()}const rs={state:{toasts:[]},listeners:[],getState:()=>rs.state,setState:t=>{typeof t=="function"?rs.state=t(rs.state):rs.state={...rs.state,...t},rs.listeners.forEach(e=>e(rs.state))},subscribe:t=>(rs.listeners.push(t),()=>{rs.listeners=rs.listeners.filter(e=>e!==t)})},gt=({...t})=>{const e=DQ(),n=r=>rs.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...r}:o)})),s=()=>rs.setState(r=>({...r,toasts:r.toasts.filter(i=>i.id!==e)}));return rs.setState(r=>({...r,toasts:[{...t,id:e,dismiss:s},...r.toasts].slice(0,AQ)})),{id:e,dismiss:s,update:n}};function _Q(){const[t,e]=k.useState(rs.getState());return k.useEffect(()=>rs.subscribe(s=>{e(s)}),[]),k.useEffect(()=>{const n=[];return t.toasts.forEach(s=>{if(s.duration===1/0)return;const r=setTimeout(()=>{s.dismiss()},s.duration||5e3);n.push(r)}),()=>{n.forEach(s=>clearTimeout(s))}},[t.toasts]),{toast:gt,toasts:t.toasts}}let X2=class{constructor(e,n,s){this.next=s,s&&(s.prev=this),this.prev=n,n&&(n.next=this),this.data=e}};class PQ{constructor(){this._length=0}get head(){return this._head&&this._head.data}get tail(){return this._tail&&this._tail.data}get current(){return this._current&&this._current.data}get length(){return this._length}push(e){this._tail=new X2(e,this._tail),this._length===0&&(this._head=this._tail,this._current=this._head,this._next=this._head),this._length++}pop(){var e=this._tail;if(this._length!==0)return this._length--,this._length===0?(this._head=this._tail=this._current=this._next=void 0,e.data):(this._tail=e.prev,this._tail.next=void 0,this._current===e&&(this._current=this._tail,this._next=void 0),e.data)}shift(){var e=this._head;if(this._length!==0)return this._length--,this._length===0?(this._head=this._tail=this._current=this._next=void 0,e.data):(this._head=this._head.next,this._current===e&&(this._current=this._head,this._next=this._current.next),e.data)}unshift(e){this._head=new X2(e,void 0,this._head),this._length===0&&(this._tail=this._head,this._next=this._head),this._length++}unshiftCurrent(){var e=this._current;return e===this._head||this._length<2?e&&e.data:(e===this._tail?(this._tail=e.prev,this._tail.next=void 0,this._current=this._tail):(e.next.prev=e.prev,e.prev.next=e.next,this._current=e.prev),this._next=this._current.next,e.next=this._head,e.prev=void 0,this._head.prev=e,this._head=e,e.data)}removeCurrent(){var e=this._current;if(this._length!==0)return this._length--,this._length===0?(this._head=this._tail=this._current=this._next=void 0,e.data):(e===this._tail?(this._tail=e.prev,this._tail.next=void 0,this._current=this._tail):e===this._head?(this._head=e.next,this._head.prev=void 0,this._current=this._head):(e.next.prev=e.prev,e.prev.next=e.next,this._current=e.prev),this._next=this._current.next,e.data)}resetCursor(){return this._current=this._next=this._head,this}next(){var e=this._next;if(e!==void 0)return this._next=e.next,this._current=e,e.data}}let FQ={};function OQ(t){return FQ[t]}function MQ(t){let e=OQ("precision");return e?parseFloat(t.toPrecision(e)):t}class yr{constructor(e){this.format=e.format||MQ}static reverseInputs(e){e.reversedInput&&(e.values&&e.values.reverse(),e.open&&e.open.reverse(),e.high&&e.high.reverse(),e.low&&e.low.reverse(),e.close&&e.close.reverse(),e.volume&&e.volume.reverse(),e.timestamp&&e.timestamp.reverse())}getResult(){return this.result}}class jS extends yr{constructor(e){super(e),this.period=e.period,this.price=e.values;var n=function*(s){var r=new PQ,i=0,o=1,a=yield,l;for(r.push(0);;)o<s?(o++,r.push(a),i=i+a):(i=i-r.shift()+a,l=i/s,r.push(a)),a=yield l};this.generator=n(this.period),this.generator.next(),this.result=[],this.price.forEach(s=>{var r=this.generator.next(s);r.value!==void 0&&this.result.push(this.format(r.value))})}nextValue(e){var n=this.generator.next(e).value;if(n!=null)return this.format(n)}}jS.calculate=LQ;function LQ(t){yr.reverseInputs(t);var e=new jS(t).result;return t.reversedInput&&e.reverse(),yr.reverseInputs(t),e}class WS extends yr{constructor(e){super(e);let n=e.values,s=e.period,r=this.format;this.generator=function*(i){var o=yield,a=1,l=0,c,u,h=o;for(o=yield;;)u=o-h,u=u>0?u:0,u>0&&(l=l+u),a<i?a++:c===void 0?c=l/i:c=(c*(i-1)+u)/i,h=o,c=c!==void 0?r(c):void 0,o=yield c}(s),this.generator.next(),this.result=[],n.forEach(i=>{var o=this.generator.next(i);o.value!==void 0&&this.result.push(o.value)})}nextValue(e){return this.generator.next(e).value}}WS.calculate=zQ;function zQ(t){yr.reverseInputs(t);var e=new WS(t).result;return t.reversedInput&&e.reverse(),yr.reverseInputs(t),e}class US extends yr{constructor(e){super(e);let n=e.values,s=e.period,r=this.format;this.generator=function*(i){var o=yield,a=1,l=0,c,u,h=o;for(o=yield;;)u=h-o,u=u>0?u:0,u>0&&(l=l+u),a<i?a++:c===void 0?c=l/i:c=(c*(i-1)+u)/i,h=o,c=c!==void 0?r(c):void 0,o=yield c}(s),this.generator.next(),this.result=[],n.forEach(i=>{var o=this.generator.next(i);o.value!==void 0&&this.result.push(o.value)})}nextValue(e){return this.generator.next(e).value}}US.calculate=VQ;function VQ(t){yr.reverseInputs(t);var e=new US(t).result;return t.reversedInput&&e.reverse(),yr.reverseInputs(t),e}class GS extends yr{constructor(e){super(e);var n=e.period,s=e.values,r=new WS({period:n,values:[]}),i=new US({period:n,values:[]});this.generator=function*(o){for(var a=yield,l,c,u,h;;)l=r.nextValue(a),c=i.nextValue(a),l!==void 0&&c!==void 0&&(c===0?h=100:l===0?h=0:(u=l/c,u=isNaN(u)?0:u,h=parseFloat((100-100/(1+u)).toFixed(2)))),a=yield h}(),this.generator.next(),this.result=[],s.forEach(o=>{var a=this.generator.next(o);a.value!==void 0&&this.result.push(a.value)})}nextValue(e){return this.generator.next(e).value}}GS.calculate=BQ;function BQ(t){yr.reverseInputs(t);var e=new GS(t).result;return t.reversedInput&&e.reverse(),yr.reverseInputs(t),e}function qO(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=qO(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function YO(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=qO(t))&&(s&&(s+=" "),s+=e);return s}function jQ(){for(var t=0,e,n,s="";t<arguments.length;)(e=arguments[t++])&&(n=QO(e))&&(s&&(s+=" "),s+=n);return s}function QO(t){if(typeof t=="string")return t;for(var e,n="",s=0;s<t.length;s++)t[s]&&(e=QO(t[s]))&&(n&&(n+=" "),n+=e);return n}var HS="-";function WQ(t){var e=GQ(t),n=t.conflictingClassGroups,s=t.conflictingClassGroupModifiers,r=s===void 0?{}:s;function i(a){var l=a.split(HS);return l[0]===""&&l.length!==1&&l.shift(),ZO(l,e)||UQ(a)}function o(a,l){var c=n[a]||[];return l&&r[a]?[].concat(c,r[a]):c}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function ZO(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],s=e.nextPart.get(n),r=s?ZO(t.slice(1),s):void 0;if(r)return r;if(e.validators.length!==0){var i=t.join(HS);return(o=e.validators.find(function(a){var l=a.validator;return l(i)}))==null?void 0:o.classGroupId}}var q2=/^\[(.+)\]$/;function UQ(t){if(q2.test(t)){var e=q2.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function GQ(t){var e=t.theme,n=t.prefix,s={nextPart:new Map,validators:[]},r=KQ(Object.entries(t.classGroups),n);return r.forEach(function(i){var o=i[0],a=i[1];e1(a,s,o,e)}),s}function e1(t,e,n,s){t.forEach(function(r){if(typeof r=="string"){var i=r===""?e:Y2(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(HQ(r)){e1(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(function(o){var a=o[0],l=o[1];e1(l,Y2(e,a),n,s)})})}function Y2(t,e){var n=t;return e.split(HS).forEach(function(s){n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n}function HQ(t){return t.isThemeGetter}function KQ(t,e){return e?t.map(function(n){var s=n[0],r=n[1],i=r.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(a){var l=a[0],c=a[1];return[e+l,c]})):o});return[s,i]}):t}function XQ(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,s=new Map;function r(i,o){n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)}return{get:function(o){var a=n.get(o);if(a!==void 0)return a;if((a=s.get(o))!==void 0)return r(o,a),a},set:function(o,a){n.has(o)?n.set(o,a):r(o,a)}}}var JO="!";function qQ(t){var e=t.separator||":",n=e.length===1,s=e[0],r=e.length;return function(o){for(var a=[],l=0,c=0,u,h=0;h<o.length;h++){var d=o[h];if(l===0){if(d===s&&(n||o.slice(h,h+r)===e)){a.push(o.slice(c,h)),c=h+r;continue}if(d==="/"){u=h;continue}}d==="["?l++:d==="]"&&l--}var f=a.length===0?o:o.substring(c),p=f.startsWith(JO),m=p?f.substring(1):f,v=u&&u>c?u-c:void 0;return{modifiers:a,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:v}}}function YQ(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(s){var r=s[0]==="[";r?(e.push.apply(e,n.sort().concat([s])),n=[]):n.push(s)}),e.push.apply(e,n.sort()),e}function QQ(t){return{cache:XQ(t.cacheSize),splitModifiers:qQ(t),...WQ(t)}}var ZQ=/\s+/;function JQ(t,e){var n=e.splitModifiers,s=e.getClassGroupId,r=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(ZQ).map(function(o){var a=n(o),l=a.modifiers,c=a.hasImportantModifier,u=a.baseClassName,h=a.maybePostfixModifierPosition,d=s(h?u.substring(0,h):u),f=!!h;if(!d){if(!h)return{isTailwindClass:!1,originalClassName:o};if(d=s(u),!d)return{isTailwindClass:!1,originalClassName:o};f=!1}var p=YQ(l).join(":"),m=c?p+JO:p;return{isTailwindClass:!0,modifierId:m,classGroupId:d,originalClassName:o,hasPostfixModifier:f}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var a=o.modifierId,l=o.classGroupId,c=o.hasPostfixModifier,u=a+l;return i.has(u)?!1:(i.add(u),r(l,c).forEach(function(h){return i.add(a+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function eZ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s,r,i,o=a;function a(c){var u=e[0],h=e.slice(1),d=h.reduce(function(f,p){return p(f)},u());return s=QQ(d),r=s.cache.get,i=s.cache.set,o=l,l(c)}function l(c){var u=r(c);if(u)return u;var h=JQ(c,s);return i(c,h),h}return function(){return o(jQ.apply(null,arguments))}}function It(t){var e=function(s){return s[t]||[]};return e.isThemeGetter=!0,e}var eM=/^\[(?:([a-z-]+):)?(.+)\]$/i,tZ=/^\d+\/\d+$/,nZ=new Set(["px","full","screen"]),sZ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,rZ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iZ=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Nr(t){return Ka(t)||nZ.has(t)||tZ.test(t)||t1(t)}function t1(t){return Ml(t,"length",hZ)}function oZ(t){return Ml(t,"size",tM)}function aZ(t){return Ml(t,"position",tM)}function lZ(t){return Ml(t,"url",dZ)}function Yp(t){return Ml(t,"number",Ka)}function Ka(t){return!Number.isNaN(Number(t))}function cZ(t){return t.endsWith("%")&&Ka(t.slice(0,-1))}function nh(t){return Q2(t)||Ml(t,"number",Q2)}function Ye(t){return eM.test(t)}function sh(){return!0}function yo(t){return sZ.test(t)}function uZ(t){return Ml(t,"",fZ)}function Ml(t,e,n){var s=eM.exec(t);return s?s[1]?s[1]===e:n(s[2]):!1}function hZ(t){return rZ.test(t)}function tM(){return!1}function dZ(t){return t.startsWith("url(")}function Q2(t){return Number.isInteger(Number(t))}function fZ(t){return iZ.test(t)}function pZ(){var t=It("colors"),e=It("spacing"),n=It("blur"),s=It("brightness"),r=It("borderColor"),i=It("borderRadius"),o=It("borderSpacing"),a=It("borderWidth"),l=It("contrast"),c=It("grayscale"),u=It("hueRotate"),h=It("invert"),d=It("gap"),f=It("gradientColorStops"),p=It("gradientColorStopPositions"),m=It("inset"),v=It("margin"),x=It("opacity"),g=It("padding"),y=It("saturate"),b=It("scale"),C=It("sepia"),S=It("skew"),T=It("space"),I=It("translate"),$=function(){return["auto","contain","none"]},N=function(){return["auto","hidden","clip","visible","scroll"]},A=function(){return["auto",Ye,e]},F=function(){return[Ye,e]},E=function(){return["",Nr]},R=function(){return["auto",Ka,Ye]},O=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},P=function(){return["solid","dashed","dotted","double","none"]},z=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},_=function(){return["start","end","center","between","around","evenly","stretch"]},M=function(){return["","0",Ye]},U=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},W=function(){return[Ka,Yp]},X=function(){return[Ka,Ye]};return{cacheSize:500,theme:{colors:[sh],spacing:[Nr],blur:["none","",yo,Ye],brightness:W(),borderColor:[t],borderRadius:["none","","full",yo,Ye],borderSpacing:F(),borderWidth:E(),contrast:W(),grayscale:M(),hueRotate:X(),invert:M(),gap:F(),gradientColorStops:[t],gradientColorStopPositions:[cZ,t1],inset:A(),margin:A(),opacity:W(),padding:F(),saturate:W(),scale:W(),sepia:M(),skew:X(),space:F(),translate:F()},classGroups:{aspect:[{aspect:["auto","square","video",Ye]}],container:["container"],columns:[{columns:[yo]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(O(),[Ye])}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:$()}],"overscroll-x":[{"overscroll-x":$()}],"overscroll-y":[{"overscroll-y":$()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",nh]}],basis:[{basis:A()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ye]}],grow:[{grow:M()}],shrink:[{shrink:M()}],order:[{order:["first","last","none",nh]}],"grid-cols":[{"grid-cols":[sh]}],"col-start-end":[{col:["auto",{span:["full",nh]},Ye]}],"col-start":[{"col-start":R()}],"col-end":[{"col-end":R()}],"grid-rows":[{"grid-rows":[sh]}],"row-start-end":[{row:["auto",{span:[nh]},Ye]}],"row-start":[{"row-start":R()}],"row-end":[{"row-end":R()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ye]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ye]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal"].concat(_())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(_(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(_(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Ye,e]}],"min-w":[{"min-w":["min","max","fit",Ye,Nr]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[yo]},yo,Ye]}],h:[{h:[Ye,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Ye,Nr]}],"max-h":[{"max-h":[Ye,e,"min","max","fit"]}],"font-size":[{text:["base",yo,t1]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Yp]}],"font-family":[{font:[sh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ye]}],"line-clamp":[{"line-clamp":["none",Ka,Yp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ye,Nr]}],"list-image":[{"list-image":["none",Ye]}],"list-style-type":[{list:["none","disc","decimal",Ye]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(P(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Nr]}],"underline-offset":[{"underline-offset":["auto",Ye,Nr]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:F()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ye]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ye]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(O(),[aZ])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",oZ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},lZ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(P(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:P()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:[""].concat(P())}],"outline-offset":[{"outline-offset":[Ye,Nr]}],"outline-w":[{outline:[Nr]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Nr]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",yo,uZ]}],"shadow-color":[{shadow:[sh]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":z()}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",yo,Ye]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[y]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ye]}],duration:[{duration:X()}],ease:[{ease:["linear","in","out","in-out",Ye]}],delay:[{delay:X()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ye]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[nh,Ye]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ye]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ye]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":F()}],"scroll-mx":[{"scroll-mx":F()}],"scroll-my":[{"scroll-my":F()}],"scroll-ms":[{"scroll-ms":F()}],"scroll-me":[{"scroll-me":F()}],"scroll-mt":[{"scroll-mt":F()}],"scroll-mr":[{"scroll-mr":F()}],"scroll-mb":[{"scroll-mb":F()}],"scroll-ml":[{"scroll-ml":F()}],"scroll-p":[{"scroll-p":F()}],"scroll-px":[{"scroll-px":F()}],"scroll-py":[{"scroll-py":F()}],"scroll-ps":[{"scroll-ps":F()}],"scroll-pe":[{"scroll-pe":F()}],"scroll-pt":[{"scroll-pt":F()}],"scroll-pr":[{"scroll-pr":F()}],"scroll-pb":[{"scroll-pb":F()}],"scroll-pl":[{"scroll-pl":F()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ye]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Nr,Yp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var mZ=eZ(pZ);function Ie(...t){return mZ(YO(t))}const mi=oe.forwardRef(({className:t,type:e,...n},s)=>w.jsx("input",{type:e,className:Ie("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n}));mi.displayName="Input";function Z2(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function nM(...t){return e=>{let n=!1;const s=t.map(r=>{const i=Z2(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():Z2(t[r],null)}}}}function Le(...t){return k.useCallback(nM(...t),t)}function fl(t){const e=xZ(t),n=k.forwardRef((s,r)=>{const{children:i,...o}=s,a=k.Children.toArray(i),l=a.find(yZ);if(l){const c=l.props.children,u=a.map(h=>h===l?k.Children.count(c)>1?k.Children.only(null):k.isValidElement(c)?c.props.children:null:h);return w.jsx(e,{...o,ref:r,children:k.isValidElement(c)?k.cloneElement(c,void 0,u):null})}return w.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var gZ=fl("Slot");function xZ(t){const e=k.forwardRef((n,s)=>{const{children:r,...i}=n;if(k.isValidElement(r)){const o=wZ(r),a=bZ(i,r.props);return r.type!==k.Fragment&&(a.ref=s?nM(s,o):o),k.cloneElement(r,a)}return k.Children.count(r)>1?k.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var sM=Symbol("radix.slottable");function vZ(t){const e=({children:n})=>w.jsx(w.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=sM,e}function yZ(t){return k.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sM}function bZ(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function wZ(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var CZ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Te=CZ.reduce((t,e)=>{const n=fl(`Primitive.${e}`),s=k.forwardRef((r,i)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function rM(t,e){t&&Pl.flushSync(()=>t.dispatchEvent(e))}var wn=globalThis!=null&&globalThis.document?k.useLayoutEffect:()=>{};function SZ(t,e){return k.useReducer((n,s)=>e[n][s]??n,t)}var gs=t=>{const{present:e,children:n}=t,s=kZ(e),r=typeof n=="function"?n({present:s.isPresent}):k.Children.only(n),i=Le(s.ref,TZ(r));return typeof n=="function"||s.isPresent?k.cloneElement(r,{ref:i}):null};gs.displayName="Presence";function kZ(t){const[e,n]=k.useState(),s=k.useRef(null),r=k.useRef(t),i=k.useRef("none"),o=t?"mounted":"unmounted",[a,l]=SZ(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return k.useEffect(()=>{const c=Qp(s.current);i.current=a==="mounted"?c:"none"},[a]),wn(()=>{const c=s.current,u=r.current;if(u!==t){const d=i.current,f=Qp(c);t?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),wn(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const m=Qp(s.current).includes(CSS.escape(f.animationName));if(f.target===e&&m&&(l("ANIMATION_END"),!r.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},d=f=>{f.target===e&&(i.current=Qp(s.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:k.useCallback(c=>{s.current=c?getComputedStyle(c):null,n(c)},[])}}function Qp(t){return(t==null?void 0:t.animationName)||"none"}function TZ(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function IZ(t,e){const n=k.createContext(e),s=i=>{const{children:o,...a}=i,l=k.useMemo(()=>a,Object.values(a));return w.jsx(n.Provider,{value:l,children:o})};s.displayName=t+"Provider";function r(i){const o=k.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[s,r]}function _s(t,e=[]){let n=[];function s(i,o){const a=k.createContext(o),l=n.length;n=[...n,o];const c=h=>{var x;const{scope:d,children:f,...p}=h,m=((x=d==null?void 0:d[t])==null?void 0:x[l])||a,v=k.useMemo(()=>p,Object.values(p));return w.jsx(m.Provider,{value:v,children:f})};c.displayName=i+"Provider";function u(h,d){var m;const f=((m=d==null?void 0:d[t])==null?void 0:m[l])||a,p=k.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const r=()=>{const i=n.map(o=>k.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return k.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,$Z(r,...e)]}function $Z(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return k.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function gn(t){const e=k.useRef(t);return k.useEffect(()=>{e.current=t}),k.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}var NZ=k.createContext(void 0);function yu(t){const e=k.useContext(NZ);return t||e||"ltr"}function gd(t,[e,n]){return Math.min(n,Math.max(e,t))}function be(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function EZ(t,e){return k.useReducer((n,s)=>e[n][s]??n,t)}var KS="ScrollArea",[iM,OAe]=_s(KS),[RZ,Cr]=iM(KS),oM=k.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:s="hover",dir:r,scrollHideDelay:i=600,...o}=t,[a,l]=k.useState(null),[c,u]=k.useState(null),[h,d]=k.useState(null),[f,p]=k.useState(null),[m,v]=k.useState(null),[x,g]=k.useState(0),[y,b]=k.useState(0),[C,S]=k.useState(!1),[T,I]=k.useState(!1),$=Le(e,A=>l(A)),N=yu(r);return w.jsx(RZ,{scope:n,type:s,dir:N,scrollHideDelay:i,scrollArea:a,viewport:c,onViewportChange:u,content:h,onContentChange:d,scrollbarX:f,onScrollbarXChange:p,scrollbarXEnabled:C,onScrollbarXEnabledChange:S,scrollbarY:m,onScrollbarYChange:v,scrollbarYEnabled:T,onScrollbarYEnabledChange:I,onCornerWidthChange:g,onCornerHeightChange:b,children:w.jsx(Te.div,{dir:N,...o,ref:$,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":y+"px",...t.style}})})});oM.displayName=KS;var aM="ScrollAreaViewport",lM=k.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:s,nonce:r,...i}=t,o=Cr(aM,n),a=k.useRef(null),l=Le(e,a,o.onViewportChange);return w.jsxs(w.Fragment,{children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),w.jsx(Te.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:w.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});lM.displayName=aM;var Fi="ScrollAreaScrollbar",XS=k.forwardRef((t,e)=>{const{forceMount:n,...s}=t,r=Cr(Fi,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=r,a=t.orientation==="horizontal";return k.useEffect(()=>(a?i(!0):o(!0),()=>{a?i(!1):o(!1)}),[a,i,o]),r.type==="hover"?w.jsx(AZ,{...s,ref:e,forceMount:n}):r.type==="scroll"?w.jsx(DZ,{...s,ref:e,forceMount:n}):r.type==="auto"?w.jsx(cM,{...s,ref:e,forceMount:n}):r.type==="always"?w.jsx(qS,{...s,ref:e}):null});XS.displayName=Fi;var AZ=k.forwardRef((t,e)=>{const{forceMount:n,...s}=t,r=Cr(Fi,t.__scopeScrollArea),[i,o]=k.useState(!1);return k.useEffect(()=>{const a=r.scrollArea;let l=0;if(a){const c=()=>{window.clearTimeout(l),o(!0)},u=()=>{l=window.setTimeout(()=>o(!1),r.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",u)}}},[r.scrollArea,r.scrollHideDelay]),w.jsx(gs,{present:n||i,children:w.jsx(cM,{"data-state":i?"visible":"hidden",...s,ref:e})})}),DZ=k.forwardRef((t,e)=>{const{forceMount:n,...s}=t,r=Cr(Fi,t.__scopeScrollArea),i=t.orientation==="horizontal",o=Hx(()=>l("SCROLL_END"),100),[a,l]=EZ("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return k.useEffect(()=>{if(a==="idle"){const c=window.setTimeout(()=>l("HIDE"),r.scrollHideDelay);return()=>window.clearTimeout(c)}},[a,r.scrollHideDelay,l]),k.useEffect(()=>{const c=r.viewport,u=i?"scrollLeft":"scrollTop";if(c){let h=c[u];const d=()=>{const f=c[u];h!==f&&(l("SCROLL"),o()),h=f};return c.addEventListener("scroll",d),()=>c.removeEventListener("scroll",d)}},[r.viewport,i,l,o]),w.jsx(gs,{present:n||a!=="hidden",children:w.jsx(qS,{"data-state":a==="hidden"?"hidden":"visible",...s,ref:e,onPointerEnter:be(t.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:be(t.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),cM=k.forwardRef((t,e)=>{const n=Cr(Fi,t.__scopeScrollArea),{forceMount:s,...r}=t,[i,o]=k.useState(!1),a=t.orientation==="horizontal",l=Hx(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;o(a?c:u)}},10);return eu(n.viewport,l),eu(n.content,l),w.jsx(gs,{present:s||i,children:w.jsx(qS,{"data-state":i?"visible":"hidden",...r,ref:e})})}),qS=k.forwardRef((t,e)=>{const{orientation:n="vertical",...s}=t,r=Cr(Fi,t.__scopeScrollArea),i=k.useRef(null),o=k.useRef(0),[a,l]=k.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=pM(a.viewport,a.content),u={...s,sizes:a,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:d=>i.current=d,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:d=>o.current=d};function h(d,f){return LZ(d,o.current,a,f)}return n==="horizontal"?w.jsx(_Z,{...u,ref:e,onThumbPositionChange:()=>{if(r.viewport&&i.current){const d=r.viewport.scrollLeft,f=J2(d,a,r.dir);i.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:d=>{r.viewport&&(r.viewport.scrollLeft=d)},onDragScroll:d=>{r.viewport&&(r.viewport.scrollLeft=h(d,r.dir))}}):n==="vertical"?w.jsx(PZ,{...u,ref:e,onThumbPositionChange:()=>{if(r.viewport&&i.current){const d=r.viewport.scrollTop,f=J2(d,a);i.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:d=>{r.viewport&&(r.viewport.scrollTop=d)},onDragScroll:d=>{r.viewport&&(r.viewport.scrollTop=h(d))}}):null}),_Z=k.forwardRef((t,e)=>{const{sizes:n,onSizesChange:s,...r}=t,i=Cr(Fi,t.__scopeScrollArea),[o,a]=k.useState(),l=k.useRef(null),c=Le(e,l,i.onScrollbarXChange);return k.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),w.jsx(hM,{"data-orientation":"horizontal",...r,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Gx(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.x),onDragScroll:u=>t.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const d=i.viewport.scrollLeft+u.deltaX;t.onWheelScroll(d),gM(d,h)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:Ag(o.paddingLeft),paddingEnd:Ag(o.paddingRight)}})}})}),PZ=k.forwardRef((t,e)=>{const{sizes:n,onSizesChange:s,...r}=t,i=Cr(Fi,t.__scopeScrollArea),[o,a]=k.useState(),l=k.useRef(null),c=Le(e,l,i.onScrollbarYChange);return k.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),w.jsx(hM,{"data-orientation":"vertical",...r,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Gx(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.y),onDragScroll:u=>t.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const d=i.viewport.scrollTop+u.deltaY;t.onWheelScroll(d),gM(d,h)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:Ag(o.paddingTop),paddingEnd:Ag(o.paddingBottom)}})}})}),[FZ,uM]=iM(Fi),hM=k.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:s,hasThumb:r,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:a,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:h,...d}=t,f=Cr(Fi,n),[p,m]=k.useState(null),v=Le(e,$=>m($)),x=k.useRef(null),g=k.useRef(""),y=f.viewport,b=s.content-s.viewport,C=gn(u),S=gn(l),T=Hx(h,10);function I($){if(x.current){const N=$.clientX-x.current.left,A=$.clientY-x.current.top;c({x:N,y:A})}}return k.useEffect(()=>{const $=N=>{const A=N.target;(p==null?void 0:p.contains(A))&&C(N,b)};return document.addEventListener("wheel",$,{passive:!1}),()=>document.removeEventListener("wheel",$,{passive:!1})},[y,p,b,C]),k.useEffect(S,[s,S]),eu(p,T),eu(f.content,T),w.jsx(FZ,{scope:n,scrollbar:p,hasThumb:r,onThumbChange:gn(i),onThumbPointerUp:gn(o),onThumbPositionChange:S,onThumbPointerDown:gn(a),children:w.jsx(Te.div,{...d,ref:v,style:{position:"absolute",...d.style},onPointerDown:be(t.onPointerDown,$=>{$.button===0&&($.target.setPointerCapture($.pointerId),x.current=p.getBoundingClientRect(),g.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),I($))}),onPointerMove:be(t.onPointerMove,I),onPointerUp:be(t.onPointerUp,$=>{const N=$.target;N.hasPointerCapture($.pointerId)&&N.releasePointerCapture($.pointerId),document.body.style.webkitUserSelect=g.current,f.viewport&&(f.viewport.style.scrollBehavior=""),x.current=null})})})}),Rg="ScrollAreaThumb",dM=k.forwardRef((t,e)=>{const{forceMount:n,...s}=t,r=uM(Rg,t.__scopeScrollArea);return w.jsx(gs,{present:n||r.hasThumb,children:w.jsx(OZ,{ref:e,...s})})}),OZ=k.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:s,...r}=t,i=Cr(Rg,n),o=uM(Rg,n),{onThumbPositionChange:a}=o,l=Le(e,h=>o.onThumbChange(h)),c=k.useRef(void 0),u=Hx(()=>{c.current&&(c.current(),c.current=void 0)},100);return k.useEffect(()=>{const h=i.viewport;if(h){const d=()=>{if(u(),!c.current){const f=zZ(h,a);c.current=f,a()}};return a(),h.addEventListener("scroll",d),()=>h.removeEventListener("scroll",d)}},[i.viewport,u,a]),w.jsx(Te.div,{"data-state":o.hasThumb?"visible":"hidden",...r,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:be(t.onPointerDownCapture,h=>{const f=h.target.getBoundingClientRect(),p=h.clientX-f.left,m=h.clientY-f.top;o.onThumbPointerDown({x:p,y:m})}),onPointerUp:be(t.onPointerUp,o.onThumbPointerUp)})});dM.displayName=Rg;var YS="ScrollAreaCorner",fM=k.forwardRef((t,e)=>{const n=Cr(YS,t.__scopeScrollArea),s=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&s?w.jsx(MZ,{...t,ref:e}):null});fM.displayName=YS;var MZ=k.forwardRef((t,e)=>{const{__scopeScrollArea:n,...s}=t,r=Cr(YS,n),[i,o]=k.useState(0),[a,l]=k.useState(0),c=!!(i&&a);return eu(r.scrollbarX,()=>{var h;const u=((h=r.scrollbarX)==null?void 0:h.offsetHeight)||0;r.onCornerHeightChange(u),l(u)}),eu(r.scrollbarY,()=>{var h;const u=((h=r.scrollbarY)==null?void 0:h.offsetWidth)||0;r.onCornerWidthChange(u),o(u)}),c?w.jsx(Te.div,{...s,ref:e,style:{width:i,height:a,position:"absolute",right:r.dir==="ltr"?0:void 0,left:r.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Ag(t){return t?parseInt(t,10):0}function pM(t,e){const n=t/e;return isNaN(n)?0:n}function Gx(t){const e=pM(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=(t.scrollbar.size-n)*e;return Math.max(s,18)}function LZ(t,e,n,s="ltr"){const r=Gx(n),i=r/2,o=e||i,a=r-o,l=n.scrollbar.paddingStart+o,c=n.scrollbar.size-n.scrollbar.paddingEnd-a,u=n.content-n.viewport,h=s==="ltr"?[0,u]:[u*-1,0];return mM([l,c],h)(t)}function J2(t,e,n="ltr"){const s=Gx(e),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-r,o=e.content-e.viewport,a=i-s,l=n==="ltr"?[0,o]:[o*-1,0],c=gd(t,l);return mM([0,o],[0,a])(c)}function mM(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const s=(e[1]-e[0])/(t[1]-t[0]);return e[0]+s*(n-t[0])}}function gM(t,e){return t>0&&t<e}var zZ=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},s=0;return function r(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,a=n.top!==i.top;(o||a)&&e(),n=i,s=window.requestAnimationFrame(r)}(),()=>window.cancelAnimationFrame(s)};function Hx(t,e){const n=gn(t),s=k.useRef(0);return k.useEffect(()=>()=>window.clearTimeout(s.current),[]),k.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(n,e)},[n,e])}function eu(t,e){const n=gn(e);wn(()=>{let s=0;if(t){const r=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(n)});return r.observe(t),()=>{window.cancelAnimationFrame(s),r.unobserve(t)}}},[t,n])}var xM=oM,VZ=lM,BZ=fM;const Do=oe.forwardRef(({className:t,children:e,...n},s)=>w.jsxs(xM,{ref:s,className:Ie("relative overflow-hidden",t),...n,children:[w.jsx(VZ,{className:"h-full w-full rounded-[inherit]",children:e}),w.jsx(vM,{}),w.jsx(BZ,{})]}));Do.displayName=xM.displayName;const vM=oe.forwardRef(({className:t,orientation:e="vertical",...n},s)=>w.jsx(XS,{ref:s,orientation:e,className:Ie("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:w.jsx(dM,{className:"relative flex-1 rounded-full bg-border"})}));vM.displayName=XS.displayName;function jZ(t,e=globalThis==null?void 0:globalThis.document){const n=gn(t);k.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var WZ="DismissableLayer",n1="dismissableLayer.update",UZ="dismissableLayer.pointerDownOutside",GZ="dismissableLayer.focusOutside",eR,yM=k.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bu=k.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=k.useContext(yM),[u,h]=k.useState(null),d=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=k.useState({}),p=Le(e,T=>h(T)),m=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=m.indexOf(v),g=u?m.indexOf(u):-1,y=c.layersWithOutsidePointerEventsDisabled.size>0,b=g>=x,C=KZ(T=>{const I=T.target,$=[...c.branches].some(N=>N.contains(I));!b||$||(r==null||r(T),o==null||o(T),T.defaultPrevented||a==null||a())},d),S=XZ(T=>{const I=T.target;[...c.branches].some(N=>N.contains(I))||(i==null||i(T),o==null||o(T),T.defaultPrevented||a==null||a())},d);return jZ(T=>{g===c.layers.size-1&&(s==null||s(T),!T.defaultPrevented&&a&&(T.preventDefault(),a()))},d),k.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(eR=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),tR(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=eR)}},[u,d,n,c]),k.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),tR())},[u,c]),k.useEffect(()=>{const T=()=>f({});return document.addEventListener(n1,T),()=>document.removeEventListener(n1,T)},[]),w.jsx(Te.div,{...l,ref:p,style:{pointerEvents:y?b?"auto":"none":void 0,...t.style},onFocusCapture:be(t.onFocusCapture,S.onFocusCapture),onBlurCapture:be(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:be(t.onPointerDownCapture,C.onPointerDownCapture)})});bu.displayName=WZ;var HZ="DismissableLayerBranch",bM=k.forwardRef((t,e)=>{const n=k.useContext(yM),s=k.useRef(null),r=Le(e,s);return k.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),w.jsx(Te.div,{...t,ref:r})});bM.displayName=HZ;function KZ(t,e=globalThis==null?void 0:globalThis.document){const n=gn(t),s=k.useRef(!1),r=k.useRef(()=>{});return k.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){wM(UZ,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function XZ(t,e=globalThis==null?void 0:globalThis.document){const n=gn(t),s=k.useRef(!1);return k.useEffect(()=>{const r=i=>{i.target&&!s.current&&wM(GZ,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function tR(){const t=new CustomEvent(n1);document.dispatchEvent(t)}function wM(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?rM(r,i):r.dispatchEvent(i)}var qZ=bu,YZ=bM,Jy=0;function QS(){k.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??nR()),document.body.insertAdjacentElement("beforeend",t[1]??nR()),Jy++,()=>{Jy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Jy--}},[])}function nR(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var eb="focusScope.autoFocusOnMount",tb="focusScope.autoFocusOnUnmount",sR={bubbles:!1,cancelable:!0},QZ="FocusScope",Kx=k.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:i,...o}=t,[a,l]=k.useState(null),c=gn(r),u=gn(i),h=k.useRef(null),d=Le(e,m=>l(m)),f=k.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;k.useEffect(()=>{if(s){let m=function(y){if(f.paused||!a)return;const b=y.target;a.contains(b)?h.current=b:So(h.current,{select:!0})},v=function(y){if(f.paused||!a)return;const b=y.relatedTarget;b!==null&&(a.contains(b)||So(h.current,{select:!0}))},x=function(y){if(document.activeElement===document.body)for(const C of y)C.removedNodes.length>0&&So(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const g=new MutationObserver(x);return a&&g.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),g.disconnect()}}},[s,a,f.paused]),k.useEffect(()=>{if(a){iR.add(f);const m=document.activeElement;if(!a.contains(m)){const x=new CustomEvent(eb,sR);a.addEventListener(eb,c),a.dispatchEvent(x),x.defaultPrevented||(ZZ(sJ(CM(a)),{select:!0}),document.activeElement===m&&So(a))}return()=>{a.removeEventListener(eb,c),setTimeout(()=>{const x=new CustomEvent(tb,sR);a.addEventListener(tb,u),a.dispatchEvent(x),x.defaultPrevented||So(m??document.body,{select:!0}),a.removeEventListener(tb,u),iR.remove(f)},0)}}},[a,c,u,f]);const p=k.useCallback(m=>{if(!n&&!s||f.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,x=document.activeElement;if(v&&x){const g=m.currentTarget,[y,b]=JZ(g);y&&b?!m.shiftKey&&x===b?(m.preventDefault(),n&&So(y,{select:!0})):m.shiftKey&&x===y&&(m.preventDefault(),n&&So(b,{select:!0})):x===g&&m.preventDefault()}},[n,s,f.paused]);return w.jsx(Te.div,{tabIndex:-1,...o,ref:d,onKeyDown:p})});Kx.displayName=QZ;function ZZ(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(So(s,{select:e}),document.activeElement!==n)return}function JZ(t){const e=CM(t),n=rR(e,t),s=rR(e.reverse(),t);return[n,s]}function CM(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function rR(t,e){for(const n of t)if(!eJ(n,{upTo:e}))return n}function eJ(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function tJ(t){return t instanceof HTMLInputElement&&"select"in t}function So(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&tJ(t)&&e&&t.select()}}var iR=nJ();function nJ(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=oR(t,e),t.unshift(e)},remove(e){var n;t=oR(t,e),(n=t[0])==null||n.resume()}}}function oR(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function sJ(t){return t.filter(e=>e.tagName!=="A")}var rJ=VD[" useId ".trim().toString()]||(()=>{}),iJ=0;function gr(t){const[e,n]=k.useState(rJ());return wn(()=>{t||n(s=>s??String(iJ++))},[t]),t||(e?`radix-${e}`:"")}const oJ=["top","right","bottom","left"],na=Math.min,Os=Math.max,Dg=Math.round,Zp=Math.floor,Si=t=>({x:t,y:t}),aJ={left:"right",right:"left",bottom:"top",top:"bottom"},lJ={start:"end",end:"start"};function s1(t,e,n){return Os(t,na(e,n))}function io(t,e){return typeof t=="function"?t(e):t}function oo(t){return t.split("-")[0]}function wu(t){return t.split("-")[1]}function ZS(t){return t==="x"?"y":"x"}function JS(t){return t==="y"?"height":"width"}const cJ=new Set(["top","bottom"]);function gi(t){return cJ.has(oo(t))?"y":"x"}function ek(t){return ZS(gi(t))}function uJ(t,e,n){n===void 0&&(n=!1);const s=wu(t),r=ek(t),i=JS(r);let o=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=_g(o)),[o,_g(o)]}function hJ(t){const e=_g(t);return[r1(t),e,r1(e)]}function r1(t){return t.replace(/start|end/g,e=>lJ[e])}const aR=["left","right"],lR=["right","left"],dJ=["top","bottom"],fJ=["bottom","top"];function pJ(t,e,n){switch(t){case"top":case"bottom":return n?e?lR:aR:e?aR:lR;case"left":case"right":return e?dJ:fJ;default:return[]}}function mJ(t,e,n,s){const r=wu(t);let i=pJ(oo(t),n==="start",s);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(r1)))),i}function _g(t){return t.replace(/left|right|bottom|top/g,e=>aJ[e])}function gJ(t){return{top:0,right:0,bottom:0,left:0,...t}}function SM(t){return typeof t!="number"?gJ(t):{top:t,right:t,bottom:t,left:t}}function Pg(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function cR(t,e,n){let{reference:s,floating:r}=t;const i=gi(e),o=ek(e),a=JS(o),l=oo(e),c=i==="y",u=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,d=s[a]/2-r[a]/2;let f;switch(l){case"top":f={x:u,y:s.y-r.height};break;case"bottom":f={x:u,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:h};break;case"left":f={x:s.x-r.width,y:h};break;default:f={x:s.x,y:s.y}}switch(wu(e)){case"start":f[o]-=d*(n&&c?-1:1);break;case"end":f[o]+=d*(n&&c?-1:1);break}return f}const xJ=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:h}=cR(c,s,l),d=s,f={},p=0;for(let m=0;m<a.length;m++){const{name:v,fn:x}=a[m],{x:g,y,data:b,reset:C}=await x({x:u,y:h,initialPlacement:s,placement:d,strategy:r,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=g??u,h=y??h,f={...f,[v]:{...f[v],...b}},C&&p<=50&&(p++,typeof C=="object"&&(C.placement&&(d=C.placement),C.rects&&(c=C.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):C.rects),{x:u,y:h}=cR(c,d,l)),m=-1)}return{x:u,y:h,placement:d,strategy:r,middlewareData:f}};async function xd(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=io(e,t),p=SM(f),v=a[d?h==="floating"?"reference":"floating":h],x=Pg(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),g=h==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,y=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(y))?await(i.getScale==null?void 0:i.getScale(y))||{x:1,y:1}:{x:1,y:1},C=Pg(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:g,offsetParent:y,strategy:l}):g);return{top:(x.top-C.top+p.top)/b.y,bottom:(C.bottom-x.bottom+p.bottom)/b.y,left:(x.left-C.left+p.left)/b.x,right:(C.right-x.right+p.right)/b.x}}const vJ=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=io(t,e)||{};if(c==null)return{};const h=SM(u),d={x:n,y:s},f=ek(r),p=JS(f),m=await o.getDimensions(c),v=f==="y",x=v?"top":"left",g=v?"bottom":"right",y=v?"clientHeight":"clientWidth",b=i.reference[p]+i.reference[f]-d[f]-i.floating[p],C=d[f]-i.reference[f],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let T=S?S[y]:0;(!T||!await(o.isElement==null?void 0:o.isElement(S)))&&(T=a.floating[y]||i.floating[p]);const I=b/2-C/2,$=T/2-m[p]/2-1,N=na(h[x],$),A=na(h[g],$),F=N,E=T-m[p]-A,R=T/2-m[p]/2+I,O=s1(F,R,E),P=!l.arrow&&wu(r)!=null&&R!==O&&i.reference[p]/2-(R<F?N:A)-m[p]/2<0,z=P?R<F?R-F:R-E:0;return{[f]:d[f]+z,data:{[f]:O,centerOffset:R-O-z,...P&&{alignmentOffset:z}},reset:P}}}),yJ=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...v}=io(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=oo(r),g=gi(a),y=oo(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=d||(y||!m?[_g(a)]:hJ(a)),S=p!=="none";!d&&S&&C.push(...mJ(a,m,p,b));const T=[a,...C],I=await xd(e,v),$=[];let N=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&$.push(I[x]),h){const R=uJ(r,o,b);$.push(I[R[0]],I[R[1]])}if(N=[...N,{placement:r,overflows:$}],!$.every(R=>R<=0)){var A,F;const R=(((A=i.flip)==null?void 0:A.index)||0)+1,O=T[R];if(O&&(!(h==="alignment"?g!==gi(O):!1)||N.every(_=>gi(_.placement)===g?_.overflows[0]>0:!0)))return{data:{index:R,overflows:N},reset:{placement:O}};let P=(F=N.filter(z=>z.overflows[0]<=0).sort((z,_)=>z.overflows[1]-_.overflows[1])[0])==null?void 0:F.placement;if(!P)switch(f){case"bestFit":{var E;const z=(E=N.filter(_=>{if(S){const M=gi(_.placement);return M===g||M==="y"}return!0}).map(_=>[_.placement,_.overflows.filter(M=>M>0).reduce((M,U)=>M+U,0)]).sort((_,M)=>_[1]-M[1])[0])==null?void 0:E[0];z&&(P=z);break}case"initialPlacement":P=a;break}if(r!==P)return{reset:{placement:P}}}return{}}}};function uR(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function hR(t){return oJ.some(e=>t[e]>=0)}const bJ=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=io(t,e);switch(s){case"referenceHidden":{const i=await xd(e,{...r,elementContext:"reference"}),o=uR(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:hR(o)}}}case"escaped":{const i=await xd(e,{...r,altBoundary:!0}),o=uR(i,n.floating);return{data:{escapedOffsets:o,escaped:hR(o)}}}default:return{}}}}},kM=new Set(["left","top"]);async function wJ(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=oo(n),a=wu(n),l=gi(n)==="y",c=kM.has(o)?-1:1,u=i&&l?-1:1,h=io(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const CJ=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:o,middlewareData:a}=e,l=await wJ(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:o}}}}},SJ=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:v=>{let{x,y:g}=v;return{x,y:g}}},...l}=io(t,e),c={x:n,y:s},u=await xd(e,l),h=gi(oo(r)),d=ZS(h);let f=c[d],p=c[h];if(i){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",g=f+u[v],y=f-u[x];f=s1(g,f,y)}if(o){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",g=p+u[v],y=p-u[x];p=s1(g,p,y)}const m=a.fn({...e,[d]:f,[h]:p});return{...m,data:{x:m.x-n,y:m.y-s,enabled:{[d]:i,[h]:o}}}}}},kJ=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=io(t,e),u={x:n,y:s},h=gi(r),d=ZS(h);let f=u[d],p=u[h];const m=io(a,e),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const y=d==="y"?"height":"width",b=i.reference[d]-i.floating[y]+v.mainAxis,C=i.reference[d]+i.reference[y]-v.mainAxis;f<b?f=b:f>C&&(f=C)}if(c){var x,g;const y=d==="y"?"width":"height",b=kM.has(oo(r)),C=i.reference[h]-i.floating[y]+(b&&((x=o.offset)==null?void 0:x[h])||0)+(b?0:v.crossAxis),S=i.reference[h]+i.reference[y]+(b?0:((g=o.offset)==null?void 0:g[h])||0)-(b?v.crossAxis:0);p<C?p=C:p>S&&(p=S)}return{[d]:f,[h]:p}}}},TJ=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=io(t,e),u=await xd(e,c),h=oo(r),d=wu(r),f=gi(r)==="y",{width:p,height:m}=i.floating;let v,x;h==="top"||h==="bottom"?(v=h,x=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(x=h,v=d==="end"?"top":"bottom");const g=m-u.top-u.bottom,y=p-u.left-u.right,b=na(m-u[v],g),C=na(p-u[x],y),S=!e.middlewareData.shift;let T=b,I=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=y),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(T=g),S&&!d){const N=Os(u.left,0),A=Os(u.right,0),F=Os(u.top,0),E=Os(u.bottom,0);f?I=p-2*(N!==0||A!==0?N+A:Os(u.left,u.right)):T=m-2*(F!==0||E!==0?F+E:Os(u.top,u.bottom))}await l({...e,availableWidth:I,availableHeight:T});const $=await o.getDimensions(a.floating);return p!==$.width||m!==$.height?{reset:{rects:!0}}:{}}}};function Xx(){return typeof window<"u"}function Cu(t){return TM(t)?(t.nodeName||"").toLowerCase():"#document"}function Bs(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Oi(t){var e;return(e=(TM(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function TM(t){return Xx()?t instanceof Node||t instanceof Bs(t).Node:!1}function Kr(t){return Xx()?t instanceof Element||t instanceof Bs(t).Element:!1}function Ei(t){return Xx()?t instanceof HTMLElement||t instanceof Bs(t).HTMLElement:!1}function dR(t){return!Xx()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Bs(t).ShadowRoot}const IJ=new Set(["inline","contents"]);function Ud(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=Xr(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!IJ.has(r)}const $J=new Set(["table","td","th"]);function NJ(t){return $J.has(Cu(t))}const EJ=[":popover-open",":modal"];function qx(t){return EJ.some(e=>{try{return t.matches(e)}catch{return!1}})}const RJ=["transform","translate","scale","rotate","perspective"],AJ=["transform","translate","scale","rotate","perspective","filter"],DJ=["paint","layout","strict","content"];function tk(t){const e=nk(),n=Kr(t)?Xr(t):t;return RJ.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||AJ.some(s=>(n.willChange||"").includes(s))||DJ.some(s=>(n.contain||"").includes(s))}function _J(t){let e=sa(t);for(;Ei(e)&&!tu(e);){if(tk(e))return e;if(qx(e))return null;e=sa(e)}return null}function nk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const PJ=new Set(["html","body","#document"]);function tu(t){return PJ.has(Cu(t))}function Xr(t){return Bs(t).getComputedStyle(t)}function Yx(t){return Kr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function sa(t){if(Cu(t)==="html")return t;const e=t.assignedSlot||t.parentNode||dR(t)&&t.host||Oi(t);return dR(e)?e.host:e}function IM(t){const e=sa(t);return tu(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ei(e)&&Ud(e)?e:IM(e)}function vd(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=IM(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),o=Bs(r);if(i){const a=i1(o);return e.concat(o,o.visualViewport||[],Ud(r)?r:[],a&&n?vd(a):[])}return e.concat(r,vd(r,[],n))}function i1(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function $M(t){const e=Xr(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Ei(t),i=r?t.offsetWidth:n,o=r?t.offsetHeight:s,a=Dg(n)!==i||Dg(s)!==o;return a&&(n=i,s=o),{width:n,height:s,$:a}}function sk(t){return Kr(t)?t:t.contextElement}function Oc(t){const e=sk(t);if(!Ei(e))return Si(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=$M(e);let o=(i?Dg(n.width):n.width)/s,a=(i?Dg(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const FJ=Si(0);function NM(t){const e=Bs(t);return!nk()||!e.visualViewport?FJ:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function OJ(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Bs(t)?!1:e}function pl(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=sk(t);let o=Si(1);e&&(s?Kr(s)&&(o=Oc(s)):o=Oc(t));const a=OJ(i,n,s)?NM(i):Si(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,u=r.width/o.x,h=r.height/o.y;if(i){const d=Bs(i),f=s&&Kr(s)?Bs(s):s;let p=d,m=i1(p);for(;m&&s&&f!==p;){const v=Oc(m),x=m.getBoundingClientRect(),g=Xr(m),y=x.left+(m.clientLeft+parseFloat(g.paddingLeft))*v.x,b=x.top+(m.clientTop+parseFloat(g.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,h*=v.y,l+=y,c+=b,p=Bs(m),m=i1(p)}}return Pg({width:u,height:h,x:l,y:c})}function Qx(t,e){const n=Yx(t).scrollLeft;return e?e.left+n:pl(Oi(t)).left+n}function EM(t,e){const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-Qx(t,n),r=n.top+e.scrollTop;return{x:s,y:r}}function MJ(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",o=Oi(s),a=e?qx(e.floating):!1;if(s===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Si(1);const u=Si(0),h=Ei(s);if((h||!h&&!i)&&((Cu(s)!=="body"||Ud(o))&&(l=Yx(s)),Ei(s))){const f=pl(s);c=Oc(s),u.x=f.x+s.clientLeft,u.y=f.y+s.clientTop}const d=o&&!h&&!i?EM(o,l):Si(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:n.y*c.y-l.scrollTop*c.y+u.y+d.y}}function LJ(t){return Array.from(t.getClientRects())}function zJ(t){const e=Oi(t),n=Yx(t),s=t.ownerDocument.body,r=Os(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=Os(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+Qx(t);const a=-n.scrollTop;return Xr(s).direction==="rtl"&&(o+=Os(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:o,y:a}}const fR=25;function VJ(t,e){const n=Bs(t),s=Oi(t),r=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){i=r.width,o=r.height;const u=nk();(!u||u&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const c=Qx(s);if(c<=0){const u=s.ownerDocument,h=u.body,d=getComputedStyle(h),f=u.compatMode==="CSS1Compat"&&parseFloat(d.marginLeft)+parseFloat(d.marginRight)||0,p=Math.abs(s.clientWidth-h.clientWidth-f);p<=fR&&(i-=p)}else c<=fR&&(i+=c);return{width:i,height:o,x:a,y:l}}const BJ=new Set(["absolute","fixed"]);function jJ(t,e){const n=pl(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=Ei(t)?Oc(t):Si(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=r*i.x,c=s*i.y;return{width:o,height:a,x:l,y:c}}function pR(t,e,n){let s;if(e==="viewport")s=VJ(t,n);else if(e==="document")s=zJ(Oi(t));else if(Kr(e))s=jJ(e,n);else{const r=NM(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return Pg(s)}function RM(t,e){const n=sa(t);return n===e||!Kr(n)||tu(n)?!1:Xr(n).position==="fixed"||RM(n,e)}function WJ(t,e){const n=e.get(t);if(n)return n;let s=vd(t,[],!1).filter(a=>Kr(a)&&Cu(a)!=="body"),r=null;const i=Xr(t).position==="fixed";let o=i?sa(t):t;for(;Kr(o)&&!tu(o);){const a=Xr(o),l=tk(o);!l&&a.position==="fixed"&&(r=null),(i?!l&&!r:!l&&a.position==="static"&&!!r&&BJ.has(r.position)||Ud(o)&&!l&&RM(t,o))?s=s.filter(u=>u!==o):r=a,o=sa(o)}return e.set(t,s),s}function UJ(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const o=[...n==="clippingAncestors"?qx(e)?[]:WJ(e,this._c):[].concat(n),s],a=o[0],l=o.reduce((c,u)=>{const h=pR(e,u,r);return c.top=Os(h.top,c.top),c.right=na(h.right,c.right),c.bottom=na(h.bottom,c.bottom),c.left=Os(h.left,c.left),c},pR(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function GJ(t){const{width:e,height:n}=$M(t);return{width:e,height:n}}function HJ(t,e,n){const s=Ei(e),r=Oi(e),i=n==="fixed",o=pl(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Si(0);function c(){l.x=Qx(r)}if(s||!s&&!i)if((Cu(e)!=="body"||Ud(r))&&(a=Yx(e)),s){const f=pl(e,!0,i,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else r&&c();i&&!s&&r&&c();const u=r&&!s&&!i?EM(r,a):Si(0),h=o.left+a.scrollLeft-l.x-u.x,d=o.top+a.scrollTop-l.y-u.y;return{x:h,y:d,width:o.width,height:o.height}}function nb(t){return Xr(t).position==="static"}function mR(t,e){if(!Ei(t)||Xr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Oi(t)===n&&(n=n.ownerDocument.body),n}function AM(t,e){const n=Bs(t);if(qx(t))return n;if(!Ei(t)){let r=sa(t);for(;r&&!tu(r);){if(Kr(r)&&!nb(r))return r;r=sa(r)}return n}let s=mR(t,e);for(;s&&NJ(s)&&nb(s);)s=mR(s,e);return s&&tu(s)&&nb(s)&&!tk(s)?n:s||_J(t)||n}const KJ=async function(t){const e=this.getOffsetParent||AM,n=this.getDimensions,s=await n(t.floating);return{reference:HJ(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function XJ(t){return Xr(t).direction==="rtl"}const qJ={convertOffsetParentRelativeRectToViewportRelativeRect:MJ,getDocumentElement:Oi,getClippingRect:UJ,getOffsetParent:AM,getElementRects:KJ,getClientRects:LJ,getDimensions:GJ,getScale:Oc,isElement:Kr,isRTL:XJ};function DM(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function YJ(t,e){let n=null,s;const r=Oi(t);function i(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(a||e(),!d||!f)return;const p=Zp(h),m=Zp(r.clientWidth-(u+d)),v=Zp(r.clientHeight-(h+f)),x=Zp(u),y={rootMargin:-p+"px "+-m+"px "+-v+"px "+-x+"px",threshold:Os(0,na(1,l))||1};let b=!0;function C(S){const T=S[0].intersectionRatio;if(T!==l){if(!b)return o();T?o(!1,T):s=setTimeout(()=>{o(!1,1e-7)},1e3)}T===1&&!DM(c,t.getBoundingClientRect())&&o(),b=!1}try{n=new IntersectionObserver(C,{...y,root:r.ownerDocument})}catch{n=new IntersectionObserver(C,y)}n.observe(t)}return o(!0),i}function QJ(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=sk(t),u=r||i?[...c?vd(c):[],...vd(e)]:[];u.forEach(x=>{r&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const h=c&&a?YJ(c,n):null;let d=-1,f=null;o&&(f=new ResizeObserver(x=>{let[g]=x;g&&g.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var y;(y=f)==null||y.observe(e)})),n()}),c&&!l&&f.observe(c),f.observe(e));let p,m=l?pl(t):null;l&&v();function v(){const x=pl(t);m&&!DM(m,x)&&n(),m=x,p=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(g=>{r&&g.removeEventListener("scroll",n),i&&g.removeEventListener("resize",n)}),h==null||h(),(x=f)==null||x.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const ZJ=CJ,JJ=SJ,eee=yJ,tee=TJ,nee=bJ,gR=vJ,see=kJ,ree=(t,e,n)=>{const s=new Map,r={platform:qJ,...n},i={...r.platform,_c:s};return xJ(t,e,{...r,platform:i})};var iee=typeof document<"u",oee=function(){},Om=iee?k.useLayoutEffect:oee;function Fg(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!Fg(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!Fg(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function _M(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function xR(t,e){const n=_M(t);return Math.round(e*n)/n}function sb(t){const e=k.useRef(t);return Om(()=>{e.current=t}),e}function aee(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=k.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=k.useState(s);Fg(d,s)||f(s);const[p,m]=k.useState(null),[v,x]=k.useState(null),g=k.useCallback(_=>{_!==S.current&&(S.current=_,m(_))},[]),y=k.useCallback(_=>{_!==T.current&&(T.current=_,x(_))},[]),b=i||p,C=o||v,S=k.useRef(null),T=k.useRef(null),I=k.useRef(u),$=l!=null,N=sb(l),A=sb(r),F=sb(c),E=k.useCallback(()=>{if(!S.current||!T.current)return;const _={placement:e,strategy:n,middleware:d};A.current&&(_.platform=A.current),ree(S.current,T.current,_).then(M=>{const U={...M,isPositioned:F.current!==!1};R.current&&!Fg(I.current,U)&&(I.current=U,Pl.flushSync(()=>{h(U)}))})},[d,e,n,A,F]);Om(()=>{c===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,h(_=>({..._,isPositioned:!1})))},[c]);const R=k.useRef(!1);Om(()=>(R.current=!0,()=>{R.current=!1}),[]),Om(()=>{if(b&&(S.current=b),C&&(T.current=C),b&&C){if(N.current)return N.current(b,C,E);E()}},[b,C,E,N,$]);const O=k.useMemo(()=>({reference:S,floating:T,setReference:g,setFloating:y}),[g,y]),P=k.useMemo(()=>({reference:b,floating:C}),[b,C]),z=k.useMemo(()=>{const _={position:n,left:0,top:0};if(!P.floating)return _;const M=xR(P.floating,u.x),U=xR(P.floating,u.y);return a?{..._,transform:"translate("+M+"px, "+U+"px)",..._M(P.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:M,top:U}},[n,a,P.floating,u.x,u.y]);return k.useMemo(()=>({...u,update:E,refs:O,elements:P,floatingStyles:z}),[u,E,O,P,z])}const lee=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?gR({element:s.current,padding:r}).fn(n):{}:s?gR({element:s,padding:r}).fn(n):{}}}},cee=(t,e)=>({...ZJ(t),options:[t,e]}),uee=(t,e)=>({...JJ(t),options:[t,e]}),hee=(t,e)=>({...see(t),options:[t,e]}),dee=(t,e)=>({...eee(t),options:[t,e]}),fee=(t,e)=>({...tee(t),options:[t,e]}),pee=(t,e)=>({...nee(t),options:[t,e]}),mee=(t,e)=>({...lee(t),options:[t,e]});var gee="Arrow",PM=k.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return w.jsx(Te.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:w.jsx("polygon",{points:"0,0 30,0 15,10"})})});PM.displayName=gee;var xee=PM;function rk(t){const[e,n]=k.useState(void 0);return wn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var ik="Popper",[FM,Su]=_s(ik),[vee,OM]=FM(ik),MM=t=>{const{__scopePopper:e,children:n}=t,[s,r]=k.useState(null);return w.jsx(vee,{scope:e,anchor:s,onAnchorChange:r,children:n})};MM.displayName=ik;var LM="PopperAnchor",zM=k.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=OM(LM,n),o=k.useRef(null),a=Le(e,o),l=k.useRef(null);return k.useEffect(()=>{const c=l.current;l.current=(s==null?void 0:s.current)||o.current,c!==l.current&&i.onAnchorChange(l.current)}),s?null:w.jsx(Te.div,{...r,ref:a})});zM.displayName=LM;var ok="PopperContent",[yee,bee]=FM(ok),VM=k.forwardRef((t,e)=>{var te,le,q,ie,ce,we;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:p,...m}=t,v=OM(ok,n),[x,g]=k.useState(null),y=Le(e,se=>g(se)),[b,C]=k.useState(null),S=rk(b),T=(S==null?void 0:S.width)??0,I=(S==null?void 0:S.height)??0,$=s+(i!=="center"?"-"+i:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},A=Array.isArray(c)?c:[c],F=A.length>0,E={padding:N,boundary:A.filter(Cee),altBoundary:F},{refs:R,floatingStyles:O,placement:P,isPositioned:z,middlewareData:_}=aee({strategy:"fixed",placement:$,whileElementsMounted:(...se)=>QJ(...se,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[cee({mainAxis:r+I,alignmentAxis:o}),l&&uee({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?hee():void 0,...E}),l&&dee({...E}),fee({...E,apply:({elements:se,rects:ye,availableWidth:ge,availableHeight:me})=>{const{width:Ae,height:Fe}=ye.reference,it=se.floating.style;it.setProperty("--radix-popper-available-width",`${ge}px`),it.setProperty("--radix-popper-available-height",`${me}px`),it.setProperty("--radix-popper-anchor-width",`${Ae}px`),it.setProperty("--radix-popper-anchor-height",`${Fe}px`)}}),b&&mee({element:b,padding:a}),See({arrowWidth:T,arrowHeight:I}),d&&pee({strategy:"referenceHidden",...E})]}),[M,U]=WM(P),W=gn(p);wn(()=>{z&&(W==null||W())},[z,W]);const X=(te=_.arrow)==null?void 0:te.x,J=(le=_.arrow)==null?void 0:le.y,Z=((q=_.arrow)==null?void 0:q.centerOffset)!==0,[re,Q]=k.useState();return wn(()=>{x&&Q(window.getComputedStyle(x).zIndex)},[x]),w.jsx("div",{ref:R.setFloating,"data-radix-popper-content-wrapper":"",style:{...O,transform:z?O.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(ie=_.transformOrigin)==null?void 0:ie.x,(ce=_.transformOrigin)==null?void 0:ce.y].join(" "),...((we=_.hide)==null?void 0:we.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:w.jsx(yee,{scope:n,placedSide:M,onArrowChange:C,arrowX:X,arrowY:J,shouldHideArrow:Z,children:w.jsx(Te.div,{"data-side":M,"data-align":U,...m,ref:y,style:{...m.style,animation:z?void 0:"none"}})})})});VM.displayName=ok;var BM="PopperArrow",wee={top:"bottom",right:"left",bottom:"top",left:"right"},jM=k.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=bee(BM,s),o=wee[i.placedSide];return w.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:w.jsx(xee,{...r,ref:n,style:{...r.style,display:"block"}})})});jM.displayName=BM;function Cee(t){return t!==null}var See=t=>({name:"transformOrigin",options:t,fn(e){var v,x,g;const{placement:n,rects:s,middlewareData:r}=e,o=((v=r.arrow)==null?void 0:v.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=WM(n),h={start:"0%",center:"50%",end:"100%"}[u],d=(((x=r.arrow)==null?void 0:x.x)??0)+a/2,f=(((g=r.arrow)==null?void 0:g.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=o?h:`${d}px`,m=`${-l}px`):c==="top"?(p=o?h:`${d}px`,m=`${s.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=o?h:`${f}px`):c==="left"&&(p=`${s.floating.width+l}px`,m=o?h:`${f}px`),{data:{x:p,y:m}}}});function WM(t){const[e,n="center"]=t.split("-");return[e,n]}var ak=MM,Zx=zM,lk=VM,ck=jM,kee="Portal",Gd=k.forwardRef((t,e)=>{var a;const{container:n,...s}=t,[r,i]=k.useState(!1);wn(()=>i(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?$6.createPortal(w.jsx(Te.div,{...s,ref:e}),o):null});Gd.displayName=kee;var Tee=VD[" useInsertionEffect ".trim().toString()]||wn;function Gs({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,o]=Iee({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const u=k.useRef(t!==void 0);k.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,s])}const c=k.useCallback(u=>{var h;if(a){const d=$ee(u)?u(t):u;d!==t&&((h=o.current)==null||h.call(o,d))}else i(u)},[a,t,i,o]);return[l,c]}function Iee({defaultProp:t,onChange:e}){const[n,s]=k.useState(t),r=k.useRef(n),i=k.useRef(e);return Tee(()=>{i.current=e},[e]),k.useEffect(()=>{var o;r.current!==n&&((o=i.current)==null||o.call(i,n),r.current=n)},[n,r]),[n,s,i]}function $ee(t){return typeof t=="function"}var Nee=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Jl=new WeakMap,Jp=new WeakMap,em={},rb=0,UM=function(t){return t&&(t.host||UM(t.parentNode))},Eee=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=UM(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Ree=function(t,e,n,s){var r=Eee(e,Array.isArray(t)?t:[t]);em[n]||(em[n]=new WeakMap);var i=em[n],o=[],a=new Set,l=new Set(r),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};r.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(d){if(a.has(d))u(d);else try{var f=d.getAttribute(s),p=f!==null&&f!=="false",m=(Jl.get(d)||0)+1,v=(i.get(d)||0)+1;Jl.set(d,m),i.set(d,v),o.push(d),m===1&&p&&Jp.set(d,!0),v===1&&d.setAttribute(n,"true"),p||d.setAttribute(s,"true")}catch(x){console.error("aria-hidden: cannot operate on ",d,x)}})};return u(e),a.clear(),rb++,function(){o.forEach(function(h){var d=Jl.get(h)-1,f=i.get(h)-1;Jl.set(h,d),i.set(h,f),d||(Jp.has(h)||h.removeAttribute(s),Jp.delete(h)),f||h.removeAttribute(n)}),rb--,rb||(Jl=new WeakMap,Jl=new WeakMap,Jp=new WeakMap,em={})}},uk=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=e||Nee(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),Ree(s,r,n,"aria-hidden")):function(){return null}},fi=function(){return fi=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fi.apply(this,arguments)};function GM(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function Aee(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}var Mm="right-scroll-bar-position",Lm="width-before-scroll-bar",Dee="with-scroll-bars-hidden",_ee="--removed-body-scroll-bar-size";function ib(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Pee(t,e){var n=k.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var r=n.value;r!==s&&(n.value=s,n.callback(s,r))}}}})[0];return n.callback=e,n.facade}var Fee=typeof window<"u"?k.useLayoutEffect:k.useEffect,vR=new WeakMap;function Oee(t,e){var n=Pee(e||null,function(s){return t.forEach(function(r){return ib(r,s)})});return Fee(function(){var s=vR.get(n);if(s){var r=new Set(s),i=new Set(t),o=n.current;r.forEach(function(a){i.has(a)||ib(a,null)}),i.forEach(function(a){r.has(a)||ib(a,o)})}vR.set(n,t)},[t]),n}function Mee(t){return t}function Lee(t,e){e===void 0&&(e=Mee);var n=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return r}function zee(t){t===void 0&&(t={});var e=Lee(null);return e.options=fi({async:!0,ssr:!1},t),e}var HM=function(t){var e=t.sideCar,n=GM(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return k.createElement(s,fi({},n))};HM.isSideCarExport=!0;function Vee(t,e){return t.useMedium(e),HM}var KM=zee(),ob=function(){},Jx=k.forwardRef(function(t,e){var n=k.useRef(null),s=k.useState({onScrollCapture:ob,onWheelCapture:ob,onTouchMoveCapture:ob}),r=s[0],i=s[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,h=t.shards,d=t.sideCar,f=t.noRelative,p=t.noIsolation,m=t.inert,v=t.allowPinchZoom,x=t.as,g=x===void 0?"div":x,y=t.gapMode,b=GM(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=d,S=Oee([n,e]),T=fi(fi({},b),r);return k.createElement(k.Fragment,null,u&&k.createElement(C,{sideCar:KM,removeScrollBar:c,shards:h,noRelative:f,noIsolation:p,inert:m,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:y}),o?k.cloneElement(k.Children.only(a),fi(fi({},T),{ref:S})):k.createElement(g,fi({},T,{className:l,ref:S}),a))});Jx.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Jx.classNames={fullWidth:Lm,zeroRight:Mm};var yR,Bee=function(){if(yR)return yR;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function jee(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Bee();return e&&t.setAttribute("nonce",e),t}function Wee(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Uee(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Gee=function(){var t=0,e=null;return{add:function(n){t==0&&(e=jee())&&(Wee(e,n),Uee(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Hee=function(){var t=Gee();return function(e,n){k.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},XM=function(){var t=Hee(),e=function(n){var s=n.styles,r=n.dynamic;return t(s,r),null};return e},Kee={left:0,top:0,right:0,gap:0},ab=function(t){return parseInt(t||"",10)||0},Xee=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[ab(n),ab(s),ab(r)]},qee=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Kee;var e=Xee(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},Yee=XM(),Mc="data-scroll-locked",Qee=function(t,e,n,s){var r=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Dee,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(Mc,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Mm,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(Lm,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(Mm," .").concat(Mm,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Lm," .").concat(Lm,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Mc,`] {
    `).concat(_ee,": ").concat(a,`px;
  }
`)},bR=function(){var t=parseInt(document.body.getAttribute(Mc)||"0",10);return isFinite(t)?t:0},Zee=function(){k.useEffect(function(){return document.body.setAttribute(Mc,(bR()+1).toString()),function(){var t=bR()-1;t<=0?document.body.removeAttribute(Mc):document.body.setAttribute(Mc,t.toString())}},[])},Jee=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,r=s===void 0?"margin":s;Zee();var i=k.useMemo(function(){return qee(r)},[r]);return k.createElement(Yee,{styles:Qee(i,!e,r,n?"":"!important")})},o1=!1;if(typeof window<"u")try{var tm=Object.defineProperty({},"passive",{get:function(){return o1=!0,!0}});window.addEventListener("test",tm,tm),window.removeEventListener("test",tm,tm)}catch{o1=!1}var ec=o1?{passive:!1}:!1,ete=function(t){return t.tagName==="TEXTAREA"},qM=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!ete(t)&&n[e]==="visible")},tte=function(t){return qM(t,"overflowY")},nte=function(t){return qM(t,"overflowX")},wR=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=YM(t,s);if(r){var i=QM(t,s),o=i[1],a=i[2];if(o>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},ste=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},rte=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},YM=function(t,e){return t==="v"?tte(e):nte(e)},QM=function(t,e){return t==="v"?ste(e):rte(e)},ite=function(t,e){return t==="h"&&e==="rtl"?-1:1},ote=function(t,e,n,s,r){var i=ite(t,window.getComputedStyle(e).direction),o=i*s,a=n.target,l=e.contains(a),c=!1,u=o>0,h=0,d=0;do{if(!a)break;var f=QM(t,a),p=f[0],m=f[1],v=f[2],x=m-v-i*p;(p||x)&&YM(t,a)&&(h+=x,d+=p);var g=a.parentNode;a=g&&g.nodeType===Node.DOCUMENT_FRAGMENT_NODE?g.host:g}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(r&&Math.abs(h)<1||!r&&o>h)||!u&&(r&&Math.abs(d)<1||!r&&-o>d))&&(c=!0),c},nm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},CR=function(t){return[t.deltaX,t.deltaY]},SR=function(t){return t&&"current"in t?t.current:t},ate=function(t,e){return t[0]===e[0]&&t[1]===e[1]},lte=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},cte=0,tc=[];function ute(t){var e=k.useRef([]),n=k.useRef([0,0]),s=k.useRef(),r=k.useState(cte++)[0],i=k.useState(XM)[0],o=k.useRef(t);k.useEffect(function(){o.current=t},[t]),k.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var m=Aee([t.lockRef.current],(t.shards||[]).map(SR),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=k.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!o.current.allowPinchZoom;var x=nm(m),g=n.current,y="deltaX"in m?m.deltaX:g[0]-x[0],b="deltaY"in m?m.deltaY:g[1]-x[1],C,S=m.target,T=Math.abs(y)>Math.abs(b)?"h":"v";if("touches"in m&&T==="h"&&S.type==="range")return!1;var I=wR(T,S);if(!I)return!0;if(I?C=T:(C=T==="v"?"h":"v",I=wR(T,S)),!I)return!1;if(!s.current&&"changedTouches"in m&&(y||b)&&(s.current=C),!C)return!0;var $=s.current||C;return ote($,v,m,$==="h"?y:b,!0)},[]),l=k.useCallback(function(m){var v=m;if(!(!tc.length||tc[tc.length-1]!==i)){var x="deltaY"in v?CR(v):nm(v),g=e.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&ate(C.delta,x)})[0];if(g&&g.should){v.cancelable&&v.preventDefault();return}if(!g){var y=(o.current.shards||[]).map(SR).filter(Boolean).filter(function(C){return C.contains(v.target)}),b=y.length>0?a(v,y[0]):!o.current.noIsolation;b&&v.cancelable&&v.preventDefault()}}},[]),c=k.useCallback(function(m,v,x,g){var y={name:m,delta:v,target:x,should:g,shadowParent:hte(x)};e.current.push(y),setTimeout(function(){e.current=e.current.filter(function(b){return b!==y})},1)},[]),u=k.useCallback(function(m){n.current=nm(m),s.current=void 0},[]),h=k.useCallback(function(m){c(m.type,CR(m),m.target,a(m,t.lockRef.current))},[]),d=k.useCallback(function(m){c(m.type,nm(m),m.target,a(m,t.lockRef.current))},[]);k.useEffect(function(){return tc.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",l,ec),document.addEventListener("touchmove",l,ec),document.addEventListener("touchstart",u,ec),function(){tc=tc.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,ec),document.removeEventListener("touchmove",l,ec),document.removeEventListener("touchstart",u,ec)}},[]);var f=t.removeScrollBar,p=t.inert;return k.createElement(k.Fragment,null,p?k.createElement(i,{styles:lte(r)}):null,f?k.createElement(Jee,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function hte(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const dte=Vee(KM,ute);var ZM=k.forwardRef(function(t,e){return k.createElement(Jx,fi({},t,{ref:e,sideCar:dte}))});ZM.classNames=Jx.classNames;const hk=ZM;var e0="Popover",[JM,MAe]=_s(e0,[Su]),Hd=Su(),[fte,ma]=JM(e0),eL=t=>{const{__scopePopover:e,children:n,open:s,defaultOpen:r,onOpenChange:i,modal:o=!1}=t,a=Hd(e),l=k.useRef(null),[c,u]=k.useState(!1),[h,d]=Gs({prop:s,defaultProp:r??!1,onChange:i,caller:e0});return w.jsx(ak,{...a,children:w.jsx(fte,{scope:e,contentId:gr(),triggerRef:l,open:h,onOpenChange:d,onOpenToggle:k.useCallback(()=>d(f=>!f),[d]),hasCustomAnchor:c,onCustomAnchorAdd:k.useCallback(()=>u(!0),[]),onCustomAnchorRemove:k.useCallback(()=>u(!1),[]),modal:o,children:n})})};eL.displayName=e0;var tL="PopoverAnchor",pte=k.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,r=ma(tL,n),i=Hd(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return k.useEffect(()=>(o(),()=>a()),[o,a]),w.jsx(Zx,{...i,...s,ref:e})});pte.displayName=tL;var nL="PopoverTrigger",sL=k.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,r=ma(nL,n),i=Hd(n),o=Le(e,r.triggerRef),a=w.jsx(Te.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":lL(r.open),...s,ref:o,onClick:be(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:w.jsx(Zx,{asChild:!0,...i,children:a})});sL.displayName=nL;var dk="PopoverPortal",[mte,gte]=JM(dk,{forceMount:void 0}),rL=t=>{const{__scopePopover:e,forceMount:n,children:s,container:r}=t,i=ma(dk,e);return w.jsx(mte,{scope:e,forceMount:n,children:w.jsx(gs,{present:n||i.open,children:w.jsx(Gd,{asChild:!0,container:r,children:s})})})};rL.displayName=dk;var nu="PopoverContent",iL=k.forwardRef((t,e)=>{const n=gte(nu,t.__scopePopover),{forceMount:s=n.forceMount,...r}=t,i=ma(nu,t.__scopePopover);return w.jsx(gs,{present:s||i.open,children:i.modal?w.jsx(vte,{...r,ref:e}):w.jsx(yte,{...r,ref:e})})});iL.displayName=nu;var xte=fl("PopoverContent.RemoveScroll"),vte=k.forwardRef((t,e)=>{const n=ma(nu,t.__scopePopover),s=k.useRef(null),r=Le(e,s),i=k.useRef(!1);return k.useEffect(()=>{const o=s.current;if(o)return uk(o)},[]),w.jsx(hk,{as:xte,allowPinchZoom:!0,children:w.jsx(oL,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:be(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),i.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:be(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:be(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),yte=k.forwardRef((t,e)=>{const n=ma(nu,t.__scopePopover),s=k.useRef(!1),r=k.useRef(!1);return w.jsx(oL,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(s.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&r.current&&i.preventDefault()}})}),oL=k.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...h}=t,d=ma(nu,n),f=Hd(n);return QS(),w.jsx(Kx,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:i,children:w.jsx(bu,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>d.onOpenChange(!1),children:w.jsx(lk,{"data-state":lL(d.open),role:"dialog",id:d.contentId,...f,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),aL="PopoverClose",bte=k.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,r=ma(aL,n);return w.jsx(Te.button,{type:"button",...s,ref:e,onClick:be(t.onClick,()=>r.onOpenChange(!1))})});bte.displayName=aL;var wte="PopoverArrow",Cte=k.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,r=Hd(n);return w.jsx(ck,{...r,...s,ref:e})});Cte.displayName=wte;function lL(t){return t?"open":"closed"}var Ste=eL,kte=sL,Tte=rL,cL=iL;const uL=Ste,hL=kte,fk=oe.forwardRef(({className:t,align:e="center",sideOffset:n=4,...s},r)=>w.jsx(Tte,{children:w.jsx(cL,{ref:r,align:e,sideOffset:n,className:Ie("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));fk.displayName=cL.displayName;const kR=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,TR=YO,pk=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return TR(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(c=>{const u=n==null?void 0:n[c],h=i==null?void 0:i[c];if(u===null)return null;const d=kR(u)||kR(h);return r[c][d]}),a=n&&Object.entries(n).reduce((c,u)=>{let[h,d]=u;return d===void 0||(c[h]=d),c},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((c,u)=>{let{class:h,className:d,...f}=u;return Object.entries(f).every(p=>{let[m,v]=p;return Array.isArray(v)?v.includes({...i,...a}[m]):{...i,...a}[m]===v})?[...c,h,d]:c},[]);return TR(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},Ite=pk("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",brand:"bg-red-500 text-white hover:bg-red-600"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Be=oe.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const o=s?gZ:"button";return w.jsx(o,{className:Ie(Ite({variant:e,size:n,className:t})),ref:i,...r})});Be.displayName="Button";function Kd(t){const e=t+"CollectionProvider",[n,s]=_s(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:v,children:x}=m,g=oe.useRef(null),y=oe.useRef(new Map).current;return w.jsx(r,{scope:v,itemMap:y,collectionRef:g,children:x})};o.displayName=e;const a=t+"CollectionSlot",l=fl(a),c=oe.forwardRef((m,v)=>{const{scope:x,children:g}=m,y=i(a,x),b=Le(v,y.collectionRef);return w.jsx(l,{ref:b,children:g})});c.displayName=a;const u=t+"CollectionItemSlot",h="data-radix-collection-item",d=fl(u),f=oe.forwardRef((m,v)=>{const{scope:x,children:g,...y}=m,b=oe.useRef(null),C=Le(v,b),S=i(u,x);return oe.useEffect(()=>(S.itemMap.set(b,{ref:b,...y}),()=>void S.itemMap.delete(b))),w.jsx(d,{[h]:"",ref:C,children:g})});f.displayName=u;function p(m){const v=i(t+"CollectionConsumer",m);return oe.useCallback(()=>{const g=v.collectionRef.current;if(!g)return[];const y=Array.from(g.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((S,T)=>y.indexOf(S.ref.current)-y.indexOf(T.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:c,ItemSlot:f},p,s]}var t0="Collapsible",[$te,dL]=_s(t0),[Nte,mk]=$te(t0),fL=k.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:s,defaultOpen:r,disabled:i,onOpenChange:o,...a}=t,[l,c]=Gs({prop:s,defaultProp:r??!1,onChange:o,caller:t0});return w.jsx(Nte,{scope:n,disabled:i,contentId:gr(),open:l,onOpenToggle:k.useCallback(()=>c(u=>!u),[c]),children:w.jsx(Te.div,{"data-state":xk(l),"data-disabled":i?"":void 0,...a,ref:e})})});fL.displayName=t0;var pL="CollapsibleTrigger",mL=k.forwardRef((t,e)=>{const{__scopeCollapsible:n,...s}=t,r=mk(pL,n);return w.jsx(Te.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":xk(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...s,ref:e,onClick:be(t.onClick,r.onOpenToggle)})});mL.displayName=pL;var gk="CollapsibleContent",gL=k.forwardRef((t,e)=>{const{forceMount:n,...s}=t,r=mk(gk,t.__scopeCollapsible);return w.jsx(gs,{present:n||r.open,children:({present:i})=>w.jsx(Ete,{...s,ref:e,present:i})})});gL.displayName=gk;var Ete=k.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:s,children:r,...i}=t,o=mk(gk,n),[a,l]=k.useState(s),c=k.useRef(null),u=Le(e,c),h=k.useRef(0),d=h.current,f=k.useRef(0),p=f.current,m=o.open||a,v=k.useRef(m),x=k.useRef(void 0);return k.useEffect(()=>{const g=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(g)},[]),wn(()=>{const g=c.current;if(g){x.current=x.current||{transitionDuration:g.style.transitionDuration,animationName:g.style.animationName},g.style.transitionDuration="0s",g.style.animationName="none";const y=g.getBoundingClientRect();h.current=y.height,f.current=y.width,v.current||(g.style.transitionDuration=x.current.transitionDuration,g.style.animationName=x.current.animationName),l(s)}},[o.open,s]),w.jsx(Te.div,{"data-state":xk(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!m,...i,ref:u,style:{"--radix-collapsible-content-height":d?`${d}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...t.style},children:m&&r})});function xk(t){return t?"open":"closed"}var Rte=fL,Ate=mL,Dte=gL,Jr="Accordion",_te=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[vk,Pte,Fte]=Kd(Jr),[n0,LAe]=_s(Jr,[Fte,dL]),yk=dL(),Ote=oe.forwardRef((t,e)=>{const{type:n,...s}=t,r=s,i=s;return w.jsx(vk.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?w.jsx(Vte,{...i,ref:e}):w.jsx(zte,{...r,ref:e})})});Ote.displayName=Jr;var[xL,Mte]=n0(Jr),[vL,Lte]=n0(Jr,{collapsible:!1}),zte=oe.forwardRef((t,e)=>{const{value:n,defaultValue:s,onValueChange:r=()=>{},collapsible:i=!1,...o}=t,[a,l]=Gs({prop:n,defaultProp:s??"",onChange:r,caller:Jr});return w.jsx(xL,{scope:t.__scopeAccordion,value:oe.useMemo(()=>a?[a]:[],[a]),onItemOpen:l,onItemClose:oe.useCallback(()=>i&&l(""),[i,l]),children:w.jsx(vL,{scope:t.__scopeAccordion,collapsible:i,children:w.jsx(yL,{...o,ref:e})})})}),Vte=oe.forwardRef((t,e)=>{const{value:n,defaultValue:s,onValueChange:r=()=>{},...i}=t,[o,a]=Gs({prop:n,defaultProp:s??[],onChange:r,caller:Jr}),l=oe.useCallback(u=>a((h=[])=>[...h,u]),[a]),c=oe.useCallback(u=>a((h=[])=>h.filter(d=>d!==u)),[a]);return w.jsx(xL,{scope:t.__scopeAccordion,value:o,onItemOpen:l,onItemClose:c,children:w.jsx(vL,{scope:t.__scopeAccordion,collapsible:!0,children:w.jsx(yL,{...i,ref:e})})})}),[Bte,s0]=n0(Jr),yL=oe.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:s,dir:r,orientation:i="vertical",...o}=t,a=oe.useRef(null),l=Le(a,e),c=Pte(n),h=yu(r)==="ltr",d=be(t.onKeyDown,f=>{var I;if(!_te.includes(f.key))return;const p=f.target,m=c().filter($=>{var N;return!((N=$.ref.current)!=null&&N.disabled)}),v=m.findIndex($=>$.ref.current===p),x=m.length;if(v===-1)return;f.preventDefault();let g=v;const y=0,b=x-1,C=()=>{g=v+1,g>b&&(g=y)},S=()=>{g=v-1,g<y&&(g=b)};switch(f.key){case"Home":g=y;break;case"End":g=b;break;case"ArrowRight":i==="horizontal"&&(h?C():S());break;case"ArrowDown":i==="vertical"&&C();break;case"ArrowLeft":i==="horizontal"&&(h?S():C());break;case"ArrowUp":i==="vertical"&&S();break}const T=g%x;(I=m[T].ref.current)==null||I.focus()});return w.jsx(Bte,{scope:n,disabled:s,direction:r,orientation:i,children:w.jsx(vk.Slot,{scope:n,children:w.jsx(Te.div,{...o,"data-orientation":i,ref:l,onKeyDown:s?void 0:d})})})}),Og="AccordionItem",[jte,bk]=n0(Og),bL=oe.forwardRef((t,e)=>{const{__scopeAccordion:n,value:s,...r}=t,i=s0(Og,n),o=Mte(Og,n),a=yk(n),l=gr(),c=s&&o.value.includes(s)||!1,u=i.disabled||t.disabled;return w.jsx(jte,{scope:n,open:c,disabled:u,triggerId:l,children:w.jsx(Rte,{"data-orientation":i.orientation,"data-state":IL(c),...a,...r,ref:e,disabled:u,open:c,onOpenChange:h=>{h?o.onItemOpen(s):o.onItemClose(s)}})})});bL.displayName=Og;var wL="AccordionHeader",CL=oe.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,r=s0(Jr,n),i=bk(wL,n);return w.jsx(Te.h3,{"data-orientation":r.orientation,"data-state":IL(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:e})});CL.displayName=wL;var a1="AccordionTrigger",SL=oe.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,r=s0(Jr,n),i=bk(a1,n),o=Lte(a1,n),a=yk(n);return w.jsx(vk.ItemSlot,{scope:n,children:w.jsx(Ate,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":r.orientation,id:i.triggerId,...a,...s,ref:e})})});SL.displayName=a1;var kL="AccordionContent",TL=oe.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,r=s0(Jr,n),i=bk(kL,n),o=yk(n);return w.jsx(Dte,{role:"region","aria-labelledby":i.triggerId,"data-orientation":r.orientation,...o,...s,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});TL.displayName=kL;function IL(t){return t?"open":"closed"}var Wte=bL,Ute=CL,$L=SL,NL=TL;const Gte=k.forwardRef(({className:t,...e},n)=>w.jsx(Wte,{ref:n,className:Ie("border-b border-b-mauve-6 data-[state=closed]:border-b-transparent dark:border-b-mauve-6 dark:data-[state=closed]:border-b-transparent",t),...e}));Gte.displayName="AccordionItem";const Hte=k.forwardRef(({className:t,children:e,...n},s)=>w.jsx(Ute,{className:"flex",children:w.jsxs($L,{ref:s,className:Ie("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,w.jsx($S,{className:"h-4 w-4 transition-transform duration-200"})]})}));Hte.displayName=$L.displayName;const Kte=k.forwardRef(({className:t,children:e,...n},s)=>w.jsx(NL,{ref:s,className:Ie("overflow-hidden text-sm transition-all data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up",t),...n,children:w.jsx("div",{className:"pt-0 pb-4",children:e})}));Kte.displayName=NL.displayName;const Xte=1089,IR={AUD:"",CAD:"",CHF:"",EUR:"",GBP:"",JPY:"",NZD:"",SGD:"",USD:"",MXN:"",NOK:"",PLN:"",SEK:"",DXY:""},$R={Favorites:"",Derived:"",Forex:"","Stock Indices":"",Commodities:"",Cryptocurrencies:"",Stocks:""},NR={"Major Pairs":"","Minor Pairs":"","Continuous Indices":"","Crash/Boom Indices":"","Step Indices":"","Jump Indices":"","Range Break Indices":"","Daily Reset Indices":"",Baskets:"",Metals:"",Cryptocurrencies:""},qte=({selectedMarket:t,onMarketChange:e,latestTick:n,fullView:s=!1,appId:r=Xte})=>{const[i,o]=k.useState(!1),[a,l]=k.useState(""),[c,u]=k.useState([]),[h,d]=k.useState([]),[f,p]=k.useState("Forex"),[m,v]=k.useState(!1),x=k.useRef(null);k.useEffect(()=>{const E=localStorage.getItem("tradingChartFavorites");E&&u(JSON.parse(E))},[]),k.useEffect(()=>{localStorage.setItem("tradingChartFavorites",JSON.stringify(c))},[c]);const g=k.useCallback(()=>{x.current&&x.current.close();const E=new WebSocket(`wss://ws.derivws.com/websockets/v3?app_id=${r}`);return x.current=E,E.onopen=()=>{v(!1),E.send(JSON.stringify({active_symbols:"brief",product_type:"basic"}))},E.onmessage=R=>{const O=JSON.parse(R.data);O.msg_type==="active_symbols"&&(d(O.active_symbols.map(P=>{const{symbol:z,display_name:_,market:M,market_display_name:U,subgroup:W,subgroup_display_name:X,submarket:J,submarket_display_name:Z}=P;let re=[],Q=U||y(M),te=Z||X||b(J,W,M);if(M==="forex"){const le=_.replace(/\/|\s/g,""),q=le.slice(0,3),ie=le.slice(3,6);re=[IR[q]||q,IR[ie]||ie]}else["synthetic_index"].includes(M)?re=[""]:M==="commodities"?_.includes("Gold")?re=[""]:_.includes("Silver")?re=[""]:_.includes("Oil")?re=[""]:re=[""]:M==="cryptocurrency"?re=[""]:re=[""];return{id:z,name:_,category:Q,subcategory:te,flags:re,display_order:P.display_order,pip:P.pip,...P}}).sort((P,z)=>P.display_order-z.display_order||P.name.localeCompare(z.name))),E.close())},E.onerror=()=>{v(!0)},E.onclose=()=>{x.current=null},()=>{E&&E.close()}},[r]);k.useEffect(()=>{g()},[g]);const y=k.useCallback(E=>({forex:"Forex",stocks:"Stocks",indices:"Stock Indices",commodities:"Commodities",cryptocurrency:"Cryptocurrencies",synthetic_index:"Derived"})[E]||E,[]),b=k.useCallback((E,R,O)=>{if(O==="synthetic_index"){if(R==="synthetics"){if(E==="random_index")return"Continuous Indices";if(E==="crash_index")return"Crash/Boom Indices";if(E==="step_index")return"Step Indices";if(E==="jump_index")return"Jump Indices";if(E==="range_index")return"Range Break Indices";if(E==="random_daily")return"Daily Reset Indices"}else if(R==="baskets")return"Baskets"}else if(O==="forex"){if(E==="major_pairs")return"Major Pairs";if(E==="minor_pairs")return"Minor Pairs"}else if(O==="commodities"&&E==="metals")return"Metals";return E||R||""},[]),C=k.useMemo(()=>{const E={};return h.forEach(R=>{const O=R.category;E[O]||(E[O]={items:[],subcategories:{}});const P=R.subcategory;P&&P!==O&&P!==""?(E[O].subcategories[P]||(E[O].subcategories[P]=[]),E[O].subcategories[P].push(R)):E[O].items.push(R)}),Object.keys(E).forEach(R=>{E[R].items.sort((O,P)=>O.display_order-P.display_order||O.name.localeCompare(P.name)),Object.keys(E[R].subcategories).forEach(O=>{E[R].subcategories[O].sort((P,z)=>P.display_order-z.display_order||P.name.localeCompare(z.name))})}),E},[h]),S=k.useMemo(()=>({Favorites:{items:c.map(R=>h.find(O=>O.id===R)).filter(Boolean).sort((R,O)=>R.display_order-O.display_order||R.name.localeCompare(O.name)),subcategories:{}}}),[c,h]),T=k.useCallback(E=>{u(R=>R.includes(E)?R.filter(O=>O!==E):[...R,E])},[]),I=k.useCallback(E=>{e(E),s||o(!1)},[e,s]),$=k.useMemo(()=>h.find(E=>E.id===t),[h,t]),N=k.useMemo(()=>a.trim()===""?[]:h.filter(E=>E.name.toLowerCase().includes(a.toLowerCase())).sort((E,R)=>E.display_order-R.display_order||E.name.localeCompare(R.name)),[a,h]),A=k.useMemo(()=>["Favorites","Derived","Forex","Stock Indices","Commodities","Cryptocurrencies","Stocks"],[]),F=k.useCallback(E=>{p(E)},[]);return h.length===0&&!m?w.jsx(Be,{variant:"outline",className:"w-auto md:w-[280px] justify-between bg-white border-gray-200 text-gray-800 h-auto p-2 rounded-lg shadow-sm",disabled:!0,children:"Loading markets..."}):m?w.jsx(Be,{variant:"outline",className:"w-auto md:w-[280px] justify-between bg-white border-red-200 text-red-600 h-auto p-2 rounded-lg shadow-sm",onClick:g,children:"Failed to load markets. Retry?"}):s?w.jsxs("div",{className:"flex h-full bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[w.jsx("div",{className:"w-1/4 border-r border-gray-200 bg-gray-50",children:w.jsx(Do,{className:"h-full",children:w.jsxs("div",{className:"p-2 space-y-1",children:[c.length>0&&w.jsxs("div",{onClick:()=>F("Favorites"),className:Ie("p-2 rounded-md cursor-pointer text-sm font-medium transition-colors flex items-center gap-2",f==="Favorites"?"bg-white text-black shadow-sm border border-gray-300":"text-gray-600 hover:bg-gray-100"),children:[w.jsx(xh,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),"Favorites (",c.length,")"]}),A.filter(E=>C[E]).map(E=>w.jsxs("div",{onClick:()=>F(E),className:Ie("p-2 rounded-md cursor-pointer text-sm font-medium transition-colors flex items-center gap-2",f===E?"bg-white text-black shadow-sm border border-gray-300":"text-gray-600 hover:bg-gray-100"),children:[w.jsx("span",{children:$R[E]||""}),E]},E))]})})}),w.jsxs("div",{className:"w-3/4 flex flex-col",children:[w.jsx("div",{className:"p-2 border-b border-gray-200",children:w.jsxs("div",{className:"relative",children:[w.jsx(Ig,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),w.jsx(mi,{placeholder:"Search markets...",value:a,onChange:E=>l(E.target.value),className:"pl-9 bg-gray-100 border-gray-200 text-gray-800 rounded-md"})]})}),w.jsxs(Do,{className:"flex-1 p-2",children:[c.length>0&&a===""&&f==="Favorites"&&w.jsxs("div",{className:"mb-4",children:[w.jsxs("h3",{className:"text-xs font-semibold text-gray-500 mb-2 px-2 flex items-center gap-1",children:[w.jsx(xh,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),"Favorites"]}),S.Favorites.items.map(E=>w.jsx(bo,{market:E,isSelected:t===E.id,isFavorite:!0,onSelect:I,onToggleFavorite:T,showSparkline:!0},E.id))]}),a===""?(()=>{const E=f==="Favorites"?S.Favorites:C[f];return E?w.jsxs("div",{className:"space-y-1",children:[Object.entries(E.subcategories).map(([R,O])=>w.jsxs("div",{children:[R&&w.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-1 px-2 flex items-center gap-1 border-l-2 border-blue-500 pl-2",children:[NR[R]||""," ",R]}),O.map(P=>w.jsx(bo,{market:P,isSelected:t===P.id,isFavorite:c.includes(P.id),onSelect:I,onToggleFavorite:T,showSparkline:!0},P.id))]},R)),E.items.map(R=>w.jsx(bo,{market:R,isSelected:t===R.id,isFavorite:c.includes(R.id),onSelect:I,onToggleFavorite:T,showSparkline:!0},R.id))]}):w.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"No markets in this category."})})():N.map(E=>w.jsx(bo,{market:E,isSelected:t===E.id,isFavorite:c.includes(E.id),onSelect:I,onToggleFavorite:T},E.id)),a!==""&&N.length===0&&w.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"No markets found."})]})]})]}):w.jsxs(uL,{open:i,onOpenChange:o,children:[w.jsx(hL,{asChild:!0,children:w.jsxs(Be,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-auto md:w-[280px] justify-between bg-white hover:bg-gray-50 border-gray-200 text-gray-800 h-auto p-2 shadow-sm rounded-lg",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"flex items-center",children:$==null?void 0:$.flags.map((E,R)=>w.jsx("span",{className:Ie("text-2xl",R>0&&"-ml-2"),children:E},R))}),w.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[w.jsx("p",{className:"font-bold text-base truncate",children:($==null?void 0:$.name)||"Select Market"}),n&&w.jsxs("p",{className:Ie("text-xs truncate",n.change>=0?"text-green-600":"text-red-600"),children:[n.price.toFixed(5)," ",w.jsxs("span",{className:"ml-2",children:[n.change>=0?"+":"",n.change.toFixed(5)]}),w.jsxs("span",{className:"ml-2",children:["(",n.percentChange.toFixed(2),"%)"]})]})]})]}),w.jsx($S,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),w.jsx(fk,{className:"w-[620px] p-0 bg-white border-gray-200 shadow-lg rounded-xl",children:w.jsxs("div",{className:"flex h-[400px]",children:[w.jsx("div",{className:"w-1/3 border-r border-gray-200 bg-gray-50",children:w.jsx(Do,{className:"h-full",children:w.jsxs("div",{className:"p-2 space-y-1",children:[c.length>0&&w.jsxs("div",{onClick:()=>F("Favorites"),className:Ie("p-2 rounded-md cursor-pointer text-sm font-medium transition-colors flex items-center gap-2",f==="Favorites"?"bg-white text-black shadow-sm border border-gray-300":"text-gray-600 hover:bg-gray-100"),children:[w.jsx(xh,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),"Favorites (",c.length,")"]}),A.filter(E=>C[E]).map(E=>w.jsxs("div",{onClick:()=>F(E),className:Ie("p-2 rounded-md cursor-pointer text-sm font-medium transition-colors flex items-center gap-2",f===E?"bg-white text-black shadow-sm border border-gray-300":"text-gray-600 hover:bg-gray-100"),children:[w.jsx("span",{children:$R[E]||""}),E]},E))]})})}),w.jsxs("div",{className:"w-2/3",children:[w.jsx("div",{className:"p-2 border-b border-gray-200",children:w.jsxs("div",{className:"relative",children:[w.jsx(Ig,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),w.jsx(mi,{placeholder:"Search markets...",value:a,onChange:E=>l(E.target.value),className:"pl-9 bg-gray-100 border-gray-200 text-gray-800 rounded-md"})]})}),w.jsxs(Do,{className:"h-[calc(400px-50px)] p-2",children:[c.length>0&&a===""&&f==="Favorites"&&w.jsxs("div",{className:"mb-4",children:[w.jsxs("h3",{className:"text-xs font-semibold text-gray-500 mb-2 px-2 flex items-center gap-1",children:[w.jsx(xh,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),"Favorites"]}),S.Favorites.items.map(E=>w.jsx(bo,{market:E,isSelected:t===E.id,isFavorite:!0,onSelect:I,onToggleFavorite:T,showSparkline:!0},E.id))]}),a===""?(()=>{const E=f==="Favorites"?S.Favorites:C[f];return E?w.jsxs("div",{className:"space-y-1",children:[Object.entries(E.subcategories).map(([R,O])=>w.jsxs("div",{children:[R&&w.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-1 px-2 flex items-center gap-1 border-l-2 border-blue-500 pl-2",children:[NR[R]||""," ",R]}),O.map(P=>w.jsx(bo,{market:P,isSelected:t===P.id,isFavorite:c.includes(P.id),onSelect:I,onToggleFavorite:T,showSparkline:!0},P.id))]},R)),E.items.map(R=>w.jsx(bo,{market:R,isSelected:t===R.id,isFavorite:c.includes(R.id),onSelect:I,onToggleFavorite:T,showSparkline:!0},R.id))]}):w.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"No markets in this category."})})():N.map(E=>w.jsx(bo,{market:E,isSelected:t===E.id,isFavorite:c.includes(E.id),onSelect:I,onToggleFavorite:T},E.id)),a!==""&&N.length===0&&w.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"No markets found."})]})]})]})})]})},bo=({market:t,isSelected:e,isFavorite:n,onSelect:s,onToggleFavorite:r,showSparkline:i=!1})=>w.jsxs("div",{onClick:()=>s(t.id),className:Ie("flex items-center justify-between p-2 rounded-lg cursor-pointer text-sm hover:bg-gray-100 transition-colors",e&&"bg-gray-100 border border-gray-300"),children:[w.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[w.jsx("div",{className:"flex items-center",children:t.flags.map((o,a)=>w.jsx("span",{className:Ie("text-xl",a>0&&"-ml-1.5"),children:o},a))}),w.jsx("p",{className:"font-medium text-gray-800 truncate",children:t.name})]}),w.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[w.jsx(Be,{variant:"ghost",size:"icon",className:"h-6 w-6 text-gray-500 hover:bg-gray-200 rounded-full",onClick:o=>{o.stopPropagation(),r(t.id)},children:w.jsx(xh,{className:Ie("h-3 w-3",n?"fill-yellow-400 text-yellow-400":"text-gray-400")})}),i&&w.jsx("div",{className:"w-16 h-4 bg-gray-100 rounded",children:w.jsx("svg",{className:"w-full h-full",viewBox:"0 0 40 16",children:w.jsx("path",{d:"M2 12 L8 8 L14 14 L20 10 L26 13 L32 6 L38 11",stroke:"#10B981",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),rh=t=>{if(t==null)return console.warn("Null time value"),Math.floor(Date.now()/1e3);if(typeof t=="number")return t;if(typeof t=="string"){const e=Date.parse(t);if(!isNaN(e))return Math.floor(e/1e3);const n=parseInt(t,10);if(!isNaN(n))return n}return typeof t=="object"&&(t instanceof Date||typeof t.getTime=="function")?Math.floor(t.getTime()/1e3):(console.warn("Invalid time value:",t,"- using current time"),Math.floor(Date.now()/1e3))},EL=k.forwardRef(({data:t=[],chartType:e="candlestick",market:n="default",indicators:s=[],indicatorData:r={},selectedMarket:i,onMarketChange:o,latestTick:a},l)=>{const c=k.useRef(null),u=k.useRef(null),h=k.useRef(null),d=k.useRef({}),f=k.useRef(!1),p=k.useRef([]),m=k.useRef({isVerticalPanning:!1,startY:0,startVisible:null}),v=k.useMemo(()=>t.map(g=>g.close),[t]);k.useImperativeHandle(l,()=>({downloadChart:g=>{if(g==="png"&&u.current)u.current.takeScreenshot().then(y=>{const b=document.createElement("a");b.href=y,b.download=`${n}_chart_${new Date().toISOString()}.png`,document.body.appendChild(b),b.click(),document.body.removeChild(b),gt({title:"Download Complete",description:"Chart screenshot saved as PNG"})}).catch(()=>{gt({title:"Download Error",description:"Failed to capture screenshot.",variant:"destructive"})});else if(g==="csv"&&(t==null?void 0:t.length)>0){const y=["Time,Open,High,Low,Close",...t.map(T=>`${new Date(rh(T.time)*1e3).toISOString()},${T.open},${T.high},${T.low},${T.close}`)].join(`
`),b=new Blob([y],{type:"text/csv"}),C=URL.createObjectURL(b),S=document.createElement("a");S.href=C,S.download=`${n}_${new Date().toISOString()}.csv`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(C),gt({title:"Download Complete",description:"Chart data exported as CSV"})}else gt({title:"Invalid Format",description:`Export to ${g} not supported.`,variant:"destructive"})}})),k.useEffect(()=>{const g=RQ(c.current,{layout:{background:{color:"#ffffff"},textColor:"#334155"},grid:{vertLines:{color:"#f0f0f0",style:$g.Solid,visible:!0},horzLines:{color:"#f0f0f0",style:$g.Solid,visible:!0}},crosshair:{mode:1,vertLine:{labelVisible:!1},horzLine:{labelVisible:!1}},rightPriceScale:{borderColor:"#e0e0e0",scaleMargins:{top:.1,bottom:.1}},leftPriceScale:{borderColor:"#e0e0e0",visible:!0},timeScale:{borderColor:"#e0e0e0",timeVisible:!0,secondsVisible:!1,rightOffset:5},handleScroll:!0,handleScale:!0,watermark:{visible:!1},localization:{locale:"en-US",dateFormat:"dd MMM"}});u.current=g;const y=()=>{const C=document.getElementById("tv-attr-logo");C&&(C.style.display="none")};y(),setTimeout(y,100);const b=()=>{c.current&&u.current&&u.current.resize(c.current.clientWidth,c.current.clientHeight)};return window.addEventListener("resize",b),b(),()=>{window.removeEventListener("resize",b),u.current&&u.current.remove()}},[]),k.useEffect(()=>{const g=c.current;if(!g||!u.current)return;const y=u.current.priceScale("right"),b=$=>{if($.button!==0||!$.shiftKey)return;const N=y.getVisibleRange();!N||N.from>=N.to||t.length===0||(m.current.isVerticalPanning=!0,m.current.startY=$.clientY,m.current.startVisible=N,g.setPointerCapture($.pointerId),g.style.cursor="ns-resize",$.preventDefault())},C=$=>{if(!m.current.isVerticalPanning)return;const N=m.current.startY-$.clientY,A=m.current.startVisible;if(!A)return;const F=g.clientHeight,E=A.to-A.from;if(E<=0)return;const R=F/E,O=N/R,P=A.from+O,z=A.to+O;y.setVisibleRange({from:P,to:z})},S=$=>{m.current.isVerticalPanning&&(m.current.isVerticalPanning=!1,m.current.startVisible=null,g.style.cursor="default",g.releasePointerCapture($.pointerId))},T=$=>{$.key==="Shift"&&(g.style.cursor="ns-resize")},I=$=>{$.key==="Shift"&&(g.style.cursor="default")};return g.addEventListener("pointerdown",b),g.addEventListener("pointermove",C),g.addEventListener("pointerup",S),g.addEventListener("pointerleave",S),window.addEventListener("keydown",T),window.addEventListener("keyup",I),()=>{g.removeEventListener("pointerdown",b),g.removeEventListener("pointermove",C),g.removeEventListener("pointerup",S),g.removeEventListener("pointerleave",S),window.removeEventListener("keydown",T),window.removeEventListener("keyup",I)}},[u,t]),k.useEffect(()=>{if(!u.current)return;h.current&&u.current.removeSeries(h.current),h.current=null,f.current=!1,p.current=[];let g;e==="candlestick"?g=u.current.addCandlestickSeries({upColor:"#26a69a",downColor:"#ef5350",borderVisible:!1,wickUpColor:"#26a69a",wickDownColor:"#ef5350"}):e==="line"?g=u.current.addLineSeries({color:"#2196f3",lineWidth:2}):e==="area"?g=u.current.addAreaSeries({topColor:"rgba(33, 150, 243, 0.4)",bottomColor:"rgba(33, 150, 243, 0.0)",lineColor:"#2196f3",lineWidth:2}):e==="bar"?g=u.current.addBarSeries({upColor:"#26a69a",downColor:"#ef5350"}):e==="hollow"?g=u.current.addCandlestickSeries({upColor:"transparent",downColor:"#ef5350",borderVisible:!0,borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickUpColor:"#26a69a",wickDownColor:"#ef5350"}):e==="ohlc"&&(g=u.current.addCandlestickSeries({upColor:"#26a69a",downColor:"#ef5350",borderVisible:!0,borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickUpColor:"#26a69a",wickDownColor:"#ef5350"})),h.current=g},[e]),k.useEffect(()=>{var C;if(!h.current||!t)return;const g=S=>{if(!S||typeof S.time>"u")return null;const T=rh(S.time);switch(e){case"line":case"area":return{time:T,value:S.close};case"bar":case"candlestick":case"hollow":case"ohlc":return{time:T,open:S.open,high:S.high,low:S.low,close:S.close};default:return null}},y=t.map(g).filter(Boolean);if(y.length===0){h.current.setData([]),p.current=[],f.current=!1;return}const b=p.current;if(b.length===0||!f.current)h.current.setData(y),f.current?u.current.timeScale().scrollToRealTime():(u.current.timeScale().fitContent(),f.current=!0);else{const S=b.length;if(y.length>S){const T=y.slice(S);if(T.length>0){const I=(C=b[b.length-1])==null?void 0:C.time,$=T[0].time;I!==void 0&&$<=I?(console.warn("Cannot append older or equal time data; resetting series"),h.current.setData(y),u.current.timeScale().scrollToRealTime()):(T.forEach(N=>{h.current.update(N)}),u.current.timeScale().scrollToRealTime())}}else if(y.length<b.length)console.warn("Data length reduced; resetting series"),h.current.setData(y),u.current.timeScale().scrollToRealTime();else{const T=b[b.length-1],I=y[y.length-1];T&&I&&(T.time!==I.time||T.open!==I.open||T.high!==I.high||T.low!==I.low||T.close!==I.close||(e==="line"||e==="area")&&T.value!==I.value)&&(h.current.update(I),u.current.timeScale().scrollToRealTime())}}p.current=y},[t,e]),k.useEffect(()=>{if(!u.current||t.length<1)return;const g=Object.keys(d.current),y=s;g.forEach(S=>{y.includes(S)||(u.current.removeSeries(d.current[S]),delete d.current[S])});const b=y.length>0,C=u.current.priceScale("right");if(C&&C.applyOptions({scaleMargins:b?{top:.05,bottom:.2}:{top:.1,bottom:.1}}),y.forEach(S=>{let T=d.current[S];const I=r[S];if(!T){const $={sma:{color:"#795548",lineWidth:2,priceScaleId:"right",priceLineVisible:!1},rsi:{color:"#ff9800",lineWidth:2,priceScaleId:"left",priceLineVisible:!1},custom:{color:"#9c27b0",lineWidth:2,priceScaleId:"right",priceLineVisible:!1}}[S]||{color:"#666",lineWidth:1,priceScaleId:"right",priceLineVisible:!1};T=u.current.addLineSeries($),d.current[S]=T}if(T&&I&&I.length>0&&t.length>=I.length)try{const $=t.slice(0,I.length).map((N,A)=>({time:rh(N.time),value:I[A]}));T.setData($)}catch($){console.error(`Error updating indicator ${S}:`,$),gt({title:"Indicator Error",description:`Failed to update ${S.toUpperCase()}.`,variant:"destructive"})}else if(T)try{if(S==="sma"&&v.length>=14&&!I){const $=jS.calculate({period:14,values:v}),N=t.slice(13).map((A,F)=>({time:rh(A.time),value:$[F]}));T.setData(N)}else if(S==="rsi"&&v.length>=14&&!I){const $=GS.calculate({period:14,values:v}),N=t.slice(13).map((A,F)=>({time:rh(A.time),value:$[F]}));T.setData(N)}}catch($){console.error(`Error updating indicator ${S}:`,$),gt({title:"Indicator Error",description:`Failed to update ${S.toUpperCase()}.`,variant:"destructive"})}}),y.includes("rsi")){const S=u.current.priceScale("left");S&&S.applyOptions({scaleMargins:{top:.8,bottom:.05}})}},[s,t,v,r]);const x=()=>{u.current&&u.current.timeScale().scrollToRealTime()};return w.jsx("div",{className:"flex flex-col h-4/5 w-full rounded-lg border border-gray-200 bg-white shadow-sm ",children:w.jsx("div",{ref:c,className:"flex-1 w-full relative cursor-pointer","aria-label":`Trading chart for ${n}`,role:"img",children:w.jsx("button",{onClick:x,className:"absolute bottom-4 right-4 z-10 flex items-center justify-center w-10 h-10 bg-white border border-gray-300 rounded-full shadow-lg hover:shadow-xl transition-shadow duration-200 opacity-80 hover:opacity-100",title:"Go to latest (real-time)","aria-label":"Scroll to latest data",children:w.jsx(B9,{className:"w-5 h-5 text-gray-600"})})})})});EL.displayName="ChartCanvas";function wk(t){const e=k.useRef({value:t,previous:t});return k.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var RL=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Yte="VisuallyHidden",r0=k.forwardRef((t,e)=>w.jsx(Te.span,{...t,ref:e,style:{...RL,...t.style}}));r0.displayName=Yte;var Qte=r0,Zte=[" ","Enter","ArrowUp","ArrowDown"],Jte=[" ","Enter"],ml="Select",[i0,o0,ene]=Kd(ml),[ku,zAe]=_s(ml,[ene,Su]),a0=Su(),[tne,ga]=ku(ml),[nne,sne]=ku(ml),AL=t=>{const{__scopeSelect:e,children:n,open:s,defaultOpen:r,onOpenChange:i,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:h,disabled:d,required:f,form:p}=t,m=a0(e),[v,x]=k.useState(null),[g,y]=k.useState(null),[b,C]=k.useState(!1),S=yu(c),[T,I]=Gs({prop:s,defaultProp:r??!1,onChange:i,caller:ml}),[$,N]=Gs({prop:o,defaultProp:a,onChange:l,caller:ml}),A=k.useRef(null),F=v?p||!!v.closest("form"):!0,[E,R]=k.useState(new Set),O=Array.from(E).map(P=>P.props.value).join(";");return w.jsx(ak,{...m,children:w.jsxs(tne,{required:f,scope:e,trigger:v,onTriggerChange:x,valueNode:g,onValueNodeChange:y,valueNodeHasChildren:b,onValueNodeHasChildrenChange:C,contentId:gr(),value:$,onValueChange:N,open:T,onOpenChange:I,dir:S,triggerPointerDownPosRef:A,disabled:d,children:[w.jsx(i0.Provider,{scope:e,children:w.jsx(nne,{scope:t.__scopeSelect,onNativeOptionAdd:k.useCallback(P=>{R(z=>new Set(z).add(P))},[]),onNativeOptionRemove:k.useCallback(P=>{R(z=>{const _=new Set(z);return _.delete(P),_})},[]),children:n})}),F?w.jsxs(JL,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:h,value:$,onChange:P=>N(P.target.value),disabled:d,form:p,children:[$===void 0?w.jsx("option",{value:""}):null,Array.from(E)]},O):null]})})};AL.displayName=ml;var DL="SelectTrigger",_L=k.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:s=!1,...r}=t,i=a0(n),o=ga(DL,n),a=o.disabled||s,l=Le(e,o.onTriggerChange),c=o0(n),u=k.useRef("touch"),[h,d,f]=t3(m=>{const v=c().filter(y=>!y.disabled),x=v.find(y=>y.value===o.value),g=n3(v,m,x);g!==void 0&&o.onValueChange(g.value)}),p=m=>{a||(o.onOpenChange(!0),f()),m&&(o.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return w.jsx(Zx,{asChild:!0,...i,children:w.jsx(Te.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":e3(o.value)?"":void 0,...r,ref:l,onClick:be(r.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&p(m)}),onPointerDown:be(r.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(p(m),m.preventDefault())}),onKeyDown:be(r.onKeyDown,m=>{const v=h.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&d(m.key),!(v&&m.key===" ")&&Zte.includes(m.key)&&(p(),m.preventDefault())})})})});_L.displayName=DL;var PL="SelectValue",FL=k.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:r,children:i,placeholder:o="",...a}=t,l=ga(PL,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,h=Le(e,l.onValueNodeChange);return wn(()=>{c(u)},[c,u]),w.jsx(Te.span,{...a,ref:h,style:{pointerEvents:"none"},children:e3(l.value)?w.jsx(w.Fragment,{children:o}):i})});FL.displayName=PL;var rne="SelectIcon",OL=k.forwardRef((t,e)=>{const{__scopeSelect:n,children:s,...r}=t;return w.jsx(Te.span,{"aria-hidden":!0,...r,ref:e,children:s||""})});OL.displayName=rne;var ine="SelectPortal",ML=t=>w.jsx(Gd,{asChild:!0,...t});ML.displayName=ine;var gl="SelectContent",LL=k.forwardRef((t,e)=>{const n=ga(gl,t.__scopeSelect),[s,r]=k.useState();if(wn(()=>{r(new DocumentFragment)},[]),!n.open){const i=s;return i?Pl.createPortal(w.jsx(zL,{scope:t.__scopeSelect,children:w.jsx(i0.Slot,{scope:t.__scopeSelect,children:w.jsx("div",{children:t.children})})}),i):null}return w.jsx(VL,{...t,ref:e})});LL.displayName=gl;var Ar=10,[zL,xa]=ku(gl),one="SelectContentImpl",ane=fl("SelectContent.RemoveScroll"),VL=k.forwardRef((t,e)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:i,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:d,collisionPadding:f,sticky:p,hideWhenDetached:m,avoidCollisions:v,...x}=t,g=ga(gl,n),[y,b]=k.useState(null),[C,S]=k.useState(null),T=Le(e,te=>b(te)),[I,$]=k.useState(null),[N,A]=k.useState(null),F=o0(n),[E,R]=k.useState(!1),O=k.useRef(!1);k.useEffect(()=>{if(y)return uk(y)},[y]),QS();const P=k.useCallback(te=>{const[le,...q]=F().map(we=>we.ref.current),[ie]=q.slice(-1),ce=document.activeElement;for(const we of te)if(we===ce||(we==null||we.scrollIntoView({block:"nearest"}),we===le&&C&&(C.scrollTop=0),we===ie&&C&&(C.scrollTop=C.scrollHeight),we==null||we.focus(),document.activeElement!==ce))return},[F,C]),z=k.useCallback(()=>P([I,y]),[P,I,y]);k.useEffect(()=>{E&&z()},[E,z]);const{onOpenChange:_,triggerPointerDownPosRef:M}=g;k.useEffect(()=>{if(y){let te={x:0,y:0};const le=ie=>{var ce,we;te={x:Math.abs(Math.round(ie.pageX)-(((ce=M.current)==null?void 0:ce.x)??0)),y:Math.abs(Math.round(ie.pageY)-(((we=M.current)==null?void 0:we.y)??0))}},q=ie=>{te.x<=10&&te.y<=10?ie.preventDefault():y.contains(ie.target)||_(!1),document.removeEventListener("pointermove",le),M.current=null};return M.current!==null&&(document.addEventListener("pointermove",le),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",le),document.removeEventListener("pointerup",q,{capture:!0})}}},[y,_,M]),k.useEffect(()=>{const te=()=>_(!1);return window.addEventListener("blur",te),window.addEventListener("resize",te),()=>{window.removeEventListener("blur",te),window.removeEventListener("resize",te)}},[_]);const[U,W]=t3(te=>{const le=F().filter(ce=>!ce.disabled),q=le.find(ce=>ce.ref.current===document.activeElement),ie=n3(le,te,q);ie&&setTimeout(()=>ie.ref.current.focus())}),X=k.useCallback((te,le,q)=>{const ie=!O.current&&!q;(g.value!==void 0&&g.value===le||ie)&&($(te),ie&&(O.current=!0))},[g.value]),J=k.useCallback(()=>y==null?void 0:y.focus(),[y]),Z=k.useCallback((te,le,q)=>{const ie=!O.current&&!q;(g.value!==void 0&&g.value===le||ie)&&A(te)},[g.value]),re=s==="popper"?l1:BL,Q=re===l1?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:d,collisionPadding:f,sticky:p,hideWhenDetached:m,avoidCollisions:v}:{};return w.jsx(zL,{scope:n,content:y,viewport:C,onViewportChange:S,itemRefCallback:X,selectedItem:I,onItemLeave:J,itemTextRefCallback:Z,focusSelectedItem:z,selectedItemText:N,position:s,isPositioned:E,searchRef:U,children:w.jsx(hk,{as:ane,allowPinchZoom:!0,children:w.jsx(Kx,{asChild:!0,trapped:g.open,onMountAutoFocus:te=>{te.preventDefault()},onUnmountAutoFocus:be(r,te=>{var le;(le=g.trigger)==null||le.focus({preventScroll:!0}),te.preventDefault()}),children:w.jsx(bu,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:te=>te.preventDefault(),onDismiss:()=>g.onOpenChange(!1),children:w.jsx(re,{role:"listbox",id:g.contentId,"data-state":g.open?"open":"closed",dir:g.dir,onContextMenu:te=>te.preventDefault(),...x,...Q,onPlaced:()=>R(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:be(x.onKeyDown,te=>{const le=te.ctrlKey||te.altKey||te.metaKey;if(te.key==="Tab"&&te.preventDefault(),!le&&te.key.length===1&&W(te.key),["ArrowUp","ArrowDown","Home","End"].includes(te.key)){let ie=F().filter(ce=>!ce.disabled).map(ce=>ce.ref.current);if(["ArrowUp","End"].includes(te.key)&&(ie=ie.slice().reverse()),["ArrowUp","ArrowDown"].includes(te.key)){const ce=te.target,we=ie.indexOf(ce);ie=ie.slice(we+1)}setTimeout(()=>P(ie)),te.preventDefault()}})})})})})})});VL.displayName=one;var lne="SelectItemAlignedPosition",BL=k.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:s,...r}=t,i=ga(gl,n),o=xa(gl,n),[a,l]=k.useState(null),[c,u]=k.useState(null),h=Le(e,T=>u(T)),d=o0(n),f=k.useRef(!1),p=k.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:x,focusSelectedItem:g}=o,y=k.useCallback(()=>{if(i.trigger&&i.valueNode&&a&&c&&m&&v&&x){const T=i.trigger.getBoundingClientRect(),I=c.getBoundingClientRect(),$=i.valueNode.getBoundingClientRect(),N=x.getBoundingClientRect();if(i.dir!=="rtl"){const ce=N.left-I.left,we=$.left-ce,se=T.left-we,ye=T.width+se,ge=Math.max(ye,I.width),me=window.innerWidth-Ar,Ae=gd(we,[Ar,Math.max(Ar,me-ge)]);a.style.minWidth=ye+"px",a.style.left=Ae+"px"}else{const ce=I.right-N.right,we=window.innerWidth-$.right-ce,se=window.innerWidth-T.right-we,ye=T.width+se,ge=Math.max(ye,I.width),me=window.innerWidth-Ar,Ae=gd(we,[Ar,Math.max(Ar,me-ge)]);a.style.minWidth=ye+"px",a.style.right=Ae+"px"}const A=d(),F=window.innerHeight-Ar*2,E=m.scrollHeight,R=window.getComputedStyle(c),O=parseInt(R.borderTopWidth,10),P=parseInt(R.paddingTop,10),z=parseInt(R.borderBottomWidth,10),_=parseInt(R.paddingBottom,10),M=O+P+E+_+z,U=Math.min(v.offsetHeight*5,M),W=window.getComputedStyle(m),X=parseInt(W.paddingTop,10),J=parseInt(W.paddingBottom,10),Z=T.top+T.height/2-Ar,re=F-Z,Q=v.offsetHeight/2,te=v.offsetTop+Q,le=O+P+te,q=M-le;if(le<=Z){const ce=A.length>0&&v===A[A.length-1].ref.current;a.style.bottom="0px";const we=c.clientHeight-m.offsetTop-m.offsetHeight,se=Math.max(re,Q+(ce?J:0)+we+z),ye=le+se;a.style.height=ye+"px"}else{const ce=A.length>0&&v===A[0].ref.current;a.style.top="0px";const se=Math.max(Z,O+m.offsetTop+(ce?X:0)+Q)+q;a.style.height=se+"px",m.scrollTop=le-Z+m.offsetTop}a.style.margin=`${Ar}px 0`,a.style.minHeight=U+"px",a.style.maxHeight=F+"px",s==null||s(),requestAnimationFrame(()=>f.current=!0)}},[d,i.trigger,i.valueNode,a,c,m,v,x,i.dir,s]);wn(()=>y(),[y]);const[b,C]=k.useState();wn(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const S=k.useCallback(T=>{T&&p.current===!0&&(y(),g==null||g(),p.current=!1)},[y,g]);return w.jsx(une,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:f,onScrollButtonChange:S,children:w.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:b},children:w.jsx(Te.div,{...r,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});BL.displayName=lne;var cne="SelectPopperPosition",l1=k.forwardRef((t,e)=>{const{__scopeSelect:n,align:s="start",collisionPadding:r=Ar,...i}=t,o=a0(n);return w.jsx(lk,{...o,...i,ref:e,align:s,collisionPadding:r,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});l1.displayName=cne;var[une,Ck]=ku(gl,{}),c1="SelectViewport",jL=k.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:s,...r}=t,i=xa(c1,n),o=Ck(c1,n),a=Le(e,i.onViewportChange),l=k.useRef(0);return w.jsxs(w.Fragment,{children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),w.jsx(i0.Slot,{scope:n,children:w.jsx(Te.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:be(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:d}=o;if(d!=null&&d.current&&h){const f=Math.abs(l.current-u.scrollTop);if(f>0){const p=window.innerHeight-Ar*2,m=parseFloat(h.style.minHeight),v=parseFloat(h.style.height),x=Math.max(m,v);if(x<p){const g=x+f,y=Math.min(p,g),b=g-y;h.style.height=y+"px",h.style.bottom==="0px"&&(u.scrollTop=b>0?b:0,h.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});jL.displayName=c1;var WL="SelectGroup",[hne,dne]=ku(WL),fne=k.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,r=gr();return w.jsx(hne,{scope:n,id:r,children:w.jsx(Te.div,{role:"group","aria-labelledby":r,...s,ref:e})})});fne.displayName=WL;var UL="SelectLabel",GL=k.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,r=dne(UL,n);return w.jsx(Te.div,{id:r.id,...s,ref:e})});GL.displayName=UL;var Mg="SelectItem",[pne,HL]=ku(Mg),KL=k.forwardRef((t,e)=>{const{__scopeSelect:n,value:s,disabled:r=!1,textValue:i,...o}=t,a=ga(Mg,n),l=xa(Mg,n),c=a.value===s,[u,h]=k.useState(i??""),[d,f]=k.useState(!1),p=Le(e,g=>{var y;return(y=l.itemRefCallback)==null?void 0:y.call(l,g,s,r)}),m=gr(),v=k.useRef("touch"),x=()=>{r||(a.onValueChange(s),a.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return w.jsx(pne,{scope:n,value:s,disabled:r,textId:m,isSelected:c,onItemTextChange:k.useCallback(g=>{h(y=>y||((g==null?void 0:g.textContent)??"").trim())},[]),children:w.jsx(i0.ItemSlot,{scope:n,value:s,disabled:r,textValue:u,children:w.jsx(Te.div,{role:"option","aria-labelledby":m,"data-highlighted":d?"":void 0,"aria-selected":c&&d,"data-state":c?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:p,onFocus:be(o.onFocus,()=>f(!0)),onBlur:be(o.onBlur,()=>f(!1)),onClick:be(o.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:be(o.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:be(o.onPointerDown,g=>{v.current=g.pointerType}),onPointerMove:be(o.onPointerMove,g=>{var y;v.current=g.pointerType,r?(y=l.onItemLeave)==null||y.call(l):v.current==="mouse"&&g.currentTarget.focus({preventScroll:!0})}),onPointerLeave:be(o.onPointerLeave,g=>{var y;g.currentTarget===document.activeElement&&((y=l.onItemLeave)==null||y.call(l))}),onKeyDown:be(o.onKeyDown,g=>{var b;((b=l.searchRef)==null?void 0:b.current)!==""&&g.key===" "||(Jte.includes(g.key)&&x(),g.key===" "&&g.preventDefault())})})})})});KL.displayName=Mg;var vh="SelectItemText",XL=k.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:r,...i}=t,o=ga(vh,n),a=xa(vh,n),l=HL(vh,n),c=sne(vh,n),[u,h]=k.useState(null),d=Le(e,x=>h(x),l.onItemTextChange,x=>{var g;return(g=a.itemTextRefCallback)==null?void 0:g.call(a,x,l.value,l.disabled)}),f=u==null?void 0:u.textContent,p=k.useMemo(()=>w.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=c;return wn(()=>(m(p),()=>v(p)),[m,v,p]),w.jsxs(w.Fragment,{children:[w.jsx(Te.span,{id:l.textId,...i,ref:d}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Pl.createPortal(i.children,o.valueNode):null]})});XL.displayName=vh;var qL="SelectItemIndicator",YL=k.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return HL(qL,n).isSelected?w.jsx(Te.span,{"aria-hidden":!0,...s,ref:e}):null});YL.displayName=qL;var u1="SelectScrollUpButton",mne=k.forwardRef((t,e)=>{const n=xa(u1,t.__scopeSelect),s=Ck(u1,t.__scopeSelect),[r,i]=k.useState(!1),o=Le(e,s.onScrollButtonChange);return wn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?w.jsx(QL,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});mne.displayName=u1;var h1="SelectScrollDownButton",gne=k.forwardRef((t,e)=>{const n=xa(h1,t.__scopeSelect),s=Ck(h1,t.__scopeSelect),[r,i]=k.useState(!1),o=Le(e,s.onScrollButtonChange);return wn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?w.jsx(QL,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});gne.displayName=h1;var QL=k.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:s,...r}=t,i=xa("SelectScrollButton",n),o=k.useRef(null),a=o0(n),l=k.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return k.useEffect(()=>()=>l(),[l]),wn(()=>{var u;const c=a().find(h=>h.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),w.jsx(Te.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:be(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:be(r.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:be(r.onPointerLeave,()=>{l()})})}),xne="SelectSeparator",ZL=k.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return w.jsx(Te.div,{"aria-hidden":!0,...s,ref:e})});ZL.displayName=xne;var d1="SelectArrow",vne=k.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,r=a0(n),i=ga(d1,n),o=xa(d1,n);return i.open&&o.position==="popper"?w.jsx(ck,{...r,...s,ref:e}):null});vne.displayName=d1;var yne="SelectBubbleInput",JL=k.forwardRef(({__scopeSelect:t,value:e,...n},s)=>{const r=k.useRef(null),i=Le(s,r),o=wk(e);return k.useEffect(()=>{const a=r.current;if(!a)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const h=new Event("change",{bubbles:!0});u.call(a,e),a.dispatchEvent(h)}},[o,e]),w.jsx(Te.select,{...n,style:{...RL,...n.style},ref:i,defaultValue:e})});JL.displayName=yne;function e3(t){return t===""||t===void 0}function t3(t){const e=gn(t),n=k.useRef(""),s=k.useRef(0),r=k.useCallback(o=>{const a=n.current+o;e(a),function l(c){n.current=c,window.clearTimeout(s.current),c!==""&&(s.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),i=k.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return k.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,r,i]}function n3(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=bne(t,Math.max(i,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function bne(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var wne=AL,s3=_L,Cne=FL,Sne=OL,kne=ML,r3=LL,Tne=jL,i3=GL,o3=KL,Ine=XL,$ne=YL,a3=ZL;const ER=wne,RR=Cne,f1=oe.forwardRef(({className:t,children:e,...n},s)=>w.jsxs(s3,{ref:s,className:Ie("flex h-10 w-full items-center justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:[e,w.jsx(Sne,{asChild:!0,children:w.jsx($S,{className:"h-4 w-4 opacity-50"})})]}));f1.displayName=s3.displayName;const p1=oe.forwardRef(({className:t,children:e,position:n="popper",...s},r)=>w.jsx(kne,{children:w.jsx(r3,{ref:r,className:Ie("relative z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white text-gray-900 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...s,children:w.jsx(Tne,{className:Ie("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e})})}));p1.displayName=r3.displayName;const Nne=oe.forwardRef(({className:t,...e},n)=>w.jsx(i3,{ref:n,className:Ie("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));Nne.displayName=i3.displayName;const Rr=oe.forwardRef(({className:t,children:e,...n},s)=>w.jsxs(o3,{ref:s,className:Ie("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[w.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx($ne,{children:w.jsx(yO,{className:"h-4 w-4"})})}),w.jsx(Ine,{children:e})]}));Rr.displayName=o3.displayName;const Ene=oe.forwardRef(({className:t,...e},n)=>w.jsx(a3,{ref:n,className:Ie("-mx-1 my-1 h-px bg-gray-100",t),...e}));Ene.displayName=a3.displayName;const Rne=(t,e=100)=>{const[n,s]=k.useState([]);return k.useEffect(()=>{if(t!=null&&t.price){const r=t.price.toString(),i=parseInt(r[r.length-1],10);s(o=>{const a=[...o,i];return a.length>e?a.slice(a.length-e):a})}},[t,e]),n},Ane=({latestTick:t,selectedMarket:e="R_10",onMarketChange:n,numTicks:s=100,onNumTicksChange:r})=>{const i=Rne(t,s),o=k.useMemo(()=>{const u=Array(10).fill(0);if(i.length===0)return{counts:u.map(x=>({count:x,percentage:0})),highest:-1,lowest:-1,last:null};for(const x of i)u[x]++;let h=-1,d=1/0,f=-1,p=-1;u.forEach((x,g)=>{x>h&&(h=x,f=g),x<d&&(d=x,p=g)});const m=i.length,v=u.map(x=>m>0?x/m*100:0);return{counts:u.map((x,g)=>({count:x,percentage:v[g]})),highest:f,lowest:p,last:i.length>0?i[i.length-1]:null}},[i]),a=Math.max(...o.counts.map(u=>u.percentage))||100,l=200,c=[0,3,6,9,12,15];return w.jsxs("div",{className:"w-full h-full p-6 bg-gray-50 flex flex-col",children:[w.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Select market:"}),w.jsxs(ER,{value:e,onValueChange:n,children:[w.jsx(f1,{className:"w-[120px]",children:w.jsx(RR,{placeholder:"Select market"})}),w.jsxs(p1,{children:[w.jsx(Rr,{value:"R_10",children:"R_10"}),w.jsx(Rr,{value:"R_25",children:"R_25"}),w.jsx(Rr,{value:"R_50",children:"R_50"}),w.jsx(Rr,{value:"R_75",children:"R_75"}),w.jsx(Rr,{value:"R_100",children:"R_100"})]})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Number of ticks:"}),w.jsxs(ER,{value:s.toString(),onValueChange:u=>r&&r(parseInt(u)),children:[w.jsx(f1,{className:"w-[80px]",children:w.jsx(RR,{placeholder:"Ticks"})}),w.jsxs(p1,{children:[w.jsx(Rr,{value:"25",children:"25"}),w.jsx(Rr,{value:"50",children:"50"}),w.jsx(Rr,{value:"100",children:"100"}),w.jsx(Rr,{value:"250",children:"250"}),w.jsx(Rr,{value:"500",children:"500"})]})]})]})]}),w.jsxs("div",{className:"flex justify-between items-center mb-4",children:[w.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Last Digit Statistics"}),w.jsxs("span",{className:"text-sm text-gray-500",children:["Last ",i.length," Ticks"]})]}),w.jsxs("div",{className:"mb-6 border border-gray-200 rounded-lg bg-white p-4 flex-1 flex flex-col",children:[w.jsxs("div",{className:"flex-1 relative flex items-end justify-between",children:[w.jsx("div",{className:"absolute left-0 top-0 h-full w-8 flex flex-col justify-between pr-2 text-xs text-gray-500",children:c.map(u=>w.jsxs("span",{className:"text-right leading-none",children:[u,"%"]},u))}),w.jsx("div",{className:"flex justify-between w-full ml-8 mr-4",children:o.counts.map((u,h)=>{const d=h===o.last,f=h===o.highest,p=h===o.lowest,m=(u.percentage/a*l).toFixed(0),v=u.percentage>=5;return w.jsxs("div",{className:"flex flex-col items-center flex-1 relative",children:[v&&w.jsxs(Nt.span,{className:Ie("absolute -top-6 text-xs font-bold transform -translate-x-1/2 whitespace-nowrap",f?"text-orange-600":p?"text-cyan-600":d?"text-blue-600":"text-gray-700"),initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:[u.percentage.toFixed(0),"%"]}),w.jsx("div",{className:Ie("w-1.5 rounded transition-all duration-300 relative",f?"bg-orange-500":p?"bg-cyan-500":d?"bg-blue-500":"bg-gray-400"),style:{height:`${m}px`}}),w.jsx("span",{className:"text-xs text-gray-700 mt-2",children:h})]},h)})})]}),w.jsxs("div",{className:"flex justify-between w-full mt-2 text-xs text-gray-500",children:[w.jsx("span",{children:"0"}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{}),w.jsx("span",{children:"9"})]})]}),w.jsxs("div",{className:"text-center text-xs text-gray-500 mb-4",children:["Deriv.com - Last digit stats for the last ",s," ticks on ",e]}),w.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg bg-white",children:w.jsxs("div",{className:"flex gap-1 p-3 min-w-max",children:[i.map((u,h)=>w.jsx(Nt.span,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:h*.01},className:Ie("px-3 py-2 text-sm font-bold rounded border border-gray-300 bg-gray-50 text-gray-700 min-w-[2rem] flex items-center justify-center",u===o.last&&"bg-blue-100 border-blue-500 text-blue-700 shadow-sm"),children:u},h)),i.length===0&&w.jsx("span",{className:"px-3 py-2 text-sm text-gray-500 italic",children:"No digits yet"})]})})]})},Dne=({onClose:t,children:e})=>w.jsxs(Nt.div,{initial:{x:-300},animate:{x:0},exit:{x:-300},transition:{type:"spring",damping:25},className:"w-80 bg-white border-r border-gray-200 flex flex-col shadow-lg",children:[w.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[w.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Tool Options"}),w.jsx(Be,{variant:"ghost",size:"icon",onClick:t,className:"text-gray-500 hover:bg-gray-100",children:w.jsx(Ci,{className:"h-5 w-5"})})]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e})]}),_ne=[{id:"area",name:"Area",icon:V9},{id:"candlestick",name:"Candle",icon:Uw},{id:"hollow",name:"Hollow",icon:Uw},{id:"ohlc",name:"OHLC",icon:Tg}],Pne=["1 tick","1 minute","2 minutes","3 minutes","5 minutes","10 minutes","15 minutes","30 minutes","1 hour","2 hours","4 hours","8 hours","1 day"],Fne=({selectedType:t,onTypeChange:e,selectedInterval:n,onIntervalChange:s})=>w.jsxs("div",{className:"space-y-6 p-4 bg-white rounded-lg shadow-sm border border-gray-200",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Uw,{className:"h-4 w-4 text-gray-500"}),w.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Chart Types"})]})}),w.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:_ne.map(r=>{const i=r.icon,o=t===r.id;return w.jsxs(Nt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e(r.id),className:Ie("group flex flex-col items-center p-3 rounded-xl border-2 transition-all duration-200 text-center min-h-[80px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",o?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 bg-white text-gray-700 hover:border-gray-300 hover:shadow-sm hover:bg-gray-50"),children:[w.jsx(i,{className:Ie("h-5 w-5 mb-2 transition-colors duration-200",o?"text-blue-600":"text-gray-500 group-hover:text-gray-600")}),w.jsx("p",{className:"text-xs font-medium leading-tight",children:r.name})]},r.id)})})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(U9,{className:"h-4 w-4 text-gray-500"}),w.jsx("h4",{className:"text-xs font-semibold text-gray-600",children:"Time Interval"})]}),w.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 max-h-48 overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:Pne.map(r=>{const i=n===r,o=r.replace(" minutes","m").replace(" minute","m").replace(" hours","h").replace(" hour","h").replace(" day","d");return w.jsx(Nt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>s(r),className:Ie("px-2.5 py-1.5 text-xs font-medium rounded-lg border transition-all duration-200 truncate focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",i?"bg-blue-500 text-white border-blue-500 shadow-sm":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300 hover:shadow-sm"),title:r,children:o},r)})})]})]}),lb=[{id:"sma",name:"Simple Moving Average",category:"Moving Averages"},{id:"ema",name:"Exponential Moving Average",category:"Moving Averages"},{id:"rsi",name:"Relative Strength Index",category:"Momentum"},{id:"macd",name:"MACD",category:"Momentum"},{id:"bollinger",name:"Bollinger Bands",category:"Volatility"},{id:"stochastic",name:"Stochastic Oscillator",category:"Momentum"},{id:"atr",name:"Average True Range",category:"Volatility"},{id:"adx",name:"Average Directional Index",category:"Trend"}],One=({activeIndicators:t,onAddIndicator:e,onRemoveIndicator:n})=>{const s=[...new Set(lb.map(r=>r.category))];return w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Active Indicators"}),t.length===0?w.jsx("p",{className:"text-sm text-gray-500 italic",children:"No indicators added yet"}):w.jsx("div",{className:"space-y-2",children:t.map(r=>{const i=lb.find(o=>o.id===r);return w.jsxs(Nt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center justify-between p-3 bg-gray-100 rounded-lg border border-gray-200",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(wi,{className:"h-4 w-4 text-blue-500"}),w.jsx("span",{className:"text-sm text-gray-800",children:i==null?void 0:i.name})]}),w.jsx(Be,{variant:"ghost",size:"icon",onClick:()=>n(r),className:"h-8 w-8 text-gray-500 hover:bg-gray-200",children:w.jsx(Ci,{className:"h-4 w-4"})})]},r)})})]}),w.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[w.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Available Indicators"}),w.jsx(Do,{className:"h-[400px]",children:s.map(r=>w.jsxs("div",{className:"mb-4",children:[w.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-2 px-2",children:r}),w.jsx("div",{className:"space-y-1",children:lb.filter(i=>i.category===r).map(i=>w.jsxs(Nt.button,{whileHover:{x:4},onClick:()=>e(i.id),disabled:t.includes(i.id),className:Ie("w-full flex items-center justify-between p-3 rounded-lg transition-all text-left",t.includes(i.id)?"bg-gray-100 text-gray-500 cursor-not-allowed":"hover:bg-gray-100 text-gray-800"),children:[w.jsx("span",{className:"text-sm",children:i.name}),!t.includes(i.id)&&w.jsx(NS,{className:"h-4 w-4 text-blue-500"})]},i.id))})]},r))})]})]})},Mne=()=>{const[t,e]=k.useState([]),[n,s]=k.useState("");k.useEffect(()=>{const a=localStorage.getItem("tradingChartTemplates");a&&e(JSON.parse(a))},[]),k.useEffect(()=>{localStorage.setItem("tradingChartTemplates",JSON.stringify(t))},[t]);const r=()=>{if(!n.trim()){gt({title:"Error",description:"Please enter a template name",variant:"destructive"});return}const a={id:Date.now(),name:n,createdAt:new Date().toISOString(),config:{chartType:"candlestick",indicators:["sma","rsi"]}};e(l=>[...l,a]),s(""),gt({title:"Template Saved",description:`"${n}" has been saved successfully`})},i=a=>{e(l=>l.filter(c=>c.id!==a)),gt({title:"Template Deleted",description:"Template has been removed"})},o=a=>{gt({title:" This feature isn't implemented yetbut don't worry! You can request it in your next prompt! ",description:`Loading template: ${a.name}`})};return w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Save Current Setup"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx(mi,{placeholder:"Template name...",value:n,onChange:a=>s(a.target.value),className:"bg-gray-100 border-gray-300 text-gray-800"}),w.jsxs(Be,{onClick:r,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[w.jsx(q9,{className:"h-4 w-4 mr-2"}),"Save"]})]})]}),w.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[w.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Saved Templates"}),t.length===0?w.jsxs("div",{className:"text-center py-8",children:[w.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-gray-100 flex items-center justify-center",children:w.jsx(NS,{className:"h-8 w-8 text-gray-400"})}),w.jsx("p",{className:"text-sm text-gray-500",children:"No saved templates yet"})]}):w.jsx("div",{className:"space-y-2",children:t.map(a=>w.jsxs(Nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>o(a),children:[w.jsxs("div",{children:[w.jsx("p",{className:"font-medium text-gray-800",children:a.name}),w.jsx("p",{className:"text-xs text-gray-500",children:new Date(a.createdAt).toLocaleDateString()})]}),w.jsx(Be,{variant:"ghost",size:"icon",onClick:l=>{l.stopPropagation(),i(a.id)},className:"text-red-500 hover:text-red-400 hover:bg-red-50",children:w.jsx(Q9,{className:"h-4 w-4"})})]},a.id))})]})]})},Lne=[{id:"line",name:"Trend Line",icon:wO},{id:"ray",name:"Ray",icon:wi},{id:"circle",name:"Circle",icon:W9},{id:"rectangle",name:"Rectangle",icon:CO},{id:"text",name:"Text",icon:J9},{id:"eraser",name:"Eraser",icon:H9}],zne=()=>{const t=e=>{gt({title:" This feature isn't implemented yetbut don't worry! You can request it in your next prompt! "})};return w.jsxs("div",{className:"space-y-4",children:[w.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Drawing Tools"}),w.jsx("div",{className:"grid grid-cols-2 gap-3",children:Lne.map(e=>{const n=e.icon;return w.jsxs(Nt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(e.id),className:"p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-gray-300 transition-all text-gray-800",children:[w.jsx(n,{className:"h-6 w-6 mx-auto mb-2 text-gray-500"}),w.jsx("p",{className:"text-xs font-medium",children:e.name})]},e.id)})}),w.jsxs("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg border border-gray-200",children:[w.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-3",children:"Line Style"}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("label",{className:"text-xs text-gray-600 w-16",children:"Color:"}),w.jsx("input",{type:"color",defaultValue:"#3b82f6",className:"h-8 w-full rounded cursor-pointer border border-gray-300"})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("label",{className:"text-xs text-gray-600 w-16",children:"Width:"}),w.jsx("input",{type:"range",min:"1",max:"5",defaultValue:"2",className:"flex-1"})]})]})]})]})};var[l0,VAe]=_s("Tooltip",[Su]),c0=Su(),l3="TooltipProvider",Vne=700,m1="tooltip.open",[Bne,Sk]=l0(l3),c3=t=>{const{__scopeTooltip:e,delayDuration:n=Vne,skipDelayDuration:s=300,disableHoverableContent:r=!1,children:i}=t,o=k.useRef(!0),a=k.useRef(!1),l=k.useRef(0);return k.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),w.jsx(Bne,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:k.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:k.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,s)},[s]),isPointerInTransitRef:a,onPointerInTransitChange:k.useCallback(c=>{a.current=c},[]),disableHoverableContent:r,children:i})};c3.displayName=l3;var yd="Tooltip",[jne,u0]=l0(yd),u3=t=>{const{__scopeTooltip:e,children:n,open:s,defaultOpen:r,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=Sk(yd,t.__scopeTooltip),c=c0(e),[u,h]=k.useState(null),d=gr(),f=k.useRef(0),p=o??l.disableHoverableContent,m=a??l.delayDuration,v=k.useRef(!1),[x,g]=Gs({prop:s,defaultProp:r??!1,onChange:T=>{T?(l.onOpen(),document.dispatchEvent(new CustomEvent(m1))):l.onClose(),i==null||i(T)},caller:yd}),y=k.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),b=k.useCallback(()=>{window.clearTimeout(f.current),f.current=0,v.current=!1,g(!0)},[g]),C=k.useCallback(()=>{window.clearTimeout(f.current),f.current=0,g(!1)},[g]),S=k.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{v.current=!0,g(!0),f.current=0},m)},[m,g]);return k.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),w.jsx(ak,{...c,children:w.jsx(jne,{scope:e,contentId:d,open:x,stateAttribute:y,trigger:u,onTriggerChange:h,onTriggerEnter:k.useCallback(()=>{l.isOpenDelayedRef.current?S():b()},[l.isOpenDelayedRef,S,b]),onTriggerLeave:k.useCallback(()=>{p?C():(window.clearTimeout(f.current),f.current=0)},[C,p]),onOpen:b,onClose:C,disableHoverableContent:p,children:n})})};u3.displayName=yd;var g1="TooltipTrigger",h3=k.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,r=u0(g1,n),i=Sk(g1,n),o=c0(n),a=k.useRef(null),l=Le(e,a,r.onTriggerChange),c=k.useRef(!1),u=k.useRef(!1),h=k.useCallback(()=>c.current=!1,[]);return k.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),w.jsx(Zx,{asChild:!0,...o,children:w.jsx(Te.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...s,ref:l,onPointerMove:be(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(r.onTriggerEnter(),u.current=!0)}),onPointerLeave:be(t.onPointerLeave,()=>{r.onTriggerLeave(),u.current=!1}),onPointerDown:be(t.onPointerDown,()=>{r.open&&r.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:be(t.onFocus,()=>{c.current||r.onOpen()}),onBlur:be(t.onBlur,r.onClose),onClick:be(t.onClick,r.onClose)})})});h3.displayName=g1;var Wne="TooltipPortal",[BAe,Une]=l0(Wne,{forceMount:void 0}),su="TooltipContent",d3=k.forwardRef((t,e)=>{const n=Une(su,t.__scopeTooltip),{forceMount:s=n.forceMount,side:r="top",...i}=t,o=u0(su,t.__scopeTooltip);return w.jsx(gs,{present:s||o.open,children:o.disableHoverableContent?w.jsx(f3,{side:r,...i,ref:e}):w.jsx(Gne,{side:r,...i,ref:e})})}),Gne=k.forwardRef((t,e)=>{const n=u0(su,t.__scopeTooltip),s=Sk(su,t.__scopeTooltip),r=k.useRef(null),i=Le(e,r),[o,a]=k.useState(null),{trigger:l,onClose:c}=n,u=r.current,{onPointerInTransitChange:h}=s,d=k.useCallback(()=>{a(null),h(!1)},[h]),f=k.useCallback((p,m)=>{const v=p.currentTarget,x={x:p.clientX,y:p.clientY},g=Yne(x,v.getBoundingClientRect()),y=Qne(x,g),b=Zne(m.getBoundingClientRect()),C=ese([...y,...b]);a(C),h(!0)},[h]);return k.useEffect(()=>()=>d(),[d]),k.useEffect(()=>{if(l&&u){const p=v=>f(v,u),m=v=>f(v,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",m)}}},[l,u,f,d]),k.useEffect(()=>{if(o){const p=m=>{const v=m.target,x={x:m.clientX,y:m.clientY},g=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),y=!Jne(x,o);g?d():y&&(d(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,o,c,d]),w.jsx(f3,{...t,ref:i})}),[Hne,Kne]=l0(yd,{isInside:!1}),Xne=vZ("TooltipContent"),f3=k.forwardRef((t,e)=>{const{__scopeTooltip:n,children:s,"aria-label":r,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=u0(su,n),c=c0(n),{onClose:u}=l;return k.useEffect(()=>(document.addEventListener(m1,u),()=>document.removeEventListener(m1,u)),[u]),k.useEffect(()=>{if(l.trigger){const h=d=>{const f=d.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),w.jsx(bu,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:w.jsxs(lk,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[w.jsx(Xne,{children:s}),w.jsx(Hne,{scope:n,isInside:!0,children:w.jsx(Qte,{id:l.contentId,role:"tooltip",children:r||s})})]})})});d3.displayName=su;var p3="TooltipArrow",qne=k.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,r=c0(n);return Kne(p3,n).isInside?null:w.jsx(ck,{...r,...s,ref:e})});qne.displayName=p3;function Yne(t,e){const n=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),r=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,s,r,i)){case i:return"left";case r:return"right";case n:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function Qne(t,e,n=5){const s=[];switch(e){case"top":s.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":s.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":s.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":s.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return s}function Zne(t){const{top:e,right:n,bottom:s,left:r}=t;return[{x:r,y:e},{x:n,y:e},{x:n,y:s},{x:r,y:s}]}function Jne(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,d=l.y;u>s!=d>s&&n<(h-c)*(s-u)/(d-u)+c&&(r=!r)}return r}function ese(t){const e=t.slice();return e.sort((n,s)=>n.x<s.x?-1:n.x>s.x?1:n.y<s.y?-1:n.y>s.y?1:0),tse(e)}function tse(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const r=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(r.y-o.y)>=(i.y-o.y)*(r.x-o.x))e.pop();else break}e.push(r)}e.pop();const n=[];for(let s=t.length-1;s>=0;s--){const r=t[s];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(r.y-o.y)>=(i.y-o.y)*(r.x-o.x))n.pop();else break}n.push(r)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var nse=c3,sse=u3,rse=h3,m3=d3;const ise=nse,ose=sse,ase=rse,g3=k.forwardRef(({className:t,sideOffset:e=4,...n},s)=>w.jsx(m3,{ref:s,sideOffset:e,className:Ie("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));g3.displayName=m3.displayName;var lse="Label",x3=k.forwardRef((t,e)=>w.jsx(Te.label,{...t,ref:e,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));x3.displayName=lse;var v3=x3;const cse=pk("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ir=oe.forwardRef(({className:t,...e},n)=>w.jsx(v3,{ref:n,className:Ie(cse(),t),...e}));ir.displayName=v3.displayName;var h0="Checkbox",[use,jAe]=_s(h0),[hse,kk]=use(h0);function dse(t){const{__scopeCheckbox:e,checked:n,children:s,defaultChecked:r,disabled:i,form:o,name:a,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:h}=t,[d,f]=Gs({prop:n,defaultProp:r??!1,onChange:l,caller:h0}),[p,m]=k.useState(null),[v,x]=k.useState(null),g=k.useRef(!1),y=p?!!o||!!p.closest("form"):!0,b={checked:d,disabled:i,setChecked:f,control:p,setControl:m,name:a,form:o,value:u,hasConsumerStoppedPropagationRef:g,required:c,defaultChecked:Ho(r)?!1:r,isFormControl:y,bubbleInput:v,setBubbleInput:x};return w.jsx(hse,{scope:e,...b,children:fse(h)?h(b):s})}var y3="CheckboxTrigger",b3=k.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...s},r)=>{const{control:i,value:o,disabled:a,checked:l,required:c,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:d,isFormControl:f,bubbleInput:p}=kk(y3,t),m=Le(r,u),v=k.useRef(l);return k.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const g=()=>h(v.current);return x.addEventListener("reset",g),()=>x.removeEventListener("reset",g)}},[i,h]),w.jsx(Te.button,{type:"button",role:"checkbox","aria-checked":Ho(l)?"mixed":l,"aria-required":c,"data-state":T3(l),"data-disabled":a?"":void 0,disabled:a,value:o,...s,ref:m,onKeyDown:be(e,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:be(n,x=>{h(g=>Ho(g)?!0:!g),p&&f&&(d.current=x.isPropagationStopped(),d.current||x.stopPropagation())})})});b3.displayName=y3;var Tk=k.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:s,checked:r,defaultChecked:i,required:o,disabled:a,value:l,onCheckedChange:c,form:u,...h}=t;return w.jsx(dse,{__scopeCheckbox:n,checked:r,defaultChecked:i,disabled:a,required:o,onCheckedChange:c,name:s,form:u,value:l,internal_do_not_use_render:({isFormControl:d})=>w.jsxs(w.Fragment,{children:[w.jsx(b3,{...h,ref:e,__scopeCheckbox:n}),d&&w.jsx(k3,{__scopeCheckbox:n})]})})});Tk.displayName=h0;var w3="CheckboxIndicator",C3=k.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:s,...r}=t,i=kk(w3,n);return w.jsx(gs,{present:s||Ho(i.checked)||i.checked===!0,children:w.jsx(Te.span,{"data-state":T3(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:e,style:{pointerEvents:"none",...t.style}})})});C3.displayName=w3;var S3="CheckboxBubbleInput",k3=k.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:s,hasConsumerStoppedPropagationRef:r,checked:i,defaultChecked:o,required:a,disabled:l,name:c,value:u,form:h,bubbleInput:d,setBubbleInput:f}=kk(S3,t),p=Le(n,f),m=wk(i),v=rk(s);k.useEffect(()=>{const g=d;if(!g)return;const y=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(y,"checked").set,S=!r.current;if(m!==i&&C){const T=new Event("click",{bubbles:S});g.indeterminate=Ho(i),C.call(g,Ho(i)?!1:i),g.dispatchEvent(T)}},[d,m,i,r]);const x=k.useRef(Ho(i)?!1:i);return w.jsx(Te.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??x.current,required:a,disabled:l,name:c,value:u,form:h,...e,tabIndex:-1,ref:p,style:{...e.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});k3.displayName=S3;function fse(t){return typeof t=="function"}function Ho(t){return t==="indeterminate"}function T3(t){return Ho(t)?"indeterminate":t?"checked":"unchecked"}const x1=oe.forwardRef(({className:t,...e},n)=>w.jsx(Tk,{ref:n,className:Ie("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:w.jsx(C3,{className:Ie("flex items-center justify-center text-current"),children:w.jsx(yO,{className:"h-4 w-4"})})}));x1.displayName=Tk.displayName;var I3=["PageUp","PageDown"],$3=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],N3={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Tu="Slider",[v1,pse,mse]=Kd(Tu),[E3,WAe]=_s(Tu,[mse]),[gse,d0]=E3(Tu),R3=k.forwardRef((t,e)=>{const{name:n,min:s=0,max:r=100,step:i=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[s],value:u,onValueChange:h=()=>{},onValueCommit:d=()=>{},inverted:f=!1,form:p,...m}=t,v=k.useRef(new Set),x=k.useRef(0),y=o==="horizontal"?xse:vse,[b=[],C]=Gs({prop:u,defaultProp:c,onChange:A=>{var E;(E=[...v.current][x.current])==null||E.focus(),h(A)}}),S=k.useRef(b);function T(A){const F=Sse(b,A);N(A,F)}function I(A){N(A,x.current)}function $(){const A=S.current[x.current];b[x.current]!==A&&d(b)}function N(A,F,{commit:E}={commit:!1}){const R=$se(i),O=Nse(Math.round((A-s)/i)*i+s,R),P=gd(O,[s,r]);C((z=[])=>{const _=wse(z,P,F);if(Ise(_,l*i)){x.current=_.indexOf(P);const M=String(_)!==String(z);return M&&E&&d(_),M?_:z}else return z})}return w.jsx(gse,{scope:t.__scopeSlider,name:n,disabled:a,min:s,max:r,valueIndexToChangeRef:x,thumbs:v.current,values:b,orientation:o,form:p,children:w.jsx(v1.Provider,{scope:t.__scopeSlider,children:w.jsx(v1.Slot,{scope:t.__scopeSlider,children:w.jsx(y,{"aria-disabled":a,"data-disabled":a?"":void 0,...m,ref:e,onPointerDown:be(m.onPointerDown,()=>{a||(S.current=b)}),min:s,max:r,inverted:f,onSlideStart:a?void 0:T,onSlideMove:a?void 0:I,onSlideEnd:a?void 0:$,onHomeKeyDown:()=>!a&&N(s,0,{commit:!0}),onEndKeyDown:()=>!a&&N(r,b.length-1,{commit:!0}),onStepKeyDown:({event:A,direction:F})=>{if(!a){const O=I3.includes(A.key)||A.shiftKey&&$3.includes(A.key)?10:1,P=x.current,z=b[P],_=i*O*F;N(z+_,P,{commit:!0})}}})})})})});R3.displayName=Tu;var[A3,D3]=E3(Tu,{startEdge:"left",endEdge:"right",size:"width",direction:1}),xse=k.forwardRef((t,e)=>{const{min:n,max:s,dir:r,inverted:i,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,[h,d]=k.useState(null),f=Le(e,y=>d(y)),p=k.useRef(void 0),m=yu(r),v=m==="ltr",x=v&&!i||!v&&i;function g(y){const b=p.current||h.getBoundingClientRect(),C=[0,b.width],T=Ik(C,x?[n,s]:[s,n]);return p.current=b,T(y-b.left)}return w.jsx(A3,{scope:t.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:w.jsx(_3,{dir:m,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:y=>{const b=g(y.clientX);o==null||o(b)},onSlideMove:y=>{const b=g(y.clientX);a==null||a(b)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:y=>{const C=N3[x?"from-left":"from-right"].includes(y.key);c==null||c({event:y,direction:C?-1:1})}})})}),vse=k.forwardRef((t,e)=>{const{min:n,max:s,inverted:r,onSlideStart:i,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=t,u=k.useRef(null),h=Le(e,u),d=k.useRef(void 0),f=!r;function p(m){const v=d.current||u.current.getBoundingClientRect(),x=[0,v.height],y=Ik(x,f?[s,n]:[n,s]);return d.current=v,y(m-v.top)}return w.jsx(A3,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:w.jsx(_3,{"data-orientation":"vertical",...c,ref:h,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:m=>{const v=p(m.clientY);i==null||i(v)},onSlideMove:m=>{const v=p(m.clientY);o==null||o(v)},onSlideEnd:()=>{d.current=void 0,a==null||a()},onStepKeyDown:m=>{const x=N3[f?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:x?-1:1})}})})}),_3=k.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:s,onSlideMove:r,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=t,u=d0(Tu,n);return w.jsx(Te.span,{...c,ref:e,onKeyDown:be(t.onKeyDown,h=>{h.key==="Home"?(o(h),h.preventDefault()):h.key==="End"?(a(h),h.preventDefault()):I3.concat($3).includes(h.key)&&(l(h),h.preventDefault())}),onPointerDown:be(t.onPointerDown,h=>{const d=h.target;d.setPointerCapture(h.pointerId),h.preventDefault(),u.thumbs.has(d)?d.focus():s(h)}),onPointerMove:be(t.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&r(h)}),onPointerUp:be(t.onPointerUp,h=>{const d=h.target;d.hasPointerCapture(h.pointerId)&&(d.releasePointerCapture(h.pointerId),i(h))})})}),P3="SliderTrack",F3=k.forwardRef((t,e)=>{const{__scopeSlider:n,...s}=t,r=d0(P3,n);return w.jsx(Te.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...s,ref:e})});F3.displayName=P3;var y1="SliderRange",O3=k.forwardRef((t,e)=>{const{__scopeSlider:n,...s}=t,r=d0(y1,n),i=D3(y1,n),o=k.useRef(null),a=Le(e,o),l=r.values.length,c=r.values.map(d=>z3(d,r.min,r.max)),u=l>1?Math.min(...c):0,h=100-Math.max(...c);return w.jsx(Te.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...s,ref:a,style:{...t.style,[i.startEdge]:u+"%",[i.endEdge]:h+"%"}})});O3.displayName=y1;var b1="SliderThumb",M3=k.forwardRef((t,e)=>{const n=pse(t.__scopeSlider),[s,r]=k.useState(null),i=Le(e,a=>r(a)),o=k.useMemo(()=>s?n().findIndex(a=>a.ref.current===s):-1,[n,s]);return w.jsx(yse,{...t,ref:i,index:o})}),yse=k.forwardRef((t,e)=>{const{__scopeSlider:n,index:s,name:r,...i}=t,o=d0(b1,n),a=D3(b1,n),[l,c]=k.useState(null),u=Le(e,g=>c(g)),h=l?o.form||!!l.closest("form"):!0,d=rk(l),f=o.values[s],p=f===void 0?0:z3(f,o.min,o.max),m=Cse(s,o.values.length),v=d==null?void 0:d[a.size],x=v?kse(v,p,a.direction):0;return k.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),w.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${x}px)`},children:[w.jsx(v1.ItemSlot,{scope:t.__scopeSlider,children:w.jsx(Te.span,{role:"slider","aria-label":t["aria-label"]||m,"aria-valuemin":o.min,"aria-valuenow":f,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:u,style:f===void 0?{display:"none"}:t.style,onFocus:be(t.onFocus,()=>{o.valueIndexToChangeRef.current=s})})}),h&&w.jsx(L3,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:f},s)]})});M3.displayName=b1;var bse="RadioBubbleInput",L3=k.forwardRef(({__scopeSlider:t,value:e,...n},s)=>{const r=k.useRef(null),i=Le(r,s),o=wk(e);return k.useEffect(()=>{const a=r.current;if(!a)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const h=new Event("input",{bubbles:!0});u.call(a,e),a.dispatchEvent(h)}},[o,e]),w.jsx(Te.input,{style:{display:"none"},...n,ref:i,defaultValue:e})});L3.displayName=bse;function wse(t=[],e,n){const s=[...t];return s[n]=e,s.sort((r,i)=>r-i)}function z3(t,e,n){const i=100/(n-e)*(t-e);return gd(i,[0,100])}function Cse(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function Sse(t,e){if(t.length===1)return 0;const n=t.map(r=>Math.abs(r-e)),s=Math.min(...n);return n.indexOf(s)}function kse(t,e,n){const s=t/2,i=Ik([0,50],[0,s]);return(s-i(e)*n)*n}function Tse(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function Ise(t,e){if(e>0){const n=Tse(t);return Math.min(...n)>=e}return!0}function Ik(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const s=(e[1]-e[0])/(t[1]-t[0]);return e[0]+s*(n-t[0])}}function $se(t){return(String(t).split(".")[1]||"").length}function Nse(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var V3=R3,Ese=F3,Rse=O3,Ase=M3;const B3=oe.forwardRef(({className:t,...e},n)=>w.jsxs(V3,{ref:n,className:Ie("relative flex w-full touch-none select-none items-center",t),...e,children:[w.jsx(Ese,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:w.jsx(Rse,{className:"absolute h-full bg-primary"})}),w.jsx(Ase,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));B3.displayName=V3.displayName;const Dse=({tradeType:t,onTrade:e,selectedMarket:n})=>{const[s,r]=k.useState(10),[i,o]=k.useState(5),[a,l]=k.useState("t"),[c,u]=k.useState(1),[h,d]=k.useState(!1),[f,p]=k.useState("3%"),[m,v]=k.useState(!1),[x,g]=k.useState("rise"),[y,b]=k.useState("touch"),[C,S]=k.useState("even"),[T,I]=k.useState("over");k.useState("higher");const $=["matches-differs","even-odd","over-under"].includes(t.id),N=t.id==="accumulators",A=t.category==="multipliers",F=t.category==="options",E=["rise-fall","higher-lower","call-put","turbos"].includes(t.id),R=t.id==="touch-no-touch",O=F;k.useEffect(()=>{$&&l("t"),t.id==="higher-lower"?g("higher"):t.id==="rise-fall"&&g("rise")},[t.id,$]);const P=q=>{const ie={contract_type:q||t.id.toUpperCase(),symbol:n,amount:parseFloat(s),currency:"USD",duration:O?parseInt(i):void 0,duration_unit:O?a:void 0};$&&t.id!=="even-odd"&&(ie.prediction=c),E&&(ie.direction=x),R&&(ie.direction=y),t.id==="even-odd"&&(ie.direction=C),t.id==="over-under"&&(ie.prediction=c,ie.direction=T),t.id==="higher-lower"&&(ie.direction=x),N&&(ie.growth_rate=f,m&&(ie.take_profit=!0)),t.id==="rise-fall"&&h&&(ie.contract_type=q==="CALL"?"CALLE":"PUTE"),e(ie)},z=()=>t.id==="rise-fall"?{up:"rise",down:"fall",upLabel:"Rise",downLabel:"Fall"}:t.id==="higher-lower"?{up:"higher",down:"lower",upLabel:"Higher",downLabel:"Lower"}:t.id==="call-put"||t.id==="turbos"?{up:"call",down:"put",upLabel:"Call",downLabel:"Put"}:{up:"rise",down:"fall",upLabel:"Rise",downLabel:"Fall"},_=()=>{if(!O)return null;const q=$||t.id==="rise-fall"||t.id==="higher-lower";return w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[!q&&!N&&w.jsxs(w.Fragment,{children:[w.jsx(Be,{onClick:()=>l("t"),variant:a==="t"?"secondary":"ghost",className:"flex-1",children:"Ticks"}),w.jsx(Be,{onClick:()=>l("m"),variant:a==="m"?"secondary":"ghost",className:"flex-1",children:"Minutes"})]}),(q||N)&&w.jsx(Be,{variant:"secondary",className:"flex-1 cursor-default",children:"Ticks"})]}),w.jsx(B3,{defaultValue:[i],min:a==="t"?5:1,max:a==="t"?10:60,step:1,onValueChange:ie=>o(ie[0])}),w.jsxs("div",{className:"text-center mt-2 font-semibold text-gray-700",children:[i," ",a==="t"?"Ticks":"Minutes"]})]})},M=()=>w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx(Be,{variant:"ghost",size:"icon",onClick:()=>r(q=>Math.max(.35,q-1)),children:w.jsx(wO,{className:"h-5 w-5"})}),w.jsxs("div",{className:"text-center",children:[w.jsx("span",{className:"text-2xl font-bold",children:s.toFixed(2)}),w.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"USD"})]}),w.jsx(Be,{variant:"ghost",size:"icon",onClick:()=>r(q=>q+1),children:w.jsx(NS,{className:"h-5 w-5"})})]}),(t.id==="rise-fall"||t.id==="higher-lower")&&w.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[w.jsx(x1,{id:"allow-equals",checked:h,onCheckedChange:d}),w.jsx("label",{htmlFor:"allow-equals",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Allow equals"}),w.jsx(Dy,{className:"h-4 w-4 text-gray-400"})]})]}),U=()=>!$||t.id==="even-odd"?null:w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsx(ir,{className:"font-semibold text-center block mb-3",children:"Last Digit Prediction"}),w.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(10).keys()].map(q=>w.jsx(Be,{variant:c===q?"secondary":"outline",className:"font-bold",onClick:()=>u(q),children:q},q))})]}),W=()=>t.id!=="even-odd"?null:w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsx(ir,{className:"font-semibold text-center block mb-3",children:"Parity Prediction"}),w.jsxs("div",{className:"flex space-x-2",children:[w.jsx(Be,{variant:C==="even"?"default":"outline",className:"flex-1",onClick:()=>S("even"),children:"Even"}),w.jsx(Be,{variant:C==="odd"?"default":"outline",className:"flex-1",onClick:()=>S("odd"),children:"Odd"})]})]}),X=()=>t.id!=="over-under"?null:w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsx(ir,{className:"font-semibold text-center block mb-3",children:"Threshold Digit"}),w.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(10).keys()].map(q=>w.jsx(Be,{variant:c===q?"secondary":"outline",className:"font-bold",onClick:()=>u(q),children:q},q))})]}),w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsx(ir,{className:"font-semibold text-center block mb-3",children:"Direction"}),w.jsxs("div",{className:"flex space-x-2",children:[w.jsx(Be,{variant:T==="over"?"default":"outline",className:"flex-1",onClick:()=>I("over"),children:"Over"}),w.jsx(Be,{variant:T==="under"?"default":"outline",className:"flex-1",onClick:()=>I("under"),children:"Under"})]})]})]}),J=()=>R?w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsx(ir,{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prediction"}),w.jsxs("div",{className:"flex space-x-2",children:[w.jsx(Be,{variant:y==="touch"?"default":"outline",size:"sm",onClick:()=>b("touch"),className:"flex-1",children:"Touch"}),w.jsx(Be,{variant:y==="no-touch"?"default":"outline",size:"sm",onClick:()=>b("no-touch"),className:"flex-1",children:"No Touch"})]})]}):null,Z=()=>N?w.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[w.jsxs(ir,{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:["Growth rate ",w.jsx(Dy,{className:"h-3 w-3 ml-1 text-gray-400"})]}),w.jsx("div",{className:"flex space-x-1",children:["1%","2%","3%","4%","5%"].map(q=>w.jsx(Be,{variant:f===q?"default":"outline",size:"sm",onClick:()=>p(q),className:`flex-1 ${f===q?"bg-blue-500 text-white":"border-gray-300"}`,children:q},q))})]}):null,re=()=>A||N?w.jsxs("div",{className:"flex items-center space-x-2 p-4 bg-gray-50 rounded-lg",children:[w.jsx(x1,{id:"take-profit",checked:m,onCheckedChange:v}),w.jsx(ir,{htmlFor:"take-profit",className:"text-sm font-medium text-gray-700",children:"Take profit"}),w.jsx(Dy,{className:"h-4 w-4 text-gray-400"})]}):null,Q=()=>A||N?w.jsxs("div",{className:"grid grid-cols-2 gap-6 p-4 bg-gray-50 rounded-lg",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Max. payout"}),w.jsx("div",{className:"text-lg font-bold text-gray-900",children:"6,000.00 USD"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Max. ticks"}),w.jsx("div",{className:"text-lg font-bold text-gray-900",children:"85 ticks"})]})]}):null,te=({type:q,payout:ie,percentage:ce,onClick:we,isUp:se})=>{const ye=se?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600",ge=se?wi:ES,me=q.charAt(0).toUpperCase()+q.slice(1);return w.jsx("div",{className:"space-y-1",children:w.jsxs(Be,{onClick:we,className:`w-full h-14 text-white font-bold text-base relative overflow-hidden ${ye}`,children:[w.jsxs("div",{className:"flex items-center justify-between w-full px-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(ge,{className:"h-5 w-5"}),w.jsx("span",{children:me})]}),w.jsx("span",{children:ce})]}),w.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1/4 bg-black/10",style:{clipPath:"polygon(25% 0, 100% 0, 100% 100%, 0% 100%)"}})]})})},le=()=>{const q=z(),ie=t.id==="matches-differs";if(E){const ce=q.up.includes("call")||q.up.includes("higher")||q.up.includes("rise")?"CALL":q.up.toUpperCase(),we=q.down.includes("put")||q.down.includes("lower")||q.down.includes("fall")?"PUT":q.down.toUpperCase();return w.jsxs("div",{className:"space-y-3",children:[w.jsx(te,{type:q.up,payout:"19.42 USD",percentage:"94.20%",onClick:()=>{g(q.up),P(ce)},isUp:!0}),w.jsx(te,{type:q.down,payout:"19.42 USD",percentage:"94.20%",onClick:()=>{g(q.down),P(we)},isUp:!1})]})}return ie?w.jsxs("div",{className:"space-y-3",children:[w.jsx(te,{type:"matches",payout:"89.29 USD",percentage:"792.90%",onClick:()=>P("DIGITMATCH"),isUp:!0}),w.jsx(te,{type:"differs",payout:"10.96 USD",percentage:"9.60%",onClick:()=>P("DIGITDIFF"),isUp:!1})]}):t.id==="even-odd"?w.jsxs("div",{className:"space-y-3",children:[w.jsx(te,{type:"even",payout:"19.42 USD",percentage:"94.20%",onClick:()=>{S("even"),P("DIGITEVEN")},isUp:!0}),w.jsx(te,{type:"odd",payout:"19.42 USD",percentage:"94.20%",onClick:()=>{S("odd"),P("DIGITODD")},isUp:!1})]}):t.id==="over-under"?w.jsxs("div",{className:"space-y-3",children:[w.jsx(te,{type:"over",payout:"19.42 USD",percentage:"94.20%",onClick:()=>{I("over"),P("DIGITOVER")},isUp:!0}),w.jsx(te,{type:"under",payout:"19.42 USD",percentage:"94.20%",onClick:()=>{I("under"),P("DIGITUNDER")},isUp:!1})]}):R?w.jsxs("div",{className:"space-y-3",children:[w.jsx(te,{type:"touch",payout:"19.42 USD",percentage:"94.20%",onClick:()=>{b("touch"),P("TOUCH")},isUp:!0}),w.jsx(te,{type:"no-touch",payout:"19.42 USD",percentage:"94.20%",onClick:()=>{b("no-touch"),P("NOTOUCH")},isUp:!1})]}):N||A?w.jsx("div",{className:"space-y-3",children:w.jsxs(Be,{onClick:()=>P("ACCUMULATOR"),className:"w-full h-12 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg flex items-center justify-center gap-2 shadow-lg",children:[w.jsx(wi,{className:"h-4 w-4 -ml-1"}),"Buy",w.jsx(Gw,{className:"h-4 w-4 ml-auto"})]})}):w.jsx("div",{className:"space-y-3",children:w.jsxs(Be,{onClick:()=>P(),className:"w-full h-12 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg flex items-center justify-center gap-2 shadow-lg",children:[w.jsx(wi,{className:"h-4 w-4 -ml-1"}),"Buy ",t.name,w.jsx(Gw,{className:"h-4 w-4 ml-auto"})]})})};return w.jsxs(Nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:"space-y-4",children:[J(),W(),X(),_(),U(),Z(),M(),re(),Q(),le()]},t.id)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _se=1e-7,Pse=1e-4;class j3{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class $k{refCount(e){return vs("refCount")}incRef(e){return vs("incRef")}timerAvailable(){return!0}time(e){return vs("time")}read(e){return vs("read")}readSync(e){return vs("readSync")}readToGPU(e,n){return vs("readToGPU")}numDataIds(){return vs("numDataIds")}disposeData(e,n){return vs("disposeData")}write(e,n,s){return vs("write")}move(e,n,s,r,i){return vs("move")}createTensorFromGPUData(e,n,s){return vs("createTensorFromGPUData")}memory(){return vs("memory")}floatPrecision(){return vs("floatPrecision")}epsilon(){return this.floatPrecision()===32?_se:Pse}dispose(){return vs("dispose")}}function vs(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,ic(t,e,n)}function xl(t,e,n){return Math.max(t,Math.min(e,n))}function Nk(t){return t%2===0?t:t+1}function ic(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function Ose(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function D(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Ek(t,e,n=""){D(rt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function W3(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ne(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function rt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ru(t){return t%1===0}function w1(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Lc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function AR(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function U3(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function Ge(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),D(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),D(t.every(s=>ru(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function va(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:Ge(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Ln(t,e){return Kt(t,e)}function Kt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Mse(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function Lse(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function G3(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Lg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function zse(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Xd(t){return typeof t=="string"||t instanceof String}function Vse(t){return typeof t=="boolean"}function C1(t){return typeof t=="number"}function Iu(t){return Array.isArray(t)?Iu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":C1(t)?"float32":Xd(t)?"string":Vse(t)?"bool":"float32"}function S1(t){return!!(t&&t.constructor&&t.call&&t.apply)}function k1(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function $e(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function H3(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=H3(t+l*a,o,n,s)}return r}function jr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return H3(0,t,e,n)}function Bse(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Rk(t,e){const n=zn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function zn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function K3(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return jr(t,new Float32Array(n));if(e==="int32")return jr(t,new Int32Array(n));if(e==="bool")return jr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function fo(t){t.forEach(e=>{D(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function ki(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function $u(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function Ak(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DR="tfjsflags";class jse{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Wse,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ak(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);DR in e&&e[DR].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=Gse(r,i)})}}function Wse(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Use(e,s[0],s[1]),s.join("="))),e}function Use(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Gse(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function Y(){return X3}let X3=null;function Hse(t){X3=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cb;function q3(){if(cb==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");cb=t}return cb}function Kse(){const t=q3();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Dk(t,e){const n=Kse();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const f0="Abs",qd="Acos",Yd="Acosh",Nu="Add",_k="AddN",Pk="All",Fk="Any",p0="ArgMax",m0="ArgMin",Qd="Asin",Zd="Asinh",Jd="Atan",ef="Atanh",tf="Atan2",g0="AvgPool",Ok="AvgPoolGrad",x0="AvgPool3D",Mk="AvgPool3DGrad",v0="BatchMatMul",y0="BatchToSpaceND",Lk="Bincount",zk="BitwiseAnd",Xse="BroadcastTo",Y3="BroadcastArgs",nf="Cast",sf="Ceil",rf="ClipByValue",Vk="Complex",b0="ComplexAbs",w0="Concat",C0="Conv2D",Bk="Conv2DBackpropFilter",S0="Conv2DBackpropInput",k0="Conv3D",jk="Conv3DBackpropFilterV2",Wk="Conv3DBackpropInputV2",of="Cos",af="Cosh",Uk="Cumprod",T0="Cumsum",Gk="CropAndResize",Hk="DenseBincount",Kk="DepthToSpace",I0="DepthwiseConv2dNative",Xk="DepthwiseConv2dNativeBackpropFilter",qk="DepthwiseConv2dNativeBackpropInput",Q3="Diag",$0="Dilation2D",T1="Dilation2DBackpropInput",I1="Dilation2DBackpropFilter",qse="Draw",lf="RealDiv",Yk="Einsum",cf="Elu",Qk="EluGrad",uf="Erf",N0="Equal",hf="Exp",E0="ExpandDims",df="Expm1",Zk="FFT",Jk="Fill",eT="FlipLeftRight",ff="Floor",pf="FloorDiv",R0="FusedBatchNorm",A0="GatherV2",Z3="GatherNd",D0="Greater",mf="GreaterEqual",gf="Identity",tT="IFFT",nT="Imag",xf="IsFinite",vf="IsInf",yf="IsNan",_0="LeakyRelu",P0="Less",F0="LessEqual",J3="LinSpace",bf="Log",wf="Log1p",O0="LogicalAnd",M0="LogicalNot",L0="LogicalOr",Yse="LogSoftmax",z0="LRN",sT="LRNGrad",V0="Max",Cf="Maximum",B0="MaxPool",rT="MaxPoolGrad",j0="MaxPool3D",iT="MaxPool3DGrad",ez="MaxPoolWithArgmax",W0="Mean",U0="Min",Sf="Minimum",G0="MirrorPad",kf="Mod",tz="Multinomial",Tf="Multiply",H0="Neg",K0="NotEqual",oT="NonMaxSuppressionV3",aT="NonMaxSuppressionV4",lT="NonMaxSuppressionV5",X0="OnesLike",q0="OneHot",Y0="Pack",Q0="PadV2",If="Pow",Z0="Prelu",J0="Prod",nz="RaggedGather",sz="RaggedRange",rz="RaggedTensorToTensor",cT="Range",uT="Real",$f="Reciprocal",Nf="Relu",ev="Reshape",tv="ResizeNearestNeighbor",hT="ResizeNearestNeighborGrad",nv="ResizeBilinear",dT="ResizeBilinearGrad",Ef="Relu6",sv="Reverse",Rf="Round",Af="Rsqrt",iz="ScatterNd",oz="TensorScatterUpdate",az="SearchSorted",rv="Select",Df="Selu",iv="Slice",_f="Sin",Pf="Sinh",Ff="Sign",Of="Sigmoid",Mf="Softplus",Lf="Sqrt",ov="Sum",av="SpaceToBatchND",lv="SplitV",cv="Softmax",lz="SparseFillEmptyRows",cz="SparseReshape",uz="SparseSegmentMean",hz="SparseSegmentSum",dz="SparseToDense",zf="SquaredDifference",fT="Square",pT="StaticRegexReplace",mT="StridedSlice",fz="StringNGrams",pz="StringSplit",mz="StringToHashBucketFast",Vf="Sub",Bf="Tan",jf="Tanh",Wf="Tile",gT="TopK",xT="Transform",zc="Transpose",vT="Unique",uv="Unpack",hv="UnsortedSegmentSum",dv="ZerosLike",Uf="Step",Qse="FromPixels",yT="RotateWithOffset",zg="_FusedMatMul",Vg="FusedConv2D",gz="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(...t){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(...t)}function Zse(...t){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bg=Dk("kernelRegistry",()=>new Map),$1=Dk("gradRegistry",()=>new Map);function _R(t,e){const n=vz(t,e);return Bg.get(n)}function PR(t){return $1.get(t)}function FR(t){const e=Bg.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function xz(t){const{kernelName:e,backendName:n}=t,s=vz(e,n);Bg.has(s)&&Ms(`The kernel '${e}' for backend '${n}' is already registered`),Bg.set(s,t)}function Jse(t){const{kernelName:e}=t;$1.has(e)&&Y().getBool("DEBUG")&&Ms(`Overriding the gradient for '${e}'`),$1.set(e,t)}function vz(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yz(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var bz=Ct,ur=null;try{ur=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ct(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ct.prototype.__isLong__;Object.defineProperty(Ct.prototype,"__isLong__",{value:!0});function Ps(t){return(t&&t.__isLong__)===!0}Ct.isLong=Ps;var OR={},MR={};function Ll(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=MR[t],s)?s:(n=St(t,(t|0)<0?-1:0,!0),r&&(MR[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=OR[t],s)?s:(n=St(t,t<0?-1:0,!1),r&&(OR[t]=n),n))}Ct.fromInt=Ll;function hr(t,e){if(isNaN(t))return e?Xa:dr;if(e){if(t<0)return Xa;if(t>=wz)return kz}else{if(t<=-zR)return Ss;if(t+1>=zR)return Sz}return t<0?hr(-t,e).neg():St(t%iu|0,t/iu|0,e)}Ct.fromNumber=hr;function St(t,e,n){return new Ct(t,e,n)}Ct.fromBits=St;var jg=Math.pow;function bT(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return dr;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return bT(t.substring(1),e,n).neg();for(var r=hr(jg(n,8)),i=dr,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=hr(jg(n,a));i=i.mul(c).add(hr(l))}else i=i.mul(r),i=i.add(hr(l))}return i.unsigned=e,i}Ct.fromString=bT;function ei(t,e){return typeof t=="number"?hr(t,e):typeof t=="string"?bT(t,e):St(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Ct.fromValue=ei;var LR=65536,ere=1<<24,iu=LR*LR,wz=iu*iu,zR=wz/2,VR=Ll(ere),dr=Ll(0);Ct.ZERO=dr;var Xa=Ll(0,!0);Ct.UZERO=Xa;var Ic=Ll(1);Ct.ONE=Ic;var Cz=Ll(1,!0);Ct.UONE=Cz;var N1=Ll(-1);Ct.NEG_ONE=N1;var Sz=St(-1,2147483647,!1);Ct.MAX_VALUE=Sz;var kz=St(-1,-1,!0);Ct.MAX_UNSIGNED_VALUE=kz;var Ss=St(0,-2147483648,!1);Ct.MIN_VALUE=Ss;var pe=Ct.prototype;pe.toInt=function(){return this.unsigned?this.low>>>0:this.low};pe.toNumber=function(){return this.unsigned?(this.high>>>0)*iu+(this.low>>>0):this.high*iu+(this.low>>>0)};pe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ss)){var n=hr(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=hr(jg(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};pe.getHighBits=function(){return this.high};pe.getHighBitsUnsigned=function(){return this.high>>>0};pe.getLowBits=function(){return this.low};pe.getLowBitsUnsigned=function(){return this.low>>>0};pe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ss)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};pe.isZero=function(){return this.high===0&&this.low===0};pe.eqz=pe.isZero;pe.isNegative=function(){return!this.unsigned&&this.high<0};pe.isPositive=function(){return this.unsigned||this.high>=0};pe.isOdd=function(){return(this.low&1)===1};pe.isEven=function(){return(this.low&1)===0};pe.equals=function(e){return Ps(e)||(e=ei(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};pe.eq=pe.equals;pe.notEquals=function(e){return!this.eq(e)};pe.neq=pe.notEquals;pe.ne=pe.notEquals;pe.lessThan=function(e){return this.comp(e)<0};pe.lt=pe.lessThan;pe.lessThanOrEqual=function(e){return this.comp(e)<=0};pe.lte=pe.lessThanOrEqual;pe.le=pe.lessThanOrEqual;pe.greaterThan=function(e){return this.comp(e)>0};pe.gt=pe.greaterThan;pe.greaterThanOrEqual=function(e){return this.comp(e)>=0};pe.gte=pe.greaterThanOrEqual;pe.ge=pe.greaterThanOrEqual;pe.compare=function(e){if(Ps(e)||(e=ei(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};pe.comp=pe.compare;pe.negate=function(){return!this.unsigned&&this.eq(Ss)?Ss:this.not().add(Ic)};pe.neg=pe.negate;pe.add=function(e){Ps(e)||(e=ei(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=i+c,d+=f>>>16,f&=65535,d+=r+l,h+=d>>>16,d&=65535,h+=s+a,u+=h>>>16,h&=65535,u+=n+o,u&=65535,St(d<<16|f,u<<16|h,this.unsigned)};pe.subtract=function(e){return Ps(e)||(e=ei(e)),this.add(e.neg())};pe.sub=pe.subtract;pe.multiply=function(e){if(this.isZero())return dr;if(Ps(e)||(e=ei(e)),ur){var n=ur.mul(this.low,this.high,e.low,e.high);return St(n,ur.get_high(),this.unsigned)}if(e.isZero())return dr;if(this.eq(Ss))return e.isOdd()?Ss:dr;if(e.eq(Ss))return this.isOdd()?Ss:dr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(VR)&&e.lt(VR))return hr(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*u,h+=d>>>16,d&=65535,d+=i*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=s*u+r*c+i*l+o*a,h&=65535,St(f<<16|p,h<<16|d,this.unsigned)};pe.mul=pe.multiply;pe.divide=function(e){if(Ps(e)||(e=ei(e)),e.isZero())throw Error("division by zero");if(ur){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ur.div_u:ur.div_s)(this.low,this.high,e.low,e.high);return St(n,ur.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Xa:dr;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Xa;if(e.gt(this.shru(1)))return Cz;i=Xa}else{if(this.eq(Ss)){if(e.eq(Ic)||e.eq(N1))return Ss;if(e.eq(Ss))return Ic;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(dr)?e.isNegative()?Ic:N1:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(Ss))return this.unsigned?Xa:dr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=dr}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:jg(2,a-48),c=hr(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=hr(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Ic),i=i.add(c),r=r.sub(u)}return i};pe.div=pe.divide;pe.modulo=function(e){if(Ps(e)||(e=ei(e)),ur){var n=(this.unsigned?ur.rem_u:ur.rem_s)(this.low,this.high,e.low,e.high);return St(n,ur.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};pe.mod=pe.modulo;pe.rem=pe.modulo;pe.not=function(){return St(~this.low,~this.high,this.unsigned)};pe.and=function(e){return Ps(e)||(e=ei(e)),St(this.low&e.low,this.high&e.high,this.unsigned)};pe.or=function(e){return Ps(e)||(e=ei(e)),St(this.low|e.low,this.high|e.high,this.unsigned)};pe.xor=function(e){return Ps(e)||(e=ei(e)),St(this.low^e.low,this.high^e.high,this.unsigned)};pe.shiftLeft=function(e){return Ps(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?St(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):St(0,this.low<<e-32,this.unsigned)};pe.shl=pe.shiftLeft;pe.shiftRight=function(e){return Ps(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?St(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):St(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};pe.shr=pe.shiftRight;pe.shiftRightUnsigned=function(e){if(Ps(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return St(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?St(n,0,this.unsigned):St(n>>>e-32,0,this.unsigned)};pe.shru=pe.shiftRightUnsigned;pe.shr_u=pe.shiftRightUnsigned;pe.toSigned=function(){return this.unsigned?St(this.low,this.high,!1):this};pe.toUnsigned=function(){return this.unsigned?this:St(this.low,this.high,!0)};pe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};pe.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};pe.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ct.fromBytes=function(e,n,s){return s?Ct.fromBytesLE(e,n):Ct.fromBytesBE(e,n)};Ct.fromBytesLE=function(e,n){return new Ct(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ct.fromBytesBE=function(e,n){return new Ct(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const Tz=ua(bz),tre=ED({__proto__:null,default:Tz},[bz]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Va=Tz||tre;function fv(t){return Va.fromString(t,!0,16)}const Iz=fv("c3a5c85c97cb3127"),za=fv("b492b66fbe98f273"),Qn=fv("9ae16a3b2f90404f");function E1(t){return t.xor(t.shru(47))}function $z(t,e,n){const s=t.slice(e,e+n);return Va.fromBytes(Array.from(s),!0,!0)}function pt(t,e){return $z(t,e,8)}function BR(t,e){return $z(t,e,4)}function mn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ko(t,e,n=fv("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function nre(t,e,n,s,r,i){r=r.add(t),i=mn(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(mn(r,44)),[r.add(s),i.add(o)]}function sm(t,e,n,s){return nre(pt(t,e),pt(t,e+8),pt(t,e+16),pt(t,e+24),n,s)}function sre(t,e=t.length){if(e>=8){const n=Qn.add(e*2),s=pt(t,0).add(Qn),r=pt(t,e-8),i=mn(r,37).mul(n).add(s),o=mn(s,25).add(r).mul(n);return Ko(i,o,n)}if(e>=4){const n=Qn.add(e*2),s=BR(t,0);return Ko(s.shl(3).add(e),BR(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return E1(Qn.mul(i).xor(Iz.mul(o))).mul(Qn)}return Qn}function rre(t,e=t.length){const n=Qn.add(e*2),s=pt(t,0).mul(za),r=pt(t,8),i=pt(t,e-8).mul(n),o=pt(t,e-16).mul(Qn);return Ko(mn(s.add(r),43).add(mn(i,30)).add(o),s.add(mn(r.add(Qn),18)).add(i),n)}function ire(t,e=t.length){const n=Qn.add(e*2),s=pt(t,0).mul(Qn),r=pt(t,8),i=pt(t,e-8).mul(n),o=pt(t,e-16).mul(Qn),a=mn(s.add(r),43).add(mn(i,30)).add(o),l=Ko(a,s.add(mn(r.add(Qn),18)).add(i),n),c=pt(t,16).mul(n),u=pt(t,24),h=a.add(pt(t,e-32)).mul(n),d=l.add(pt(t,e-24)).mul(n);return Ko(mn(c.add(u),43).add(mn(h,30)).add(d),c.add(mn(u.add(s),18)).add(h),n)}function ore(t,e=t.length){const n=Va.fromNumber(81,!0);if(e<=32)return e<=16?sre(t,e):rre(t,e);if(e<=64)return ire(t,e);let s=n,r=n.mul(za).add(113),i=E1(r.mul(Qn).add(113)).mul(Qn),o=[Va.UZERO,Va.UZERO],a=[Va.UZERO,Va.UZERO];s=s.mul(Qn).add(pt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=mn(s.add(r).add(o[0]).add(pt(t,l+8)),37).mul(za),r=mn(r.add(o[1]).add(pt(t,l+48)),42).mul(za),s=s.xor(a[1]),r=r.add(o[0]).add(pt(t,l+40)),i=mn(i.add(a[0]),33).mul(za),o=sm(t,l,o[1].mul(za),s.add(a[0])),a=sm(t,l+32,i.add(a[1]),r.add(pt(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const h=za.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=mn(s.add(r).add(o[0]).add(pt(t,l+8)),37).mul(h),r=mn(r.add(o[1]).add(pt(t,l+48)),42).mul(h),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(pt(t,l+40))),i=mn(i.add(a[0]),33).mul(h),o=sm(t,l,o[1].mul(h),s.add(a[0])),a=sm(t,l+32,i.add(a[1]),r.add(pt(t,l+16))),[i,s]=[s,i],Ko(Ko(o[0],a[0],h).add(E1(r).mul(Iz)).add(i),Ko(o[1],a[1],h).add(s),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(t,e){return e==="string"?Xo(t):zl([t],e)}function are(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function zl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=vl(t)),Y().getBool("DEBUG")&&Mse(t,e),are(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function os(){return Y().platform.now()}function Xo(t,e="utf-8"){return e=e||"utf-8",Y().platform.encode(t,e)}function ra(t,e="utf-8"){return e=e||"utf-8",Y().platform.decode(t,e)}function br(t){return Y().platform.isTypedArray!=null?Y().platform.isTypedArray(t):yz(t)}function vl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Ak(t)||t==null||br(t)&&n)e.push(t);else if(Array.isArray(t)||br(t))for(let s=0;s<t.length;++s)vl(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)vl(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lre{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new ure)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=os();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:os()-a})}if(Y().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(h=>{cre(h,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function cre(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class ure{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?Lc(`${r}ms`,9):r.error,l=Lc(e,25),c=n.rank,u=n.size,h=Lc(n.shape.toString(),14);let d="";for(const f in i){const p=i[f];if(p!=null){const m=p.shape||n.shape,v=m.length;d+=`${f}: ${v}D ${v>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const h in u){const d=u[h];let f=!1;for(let p=0;p<e.length;p++)if(s[d.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(i[c.outputs[h].id]){for(const d in u)i[u[d].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const d in c.inputs){const f=c.inputs[d];s[f.id]&&(u[d]=f)}const h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function dre(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!rt(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const h=t[u.id];t[u.id]=s(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jR=20,ih=3,ub=7;function fre(t,e,n,s){const r=$e(e),i=pre(t,e,n,r),o=e.length,a=zm(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function pre(t,e,n,s){const r=ne(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?bh(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],yh(l[u+h],0,n).length)}return o}function yh(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(ub))} + ${parseFloat(t[1].toFixed(ub))}j`:Xd(t)?s=`'${t}'`:n==="bool"?s=Nz(t):s=parseFloat(t.toFixed(ub)).toString(),Lc(s,e)}function Nz(t){return t===0?"false":"true"}function zm(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=bh(t);return[yh(m[0],0,n)]}return n==="bool"?[Nz(t[0])]:[t[0].toString()]}if(l===1){if(a>jR){const v=ih*o;let x=Array.from(t.slice(0,v)),g=Array.from(t.slice((a-ih)*o,a*o));return n==="complex64"&&(x=bh(x),g=bh(g)),["["+x.map((y,b)=>yh(y,r[b],n)).join(", ")+", ..., "+g.map((y,b)=>yh(y,r[a-ih+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?bh(t):Array.from(t)).map((v,x)=>yh(v,r[x],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),h=s[0]*o,d=[];if(a>jR){for(let m=0;m<ih;m++){const v=m*h,x=v+h;d.push(...zm(t.slice(v,x),c,n,u,r,!1))}d.push("...");for(let m=a-ih;m<a;m++){const v=m*h,x=v+h;d.push(...zm(t.slice(v,x),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const v=m*h,x=v+h;d.push(...zm(t.slice(v,x),c,n,u,r,m===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function bh(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=ne(e),s!=null){const r=s.length;D(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Kt(n,this.size),this.strides=$e(e)}set(e,...n){n.length===0&&(n=[0]),D(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Or().makeTensor(this.values,this.shape,this.dtype)}}let Or=null,oc=null;function mre(t){Or=t}function gre(t){oc=t}class on{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ne(e),this.strides=$e(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return oc.buffer(this.shape,this.dtype,e)}bufferSync(){return oc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return jr(this.shape,e,this.dtype==="complex64")}arraySync(){return jr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Or().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>ra(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Or().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Or().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>ra(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Or().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Or().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return oc.print(this,e)}clone(){return this.throwIfDisposed(),oc.clone(this)}toString(e=!1){const n=this.dataSync();return fre(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),oc.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Or().makeVariable(this,e,n,s)}}Object.defineProperty(on,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ee(){return Dk("Tensor",()=>on)}ee();class Wg extends on{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!rt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Or().disposeTensor(this),this.dataId=e.dataId,Or().incRef(this,null)}dispose(){Or().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Wg,Symbol.hasInstance,{value:t=>t instanceof on&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var WR;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(WR||(WR={}));var R1;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(R1||(R1={}));var A1;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(A1||(A1={}));var D1;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(D1||(D1={}));var _1;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(_1||(_1={}));const xre={float32:D1,int32:R1,bool:A1,complex64:_1};function Rs(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return xre[t][e]}function wT(t){return Rs(t,"int32")}function Ez(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function Rz(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(t,e){if(t.dtype===e.dtype)return[t,e];const n=Rs(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Az(t){const e=[];return Dz(t,e,new Set),e}function Dz(t,e,n){if(t==null)return;if(t instanceof on){e.push(t);return}if(!vre(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),Dz(i,e,n))}}function vre(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hb(t){return t.kernelName!=null}class UR{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ou{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new UR}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Ms(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new lre(this.backendInstance),!0}setupRegisteredKernels(){FR(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){FR(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof $k)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ms(`Initialization of backend ${e} failed`),Ms(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Ms(`Initialization of backend ${e} failed`),Ms(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return ou.nextTensorId++}nextVariableId(){return ou.nextVariableId++}clone(e){const n=j.runKernel(gf,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return j.runKernel(nf,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(_R(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=hb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(hb(e)){const{kernelName:p,inputs:m,attrs:v}=e;this.backendName==null&&this.backend;const x=_R(p,this.backendName);D(x!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const g=this.backend.numDataIds();l=x.kernelFunc({inputs:m,attrs:v,backend:this.backend});const y=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,g,y);const b=y.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(r){const C=this.getTensorsForGradient(p,m,b);s=this.saveTensorsForBackwardMode(C)}return b}}else{const{forwardFunc:p}=e,m=v=>{r&&(s=v.map(x=>this.keep(this.clone(x))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,v,x),x}}const{inputs:u,attrs:h}=e,d=hb(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,d,s,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=PR(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(D(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&Xd(e[0])&&(i=e.map(l=>Xo(l)));const o=r.write(i,n,s),a=new on(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=zse(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new on(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new Wg(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Lg(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Wg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Lg(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=PR(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){const d=s[h],f=zn(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Az(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(D(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(i instanceof on,()=>"The result y returned by f() must be a tensor.");const o=hre(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??yre(i.shape),dre(a,o,c=>this.tidy(c),bre);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return D(S1(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{D(n.every(a=>a instanceof on),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),D(s.value instanceof on,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(S1(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];D(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(u.every(d=>d instanceof on),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return u.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=os(),s=await this.backend.time(e);return s.wallMs=os()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new UR;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ou.nextTensorId=0;ou.nextVariableId=0;function yre(t){const e=Rk(ne(t),"float32");return j.makeTensor(e,t,"float32")}function _z(){const t=q3();if(t._tfengine==null){const e=new jse(t);t._tfengine=new ou(e)}return Hse(t._tfengine.ENV),mre(()=>t._tfengine),t._tfengine}const j=_z();function bre(t,e){const n={a:t,b:e};return j.runKernel(Nu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(){return typeof navigator<"u"&&navigator!=null}function Pz(t){if(t||wre()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Fz(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=Y();ds.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ds.registerFlag("IS_BROWSER",()=>Fz());ds.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ds.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ds.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ds.registerFlag("PROD",()=>!1);ds.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ds.getBool("DEBUG"));ds.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ds.registerFlag("IS_TEST",()=>!1);ds.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ds.getBool("DEBUG"));ds.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ds.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ds.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pv(t,e){let n=t;if(br(t))return e==="string"?[]:[t.length];if(Ez(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(Rz(t))return[t.buffer.size/(e==null?4:Lg(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||br(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&Y().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Oz(t,s,[]),s}function Oz(t,e,n){if(n=n||[],!Array.isArray(t)&&!br(t)){D(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}D(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)Oz(t[r],s,n.concat(r))}function GR(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function L(t,e,n,s="numeric"){if(t instanceof ee())return GR(s,t.dtype,e,n),t;let r=Iu(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),GR(s,r,e,n),t==null||!br(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=pv(t,r);!br(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?zl(t,r):vl(t,[],!0);return j.makeTensor(a,i,r)}function Mz(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>L(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cre="__op";function H(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Cre;const r=(...i)=>{j.startScope(n);try{const o=s(...i);return Ak(o)&&console.error("Cannot return a Promise inside of tidy."),j.endScope(o),o}catch(o){throw j.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t,e){const n=L(t,"real","complex"),s=L(e,"imag","complex");Ek(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return j.runKernel(Vk,r)}const au=H({complex_:Sre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mv(t,e,n,s){if(s==null)s=Iu(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Rz(t)||Ez(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return j.backend.createTensorFromGPUData(t,e||n,s)}if(!br(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){fo(e);const r=ne(e),i=ne(n);D(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==ne(e.slice(o)):!0;D(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!br(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?zl(t,s):vl(t,[],!0),j.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(t,e,n){const s=pv(t,n);return mv(t,e,s,n)}class Eu{static join(e){return new Eu(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>br(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],h=e+a-c.start,d=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,h,p-h);if(o.set(m,d),a+=m.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=kre(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function kre(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(){return j}function P1(){return j.memory()}function K(t,e){return j.tidy(t,e)}function Xe(t){Az(t).forEach(n=>n.dispose())}function Ti(t){return j.keep(t)}function zz(t,e,n=1){return j.registerBackend(t,e,n)}function Tre(){return j.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HR=4;async function KR(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((v,x)=>v+x.length,0)+HR*d.length,p=new Uint8Array(f);let m=0;for(let v=0;v<d.length;v++){const x=d[v],g=new Uint8Array(new Uint32Array([x.length]).buffer);p.set(g,m),m+=HR,p.set(x,m),m+=x.length}h(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:Ire(i),specs:n}}function Ire(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const CT=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function XR(t){return CT?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function $re(t){if(CT)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function Nre(t){if(CT){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function Ere(t){return Eu.join(t)}function Vz(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:XR(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:XR(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Eu(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Xn.instance==null&&(Xn.instance=new Xn),Xn.instance}static registerSaveRouter(e){Xn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Xn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Xn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Xn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Xn.getInstance().loadRouters:Xn.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const Rre=t=>Xn.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1="tensorflowjs",O1=1,qa="models_store",_o="model_info_store";function Bz(){if(!Y().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function M1(t){const e=t.result;e.createObjectStore(qa,{keyPath:"modelPath"}),e.createObjectStore(_o,{keyPath:"modelPath"})}class yl{constructor(e){if(this.indexedDB=Bz(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(F1,O1);i.onupgradeneeded=()=>M1(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(qa,"readonly"),c=a.objectStore(qa).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=Eu.join(n.weightData);const a=Vz(n),l=o.transaction(_o,"readwrite");let c=l.objectStore(_o),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return r(d)}let h;u.onsuccess=()=>{h=o.transaction(qa,"readwrite");const d=h.objectStore(qa);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(_o);const m=c.delete(this.modelPath);m.onsuccess=()=>(o.close(),r(f.error)),m.onerror=v=>(o.close(),r(f.error))}},u.onerror=d=>(o.close(),r(u.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}yl.URL_SCHEME="indexeddb://";const jz=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(yl.URL_SCHEME)?Are(t.slice(yl.URL_SCHEME.length)):null;Xn.registerSaveRouter(jz);Xn.registerLoadRouter(jz);function Are(t){return new yl(t)}function Dre(t){return t.startsWith(yl.URL_SCHEME)?t.slice(yl.URL_SCHEME.length):t}class _re{constructor(){this.indexedDB=Bz()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(F1,O1);s.onupgradeneeded=()=>M1(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(_o,"readonly"),a=i.objectStore(_o).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=Dre(e),new Promise((n,s)=>{const r=this.indexedDB.open(F1,O1);r.onupgradeneeded=()=>M1(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(_o,"readwrite"),a=o.objectStore(_o),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),h=()=>{c=i.transaction(qa,"readwrite");const f=c.objectStore(qa).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=h,u.onerror=d=>(h(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wi="/",ac="tensorflowjs_models",Wz="info",Pre="model_topology",Fre="weight_specs",Ore="weight_data",Mre="model_metadata";function Uz(t){return{info:[ac,t,Wz].join(Wi),topology:[ac,t,Pre].join(Wi),weightSpecs:[ac,t,Fre].join(Wi),weightData:[ac,t,Ore].join(Wi),modelMetadata:[ac,t,Mre].join(Wi)}}function Gz(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function Lre(t){const e=t.split(Wi);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Wi)}function zre(t){return t.startsWith(bl.URL_SCHEME)?t.slice(bl.URL_SCHEME.length):t}class bl{constructor(e){if(!Y().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Uz(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Vz(e),i=Eu.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,$re(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw Gz(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Nre(o),n}}bl.URL_SCHEME="localstorage://";const Hz=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bl.URL_SCHEME)?Vre(t.slice(bl.URL_SCHEME.length)):null;Xn.registerSaveRouter(Hz);Xn.registerLoadRouter(Hz);function Vre(t){return new bl(t)}class Bre{constructor(){D(Y().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=ac+Wi,s=Wi+Wz;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=Lre(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=zre(e);const n=Uz(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return Gz(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qR="://";class li{constructor(){this.managers={}}static getInstance(){return li.instance==null&&(li.instance=new li),li.instance}static registerManager(e,n){D(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(qR)&&(e=e.slice(0,e.indexOf(qR))),D(e.length>0,()=>"scheme must not be an empty string.");const s=li.getInstance();D(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=li.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(li.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jre{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!Y().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return yz(e)}}if(Y().get("IS_BROWSER")){Y().setPlatform("browser",new jre);try{li.registerManager(bl.URL_SCHEME,new Bre)}catch{}try{li.registerManager(yl.URL_SCHEME,new _re)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre={importFetch:()=>require("node-fetch")};let db;class Ure{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return Y().global.fetch!=null?Y().global.fetch(e,n):(db==null&&(db=Wre.importFetch()),db(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Y().get("IS_NODE")&&!Y().get("IS_BROWSER")&&Y().setPlatform("node",new Ure);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(t,e="float32",n){return e=e||"float32",fo(t),new Nn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t,e){const n=L(t,"x","cast");if(!Lse(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return j.runKernel(nf,s,r)}const ve=H({cast_:Gre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t){const n={x:L(t,"x","clone","string_or_numeric")};return j.runKernel(gf,n)}const tl=H({clone_:Hre});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */_z();const Xre={buffer:Ue,cast:ve,clone:tl,print:Kre};gre(Xre);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t,e){let n=L(t,"a","add"),s=L(e,"b","add");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(Nu,r)}const ue=H({add_:qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t,e){let n=L(t,"a","floorDiv"),s=L(e,"b","floorDiv");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(pf,r)}const Kz=H({floorDiv_:Yre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t,e){let n=L(t,"a","div"),s=L(e,"b","div");if([n,s]=qt(n,s),n.dtype==="int32"&&s.dtype==="int32")return Kz(n,s);const r={a:n,b:s},i={};return j.runKernel(lf,r,i)}const Re=H({div_:Qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t,e){let n=L(t,"a","mul"),s=L(e,"b","mul");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(Tf,r)}const B=H({mul_:Zre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(t){const e=L(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return j.runKernel(b0,n)}else{const n={x:e};return j.runKernel(f0,n)}}const qn=H({abs_:Jre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t){const n={x:L(t,"x","acos")};return j.runKernel(qd,n)}const tie=H({acos_:eie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nie(t){const n={x:L(t,"x","acosh")};return j.runKernel(Yd,n)}const sie=H({acosh_:nie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rie(t,e=null,n=!1){const r={x:L(t,"x","all","bool")},i={axis:e,keepDims:n};return j.runKernel(Pk,r,i)}const Xz=H({all_:rie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(t,e=null,n=!1){const r={x:L(t,"x","any","bool")},i={axis:e,keepDims:n};return j.runKernel(Fk,r,i)}const L1=H({any_:iie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(t,e=0){const s={x:L(t,"x","argMax")},r={axis:e};return j.runKernel(p0,s,r)}const bd=H({argMax_:oie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(t,e=0){const s={x:L(t,"x","argMin")},r={axis:e};return j.runKernel(m0,s,r)}const lie=H({argMin_:aie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t){const n={x:L(t,"x","asin")};return j.runKernel(Qd,n)}const uie=H({asin_:cie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(t){const n={x:L(t,"x","asinh")};return j.runKernel(Zd,n)}const die=H({asinh_:hie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fie(t){const n={x:L(t,"x","atan")};return j.runKernel(Jd,n)}const pie=H({atan_:fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mie(t,e){let n=L(t,"a","atan2"),s=L(e,"b","atan2");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(tf,r)}const gie=H({atan2_:mie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(t){const n={x:L(t,"x","atanh")};return j.runKernel(ef,n)}const vie=H({atanh_:xie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gf(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=mo(r);return En(t,a,n,i,s,null,null,l)}function Sr(t,e,n,s,r,i,o="channelsLast"){const[a,l]=wd(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return En(t,c,n,s,r,i,!1,o)}function po(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=z1(e);let u,h;if(o==="NDHWC")h="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")h="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return ba(t,u,n,s,r,!1,h,i)}function En(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=t;else if(a==="channelsFirst")[l,h,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=e,[m,v]=wd(n),[x,g]=wd(s),y=Vc(d,x),b=Vc(f,g),{padInfo:C,outHeight:S,outWidth:T}=wie(r,c,u,m,v,y,b,i,a),I=o?p*h:p;let $;return a==="channelsFirst"?$=[l,I,S,T]:a==="channelsLast"&&($=[l,S,T,I]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:S,outWidth:T,outChannels:I,padInfo:C,strideHeight:m,strideWidth:v,filterHeight:d,filterWidth:f,effectiveFilterHeight:y,effectiveFilterWidth:b,dilationHeight:x,dilationWidth:g,inShape:t,outShape:$,filterShape:e}}function ba(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,h,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,h,d]=t;else if(o==="channelsFirst")[l,d,c,u,h]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,m,,v]=e,[x,g,y]=z1(n),[b,C,S]=z1(s),T=Vc(f,b),I=Vc(p,C),$=Vc(m,S),{padInfo:N,outDepth:A,outHeight:F,outWidth:E}=Cie(r,c,u,h,x,g,y,T,I,$,a),R=i?v*d:v;let O;return o==="channelsFirst"?O=[l,R,A,F,E]:o==="channelsLast"&&(O=[l,A,F,E,R]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:A,outHeight:F,outWidth:E,outChannels:R,padInfo:N,strideDepth:x,strideHeight:g,strideWidth:y,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:T,effectiveFilterHeight:I,effectiveFilterWidth:$,dilationDepth:b,dilationHeight:C,dilationWidth:S,inShape:t,outShape:O,filterShape:e}}function yie(t,e,n,s,r){s==null&&(s=ST(t,e,n));const i=t[0],o=t[1],a=Cd((i-e+2*s)/n+1,r),l=Cd((o-e+2*s)/n+1,r);return[a,l]}function bie(t,e,n,s,r,i){r==null&&(r=ST(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=Cd((t[a]-e[a]+2*r)/s[a]+1,i));return o}function ST(t,e,n,s=1){const r=Vc(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function wd(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function z1(t){return typeof t=="number"?[t,t,t]:t}function Vc(t,e){return e<=1?t:t+(t-1)*(e-1)}function wie(t,e,n,s,r,i,o,a,l){let c,u,h;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=yie([e,n],i,s,t,a);u=f[0],h=f[1]}else if(t==="same"){u=Math.ceil(e/s),h=Math.ceil(n/r);const d=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(h-1)*r+o-n),p=Math.floor(d/2),m=d-p,v=Math.floor(f/2),x=f-v;c={top:p,bottom:m,left:v,right:x,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),h=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:p,right:m,type:d===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=Cd((e-i+d+f)/s+1,a),h=Cd((n-o+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:h}}function Cie(t,e,n,s,r,i,o,a,l,c,u){let h,d,f,p;if(t==="valid"&&(t=0),typeof t=="number"){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const v=bie([e,n,s,1],[a,l,c],1,[r,i,o],t,u);d=v[0],f=v[1],p=v[2]}else if(t==="same"){d=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const m=(d-1)*r+a-e,v=(f-1)*i+l-n,x=(p-1)*o+c-s,g=Math.floor(m/2),y=m-g,b=Math.floor(v/2),C=v-b,S=Math.floor(x/2),T=x-S;h={top:b,bottom:C,left:S,right:T,front:g,back:y,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Cd(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function wl(t){const[e,n,s]=wd(t);return e===1&&n===1&&s===1}function Bn(t,e){return wl(t)||wl(e)}function Cl(t){return wd(t).every(e=>e>0)}function mo(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function xs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")D(ru(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{D(ru(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e){const s={x:L(t,"x","reshape","string_or_numeric")},r={shape:e};return j.runKernel(ev,s,r)}const G=H({reshape_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(t,e,n,s,r){const i=L(t,"x","avgPool","float32"),o=1;D(Bn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=G(i,[1,i.shape[0],i.shape[1],i.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),xs("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let h=j.runKernel(g0,c,u);return h=ve(h,i.dtype),l?G(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const kT=H({avgPool_:kie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(t,e,n,s,r,i="NDHWC"){const o=L(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=G(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),D(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),xs("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let h=j.runKernel(x0,c,u);return h=ve(h,a.dtype),l?G(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Iie=H({avgPool3d_:Tie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t,e=0){D(t.length>=1,()=>"Pass at least one tensor to concat");const n=Mz(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return tl(n[0]);const s=n,r={axis:e};return j.runKernel(w0,s,r)}const us=H({concat_:$ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t,e,n=!1,s=!1){let r=L(t,"a","matMul"),i=L(e,"b","matMul");[r,i]=qt(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return j.runKernel(v0,o,a)}const nt=H({matMul_:Nie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t){const n={x:L(t,"x","sigmoid","float32")};return j.runKernel(Of,n)}const Ru=H({sigmoid_:Eie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t,e,n){const s=L(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return j.runKernel(iv,r,i)}const mt=H({slice_:Rie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t){const n={x:L(t,"x","tanh","float32")};return j.runKernel(jf,n)}const gv=H({tanh_:Aie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(t,e,n){const s=L(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);D(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),D(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),D(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return j.runKernel(y0,i,o)}const TT=H({batchToSpaceND_:Die});function _ie(t){let e;return t.rank===0||t.rank===1?e=G(t,[1,1,1,t.size]):t.rank===2?e=G(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=G(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(t,e,n,s,r,i){i==null&&(i=.001);const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;s!=null&&(u=L(s,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:_ie(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=j.runKernel(R0,d,f);return G(p,o.shape)}const xv=H({batchNorm_:Pie});function Fie(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),D(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),xv(o,a,l,u,c,i)}const Oie=H({batchNorm2d_:Fie});function Mie(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),D(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),xv(o,a,l,u,c,i)}const Lie=H({batchNorm3d_:Mie});function zie(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),D(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),xv(o,a,l,u,c,i)}const Vie=H({batchNorm4d_:zie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(t,e,n){const s=L(t,"x","bincount"),r=L(e,"weights","bincount");D(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return j.runKernel(Lk,i,o)}const jie=H({bincount_:Bie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wie(t,e){let n=L(t,"broadcastTo","x");const s=n.shape;if(fo(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=G(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return tl(n);const a={x:n},l={reps:i};return j.runKernel(Wf,a,l)}const jh=H({broadcastTo_:Wie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(t){const n={x:L(t,"x","ceil","float32")};return j.runKernel(sf,n)}const Gie=H({ceil_:Uie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vv(t,e,n){fo(t),n=n||Iu(e);const s={shape:t,value:e,dtype:n};return j.runKernel(Jk,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(t,e,n){const s=L(t,"x","clipByValue");if(D(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return vv(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return j.runKernel(rf,r,i)}const Hs=H({clipByValue_:Hie});function Kie(t){return us(t,0)}const Xie=H({concat1d_:Kie});function qie(t,e){return us(t,e)}const Yie=H({concat2d_:qie});function Qie(t,e){return us(t,e)}const Zie=H({concat3d_:Qie});function Jie(t,e){return us(t,e)}const eoe=H({concat4d_:Jie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(t,e,n,s,r="NHWC",i=[1,1],o){const a=L(t,"x","conv2d","float32"),l=L(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=G(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),xs("conv2d",s,o);const h=r==="NHWC"?c.shape[3]:c.shape[1];D(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),D(Bn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),D(Cl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),D(Cl(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=j.runKernel(C0,d,f);return u?G(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Sl=H({conv2d_:toe});function noe(t,e,n,s,r="NWC",i=1,o){const a=L(t,"x","conv1d"),l=L(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=G(a,[1,a.shape[0],a.shape[1]])),D(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),xs("conv1d",s,o),D(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D(Bn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),D(Cl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),D(Cl(n),()=>"Error in conv1D: Stride should be larger than 0."),D(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const h=G(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=G(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=Sl(d,h,[1,n],s,"NHWC",[1,i],o);return u?G(v,[v.shape[2],v.shape[3]]):G(v,[v.shape[0],v.shape[2],v.shape[3]])}const qz=H({conv1d_:noe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe(t,e,n,s,r,i="NHWC",o){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=G(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];D(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),D(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),xs("conv2dDerInput",r,o);const d={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=j.runKernel(S0,d,f);return c?G(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const IT=H({conv2DBackpropInput_:soe});function roe(t,e,n,s,r,i){const o=L(t,"x","conv2dTranspose"),a=L(e,"filter","conv2dTranspose");return IT(n,o,a,s,r,"NHWC",i)}const Yz=H({conv2dTranspose_:roe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=L(t,"x","conv3d"),a=L(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=G(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D(Bn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),D(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),D(Cl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),D(Cl(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},h={strides:n,pad:s,dataFormat:r,dilations:i},d=j.runKernel(k0,u,h);return c?G(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const ooe=H({conv3d_:ioe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(t,e,n,s,r){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=G(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];D(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),D(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),D(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),D(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),D(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},h={pad:r,strides:s,inputShape:i},d=j.runKernel(Wk,u,h);return a?G(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Qz=H({conv3DBackpropInput_:aoe});function loe(t,e,n,s,r){const i=L(t,"x","conv3dTranspose"),o=L(e,"filter","conv3dTranspose");return Qz(n,i,o,s,r)}const coe=H({conv3dTranspose_:loe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t){const n={x:L(t,"x","cos","float32")};return j.runKernel(of,n)}const $T=H({cos_:uoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(t){const n={x:L(t,"x","cosh","float32")};return j.runKernel(af,n)}const Zz=H({cosh_:hoe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t,e=0,n=!1,s=!1){const i={x:L(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return j.runKernel(Uk,i,o)}const V1=H({cumprod_:doe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(t,e=0,n=!1,s=!1){const i={x:L(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return j.runKernel(T0,i,o)}const Jz=H({cumsum_:foe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(t,e,n,s=!1){const r=L(t,"x","denseBincount"),i=L(e,"weights","denseBincount");D(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),D(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return j.runKernel(Hk,o,a)}const YR=H({denseBincount_:poe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function moe(t,e,n="NHWC"){const s=L(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];D(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),D(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),D(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),D(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return j.runKernel(Kk,a,l)}const goe=H({depthToSpace_:moe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t,e,n,s,r="NHWC",i=[1,1],o){const a=L(t,"x","depthwiseConv2d","float32"),l=L(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=G(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=r==="NHWC"?c.shape[3]:c.shape[1];D(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),xs("depthwiseConv2d",s,o);const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=j.runKernel(I0,d,f);return u?G(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const NT=H({depthwiseConv2d_:xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t,e,n,s,r=[1,1],i="NHWC"){const o=L(t,"x","dilation2d"),a=L(e,"filter","dilation2d");D(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=G(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),D(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},h={strides:n,pad:s,dilations:r},d=j.runKernel($0,u,h);return c?G(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const yoe=H({dilation2d_:voe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function dn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function Me(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(t,e){let n=L(t,"a","equal","string_or_numeric"),s=L(e,"b","equal","string_or_numeric");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(N0,r)}const Ri=H({equal_:boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t,e,n){const s=L(e,"a","where"),r=L(n,"b","where"),i=L(t,"condition","where","bool"),o=Me(Me(i.shape,s.shape),r.shape),a=jh(i,o),l=jh(s,o),c=jh(r,o),u={condition:a,t:l,e:c};return j.runKernel(rv,u)}const Jn=H({where_:woe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(t){const n={x:L(t,"x","zerosLike")};return j.runKernel(dv,n)}const Ze=H({zerosLike_:Coe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(t,e){let n=L(t,"a","div"),s=L(e,"b","div");[n,s]=qt(n,s);const r=Re(n,s),i=Ze(r),o=Ri(s,i);return Jn(o,i,r)}const koe=H({divNoNan_:Soe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t,e){const n=L(t,"t1","dot"),s=L(e,"t2","dot");D((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(D(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=G(n,[1,-1]),a=G(s,[-1,1]),l=nt(o,a);return G(l,[])}else if(n.rank===1&&s.rank===2){const o=G(n,[1,-1]),a=G(s,[s.shape[0],s.shape[1]]),l=nt(o,a);return G(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=G(s,[-1,1]),a=nt(n,o);return G(a,[a.size])}else{const o=G(s,[s.shape[0],s.shape[1]]);return nt(n,o)}}const Ioe=H({dot_:Toe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $oe(t,...e){const n=e.map((r,i)=>L(r,`tensors${i}`,"einsum")),s={equation:t};return j.runKernel(Yk,n,s)}const oh=H({einsum_:$oe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(t){const n={x:L(t,"x","elu","float32")};return j.runKernel(cf,n)}const yv=H({elu_:Noe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t){let e=L(t,"x","erf");D(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ve(e,"float32"));const n={x:e};return j.runKernel(uf,n)}const eV=H({erf_:Eoe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ET(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function tV(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function Cn(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function nn(t,e){const n=e.map(s=>1);return tV(t,n,e)}function Rn(t,e,n){D(ET(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Lt(t,e){if(ET(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function wa(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Yt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Roe(t,e=null,n=!1){const r={x:L(t,"x","max")},i={reductionIndices:e,keepDims:n};return j.runKernel(V0,r,i)}const Wr=H({max_:Roe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aoe(t,e=null,n=!1){const r={x:L(t,"x","min")},i={axis:e,keepDims:n};return j.runKernel(U0,r,i)}const Ug=H({min_:Aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(t,e){let n=L(t,"base","pow"),s=L(e,"exp","pow");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(If,r)}const kl=H({pow_:Doe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function st(t,e){if((br(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&br(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return mv(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(t){const n={x:L(t,"x","sqrt","float32")};return j.runKernel(Lf,n)}const Vn=H({sqrt_:_oe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(t){const e=L(t,"x","square"),n={};return j.runKernel("Square",{x:e},n)}const wt=H({square_:Poe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(t,e=null,n=!1){let s=L(t,"x","sum");s.dtype==="bool"&&(s=ve(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return j.runKernel(ov,r,i)}const Ee=H({sum_:Foe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(t,e="euclidean",n=null,s=!1){t=L(t,"x","norm");const r=nV(t,e,n);let i=r.shape;if(s){const o=Ge(n,t.shape);i=nn(r.shape,o)}return G(r,i)}function nV(t,e,n=null){if(t.rank===0)return qn(t);if(t.rank!==1&&n===null)return nV(G(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Ee(qn(t),n);if(e===1/0)return Wr(qn(t),n);if(e===-1/0)return Ug(qn(t),n);if(e==="euclidean"||e===2)return Vn(Ee(kl(qn(t),st(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Wr(Ee(qn(t),n[0]),n[1]-1);if(e===1/0)return Wr(Ee(qn(t),n[1]),n[0]);if(e===-1/0)return Ug(Ee(qn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Vn(Ee(wt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const bv=H({norm_:Ooe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe(t,e=null,n=!1){return bv(t,"euclidean",e,n)}const Loe=H({euclideanNorm_:Moe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zoe(t){const n={x:L(t,"x","exp")};return j.runKernel(hf,n)}const Ai=H({exp_:zoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t,e=0){const n=L(t,"x","expandDims","string_or_numeric");D(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return j.runKernel(E0,s,r)}const as=H({expandDims_:Voe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t){const n={x:L(t,"x","expm1")};return j.runKernel(df,n)}const joe=H({expm1_:Boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t,e){const n=L(t,"x","tile","string_or_numeric");D(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return j.runKernel(Wf,s,r)}const zr=H({tile_:Woe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t,e,n,s="float32"){e==null&&(e=t);const r=Ue([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=G(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return zr(as(o,0),[n[0],1,1]);if(n.length===2)return zr(as(as(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return zr(as(as(as(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const sV=H({eye_:Uoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t){const n={x:L(t,"x","floor","float32")};return j.runKernel(ff,n)}const wv=H({floor_:Goe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(t,e,n=0,s=0){const r=L(t,"x","gather"),i=L(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return j.runKernel(A0,o,a)}const RT=H({gather_:Hoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(t,e){let n=L(t,"a","greater","string_or_numeric"),s=L(e,"b","greater","string_or_numeric");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(D0,r)}const qs=H({greater_:Koe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t,e){let n=L(t,"a","greaterEqual","string_or_numeric"),s=L(e,"b","greaterEqual","string_or_numeric");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(mf,r)}const Vl=H({greaterEqual_:Xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(t){const n={input:L(t,"input","imag")};return j.runKernel(nT,n)}const AT=H({imag_:qoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yoe(t){const n={x:L(t,"x","isFinite")};return j.runKernel(xf,n)}const Qoe=H({isFinite_:Yoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t){const n={x:L(t,"x","isInf")};return j.runKernel(vf,n)}const Joe=H({isInf_:Zoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(t){const n={x:L(t,"x","isNaN")};return j.runKernel(yf,n)}const tae=H({isNaN_:eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(t,e=.2){const s={x:L(t,"x","leakyRelu")},r={alpha:e};return j.runKernel(_0,s,r)}const DT=H({leakyRelu_:nae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sae(t,e){let n=L(t,"a","less","string_or_numeric"),s=L(e,"b","less","string_or_numeric");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(P0,r)}const Gg=H({less_:sae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rae(t,e){let n=L(t,"a","lessEqual","string_or_numeric"),s=L(e,"b","lessEqual","string_or_numeric");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(F0,r)}const Au=H({lessEqual_:rae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iae(t,e=5,n=1,s=1,r=.5){const i=L(t,"x","localResponseNormalization");D(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),D(ru(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=G(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=j.runKernel(z0,l,c);return a?G(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const oae=H({localResponseNormalization_:iae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(t){const n={x:L(t,"x","log","float32")};return j.runKernel(bf,n)}const Di=H({log_:aae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(t){const n={x:L(t,"x","log1p")};return j.runKernel(wf,n)}const rV=H({log1p_:lae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cae(t,e){D(S1(t),()=>"The f passed in variableGrads(f) must be a function"),D(e==null||Array.isArray(e)&&e.every(c=>c instanceof Wg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in j.registeredVariables)e.push(j.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),D(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=j.gradients(t,e,null,i);D(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function cu(t){return j.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t){const n={x:L(t,"x","neg")};return j.runKernel(H0,n)}const Xt=H({neg_:uae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hae(t){const n={x:L(t,"x","softplus")};return j.runKernel(Mf,n)}const Hf=H({softplus_:hae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dae(t){const e=L(t,"x","logSigmoid");return cu(s=>({value:Xt(Hf(Xt(s))),gradFunc:o=>B(o,Ru(Xt(s)))}))(e)}const fae=H({logSigmoid_:dae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(t,e){let n=L(t,"a","sub"),s=L(e,"b","sub");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(Vf,r)}const De=H({sub_:pae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(t,e=-1){const n=L(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return cu((r,i)=>{const a=Wr(r,e,!0),l=De(r,a),c=De(ve(l,"float32"),Di(Ee(Ai(l),e,!0)));return i([c]),{value:c,gradFunc:(h,d)=>{const[f]=d,p=!0,m=Ai(f);return De(h,B(Ee(h,e,p),m))}}})(n)}const iV=H({logSoftmax_:mae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gae(t,e=null,n=!1){const s=L(t,"x","logSumExp"),r=Ge(e,s.shape),i=Wr(s,r,!0),o=De(s,i),a=Ai(o),l=Ee(a,r),c=Di(l),u=ue(G(i,c.shape),c);if(n){const h=nn(u.shape,r);return G(u,h)}return u}const oV=H({logSumExp_:gae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t,e){const n=L(t,"a","logicalAnd","bool"),s=L(e,"b","logicalAnd","bool");Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(O0,r)}const ao=H({logicalAnd_:xae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(t){const n={x:L(t,"x","logicalNot","bool")};return j.runKernel(M0,n)}const _T=H({logicalNot_:vae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t,e){const n=L(t,"a","logicalOr","bool"),s=L(e,"b","logicalOr","bool");Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(L0,r)}const aV=H({logicalOr_:yae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(t,e){const n=L(t,"a","logicalXor","bool"),s=L(e,"b","logicalXor","bool");return Me(n.shape,s.shape),ao(aV(t,e),_T(ao(t,e)))}const wae=H({logicalXor_:bae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t,e,n,s,r){const i=L(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=G(i,[1,i.shape[0],i.shape[1],i.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D(Bn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),xs("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},h=j.runKernel(B0,c,u);return l?G(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const PT=H({maxPool_:Cae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=L(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=G(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),xs("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},h=j.runKernel(j0,c,u);return l?G(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const kae=H({maxPool3d_:Sae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae(t,e){let n=L(t,"a","maximum"),s=L(e,"b","maximum");[n,s]=qt(n,s),n.dtype==="bool"&&(n=ve(n,"int32"),s=ve(s,"int32")),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(Cf,r)}const Ca=H({maximum_:Tae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iae(t,e=null,n=!1){const r={x:L(t,"x","mean")},i={axis:e,keepDims:n};return j.runKernel(W0,r,i)}const en=H({mean_:Iae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(t,e="float32"){if(fo(t),e==="complex64"){const s=xn(t,"float32"),r=xn(t,"float32");return au(s,r)}const n=zn(ne(t),e);return j.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(t,e="float32"){if(fo(t),e==="complex64"){const s=Sa(t,"float32"),r=xn(t,"float32");return au(s,r)}const n=Rk(ne(t),e);return j.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(t,e){let n=L(t,"a","minimum"),s=L(e,"b","minimum");[n,s]=qt(n,s),n.dtype==="bool"&&(n=ve(n,"int32"),s=ve(s,"int32")),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(Sf,r)}const Sd=H({minimum_:$ae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(t,e,n){D(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=L(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)D(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return j.runKernel(G0,o,i)}const Eae=H({mirrorPad_:Nae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rae(t,e){let n=L(t,"a","mod"),s=L(e,"b","mod");[n,s]=qt(n,s);const r={a:n,b:s};return j.runKernel(kf,r)}const Aae=H({mod_:Rae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t,e=null,n=!1){t=L(t,"x","moments");const s=Ge(e,t.shape),r=en(t,s,n);let i=r.shape;n||(i=nn(r.shape,s));const o=wt(De(ve(t,"float32"),G(r,i))),a=en(o,s,n);return{mean:r,variance:a}}const FT=H({moments_:Dae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(t,e){let n=L(t,"a","notEqual","string_or_numeric"),s=L(e,"b","notEqual","string_or_numeric");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(K0,r)}const Hg=H({notEqual_:_ae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pae(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:L(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return j.runKernel(q0,o,a)}const lV=H({oneHot_:Pae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(t){const n={x:L(t,"x","onesLike")};return j.runKernel(X0,n)}const wr=H({onesLike_:Fae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(t,e,n=0){const s=L(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return j.runKernel(Q0,i,r)}const OT=H({pad_:Oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t,e,n){const s=L(t,"x","spaceToBatchND");D(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),D(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),D(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return j.runKernel(av,r,i)}const MT=H({spaceToBatchND_:Mae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lae(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=L(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=G(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(Bn(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=Sr(l.shape,e,i,r,s),h=[u.dilationHeight,u.dilationWidth];let d;s==="same"?d=Vae([u.filterHeight,u.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,m]=zae([u.inHeight,u.inWidth],h,d),v=f?s:"valid",x=f?l:MT(l,h,p),y=(n==="avg"?()=>kT(x,e,i,v,o):()=>PT(x,e,i,v,o))(),b=f?y:TT(y,h,m);return c?G(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function zae(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,h)=>(u-i[h]%u)%u),a=r.map((u,h)=>u+o[h]),l=e.map((u,h)=>[s[h],a[h]]),c=e.map((u,h)=>[0,o[h]]);return[l,c]}function Vae(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const Bae=H({pool_:Lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(t,e){const n=L(t,"x","prelu"),s=L(e,"alpha","prelu"),r={x:n,alpha:s};return j.runKernel(Z0,r)}const LT=H({prelu_:jae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(t,e=null,n=!1){let s=L(t,"x","prod");s.dtype==="bool"&&(s=ve(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return j.runKernel(J0,r,i)}const Uae=H({prod_:Wae});var zT={exports:{}};zT.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),h=c&&c.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,u),d.state=function(){return i(u,{})}),d}function a(){var l=4022871197,c=function(u){u=String(u);for(var h=0;h<u.length;h++){l+=u.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.alea=o})(bn,t,!1)})(zT);var Gae=zT.exports,VT={exports:{}};VT.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xor128=o})(bn,t,!1)})(VT);var Hae=VT.exports,BT={exports:{}};BT.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xorwow=o})(bn,t,!1)})(BT);var Kae=BT.exports,jT={exports:{}};jT.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,h=l.i,d,f;return d=u[h],d^=d>>>7,f=d^d<<24,d=u[h+1&7],f^=d^d>>>10,d=u[h+3&7],f^=d^d>>>3,d=u[h+4&7],f^=d^d<<7,d=u[h+7&7],d=d^d<<13,f^=d^d<<9,u[h]=f,l.i=h+1&7,f};function c(u,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.x&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xorshift7=o})(bn,t,!1)})(jT);var Xae=jT.exports,WT={exports:{}};WT.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,h=l.X,d=l.i,f,p;return l.w=u=u+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(u^u>>>16)|0};function c(u,h){var d,f,p,m,v,x=[],g=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,g=Math.max(g,h.length)),p=0,m=-32;m<g;++m)h&&(f^=h.charCodeAt((m+32)%h.length)),m===0&&(v=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(v=v+1640531527|0,d=x[m&127]^=f+v,p=d==0?p+1:0);for(p>=128&&(x[(h&&h.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=x[p+34&127],d=x[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,x[p]=f^d;u.w=v,u.X=x,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.X&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.xor4096=o})(bn,t,!1)})(WT);var qae=WT.exports,UT={exports:{}};UT.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:s&&s.amd?s(function(){return o}):this.tychei=o})(bn,t,!1)})(UT);var Yae=UT.exports,cV={exports:{}};const Qae={},Zae=Object.freeze(Object.defineProperty({__proto__:null,default:Qae},Symbol.toStringTag,{value:"Module"})),Jae=tH(Zae);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,h=r-1,d;function f(b,C,S){var T=[];C=C==!0?{entropy:!0}:C||{};var I=x(v(C.entropy?[b,y(n)]:b??g(),3),T),$=new p(T),N=function(){for(var A=$.g(i),F=l,E=0;A<c;)A=(A+E)*r,F*=r,E=$.g(1);for(;A>=u;)A/=2,F/=2,E>>>=1;return(A+E)/F};return N.int32=function(){return $.g(4)|0},N.quick=function(){return $.g(4)/4294967296},N.double=N,x(y($.S),n),(C.pass||S||function(A,F,E,R){return R&&(R.S&&m(R,$),A.state=function(){return m($,{})}),E?(s[a]=A,F):A})(N,I,"global"in C?C.global:this==s,C.state)}function p(b){var C,S=b.length,T=this,I=0,$=T.i=T.j=0,N=T.S=[];for(S||(b=[S++]);I<r;)N[I]=I++;for(I=0;I<r;I++)N[I]=N[$=h&$+b[I%S]+(C=N[I])],N[$]=C;(T.g=function(A){for(var F,E=0,R=T.i,O=T.j,P=T.S;A--;)F=P[R=h&R+1],E=E*r+P[h&(P[R]=P[O=h&O+F])+(P[O]=F)];return T.i=R,T.j=O,E})(r)}function m(b,C){return C.i=b.i,C.j=b.j,C.S=b.S.slice(),C}function v(b,C){var S=[],T=typeof b,I;if(C&&T=="object")for(I in b)try{S.push(v(b[I],C-1))}catch{}return S.length?S:T=="string"?b:b+"\0"}function x(b,C){for(var S=b+"",T,I=0;I<S.length;)C[h&I]=h&(T^=C[h&I]*19)+S.charCodeAt(I++);return y(C)}function g(){try{var b;return d&&(b=d.randomBytes)?b=b(r):(b=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(b)),y(b)}catch{var C=e.navigator,S=C&&C.plugins;return[+new Date,e,S,e.screen,y(n)]}}function y(b){return String.fromCharCode.apply(0,b)}if(x(s.random(),n),t.exports){t.exports=f;try{d=Jae}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:bn,[],Math)})(cV);var ele=cV.exports,tle=Gae,nle=Hae,sle=Kae,rle=Xae,ile=qae,ole=Yae,Bl=ele;Bl.alea=tle;Bl.xor128=nle;Bl.xorwow=sle;Bl.xorshift7=rle;Bl.xor4096=ile;Bl.tychei=ole;var GT=Bl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uV{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=GT.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class ale{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=GT.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lle(t,e=0,n=1,s,r){if(fo(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new uV(e,n,s,!1,r),o=Ue(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const cle=H({randomNormal_:lle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(t,e=0,n=1,s="float32",r){fo(t);const i=Ue(t,s),o=new ale(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Kf=H({randomUniform_:ule});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kd(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return j.runKernel(cT,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(t){const n={input:L(t,"input","real")};return j.runKernel(uT,n)}const Kg=H({real_:hle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(t){const n={x:L(t,"x","reciprocal")};return j.runKernel($f,n)}const fle=H({reciprocal_:dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(t){const n={x:L(t,"x","relu")};return j.runKernel(Nf,n)}const jl=H({relu_:ple});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(t){const n={x:L(t,"x","relu6")};return j.runKernel(Ef,n)}const hV=H({relu6_:mle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(t,e){const s={x:L(t,"x","reverse")},r={dims:e};return j.runKernel(sv,s,r)}const Tl=H({reverse_:gle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xle(t){const n={x:L(t,"x","round")};return j.runKernel(Rf,n)}const dV=H({round_:xle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(t){const n={x:L(t,"x","rsqrt","float32")};return j.runKernel(Af,n)}const fV=H({rsqrt_:vle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(t){const n={x:L(t,"x","selu")};return j.runKernel(Df,n)}const pV=H({selu_:yle});function ble(t,e,n,s,r,i=[1,1],o="NHWC"){const a=L(t,"x","separableConv2d"),l=L(e,"depthwiseFilter","separableConv2d"),c=L(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(a.rank===3&&(h=!0,u=G(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),D(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=l.shape[2],f=l.shape[3];D(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);const p=NT(u,l,s,r,o,i),v=Sl(p,c,1,"valid",o);return h?G(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const mV=H({separableConv2d_:ble});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(t){const n={x:L(t,"x","sign")};return j.runKernel(Ff,n)}const Cle=H({sign_:wle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sle(t){const n={x:L(t,"x","sin","float32")};return j.runKernel(_f,n)}const gV=H({sin_:Sle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kle(t){const n={x:L(t,"x","sinh")};return j.runKernel(Pf,n)}const xV=H({sinh_:kle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(t,e,n){const s=L(t,"x","slice1d");return D(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),mt(s,[e],[n])}const HT=H({slice1d_:Tle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ile(t,e,n){const s=L(t,"x","slice2d");return D(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),mt(s,e,n)}const vV=H({slice2d_:Ile});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $le(t,e,n){const s=L(t,"x","slice3d");return D(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),mt(s,e,n)}const KT=H({slice3d_:$le});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(t,e,n){const s=L(t,"x","slice4d");return D(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),mt(s,e,n)}const Xg=H({slice4d_:Nle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ele(t,e=-1){const n=L(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return j.runKernel(cv,s,r)}const XT=H({softmax_:Ele});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return j.runKernel(Zk,e)}const yV=H({fft_:Rle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ale(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return j.runKernel(tT,e)}const B1=H({ifft_:Ale});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=G(t,[n,e]);s=B1(r)}else{const r=[n,2*(e-1)],i=G(Kg(t),[n,e]),o=G(AT(t),[n,e]),a=Tl(mt(i,[0,1],[n,e-2]),1),l=B(Tl(mt(o,[0,1],[n,e-2]),1),st(-1)),c=us([i,a],1),u=us([o,l],1),h=G(au(c,u),[r[0],r[1]]);s=B1(h)}if(s=Kg(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=G(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const _le=H({irfft_:Dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple(t,e,n=0){const r={x:L(t,"x","split")},i={numOrSizeSplits:e,axis:n};return j.runKernel(lv,r,i)}const js=H({split_:Ple});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t,e){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(v=>0),m=t.shape.map(v=>v);m[t.shape.length-1]=e,r=mt(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=us([t,xn(p)],t.shape.length-1),n=e}else r=t;const i=Ze(r),o=G(au(r,i),[s,n]),a=yV(o),l=Math.floor(n/2)+1,c=Kg(a),u=AT(a),h=js(c,[l,n-l],c.shape.length-1),d=js(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,G(au(h[0],d[0]),f)}const Ole=H({rfft_:Fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(t,e){let n=L(t,"a","squaredDifference"),s=L(e,"b","squaredDifference");[n,s]=qt(n,s),Me(n.shape,s.shape);const r={a:n,b:s},i={};return j.runKernel(zf,r,i)}const Lle=H({squaredDifference_:Mle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(t,e){const n=L(t,"x","squeeze","string_or_numeric");return G(n,va(n.shape,e).newShape)}const Xf=H({squeeze_:zle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(t,e=0){const n=Mz(t,"tensors","stack","string_or_numeric");D(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&D(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return j.runKernel(Y0,s,r)}const lo=H({stack_:Vle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(t,e=0){const s={x:L(t,"x","step")},r={alpha:e};return j.runKernel(Uf,s,r)}const qf=H({step_:Ble});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:L(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return j.runKernel(mT,u,h)}const Wle=H({stridedSlice_:jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(t){const n={x:L(t,"x","tan","float32")};return j.runKernel(Bf,n)}const Gle=H({tan_:Ule});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(t,e){W3(t);const n=pv(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return mv(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fb(t,e,n){if(W3(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=pv(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return mv(t,e,s,n)}function bV(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function Hle(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}bV(n,e,t)}function Wl(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let h=r;h<i;++h)o*=n[h];const a=r<1?1:r,l=ne(e.shape)/a,c=[...$e(n.slice(0,r)),1],u=ne(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t,e=1,n=!0){const s=L(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=j.runKernel(gT,i,o);return{values:a,indices:l}}const Xle=H({topk_:Kle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(t,e=0,n=1,s,r){if(fo(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new uV(e,n,s,!0,r),o=Ue(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const wV=H({truncatedNormal_:qle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(t,e=0){const n=L(t,"x","unique","string_or_numeric");D(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=j.runKernel(vT,s,r);return{values:i,indices:o}}const Qle=H({unique_:Yle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t,e,n){const s=L(t,"x","unsortedSegmentSum"),r=L(e,"segmentIds","unsortedSegmentSum","int32");D(ru(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return j.runKernel(hv,i,o)}const CV=H({unsortedSegmentSum_:Zle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jle(t,e=0){const n=L(t,"x","unstack","string_or_numeric");D(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return j.runKernel(uv,s,r)}const Il=H({unstack_:Jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(t,e=!0,n,s){return j.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=Ue(t,"int32"),r=Ue([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tce(t,e,n){const s=L(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),D(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{D(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?K(()=>{let o=Kg(s),a=AT(s);return o=j.runKernel(zc,{x:o},i),a=j.runKernel(zc,{x:a},i),n&&(a=Xt(a)),au(o,a)}):j.runKernel(zc,r,i)}const Qe=H({transpose_:tce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(t,e){if(e==null)return t.shape.slice();if(rt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(t,e,n,s){const r=L(t,"x","dropout");if(D(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),D(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof on?r.clone():r;const i=nce(r,n),o=1-e,a=Re(wv(ue(Kf(i,0,1,"float32",s),o)),o);return B(r,a)}const rce=H({dropout_:sce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=G(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=G(e,[1,e.shape[0],e.shape[1],e.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];D(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),D(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),xs("conv2dDerFilter",r,o);const h={x:a,dy:l},d={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return j.runKernel(Bk,h,d)}const qT=H({conv2DBackpropFilter_:ice});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return B(t,qf(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function QT(t,e){let n=e;const s=dn(t.shape,e.shape);return s.length>0&&(n=Ee(n,s)),G(n,t.shape)}function ZT(t,e,n,s){if(e==="linear")return t;if(e==="relu")return jl(t);if(e==="elu")return yv(t);if(e==="relu6")return hV(t);if(e==="prelu")return LT(t,n);if(e==="leakyrelu")return DT(t,s);if(e==="sigmoid")return Ru(t);throw new Error(`Unknown fused activation ${e}.`)}const JT=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oce({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",JT(j.state.gradientDepth,l)===!1){D(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=Sl(t,e,n,s,r,i,o);return a!=null&&(S=ue(S,a)),ZT(S,l,c,u)}const h=L(t,"x","conv2d","float32"),d=L(e,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=G(h,[1,h.shape[0],h.shape[1],h.shape[2]])),D(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),D(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),xs("fused conv2d",s,o);const m=r==="NHWC"?f.shape[3]:f.shape[1];D(d.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${d.shape[2]}.`),D(Bn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const v=En(f.shape,d.shape,n,i,s,o);let x;a!=null&&(x=L(a,"bias","fused conv2d"),[x]=qt(x,h),r==="NHWC"?Me(v.outShape,x.shape):(D(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),D(x.shape.length===0||x.shape[0]===v.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let g;if(c!=null){const S=c.shape;if(D(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)D(S[0]===1||S[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${v.outChannels}).`);else if(S.length===3)try{Me(S,v.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(I)}g=L(c,"prelu weights","fused conv2d")}const y=(S,T)=>{D(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[I,$,N,A]=T,F=YT(S,N,l);D(wl(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const E=IT($.shape,F,I,n,s),R=qT($,F,I.shape,n,s),O=[E,R];if(A!=null){const P=QT(A,F);O.push(P)}return O},b={x:f,filter:d,bias:x,preluActivationWeights:g},C={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?cu((T,I,$)=>{let N=j.runKernel(Vg,b,C);return $([I,T,N]),p&&(N=G(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:y}})(f,d):cu((T,I,$,N)=>{let A=j.runKernel(Vg,b,C);return N([I,T,A,$]),p&&(A=G(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:y}})(f,d,x)}const ace=H({fusedConv2d_:oce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=G(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=G(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return j.runKernel(Xk,c,u)}const cce=H({depthwiseConv2dNativeBackpropFilter_:lce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=G(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},h=j.runKernel(qk,c,u);return l?G(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const hce=H({depthwiseConv2dNativeBackpropInput_:uce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(JT(j.state.gradientDepth,i)===!1){let A=nt(t,e,n,s);return r!=null&&(A=ue(A,r)),ZT(A,i,o,a)}let l=L(t,"a","fused matMul"),c=L(e,"b","fused matMul");[l,c]=qt(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),v=ne(p),x=ne(m);D(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const y=Me(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),b=n?G(l,[v,u,d]):G(l,[v,d,u]),C=s?G(c,[x,f,h]):G(c,[x,h,f]);let S;r!=null&&(S=L(r,"bias","fused matMul"),[S]=qt(S,l),Me(y,S.shape));let T;o!=null&&(T=L(o,"prelu weights","fused matMul"));const I=(A,F)=>{const[E,R,O,P]=F,z=YT(G(A,O.shape),O,i);let _,M;if(!n&&!s?(_=nt(z,R,!1,!0),M=nt(E,z,!0,!1)):!n&&s?(_=nt(z,R,!1,!1),M=nt(z,E,!0,!1)):n&&!s?(_=nt(R,z,!1,!0),M=nt(E,z,!1,!1)):(_=nt(R,z,!0,!0),M=nt(z,E,!0,!0)),r!=null){const U=QT(P,z);return[_,M,U]}else return[_,M]},$={a:b,b:C,bias:S,preluActivationWeights:T},N={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?cu((F,E,R)=>{const O=j.runKernel(zg,$,N);return R([F,E,O]),{value:G(O,y),gradFunc:I}})(b,C):cu((F,E,R,O)=>{const P=j.runKernel(zg,$,N);return O([F,E,P,R]),{value:G(P,y),gradFunc:I}})(b,C,S)}const QR=H({fusedMatMul_:dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(t,e,n,s,r="bilinear",i=0){const o=L(t,"image","cropAndResize"),a=L(e,"boxes","cropAndResize","float32"),l=L(n,"boxInd","cropAndResize","int32"),c=a.shape[0];D(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),D(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),D(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),D(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},h={method:r,extrapolationValue:i,cropSize:s};return j.runKernel(Gk,u,h)}const pce=H({cropAndResize_:fce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const e=L(t,"image","flipLeftRight","float32");D(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return j.runKernel(eT,n,{})}const gce=H({flipLeftRight_:mce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(t){const e=L(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];D(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),D(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,zr(e,r)}const vce=H({grayscaleToRGB_:xce});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t){const e=L(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];D(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),D(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=ve(e,"float32"),o=ks([.2989,.587,.114]);let a;switch(e.rank){case 2:a=oh("ij,j->i",i,o);break;case 3:a=oh("ijk,k->ij",i,o);break;case 4:a=oh("ijkl,l->ijk",i,o);break;case 5:a=oh("ijklm,m->ijkl",i,o);break;case 6:a=oh("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=as(a,-1),ve(a,r)}const bce=H({rgbToGrayscale_:yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(t,e,n=0,s=.5){const r=L(t,"image","rotateWithOffset","float32");D(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return j.runKernel(yT,i,o)}const Cce=H({rotateWithOffset_:wce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Du(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),D(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(e.rank===1,()=>"scores must be a 1D tensor"),D(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),D(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=L(t,"boxes","nonMaxSuppression","float32"),o=L(e,"scores","nonMaxSuppression","float32"),a=Du(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return j.runKernel(oT,{boxes:i,scores:o},l)}const kce=H({nonMaxSuppression_:Sce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t,e,n){const s=Ice(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Ice(t,e,n){return Nce(t,e,n||$ce)}function $ce(t,e){return t>e?1:t<e?-1:0}function Nce(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eI(t,e,n,s,r){return sI(t,e,n,s,r,0)}function tI(t,e,n,s,r,i){return sI(t,e,n,s,r,0,!1,i,!0)}function nI(t,e,n,s,r,i){return sI(t,e,n,s,r,i,!0)}function sI(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let v=0;v<e.length;v++)e[v]>r&&c.push({score:e[v],boxIndex:v,suppressBeginIndex:0});c.sort(ZR);const u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&c.length>0;){const v=c.pop(),{score:x,boxIndex:g,suppressBeginIndex:y}=v;if(x<r)break;let b=!1;for(let C=h.length-1;C>=y;--C){const S=Ece(t,g,h[C]);if(S>=s){b=!0;break}if(v.score=v.score*Rce(s,u,S),v.score<=r)break}v.suppressBeginIndex=h.length,b||(v.score===x?(h.push(g),d.push(v.score)):v.score>r&&Tce(c,v,ZR))}const f=h.length,p=n-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const m={selectedIndices:h};return o&&(m.selectedScores=d),l&&(m.validOutputs=f),m}function Ece(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const m=Math.max(i,c),v=Math.max(o,u),x=Math.min(a,h),g=Math.min(l,d),y=Math.max(x-m,0)*Math.max(g-v,0);return y/(f+p-y)}function Rce(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function ZR(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ace(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=L(t,"boxes","nonMaxSuppressionAsync"),o=L(e,"scores","nonMaxSuppressionAsync"),a=Du(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:h}=eI(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),ks(h,"int32")}const Dce=Ace;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=L(t,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),l=Du(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},h=j.runKernel(lT,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}const Pce=H({nonMaxSuppressionWithScore_:_ce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Fce(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=L(t,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),l=Du(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=nI(u,h,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:ks(d,"int32"),selectedScores:ks(f)}}const Oce=Fce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=L(t,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),l=Du(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:i},p=j.runKernel(aT,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const Lce=H({nonMaxSuppressionPadded_:Mce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zce(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=L(t,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),l=Du(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=tI(d,f,c,u,h,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:ks(p,"int32"),validOutputs:st(m,"int32")}}const Vce=zce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(t,e,n=!1,s=!1){const r=L(t,"images","resizeBilinear");D(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),D(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),D(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=G(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=j.runKernel(nv,a,l);return o?G(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const kV=H({resizeBilinear_:Bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jce(t,e,n=!1,s=!1){const r=L(t,"images","resizeNearestNeighbor");D(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),D(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),D(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=G(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=j.runKernel(tv,a,l);return o?G(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const TV=H({resizeNearestNeighbor_:jce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t,e="binary",n=!1,s=.5){const r=L(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=B(ks([s]),255),u,h,d,f;if(D(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),D(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),D(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),D(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,h,d]=js(r,[1,1,1],-1);const v=B(u,i),x=B(h,o),g=B(d,a);f=ue(ue(v,x),g)}else f=t;if(e==="otsu"){const v=jie(ve(dV(f),"int32"),Lz([]),256);c=Uce(v,l)}const p=n?Au(f,c):qs(f,c);return ve(B(p,255),"int32")}function Uce(t,e){let n=ks([-1]),s=ks([0]),r=ks([0]),i,o,a,l,c,u;for(let h=0;h<t.size-1;h++){i=mt(t,0,h+1),o=mt(t,h+1),c=Re(Ee(i),e),u=Re(Ee(o),e);const d=Ee(B(i,kd(0,i.size)));a=Re(d,Ee(i));const f=vv(o.shape,i.size),p=ue(kd(0,o.size),f),m=B(o,p);l=Re(Ee(m),Ee(o));const v=De(a,l),x=De(a,l),g=B(c,u);r=B(B(g,v),x);const y=qs(r,s);s=Jn(y,r,s),n=Jn(y,ks([h]),n)}return n}const Gce=H({threshold_:Wce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t,e,n="nearest",s="constant",r=0,i){const o=L(t,"image","transform","float32"),a=L(e,"transforms","transform","float32");D(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),D(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return j.runKernel(xT,l,c)}const Kce=H({transform_:Hce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(t,e,n){const s=L(t,"a","bandPart");D(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(D(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),D(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=L(e<0?i:e,"numLower","bandPart")):(D(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Jn(Gg(e,0),i,Sd(e,i))),typeof n=="number"?(D(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),D(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=L(n<0?o:n,"numUpper","bandPart")):(D(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Jn(Gg(n,0),o,Sd(n,o)));const c=G(kd(0,i,1,"int32"),[-1,1]),u=kd(0,o,1,"int32"),h=De(c,u),d=ao(Au(h,a),Vl(h,Xt(l))),f=xn([i,o],s.dtype);return G(lo(Il(G(s,[-1,i,o])).map(p=>Jn(d,p,f))),r)}const qce=H({bandPart_:Xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t){let e;if(Array.isArray(t)){e=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)D(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=js(t,t.shape[0],0).map(r=>Xf(r,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(j.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=B(Ee(B(n[o],i)),n[o]);i=De(i,a)}return Re(i,bv(i,"euclidean"))}));return e?lo(n,0):n}const Qce=H({gramSchmidt_:Yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(t,e=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return JR(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=Il(G(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=JR(l,e);r.push(c),i.push(u)});const o=G(lo(r,0),t.shape),a=G(lo(i,0),t.shape);return[o,a]}}function JR(t,e=!1){return j.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=sV(n),i=tl(t);const o=fb([[1]],[1,1]);let a=tl(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,h=a,d=r;[a,i,r]=j.tidy(()=>{const f=mt(i,[c,c],[n-c,1]),p=bv(f),m=mt(i,[c,c],[1,1]),v=Jn(qs(m,0),fb([[-1]]),fb([[1]])),x=De(m,B(v,p)),g=Re(f,x);g.shape[0]===1?a=tl(o):a=us([o,mt(g,[1,0],[g.shape[0]-1,g.shape[1]])],0);const y=Xt(Re(nt(v,x),p)),b=mt(i,[c,0],[n-c,s]),C=B(y,a),S=Qe(a);if(c===0)i=De(b,nt(C,nt(S,b)));else{const $=De(b,nt(C,nt(S,b)));i=us([mt(i,[0,0],[c,s]),$],0)}const T=Qe(C),I=mt(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=De(I,nt(nt(I,a),T));else{const $=De(I,nt(nt(I,a),T));r=us([mt(r,[0,0],[n,c]),$],1)}return[a,i,r]}),Xe([u,h,d])}return!e&&n>s&&(r=mt(r,[0,0],[n,s]),i=mt(i,[0,0],[s,s])),[r,i]})}const Jce=H({qr_:Zce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qi={flipLeftRight:gce,grayscaleToRGB:vce,resizeNearestNeighbor:TV,resizeBilinear:kV,rgbToGrayscale:bce,rotateWithOffset:Cce,cropAndResize:pce,nonMaxSuppression:kce,nonMaxSuppressionAsync:Dce,nonMaxSuppressionWithScore:Pce,nonMaxSuppressionWithScoreAsync:Oce,nonMaxSuppressionPadded:Lce,nonMaxSuppressionPaddedAsync:Vce,threshold:Gce,transform:Kce},eue={bandPart:qce,gramSchmidt:Qce,qr:Jce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tue=new Map,nue=new Map;class _u{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class lr{constructor(){this.classNameMap={}}static getMap(){return lr.instance==null&&(lr.instance=new lr),lr.instance}static register(e){lr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ae(t,e,n){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return lr.register(t),tue.set(r,t),nue.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ka extends _u{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Xe(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return cae(e,n)}dispose(){this.iterations_!=null&&Xe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:st(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ka,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IV extends ka{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=j.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:K(()=>Ze(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:K(()=>Ze(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;K(()=>{const u=ue(B(l,this.rho),B(wt(a),1-this.rho)),h=B(Re(Vn(ue(c,this.epsilon)),Vn(ue(l,this.epsilon))),a),d=ue(B(c,this.rho),B(wt(h),1-this.rho));l.assign(u),c.assign(d);const f=ue(B(h,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Xe(this.accumulatedGrads.map(e=>e.variable)),Xe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $V extends ka{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=j.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:K(()=>vv(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;K(()=>{const l=ue(a,wt(o));a.assign(l);const c=ue(B(Re(o,Vn(ue(l,j.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Xe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NV extends ka{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],K(()=>{this.accBeta1=st(n).variable(),this.accBeta2=st(s).variable()}),r==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);K(()=>{const s=De(1,this.accBeta1),r=De(1,this.accBeta2);n.forEach((i,o)=>{const a=j.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:K(()=>Ze(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:K(()=>Ze(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,d=ue(B(u,this.beta1),B(c,1-this.beta1)),f=ue(B(h,this.beta2),B(wt(c),1-this.beta2)),p=Re(d,s),m=Re(f,r);u.assign(d),h.assign(f);const v=ue(B(Re(p,ue(Vn(m),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(B(this.accBeta1,this.beta1)),this.accBeta2.assign(B(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Xe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Xe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),K(()=>{this.accBeta1.assign(kl(this.beta1,this.iterations_+1)),this.accBeta2.assign(kl(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EV extends ka{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],K(()=>{this.iteration=st(0).variable(),this.accBeta1=st(n).variable()}),r==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);K(()=>{const s=De(1,this.accBeta1),r=Re(-this.learningRate,ue(B(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=j.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ze(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Ze(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,d=ue(B(u,this.beta1),B(c,1-this.beta1)),f=B(h,this.beta2),p=qn(c),m=Ca(f,p);u.assign(d),h.assign(m);const v=ue(B(Re(r,s),Re(d,ue(m,this.epsilon))),a);a.assign(v)}),this.iteration.assign(ue(this.iteration,1)),this.accBeta1.assign(B(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Xe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Xe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rI extends ka{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=j.registeredVariables[s];K(()=>{const a=ue(B(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Ti(st(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RV extends rI{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=st(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=j.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:K(()=>Ze(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&K(()=>{let l;const c=ue(B(this.m,o),a);this.useNesterov?l=ue(B(this.c,ue(a,B(c,this.m))),i):l=ue(B(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Xe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AV extends ka{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=j.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=j.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:K(()=>Ze(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:K(()=>Ze(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:K(()=>Ze(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;K(()=>{const u=ue(B(l,this.decay),B(wt(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[r].variable,d=ue(B(h,this.decay),B(a,1-this.decay)),f=Re(B(a,this.learningRate),Vn(De(u,ue(wt(d),this.epsilon)))),p=ue(B(c,this.momentum),f);l.assign(u),h.assign(d),c.assign(p);const m=De(i,p);i.assign(m)}else{const h=ue(B(l,this.decay),B(wt(a),1-this.decay)),d=ue(B(c,this.momentum),Re(B(a,this.learningRate),Vn(ue(h,this.epsilon))));l.assign(h),c.assign(d);const f=De(i,d);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Xe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Xe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Xe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sue=[IV,$V,NV,EV,RV,AV,rI];function rue(){for(const t of sue)ae(t)}function iI(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(ne(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let h=0;h<r.length-1;++h)o*=r[h];const a=t.shape,l=r.slice();l.pop();let c=1;for(let h=i;h<n;++h)c*=a[h],l.push(a[h]);const u=[...$e(t.shape).map(h=>h/c),1].slice(0,i);return[l,o,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1=-2,iue=-1;function oI(t,e,n){const s=t.shape.length;D(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),D(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)D(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function oue(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function aI(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function DV(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function _V(t,e,n){return n<=t?n:n-(e-1)}function PV(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function aue(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=FV(o,f,p,s,t),h=OV(a,f,p,r,t),d=DV(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=LV(o,s,i,t,f,l),h[f]=zV(a,r,i,t,f,l),d[f]=MV(i,f,l);return{begin:u,end:h,strides:d}}function FV(t,e,n,s,r){const i=[...r],o=PV(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=_V(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function OV(t,e,n,s,r){const i=[...r],o=PV(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=_V(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=xl(0,i[a],r[a])}return i}function MV(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function LV(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=xl(0,o,l-1),o}function zV(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=xl(0,o,l):o=xl(-1,o,l-1),o}function lI(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function cI(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Cv(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{D(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(D(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function uI(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let y=0;y<h.dims;y++)u&&1<<y&a&&h.numAddAxisAfterEllipsis++,1<<y&o&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};lue(h,d);let f=!0,p=!0,m=!0;const v=[],x=[];for(let y=0;y<t.length;++y){if(d.strides[y]===0)throw Error(`strides[${y}] must be non-zero`);const b=!!(d.shrinkAxisMask&1<<y),C=t[y];if(C===-1){v.push(b?1:-1);continue}const S=[d.beginMask&1<<y,d.endMask&1<<y],T=[d.strides[y]>0?0:-1,d.strides[y]>0?C:C-1];if(b&&d.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&d.strides[y]===1;const I=!!(d.beginMask&1<<y&&d.endMask&1<<y);if(d.beginValid&&d.endValid){if(b){const F=d.begin[y]<0?C+d.begin[y]:d.begin[y];if(d.begin[y]=F,d.end[y]=d.begin[y]+1,F<0||F>=C)throw Error(`slice index ${d.begin[y]} of dimension ${y} out of bounds.`)}else d.begin[y]=eA(d.begin[y],0,d.strides[y],C,S,T),d.end[y]=eA(d.end[y],1,d.strides[y],C,S,T);const A=d.strides[y]===1&&d.begin[y]===0&&d.end[y]===C;f=f&&A,p=p&&(y===0&&d.strides[y]===1||A)}else f=f&&d.strides[y]===1&&I,p=p&&(y===0&&d.strides[y]===1||I);let $,N=!1;if(d.beginValid&&d.endValid?($=d.end[y]-d.begin[y],N=!0):b?($=1,N=!0):I&&C>=0&&(d.strides[y]<0?$=-C:$=C,N=!0),N){let A;$===0||$<0!=d.strides[y]<0?A=0:A=Math.trunc($/d.strides[y])+($%d.strides[y]!==0?1:0),v.push(A)}else v.push(-1)}for(let y=0;y<d.finalShapeGatherIndices.length;++y){const b=d.finalShapeGatherIndices[y];b>=0?x.push(v[b]):b===j1&&x.push(1)}return{finalShapeSparse:x.filter((y,b)=>d.finalShapeGatherIndices[b]!==j1),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function lue(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(j1),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(iue),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function eA(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const cue=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:oI,computeFlatOffset:cI,computeOutShape:aI,getNormalizedAxes:aue,isSliceContinous:lI,maskToAxes:oue,parseSliceParams:Cv,sliceInfo:uI,startForAxis:LV,startIndicesWithElidedDims:FV,stopForAxis:zV,stopIndicesWithElidedDims:OV,stridesForAxis:MV,stridesWithElidedDims:DV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uue{static sgd(e){return new rI(e)}static momentum(e,n,s=!1){return new RV(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new AV(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new NV(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new IV(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new EV(e,n,s,r,i)}static adagrad(e,n=.1){return new $V(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nc=uue;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hue=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function VV(){return new Promise(t=>hue(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hI(t,e){const n=t[0].length;t.forEach((r,i)=>{D(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),D(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)D(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Ii(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Mr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Mr||(Mr={}));function BV(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function jV(t){const e={FIRST_DIM_SIZE:Mr.FIRST_DIM_SIZE,VALUE_ROWIDS:Mr.VALUE_ROWIDS,ROW_LENGTHS:Mr.ROW_LENGTHS,ROW_SPLITS:Mr.ROW_SPLITS,ROW_LIMITS:Mr.ROW_LIMITS,ROW_STARTS:Mr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function WV(t){return t.length===0?0:t[0]===Mr.FIRST_DIM_SIZE?t.length-1:t.length}function UV(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dI=30;function Sv(t){return t<=dI?t:k1(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fI(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yf(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function Qf(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function Zf(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function pI(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function mI(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kv=1.7580993408473768,Tv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI=.3275911,xI=.254829592,vI=-.284496736,yI=1.421413741,bI=-1.453152027,wI=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function co(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function GV(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function HV(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function KV(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function CI(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function XV(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function qV(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function YV(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pb="->",due=/->/g,tA=",",nA="...";function SI(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(due,"").length)/pb.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${pb}").`);const[s,r]=t.split(pb);D(s.indexOf(nA)===-1,()=>`The ellipsis notation ("${nA}") is not supported yet.`);const i=s.split(tA),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<r.length;++d){const f=r[d];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<s.length;++d){const f=s[d];a.indexOf(f)===-1&&f!==tA&&a.push(f)}const l=new Array(i.length);for(let d=0;d<o;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<i[d].length;++f)l[d].push(a.indexOf(i[d][f]))}const c=a.length,u=r.length,h=[];for(let d=u;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function kI(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function TI(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:D(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function II(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=fue(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function $I(t){return t.every((e,n)=>e===n)}function fue(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function NI(t,e,n=0){let s=[];if(typeof e=="number")D(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);D(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}D(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QV(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function ZV(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function JV(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function tB(t,e){return`size ${t} must be non-negative, not ${e}`}function nB(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function sB(t,e){const n=ne(t),s=ne(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function rB(t,e){const n=ne(t),s=ne(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1(){return"segment ids must be >= 0"}function iB(){return"segment ids are not increasing"}function oB(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function aB(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t,e){let n=!1,s;for(t<=dI?(s=t,n=!0):s=k1(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=k1(t,s+1);return s}function cB(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function EI(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let h=0;h<s;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let h=0;h<s;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=s;h<n;h++)a.push(t.shape[h]),c*=t.shape[h];for(let h=s;h<r;h++)a.push(e.shape[h]);for(let h=n+1;h<i;h++)a.push(t.shape[h]),u*=t.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const pue=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:EI,computeOutShape:cB,segOpComputeOptimalWindowSize:lB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uo(t){try{return t.map(e=>ra(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function uB(t){return t.map(e=>Xo(e))}const mue=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:xI,ERF_A2:vI,ERF_A3:yI,ERF_A4:bI,ERF_A5:wI,ERF_P:gI,PARALLELIZE_THRESHOLD:dI,get RowPartitionType(){return Mr},SELU_SCALE:Tv,SELU_SCALEALPHA:kv,applyActivation:ZT,assertAndGetBroadcastShape:Me,assertAxesAreInnerMostDims:Rn,assertParamsConsistent:hI,assignToTypedArray:XV,axesAreInnerMostDims:ET,calculateShapes:Wl,checkEinsumDimSizes:TI,checkPadOnDimRoundingMode:xs,combineLocations:tV,combineRaggedTensorToTensorShapes:BV,complexWithEvenIndex:HV,complexWithOddIndex:KV,computeConv2DInfo:En,computeConv3DInfo:ba,computeDefaultPad:ST,computeDilation2DInfo:Gf,computeOptimalWindowSize:Sv,computeOutAndReduceShapes:Cn,computeOutShape:Ii,computePool2DInfo:Sr,computePool3DInfo:po,convertConv2DDataFormat:mo,decodeEinsumEquation:SI,eitherStridesOrDilationsAreOne:Bn,expandShapeToKeepDim:nn,exponent:YV,exponents:qV,fromStringArrayToUint8:uB,fromUint8ToStringArray:uo,getAxesPermutation:Lt,getBroadcastDims:lu,getComplexWithIndex:CI,getEinsumComputePath:II,getEinsumPermutation:kI,getFusedBiasGradient:QT,getFusedDyActivation:YT,getImageCenter:fI,getInnerMostAxes:Yt,getPermuted:Qf,getRaggedRank:WV,getReductionAxes:dn,getReshaped:Yf,getReshapedPermuted:Zf,getRowPartitionTypesHelper:jV,getSliceBeginCoords:pI,getSliceSize:mI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:QV,getSparseFillEmptyRowsNegativeIndexErrorMessage:ZV,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:JV,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:nB,getSparseReshapeInputOutputMismatchErrorMessage:rB,getSparseReshapeInputOutputMultipleErrorMessage:sB,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:eB,getSparseReshapeNegativeOutputDimErrorMessage:tB,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:aB,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:W1,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:iB,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:oB,getUndoAxesPermutation:wa,isIdentityPermutation:$I,log:Zse,mergeRealAndImagArrays:co,prepareAndValidate:iI,prepareSplitSize:NI,segment_util:pue,shouldFuse:JT,slice_util:cue,splitRealAndImagArrays:GV,stridesOrDilationsArePositive:Cl,tupleValuesAreOne:wl,upcastType:Rs,validateDefaultValueShape:UV,validateInput:Hle,validateUpdateShape:bV,warn:Ms},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */rue();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hB={kernelName:f0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,qf(ve(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gue={kernelName:qd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=wt(ve(n,"float32")),r=Vn(De(st(1),s));return Xt(Re(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xue={kernelName:Yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Vn(De(wt(ve(n,"float32")),1));return Re(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue={kernelName:Nu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{let a=t;const l=dn(n.shape,r);return l.length>0&&(a=Ee(a,l)),G(a,n.shape)},b:()=>{let a=t;const l=dn(s.shape,r);return l.length>0&&(a=Ee(a,l)),G(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yue={kernelName:_k,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bue={kernelName:p0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ze(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wue={kernelName:m0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ze(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cue={kernelName:Qd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,Vn(De(st(1),wt(ve(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sue={kernelName:Zd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Vn(ue(st(1),wt(ve(n,"float32"))));return Re(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue={kernelName:tf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{const a=ue(wt(n),wt(s));let l=B(t,Re(s,a));const c=dn(n.shape,r);return c.length>0&&(l=Ee(l,c)),G(l,n.shape)},b:()=>{const a=ue(wt(n),wt(s));let l=Xt(B(t,Re(n,a)));const c=dn(s.shape,r);return c.length>0&&(l=Ee(l,c)),G(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue={kernelName:Jd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,ue(wt(ve(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue={kernelName:ef,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,De(st(1),wt(ve(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t,e,n,s,r,i){const o=L(t,"dy","avgPool3dGrad"),a=L(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=G(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=G(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),D(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),D(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),xs("avgPool3dGrad",r,i);const h={dy:l,input:c},d={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=j.runKernel(Mk,h,d);return u?G(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Nue=H({avgPool3dGrad_:$ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eue={kernelName:x0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Nue(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t,e,n,s,r){const i=L(t,"dy","avgPoolGrad"),o=L(e,"input","avgPoolGrad");D(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=G(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=G(i,[1,i.shape[0],i.shape[1],i.shape[2]])),D(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),D(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},h={filterSize:n,strides:s,pad:r},d=j.runKernel(Ok,u,h);return c?G(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Aue=H({avgPoolGrad_:Rue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Due={kernelName:g0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>Aue(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ue={kernelName:v0,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>nt(t,r,!1,!0),b:()=>nt(s,t,!0,!1)}:!i&&o?{a:()=>nt(t,r,!1,!1),b:()=>nt(t,s,!0,!1)}:i&&!o?{a:()=>nt(r,t,!1,!0),b:()=>nt(s,t,!1,!1)}:{a:()=>nt(r,t,!0,!0),b:()=>nt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pue={kernelName:y0,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>MT(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fue={kernelName:Xse,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Ee(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue={kernelName:nf,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue={kernelName:sf,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue={kernelName:rf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Jn(ao(Vl(s,r),Au(s,i)),t,Ze(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zue={kernelName:b0,inputsToSave:["x"],gradFunc:hB.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vue={kernelName:w0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=Ge(r,e[0].shape)[0],o=s.map(l=>l[i]);return js(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bue={kernelName:C0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return D(wl(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>IT(s.shape,t,r,o,a,l),filter:()=>qT(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jue={kernelName:S0,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Sl(t,r,i,o,a,1,l),filter:()=>qT(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t,e,n,s,r){let i=t;t.rank===4&&(i=G(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=G(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),D(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),D(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),D(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),D(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),D(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return j.runKernel(jk,a,l)}const Uue=H({conv3DBackpropFilter_:Wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gue={kernelName:k0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;D(wl(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>Qz(o.shape,t,a,r,i),filter:()=>Uue(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hue={kernelName:of,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(Xt(gV(ve(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kue={kernelName:af,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(xV(ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xue={kernelName:T0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Lt([r],s.rank);let l=Jz(t,r,i,!o);return a!=null&&(l=Qe(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const que={kernelName:I0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];D(wl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return D(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),D(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),D(Bn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),xs("depthwiseConv2d",i,o),{x:()=>hce(l.shape,t,c,r,i,a,o),filter:()=>cce(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yue={kernelName:$0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>j.runKernel(T1,i,n),filter:()=>j.runKernel(I1,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Que={kernelName:cf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>j.runKernel(Qk,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zue={kernelName:uf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=B(Ai(Xt(wt(n))),2/Math.sqrt(Math.PI));return{x:()=>B(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jue={kernelName:hf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ehe={kernelName:E0,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>G(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const the={kernelName:df,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,Ai(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nhe={kernelName:ff,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const she={kernelName:pf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{const a=Re(t,ve(s,"float32")),l=dn(n.shape,r);return l.length>0?G(Ee(a,l),n.shape):a},b:()=>{let a=B(t,ve(n,"float32"));const l=dn(s.shape,r);l.length>0&&(a=G(Ee(a,l),s.shape));const c=wt(s);return Xt(Re(a,ve(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rhe={kernelName:R0,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??st(1),c=dn(i.shape,r.shape),u=[];if(i.rank===1){for(let b=0;b<r.shape.length-1;++b)u.push(r.shape[b]);u.push(1)}const h=De(r,i),d=B(t,l),f=fV(ue(o,st(s))),p=B(B(B(f,f),f),st(-.5));return{x:()=>i.rank===1?G(B(B(t,zr(G(f,[1,1,1,i.shape[0]]),u)),l),r.shape):G(B(B(t,f),l),r.shape),mean:()=>{let b=B(B(f,st(-1)),d);return i.rank===1&&(b=Ee(b,c)),G(b,i.shape)},variance:()=>{let b=B(B(p,h),d);return i.rank===1&&(b=Ee(b,c)),G(b,i.shape)},scale:()=>{const b=B(h,f);let C=B(t,b);return i.rank===1&&(C=Ee(C,c)),G(C,i.shape)},offset:()=>{let b=t;return i.rank===1&&(b=Ee(b,c)),G(b,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ihe={kernelName:A0,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=Ge(i,s.shape)[0],l=(c,u,h)=>()=>{const d=c.shape,f=u.size,p=d.slice(0,a),m=p.length,v=d.slice(i,d.length).slice(1),x=v.length,g=sA(0,m),y=sA(m+1,m+1+x),b=rA([p,[f],v]),C=G(h,b),S=G(u,[f]),T=rA([[m],g,y]),I=Qe(C,T);let $=CV(I,S,c.shape[a]);const N=wa(T);return $=Qe($,N),$};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>lo(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function sA(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function rA(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ohe={kernelName:mf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Ze(n),b:()=>Ze(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ahe={kernelName:gf,gradFunc:t=>({x:()=>ve(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe={kernelName:xf,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const che={kernelName:vf,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uhe={kernelName:yf,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hhe={kernelName:_0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=qs(s,0);return{x:()=>Jn(i,t,B(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe={kernelName:wf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,ue(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fhe={kernelName:bf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,ve(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const phe={kernelName:Yse,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=Ai(s);return De(t,B(Ee(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return j.runKernel(sT,a,l)}const ghe=H({localResponseNormalizationBackprop_:mhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xhe={kernelName:z0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>ghe(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(t,e,n,s){return e.rank<n.rank&&(e=G(e,nn(e.shape,s))),t.rank<n.rank&&(t=G(t,nn(t.shape,s))),{x:()=>B(t,ve(Ri(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iA={kernelName:V0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=Ge(r,i.shape),l=dB(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vhe={kernelName:Cf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>B(t,ve(Vl(n,s),"float32")),b:()=>B(t,ve(Gg(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t,e,n,s,r,i,o){const a=L(t,"dy","maxPool3dGrad"),l=L(e,"input","maxPool3dGrad"),c=L(n,"output","maxPool3dGrad");let u=a,h=l,d=c,f=!1;l.rank===4&&(f=!0,u=G(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=G(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=G(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),D(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),D(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),D(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),xs("maxPool3dGrad",i,o);const p={dy:u,input:h,output:d},m={filterSize:s,strides:r,pad:i,dimRoundingMode:o},v=j.runKernel(iT,p,m);return f?G(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const bhe=H({maxPool3dGrad_:yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe={kernelName:j0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>bhe(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Che(t,e,n,s,r,i,o){const a=L(t,"dy","maxPoolGrad"),l=L(e,"input","maxPoolGrad"),c=L(n,"output","maxPoolGrad");D(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),D(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),D(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),xs("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},h={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return j.runKernel(rT,u,h)}const She=H({maxPoolGrad_:Che});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const khe={kernelName:B0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>She(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The={kernelName:W0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=Ge(r,s.shape),a=Cn(s.shape,i)[1],l=ne(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const h=G(t,u);return Re(B(h,Sa(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ihe={kernelName:U0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=Ge(r,i.shape),l=dB(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $he={kernelName:Sf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>B(t,ve(Au(n,s),"float32")),b:()=>B(t,ve(qs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe={kernelName:G0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>mt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ehe={kernelName:kf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{const a=dn(n.shape,r);return a.length>0?G(Ee(t,a),n.shape):t},b:()=>{const a=B(t,Xt(wv(Re(n,s)))),l=dn(s.shape,r);return l.length>0?G(Ee(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rhe={kernelName:Tf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{const a=B(t,ve(s,"float32")),l=dn(n.shape,r);return l.length>0?G(Ee(a,l),n.shape):a},b:()=>{const a=B(t,ve(n,"float32")),l=dn(s.shape,r);return l.length>0?G(Ee(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ahe={kernelName:H0,gradFunc:t=>({x:()=>Xt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dhe={kernelName:q0,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>xn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he={kernelName:X0,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Phe={kernelName:Y0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Il(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oA={kernelName:Q0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>mt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fhe={kernelName:If,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=Me(i.shape,o.shape);return{a:()=>{const u=ve(o,"float32");let h=B(t,B(u,kl(i,De(u,st(1)))));const d=dn(i.shape,a);return d.length>0&&(h=Ee(h,d)),G(h,i.shape)},b:()=>{const u=qs(i,0),h=Jn(u,Di(i),Ze(i));let d=B(t,B(r,h));const f=dn(o.shape,a);return f.length>0&&(d=Ee(d,f)),G(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe={kernelName:Z0,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=qs(n,0);return{x:()=>Jn(r,t,B(t,s)),alpha:()=>{let i=Jn(r,Ze(t),B(t,n));const o=dn(s.shape,t.shape);return o.length>0&&(i=Ee(i,o)),G(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(t,e,n){const s=t.shape.slice();s[n]=1;const r=G(e,s),i=V1(t,n,!0,!1),o=V1(t,n,!0,!0),a=B(i,o);return B(r,a)}function Lhe(t,e,n){const s=t.shape.length,r=s-n.length,i=Lt(n,s);let o=t;i!=null&&(o=Qe(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((d,f)=>d*f,1);a.push(c);const u=o.reshape(a);let h=Mhe(u,e,r);if(h=h.reshape(o.shape),i!=null){const d=wa(i);h=Qe(h,d)}return h}const zhe={kernelName:J0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>Lhe(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe={kernelName:lf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{const a=Re(t,ve(s,"float32")),l=dn(n.shape,r);return l.length>0?G(Ee(a,l),n.shape):a},b:()=>{let a=B(t,ve(n,"float32"));const l=dn(s.shape,r);l.length>0&&(a=G(Ee(a,l),s.shape));const c=wt(s);return Xt(Re(a,ve(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bhe={kernelName:$f,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,Xt(wt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jhe={kernelName:Ef,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=B(Au(n,6),qf(n));return{x:()=>B(t,ve(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Whe={kernelName:Nf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,ve(qf(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uhe={kernelName:ev,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ghe={kernelName:nv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>j.runKernel(dT,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hhe={kernelName:tv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>j.runKernel(hT,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Khe={kernelName:sv,gradFunc:(t,e,n)=>{const{dims:s}=n,r=Ge(s,t.shape);return{x:()=>Tl(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe={kernelName:Rf,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qhe={kernelName:Af,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Xt(Re(t,B(kl(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe={kernelName:rv,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ve(Ze(n),"float32"),t:()=>B(t,ve(n,t.dtype)),e:()=>B(t,ve(_T(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qhe={kernelName:Df,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=qs(n,st(0)),r=st(kv),i=st(Tv),o=B(t,i),a=B(B(t,r),Ai(ve(n,"float32")));return Jn(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe={kernelName:Of,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(n,De(st(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jhe={kernelName:Ff,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede={kernelName:_f,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B($T(ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tde={kernelName:Pf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(Zz(ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nde={kernelName:iv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=Cv(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>OT(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sde={kernelName:cv,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=B(t,s);return{logits:()=>De(o,B(Ee(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde={kernelName:Mf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,Ru(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aA={kernelName:av,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>TT(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lA={kernelName:lv,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>us(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ide={kernelName:Lf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,B(Vn(ve(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ode={kernelName:fT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(ve(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ade={kernelName:zf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=st(2);return{a:()=>B(t,B(r,De(n,s))),b:()=>B(t,B(r,De(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lde={kernelName:Uf,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cde={kernelName:Vf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Me(n.shape,s.shape);return{a:()=>{let a=t;const l=dn(n.shape,r);return l.length>0&&(a=Ee(a,l)),G(a,n.shape)},b:()=>{let a=t;const l=dn(s.shape,r);return l.length>0&&(a=Ee(a,l)),G(Xt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ude={kernelName:ov,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;Ge(i,s.shape).forEach(c=>{r[c]=1});const a=G(t,r),l=B(a,Sa(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hde={kernelName:Bf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Re(t,wt($T(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dde={kernelName:jf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(De(st(1),wt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fde={kernelName:Wf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=Ze(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=ue(o,mt(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=ue(o,mt(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=ue(o,mt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=ue(o,mt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde={kernelName:zc,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=wa(r);return{x:()=>Qe(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mde={kernelName:uv,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>lo(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde={kernelName:hv,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xde(t,n)}}};function xde(t,e){const n=Ca(e,Ze(e)),s=RT(t,n);let r=Vl(e,st(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=as(r,a+1);r=ao(r,Sa(s.shape,"bool"));const o=Ze(s);return Jn(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vde={kernelName:dv,gradFunc:t=>({x:()=>Ze(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde=[hB,gue,xue,vue,yue,bue,wue,Cue,Sue,kue,Tue,Iue,Eue,Due,_ue,Pue,Fue,Oue,Mue,Lue,zue,Vue,jue,Bue,Gue,Hue,Kue,Xue,que,Yue,Vhe,Que,Zue,Jue,ehe,the,she,nhe,rhe,ihe,ohe,ahe,lhe,che,uhe,hhe,dhe,fhe,phe,xhe,iA,iA,vhe,whe,khe,The,Ihe,$he,Nhe,Ehe,Rhe,Ahe,Dhe,_he,Phe,oA,oA,Fhe,Ohe,zhe,Bhe,jhe,Whe,Uhe,Ghe,Hhe,Khe,Xhe,qhe,Yhe,Qhe,Zhe,Jhe,ede,tde,nde,sde,rde,aA,aA,lA,lA,ide,ade,ode,lde,cde,ude,hde,dde,fde,pde,mde,gde,vde];for(const t of yde)Jse(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.abs=function(){return this.throwIfDisposed(),qn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.acos=function(){return this.throwIfDisposed(),tie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.acosh=function(){return this.throwIfDisposed(),sie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.add=function(t){return this.throwIfDisposed(),ue(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.all=function(t,e){return this.throwIfDisposed(),Xz(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.any=function(t,e){return this.throwIfDisposed(),L1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.argMax=function(t){return this.throwIfDisposed(),bd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.argMin=function(t){return this.throwIfDisposed(),lie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,()=>"The array must have only 1 element."),G(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asType=function(t){return this.throwIfDisposed(),ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as1D=function(){return this.throwIfDisposed(),G(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as2D=function(t,e){return this.throwIfDisposed(),G(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),G(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),G(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),G(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asin=function(){return this.throwIfDisposed(),uie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asinh=function(){return this.throwIfDisposed(),die(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.atan=function(){return this.throwIfDisposed(),pie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.atan2=function(t){return this.throwIfDisposed(),gie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.atanh=function(){return this.throwIfDisposed(),vie(this)};ee().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),kT(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),TT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),xv(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.broadcastTo=function(t){return this.throwIfDisposed(),jh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cast=function(t){return this.throwIfDisposed(),ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.ceil=function(){return this.throwIfDisposed(),Gie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Hs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof on&&(t=[t]),us([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),qz(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),Yz(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),Sl(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cos=function(){return this.throwIfDisposed(),$T(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cosh=function(){return this.throwIfDisposed(),Zz(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),V1(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Jz(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),goe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),NT(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),yoe(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.divNoNan=function(t){return this.throwIfDisposed(),koe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.div=function(t){return this.throwIfDisposed(),Re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.dot=function(t){return this.throwIfDisposed(),Ioe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.elu=function(){return this.throwIfDisposed(),yv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.equal=function(t){return this.throwIfDisposed(),Ri(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.erf=function(){return this.throwIfDisposed(),eV(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),Loe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.exp=function(){return this.throwIfDisposed(),Ai(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.expandDims=function(t){return this.throwIfDisposed(),as(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.expm1=function(){return this.throwIfDisposed(),joe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.fft=function(){return this.throwIfDisposed(),yV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.flatten=function(){return this.throwIfDisposed(),G(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.floor=function(){return this.throwIfDisposed(),wv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.floorDiv=function(t){return this.throwIfDisposed(),Kz(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.gather=function(t,e,n){return this.throwIfDisposed(),RT(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Vl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.greater=function(t){return this.throwIfDisposed(),qs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.ifft=function(){return this.throwIfDisposed(),B1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.irfft=function(){return this.throwIfDisposed(),_le(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.isFinite=function(){return this.throwIfDisposed(),Qoe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.isInf=function(){return this.throwIfDisposed(),Joe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.isNaN=function(){return this.throwIfDisposed(),tae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.leakyRelu=function(t){return this.throwIfDisposed(),DT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.lessEqual=function(t){return this.throwIfDisposed(),Au(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.less=function(t){return this.throwIfDisposed(),Gg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),oae(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logSigmoid=function(){return this.throwIfDisposed(),fae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logSoftmax=function(t){return this.throwIfDisposed(),iV(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),oV(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.log=function(){return this.throwIfDisposed(),Di(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.log1p=function(){return this.throwIfDisposed(),rV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ao(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalNot=function(){return this.throwIfDisposed(),_T(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalOr=function(t){return this.throwIfDisposed(),aV(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalXor=function(t){return this.throwIfDisposed(),wae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),nt(this,t,e,n)};ee().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),PT(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.max=function(t,e){return this.throwIfDisposed(),Wr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.maximum=function(t){return this.throwIfDisposed(),Ca(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mean=function(t,e){return this.throwIfDisposed(),en(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.min=function(t,e){return this.throwIfDisposed(),Ug(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.minimum=function(t){return this.throwIfDisposed(),Sd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Eae(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mod=function(t){return this.throwIfDisposed(),Aae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mul=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.neg=function(){return this.throwIfDisposed(),Xt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.norm=function(t,e,n){return this.throwIfDisposed(),bv(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.notEqual=function(t){return this.throwIfDisposed(),Hg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),lV(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.onesLike=function(){return this.throwIfDisposed(),wr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.pad=function(t,e){return this.throwIfDisposed(),OT(this,t,e)};ee().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),Bae(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.pow=function(t){return this.throwIfDisposed(),kl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.prelu=function(t){return this.throwIfDisposed(),LT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.prod=function(t,e){return this.throwIfDisposed(),Uae(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reciprocal=function(){return this.throwIfDisposed(),fle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.relu=function(){return this.throwIfDisposed(),jl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.relu6=function(){return this.throwIfDisposed(),hV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reshapeAs=function(t){return this.throwIfDisposed(),G(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reshape=function(t){return this.throwIfDisposed(),G(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),kV(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),TV(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reverse=function(t){return this.throwIfDisposed(),Tl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.rfft=function(){return this.throwIfDisposed(),Ole(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.round=function(){return this.throwIfDisposed(),dV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.rsqrt=function(){return this.throwIfDisposed(),fV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.selu=function(){return this.throwIfDisposed(),pV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),mV(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sigmoid=function(){return this.throwIfDisposed(),Ru(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sign=function(){return this.throwIfDisposed(),Cle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sin=function(){return this.throwIfDisposed(),gV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sinh=function(){return this.throwIfDisposed(),xV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.slice=function(t,e){return this.throwIfDisposed(),mt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.softmax=function(t){return this.throwIfDisposed(),XT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.softplus=function(){return this.throwIfDisposed(),Hf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),MT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.split=function(t,e){return this.throwIfDisposed(),js(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sqrt=function(){return this.throwIfDisposed(),Vn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.square=function(){return this.throwIfDisposed(),wt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Lle(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.squeeze=function(t){return this.throwIfDisposed(),Xf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof on?[this,t]:[this,...t];return lo(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.step=function(t){return this.throwIfDisposed(),qf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),Wle(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sub=function(t){return this.throwIfDisposed(),De(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sum=function(t,e){return this.throwIfDisposed(),Ee(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.tan=function(){return this.throwIfDisposed(),Gle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.tanh=function(){return this.throwIfDisposed(),gv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.tile=function(t){return this.throwIfDisposed(),zr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.toBool=function(){return this.throwIfDisposed(),ve(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.toFloat=function(){return this.throwIfDisposed(),ve(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.toInt=function(){return this.throwIfDisposed(),ve(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.topk=function(t,e){return this.throwIfDisposed(),Xle(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.transpose=function(t){return this.throwIfDisposed(),Qe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.unique=function(t){return this.throwIfDisposed(),Qle(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),CV(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.unstack=function(t){return this.throwIfDisposed(),Il(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.where=function(t,e){return this.throwIfDisposed(),Jn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.zerosLike=function(){return this.throwIfDisposed(),Ze(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ci extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ci.prototype)}}class fr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,fr.prototype)}}class V extends Error{constructor(e){super(e),Object.setPrototypeOf(this,V.prototype)}}class Ve extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ve.prototype)}}class RI extends Error{constructor(e){super(e),Object.setPrototypeOf(this,RI.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fB{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $l(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function ui(t,e){if(!t)throw new RI(e)}function cA(t,e){let n=0;for(const s of t)s===e&&n++;return n}function ls(t){return t.length===1?t[0]:t}function ot(t){return Array.isArray(t)?t:[t]}function ji(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ba(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Js={};function AI(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function U1(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>U1(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:U1(s))}}}function Jf(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in Js)o=Js[i];else if(o=e[i],o==null)throw new V(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new V(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in Js?[a,l]=Js.className:o in e&&([a,l]=e[o]),a==null)throw new V(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Js))c[f]=Js[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const h=Object.assign({},Js);for(const f of Object.keys(n))Js[f]=n[f];U1(i.config);const d=l(a,i.config,n,r);return Js=Object.assign({},h),d}else{const c=Object.assign({},Js);for(const h of Object.keys(n))Js[h]=n[h];const u=new a(i.config);return Js=Object.assign({},c),u}}}function bde(t,e){return t<e?-1:t>e?1:0}function rm(t,e){return-1*bde(t,e)}function qo(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function wde(t){if(t==null)throw new V(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Ul(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new V(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function DI(t,e,n=0,s=1/0){return ui(n>=0),ui(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function yn(t,e){Array.isArray(t)?(D(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>yn(n,`element ${s+1} of ${e}`))):D(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${pB(t)}.`)}function pB(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>pB(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Cde(t,e,n){let s=n!=null?n():os(),r;return(...o)=>{const a=n!=null?n():os();return a-s<e||(s=a,r=t(...o)),r}}function mB(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Sde=0;function gB(){return Sde++}const im={};function Iv(t=""){return t in im||(im[t]=0),im[t]+=1,t+im[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const kde=["channelsFirst","channelsLast"],Tde=["nearest","bilinear"],Ide=["valid","same","causal"],$de=["max","avg"],Nde=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const sc=new Map;function Qt(t){Ul(kde,"DataFormat",t)}function Ede(t){Ul(Tde,"InterpolationFormat",t)}function Ys(t){Ul(Ide,"PaddingMode",t)}function xB(t){Ul($de,"PoolMode",t)}const Wh=[],uA="/";function nl(t,e){Wh.push(t);try{const n=e();return Wh.pop(),n}catch(n){throw Wh.pop(),n}}function Rde(){return Wh.length===0?"":Wh.join(uA)+uA}function vB(t){if(!bB(t))throw new Error("Not a valid tensor name: '"+t+"'");return Rde()+t}function yB(t){if(!bB(t))throw new Error("Not a valid tensor name: '"+t+"'");sc.has(t)||sc.set(t,0);const e=sc.get(t);if(sc.set(t,sc.get(t)+1),e>0){const n=`${t}_${e}`;return sc.set(n,1),n}else return t}const Ade=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function bB(t){return!!t.match(Ade)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dde(t){return t===parseInt(t.toString(),10)}function Yo(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function uu(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function ia(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function qr(t,e){if(e<t)throw new V(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let mb;function ln(){return mb==null&&(mb=Tre().epsilon()),mb}function Yr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $i(t,e){return ve(t,e)}function ep(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),G(t,n)}function _de(t,e){return K(()=>{if(t.shape.length!==2)throw new V(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=ep(t,1);return G1(n,[1,e,1])})}function Pde(t){const e=[Yo(t.shape)];return G(t,e)}function Fde(t){if(t.rank<=1)throw new V(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Yo(t.shape,1)];return G(t,e)}function sl(t,e,n){return K(()=>{switch(t.rank){case 1:return HT(t,e,n);case 2:return vV(t,[e,0],[n,t.shape[1]]);case 3:return KT(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Xg(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return mt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return mt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new V(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function gb(t,e,n){return K(()=>{switch(t.rank){case 1:return HT(t,e,n);case 2:return vV(t,[0,e],[t.shape[0],n]);case 3:return KT(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Xg(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new V(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function om(t,e,n,s){return K(()=>{switch(t.rank){case 1:return HT(t,e,n);case 2:switch(s){case 1:return sl(t,e,n);case 2:return gb(t,e,n);default:throw new V(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return sl(t,e,n);case 2:return KT(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return gb(t,e,n);default:throw new V(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return sl(t,e,n);case 2:return Xg(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Xg(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return gb(t,e,n);default:throw new V(`The axis is not within the rank of the tensor ${s}`)}default:throw new V(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function _I(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),us(t,e)}function hA(t,e){switch(t.rank){case 1:return Xie([t,e]);case 2:return Yie([t,e],0);case 3:return Zie([t,e],0);case 4:return eoe([t,e],0);default:throw new V(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function G1(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new V(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return zr(t,e)}function $v(t,e=0,n=1,s,r){return cle(t,e,n,s,r)}function Ni(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ve(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Ve(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return QR({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?H1(t.rank,s,Yr()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=G(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=G(Qe(e,u),[l,-1]);const h=[...r,...c];return G(QR({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?H1(t.rank,s,Yr()):null,activation:n}),h)}}function wB(t,e,n){return K(()=>(Array.isArray(e)?e=ks(e,"int32"):e=ve(e,"int32"),RT(t,e,n)))}function tp(t){return B(t,t)}function H1(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new V(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?G(e,[1,s[0],1,1,1]):G(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?G(e,[1,1,1,1,s[0]]):G(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?G(e,[1,s[0],1,1]):G(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?G(e,[1,1,1,s[0]]):G(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?G(e,[1,s[0],1]):G(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?G(e,[1,1,s[0]]):G(e,[1].concat(s))}else if(t<3)return e;throw new V(`Unsupported input rank by biasAdd: ${e.rank}`)}function ti(t,e,n){return K(()=>(n==null&&(n=Yr()),Qt(n),ue(t,H1(t.rank,e,n))))}function Ode(t,e=1){if(e!==1)throw new Ve(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return yv(t)}function Mde(t){return K(()=>Re(t,ue(qn(t),1)))}function CB(t,e,n,s){return K(()=>rce(t,e,n,s))}function Lde(t){return K(()=>{const e=ue(.5,B(.2,t));return Hs(e,0,1)})}function np(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zde=["fanIn","fanOut","fanAvg"],Vde=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bde(t){Ul(zde,"FanMode",t)}function jde(t){Ul(Vde,"Distribution",t)}class kr extends _u{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class SB extends kr{apply(e,n){return xn(e,n)}}SB.className="Zeros";ae(SB);class PI extends kr{apply(e,n){return Sa(e,n)}}PI.className="Ones";ae(PI);class kB extends kr{constructor(e){if(super(),typeof e!="object")throw new V(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new V(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return K(()=>B(st(this.value),Sa(e,n)))}getConfig(){return{value:this.value}}}kB.className="Constant";ae(kB);class TB extends kr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Kf(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}TB.className="RandomUniform";ae(TB);class IB extends kr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ve(`randomNormal does not support dType ${n}.`);return $v(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}IB.className="RandomNormal";ae(IB);class $B extends kr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ve(`truncatedNormal does not support dType ${n}.`);return wV(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}$B.className="TruncatedNormal";ae($B);class NB extends kr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return K(()=>{if(e.length!==2||e[0]!==e[1])throw new V("Identity matrix initializer can only be used for 2D square matrices.");return B(this.gain,sV(e[0]))})}getConfig(){return{gain:this.gain}}}NB.className="Identity";ae(NB);function Wde(t,e="channelsLast"){let n,s;if(Qt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Yo(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Yo(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Yo(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class As extends kr{constructor(e){if(super(),e.scale<0)throw new V(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Bde(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,jde(this.distribution),this.seed=e.seed}apply(e,n){const s=Wde(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ve(`${this.getClassName()} does not support dType ${n}.`);return wV(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Kf(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}As.className="VarianceScaling";ae(As);class FI extends As{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return As.className}}FI.className="GlorotUniform";ae(FI);class OI extends As{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return As.className}}OI.className="GlorotNormal";ae(OI);class MI extends As{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return As.className}}MI.className="HeNormal";ae(MI);class LI extends As{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return As.className}}LI.className="HeUniform";ae(LI);class zI extends As{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return As.className}}zI.className="LeCunNormal";ae(zI);class VI extends As{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return As.className}}VI.className="LeCunUniform";ae(VI);class EB extends kr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return K(()=>{if(e.length<2)throw new Ve("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=ne(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=$v(o,0,1,n,this.seed),l=eue.qr(a,!1);let c=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=B(c,h.sign()),s<r&&(c=c.transpose()),B(st(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}EB.className="Orthogonal";ae(EB);const dA={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function fA(t,e={}){return Jf(t,lr.getMap().classNameMap,e,"initializer")}function Mt(t){return AI(t)}function At(t){if(typeof t=="string"){const e=t in dA?dA[t]:t;if(e==="GlorotNormal")return new OI;if(e==="GlorotUniform")return new FI;if(e==="HeNormal")return new MI;if(e==="HeUniform")return new LI;if(e==="LeCunNormal")return new zI;if(e==="LeCunUniform")return new VI;{const n={};return n.className=e,n.config={},fA(n)}}else return t instanceof kr?t:fA(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K1(t){return Array.isArray(t)&&Array.isArray(t[0])}function qg(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function _e(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new V(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function et(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new V(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yg(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const pA="Variable";class Ude{constructor(e,n="float32",s=pA,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=gB(),s=s??pA,this.originalName=vB(s),this.name=yB(this.originalName),this.trainable_=r,this.constraint=i,this.val=ece(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Gde(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Gde(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function X1(t){return t.map(e=>e.read())}function BI(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class _i{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=gB(),o!=null&&(this.originalName=vB(o),this.name=yB(this.originalName)),this.rank=n.length}}let Hde=0,Nv=class{constructor(e,n){this.callArgs=n,this.id=Hde++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},Kde=0;class He extends _u{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Kde++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=ji(s)+"_"+Iv(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new fr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new V(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return ls(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return ls(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ci(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ci(`Layer ${this.name} is not connected, no input to return.`);return ls(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ci(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ci(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ls(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=ot(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=ot(this.inputSpec);if(n.length!==s.length)throw new V(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new V(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new V(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new V(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new V(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),h=o.axes[c],d=u>=0?l[u]:l[l.length+u];if(h!=null&&[h,null].indexOf(d)===-1)throw new V(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${h} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new V(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=ot(e),r=Yde(e),i=Qde(e);if(r===i)throw new V("Arguments to apply() must be all SymbolicTensors or all Tensors");return nl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of ot(e))o.push(a.shape);this.build(ls(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=ot(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=ls(l),this.activityRegularizer!=null)throw new Ve("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=Xde(e),a=this.computeOutputShape(o);let l;const c=qde(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,h)=>new _i(c,u,this,ot(e),n,this.name,h)):l=new _i(c,a,this,ot(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ve("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ci(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ci(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new fr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Yg(this.weights)}build(e){this.built=!0}getWeights(e=!1){return X1(e?this.trainableWeights:this.weights)}setWeights(e){K(()=>{const n=this.weights;if(n.length!==e.length)throw new V(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=X1(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!rt(o.shape,l.shape))throw new V(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}BI(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new V(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():At("zeros"));const c=r.apply(n,s),u=new Ude(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ot(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=ot(n),o=ot(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=ot(e);n=ot(n),s=ot(s),r=ot(r),i=qg(i),o=qg(o);const c=[],u=[],h=[];for(const d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),h.push(d.tensorIndex);new Nv({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Xde(t){t=ot(t);const e=[];for(const n of t)e.push(n.shape);return ls(e)}function qde(t){return"float32"}function RB(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=RB(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function Yde(t){let e=!0;for(const n of ot(t))if(!(n instanceof _i)){e=!1;break}return e}function Qde(t){let e=!0;for(const n of ot(t))if(n instanceof _i){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sp extends He{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Iv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new V("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new V("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new V("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new _i(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Nv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new V(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}sp.className="InputLayer";ae(sp);function Zde(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new V("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new sp({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jde(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ve(e,t.dtype)}catch{throw new V(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Po{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Po)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Jde(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new V(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof _i){if(this.id2Value[e.id]==null)throw new V(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new V(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof _i){if(this.id2Value[e.id]==null)throw new V(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new V(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Xe(this.id2Mask)}}const Qg=new fB,Zg=new fB;function efe(t){Qg!=null&&Qg.setMaxEntries(t),Zg!=null&&Zg.setMaxEntries(t)}function wh(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);s!=null&&(s.maxNumTensors=-1/0,s.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().sort().join(",");let h=Qg.get(u),d;if(h==null){const p=tfe(o,e);h=p.sorted,d=p.recipientCounts,Qg.put(u,h),Zg.put(u,d)}d={},r||Object.assign(d,Zg.get(u));const f=new Po(e);for(let p=0;p<h.length;++p){if(s!=null){const $=P1().numTensors;$>s.maxNumTensors&&(s.maxNumTensors=$),$<s.minNumTensors&&(s.minNumTensors=$)}const m=h[p],v=m.sourceLayer;if(v instanceof sp)continue;const x=[],g=[],y=[];let b=!1;for(const $ of m.inputs){const N=f.getValue($),A=f.getMask($);x.push(N),g.push(A),A!=null&&(b=!0),r||(d[$.name]--,d[$.name]===0&&!e.hasKey($)&&a.indexOf($.name)===-1&&!N.isDisposed&&$.sourceLayer.stateful!==!0&&y.push(N))}b&&(n=n||{},n.mask=g[0]);const C=ot(v.apply(x,n));let S=null;v.supportsMasking&&(S=v.computeMask(x,g));const T=sfe(m),I=Array.isArray(T)?T:[T];for(let $=0;$<I.length;++$){f.hasKey(I[$])||f.add(I[$],C[$],Array.isArray(S)?S[0]:S);const N=a.indexOf(I[$].name);N!==-1&&(l[N]=C[$])}r||Xe(y)}return f.disposeMasks(),i?l:l[0]}function tfe(t,e){D(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=mA(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=mA(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:nfe(s)}}function nfe(t){const e={};for(const n in t)e[n]=t[n].size;return e}function mA(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function sfe(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rfe=Y();rfe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,efe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jI(t,e){return K(()=>Vn(Ee(B(t,t),e,!0)))}class rp extends _u{getConfig(){return{}}}class AB extends rp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{const n=jI(e,this.axis),s=Hs(n,0,this.maxValue);return B(e,Re(s,ue(ln(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}AB.className="MaxNorm";ae(AB);class DB extends rp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>Re(e,ue(ln(),jI(e,this.axis))))}getConfig(){return{axis:this.axis}}}DB.className="UnitNorm";ae(DB);class _B extends rp{apply(e){return jl(e)}}_B.className="NonNeg";ae(_B);class PB extends rp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{const n=jI(e,this.axis),s=ue(B(this.rate,Hs(n,this.minValue,this.maxValue)),B(1-this.rate,n));return B(e,Re(s,ue(ln(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}PB.className="MinMaxNorm";ae(PB);const gA={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function un(t){return AI(t)}function xA(t,e={}){return Jf(t,lr.getMap().classNameMap,e,"constraint")}function hn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in gA?gA[t]:t,config:{}};return xA(n)}else return t instanceof rp?t:xA(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Aa(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];Xe(s)}}function FB(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var vA;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(vA||(vA={}));const ife=125;class Td{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class ofe{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class afe extends Td{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=K(()=>ue(this.totals[r],B(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:K(()=>{const r=B(Re(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Ti(n[s])}))}}class lfe extends Td{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class cfe extends Td{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||VV,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=ife),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");C1(this.yieldEvery)&&(this.maybeWait=Cde(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await Aa(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Aa(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await Aa(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Aa(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await Aa(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):C1(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Aa(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Aa(e),await this.trainEnd(e))}}function OB(t,e){return t==null&&(t={}),t instanceof Td?[t]:Array.isArray(t)&&t[0]instanceof Td?t:ot(t).map(s=>new cfe(s,e))}class rr{constructor(){}static registerCallbackConstructor(e,n){D(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),rr.checkForDuplicate(n),rr.constructors[e]==null&&(rr.constructors[e]=[]),rr.constructors[e].push(n)}static checkForDuplicate(e){for(const n in rr.constructors)rr.constructors[+n].forEach(r=>{if(r===e)throw new V("Duplicate callback constructor.")})}static clear(){rr.constructors={}}static createCallbacks(e){const n=[];for(const s in rr.constructors){const r=+s;e>=r&&n.push(...rr.constructors[r])}return n.map(s=>new s)}}rr.constructors={};function MB(t,e,n,s,r,i,o,a,l){const c=new lfe,u=[new afe,...rr.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const h=new ofe(u);return h.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ji(t,e={},n=!1){return Jf(t,lr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jg(t,e){return K(()=>{t.dtype!=="float32"&&(t=ve(t,"float32"));const n=Ee(tp(t),e,!0),s=vv(n.shape,ln()),r=Vn(Ca(n,s));return Re(t,r)})}function Ev(t,e){return K(()=>en(tp(De(e,t)),-1))}function WI(t,e){return K(()=>en(qn(De(e,t)),-1))}function UI(t,e){return K(()=>{const n=De(t,e),s=Hs(qn(t),ln(),Number.MAX_VALUE),r=qn(Re(n,s));return B(100,en(r,-1))})}function ufe(t,e){return K(()=>{const n=Hs(e,ln(),Number.MAX_VALUE),s=Di(ue(1,n)),r=Hs(t,ln(),Number.MAX_VALUE),i=Di(ue(1,r));return en(tp(De(s,i)),-1)})}function hfe(t,e){return K(()=>{const n=Ca(0,De(1,B(t,e)));return en(tp(n),-1)})}function dfe(t,e){return K(()=>{const n=Ca(0,De(1,B(t,e)));return en(n,-1)})}function ffe(t,e){return K(()=>{const n=Ee(B(t,e),-1),s=Wr(B(De(1,t),e),-1);return Ca(0,ue(1,De(s,n)))})}function pfe(t,e){return K(()=>{const n=Math.log(2),s=De(e,t),r=De(ue(s,Hf(B(-2,s))),n);return en(r,-1)})}function Id(t,e,n=!1){return K(()=>{if(n)e=XT(e);else{const s=Ee(e,e.shape.length-1,!0);e=Re(e,s)}return e=Hs(e,ln(),1-ln()),Xt(Ee(B(ve(t,"float32"),Di(e)),e.shape.length-1))})}function ex(t,e,n=!1){return K(()=>{const s=ve(wv(Pde(t)),"int32");e=Hs(e,ln(),1-ln());const r=e.shape,i=G(lV(s,r[r.length-1]),r);return Id(i,e,n)})}function mfe(t,e){if(!rt(t.shape,e.shape))throw new V(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return K(()=>{const n=jl(e),s=Xt(qn(e));return ue(De(n,B(e,t)),rV(Ai(s)))})}function Rv(t,e){return K(()=>{let n;return n=Hs(e,ln(),1-ln()),n=Di(Re(n,De(1,n))),en(mfe(t,n),-1)})}function gfe(t,e){return K(()=>{const n=Hs(t,ln(),1),s=Hs(e,ln(),1);return Ee(B(t,Di(Re(n,s))),-1)})}function xfe(t,e){return K(()=>{const n=Di(ue(ln(),e));return en(De(e,B(t,n)),-1)})}function LB(t,e){return K(()=>{const n=Jg(t,-1),s=Jg(e,-1),r=B(n,s);return Xt(Ee(r,-1))})}const tx={meanSquaredError:Ev,meanAbsoluteError:WI,meanAbsolutePercentageError:UI,meanSquaredLogarithmicError:ufe,squaredHinge:hfe,hinge:dfe,categoricalHinge:ffe,logcosh:pfe,categoricalCrossentropy:Id,sparseCategoricalCrossentropy:ex,binaryCrossentropy:Rv,kullbackLeiblerDivergence:gfe,poisson:xfe,cosineProximity:LB};function xb(t){if(typeof t=="string"){if(t in tx)return tx[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new V(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zB(t,e){return K(()=>{const n=B(.5,wr(e)),s=$i(qs(e,n),t.dtype);return en(Ri(t,s),-1)})}function VB(t,e){return K(()=>$i(Ri(bd(t,-1),bd(e,-1)),"float32"))}function vfe(t,e){return K(()=>ve(Ee(ao(Ri(t,1),Ri(e,1))),"float32"))}function yfe(t,e){return K(()=>ve(Ee(ao(Ri(t,0),Ri(e,1))),"float32"))}function bfe(t,e){return K(()=>{const n=vfe(t,e),s=yfe(t,e),r=ue(n,s);return ve(Jn(qs(r,0),Re(n,r),0),"float32")})}function wfe(t,e){return Rv(t,e)}function Cfe(t,e){return t.rank===e.rank&&(t=Xf(t,[t.rank-1])),e=bd(e,-1),e.dtype!==t.dtype&&(e=ve(e,t.dtype)),ve(Ri(t,e),"float32")}const Sfe=Ev,kfe=Ev,Tfe=WI,Ife=WI,$fe=UI,Nfe=UI,BB=Id,Efe=LB,jB=ex,nx={binaryAccuracy:zB,categoricalAccuracy:VB,precision:bfe,categoricalCrossentropy:BB,sparseCategoricalCrossentropy:jB,mse:Sfe,MSE:kfe,mae:Tfe,MAE:Ife,mape:$fe,MAPE:Nfe,cosine:Efe};function Rfe(t){if(typeof t=="string"&&t in nx)return nx[t];if(typeof t!="string"&&t!=null)return t;throw new V(`Unknown metric ${t}`)}function am(t){if(ui(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(tx))if(tx[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(nx))if(nx[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Afe(t){const e={Adagrad:()=>nc.adagrad(.01),Adadelta:()=>nc.adadelta(1,.95,ln()),Adam:()=>nc.adam(.001,.9,.999,ln()),Adamax:()=>nc.adamax(.002,.9,.999,ln(),0),RMSProp:()=>nc.rmsprop(.001,.9,0,ln()),SGD:()=>nc.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new V(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yA=1*1024*1024;function bA(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!q1(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>yA&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${yA}.`)}}function q1(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!q1(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!q1(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dfe(t,e,n,s=console.log){const r=Pfe(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),sx(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?Ffe(a[u],n,s):Ofe(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=_fe(t),c=Yg(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function _fe(t){let e;return t.collectedTrainableWeights!=null?e=Yg(t.collectedTrainableWeights):e=Yg(t.trainableWeights),e}function Pfe(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function sx(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function Ffe(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];sx(a,e,n)}function Ofe(t,e,n,s){let r,i;try{i=t.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const h of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],m=h.tensorIndices[d];o.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];sx(u,e,s);for(let h=1;h<o.length;++h)sx(["","","","",o[h]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WB(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Y1(t,e){if(t===null)return null;if(typeof t=="string")return Ba(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];WB(e,r,i)?n.push(i):n.push(Y1(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=Ba(s);n[i]=Y1(r,i)}}return n}}function Q1(t,e){if(t==null)return null;if(typeof t=="string")return ji(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];WB(e,r,i)?n.push(i):n.push(Q1(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=ji(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=Q1(r,s)}return n}}/** @license See the LICENSE file. */const UB="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Mfe=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Dr extends He{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const g=this.getClassName().toLowerCase();this.name=Iv(g)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],qo(this.inputs).length!==this.inputs.length)throw new V(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(g=>g.name)}`);qo(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(g=>g.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const g of this.outputs){const y=g.sourceLayer,b=g.nodeIndex,C=g.tensorIndex;this.outputLayers.push(y),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push(C)}for(const g of this.inputs){const y=g.sourceLayer,b=g.nodeIndex,C=g.tensorIndex;ui(b===0,"input layer has >1 nodes"),ui(C===0,"input layer has >1 tensors"),this.inputLayers.push(y),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let g=0;g<this.inputLayers.length;g++){const y=this.inputLayers[g];if(!(y instanceof sp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${g} (0-based) originates from layer type ${y.getClassName()}.`);this.inputNames.push(y.name),this.feedInputShapes.push(y.batchInputShape),this.feedInputNames.push(y.name)}for(const g of this.outputLayers)this.outputNames.push(g.name);this.internalInputShapes=this.inputs.map(g=>g.shape),this.internalOutputShapes=this.outputs.map(g=>g.shape);const n={},s={},r={},i={},o={},a=[],l=(g,y,b,C,S,T)=>{(C==null||S==null||T==null)&&(C=g.sourceLayer,S=g.nodeIndex,T=g.tensorIndex);const I=C.inboundNodes[S];if(b.indexOf(I)!==-1)throw new fr(`The tensor ${g.name} at layer "${C.name}" is part of a cycle.`);if(y.indexOf(I)!==-1)return;this.containerNodes.add(Dr.nodeKey(C,S)),C.id in o||(o[C.id]=Object.keys(o).length),b.indexOf(I)===-1&&b.push(I);const $=I.inboundLayers.length;for(let N=0;N<$;N++){const A=I.inputTensors[N],F=I.inboundLayers[N],E=I.nodeIndices[N],R=I.tensorIndices[N];l(A,y,b,F,E,R)}for(y.push(I);b.indexOf(I)>=0;)b.splice(b.indexOf(I),1);a.push(I)},c=[],u=[];for(const g of this.outputs)l(g,c,u);const h=a.slice().reverse();for(const g of h){s[g.id]=g,g.id in n||(n[g.id]=0);let y=n[g.id];const b=r[g.outboundLayer.id]==null?0:r[g.outboundLayer.id];y=Math.max(y,b),r[g.outboundLayer.id]=y,i[g.outboundLayer.id]=g.outboundLayer,n[g.id]=y;for(let C=0;C<g.inboundLayers.length;C++){const S=g.inboundLayers[C],T=g.nodeIndices[C],I=S.inboundNodes[T],$=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(y+1,$),s[I.id]=I}}const d={};for(const g in n){const y=n[g];y in d||(d[y]=[]),d[y].push(s[g])}const f={};for(const g in r){const y=r[g];y in f||(f[y]=[]),f[y].push(i[g])}let p=Object.keys(f).map(g=>parseInt(g,10)).sort(rm);this.layers=[];for(const g of p){const y=f[g];y.sort((b,C)=>{const S=o[b.id],T=o[C.id];return S<T?-1:S>T?1:0});for(const b of y)b instanceof Dr&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=f,p=Object.keys(d).map(g=>parseInt(g,10)).sort(rm);const m=this.inputs.slice(),v=[];for(const g of p)for(const y of d[g]){const b=y.outboundLayer;if(b!=null){for(const C of y.inputTensors)if(m.indexOf(C)===-1)throw new fr(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${b.name}". The following previous layers were accessed without issue: ${v}`);for(const C of y.outputTensors)m.push(C);v.push(b.name)}}this.nodesByDepth=d;const x=this.layers.map(g=>g.name);for(const g of x){const y=x.filter(b=>b===g).length;if(y!==1)throw new fr(`The name "${g}" is used ${y} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new Nv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(g=>null),outputMasks:this.outputs.map(g=>null),inputShapes:this.inputs.map(g=>g.shape),outputShapes:this.outputs.map(g=>g.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new V("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=Mfe(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new V(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new V(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new V(`${a.length} of ${r} weights are not set: ${a}`)}BI(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${UB}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=Q1(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return K(()=>{e=ot(e);const s=new Po;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return wh(this.outputs,s,n)})}computeMask(e,n){return K(()=>{e=ot(e);let s;return n==null?s=$l(null,e.length):s=ot(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=qg(e);if(n.length!==this.inputLayers.length)throw new V(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(rm);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const h=[];for(let m=0;m<c.inboundLayers.length;m++){const v=c.inboundLayers[m],x=c.nodeIndices[m],g=c.tensorIndices[m],y=`${v.name}_${x}_${g}`,b=s[y];h.push(b)}const d=u.computeOutputShape(ls(h)),f=qg(d),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const v=`${u.name}_${p}_${m}`;s[v]=f[m]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],h=`${l.name}_${c}_${u}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];ui(l in s),i.push(s[l])}return ls(i)}runInternalGraph(e,n){n==null&&(n=$l(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],h=n[l];s[c.id]=[u,h]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(rm);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of d)m.id in s&&p.push(s[m.id]);if(p.length===d.length){let m={},v,x,g,y;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[b,C]=p[0];m.mask==null&&(m.mask=C),g=ot(h.call(b,m)),y=ot(h.computeMask(b,C)),v=[b],x=[C]}else v=p.map(b=>b[0]),x=p.map(b=>b[1]),m.mask==null&&(m.mask=x),g=ot(h.call(v,m)),y=ot(h.computeMask(v,x));if(h.activityRegularizer)throw new Ve("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<f.length;++b){const C=f[b],S=g[b],T=y[b];s[C.id]=[S,T]}}}}const i=[],o=[],a=[];for(const l of this.outputs){ui(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Dr?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=Dr.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new V("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new V(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new V(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return K(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Dr.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let h=0;h<o.inboundNodes.length;h++){const d=o.inboundNodes[h],f=Dr.nodeKey(o,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const m=[];for(let v=0;v<d.inboundLayers.length;v++){const x=d.inboundLayers[v],g=d.nodeIndices[v],y=d.tensorIndices[v],b=Dr.nodeKey(x,g);let C=n[b];C==null&&(C=0),m.push([x.name,C,y,p])}c.push(m)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Dr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.inputLayersTensorIndices[o];r.push([a.name,u,h])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Dr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,u,h])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(v,x){v.name in o?o[v.name].push(x):o[v.name]=[x]}function l(v,x){const g=[];let y;for(const b of x){const C=b[0],S=b[1],T=b[2];if(y=b[3]==null?{}:b[3],!(C in i)){a(v,x);return}const I=i[C];if(I.inboundNodes.length<=S){a(v,x);return}const $=I.inboundNodes[S];g.push($.outputTensors[T])}g.length>0&&v.apply(ls(g),y)}function c(v){const x=v.name,g=Ji(v,n.customObjects!=null?n.customObjects:{});g.setFastWeightInitDuringBuild(r),i[x]=g,v.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new V(`Corrupted configuration, expected array for nodeData: ${b}`);a(g,b)})}const u=n.name,h=n.layers;for(const v of h)c(v);for(;!wde(o);)for(const v of h){const x=i[v.name];if(x.name in o){const g=o[x.name];delete o[x.name];for(const y of g)l(x,y)}}const d=[],f=[],p=n.inputLayers;for(const v of p){const x=v[0],g=v[1],y=v[2];ui(x in i);const C=i[x].inboundNodes[g].outputTensors;d.push(C[y])}const m=n.outputLayers;for(const v of m){const x=v[0],g=v[1],y=v[2];ui(x in i);const C=i[x].inboundNodes[g].outputTensors;f.push(C[y])}return new e({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new V("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){K(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lfe(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function GB(t,e){return Lfe(t,e,"classWeight")}async function HB(t,e,n,s){if(e!=null||s!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const r=K(()=>{if(t.shape.length===1)return tl(t);if(t.shape.length===2){if(t.shape[1]>1)return bd(t,1);if(t.shape[1]===1)return G(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Xe(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),ks(o,"float32")}else return null}function zfe(t,e){return B(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Vfe=32;function KB(t,e){let n,s;const r=e;n=r.xs,s=r.ys,D(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=wA("input",t.inputNames,n),o=wA("output",t.outputNames,s),a=i[0].shape[0];D(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),D(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)D(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)D(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function wA(t,e,n){if(n instanceof on)return[n];if(Array.isArray(n))return D(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new V(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function Bfe(t){if(t.length===3)throw new Ve("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function jfe(t,e,n){const s=n.batchesPerEpoch!=null;if(D(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),D(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),D(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),D(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),D(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(CA(n.validationData))D(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const v=Bfe(n.validationData);i=v.xs,o=v.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(v=>"val_"+v)):c=l.slice();const u=OB(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=MB(u,h,n.epochs,null,null,Wfe(e,n),null,r,c);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const v={};await d.onEpochBegin(p);let x=0,g=0;for(s||(m=await e.iterator());!s||x<n.batchesPerEpoch;){const y=await m.next();if(s&&y.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(y.value!=null){const{xs:b,ys:C}=KB(t,y.value),S={};S.batch=g,S.size=b[0].shape[0],await d.onBatchBegin(g,S);const T=[];if(n.classWeight!=null){const N=GB(n.classWeight,t.outputNames);for(let A=0;A<N.length;++A)T.push(await HB(C[A],null,N[A]))}const I=b.concat(C).concat(T),$=a(I);Xe(I);for(let N=0;N<l.length;++N){const A=l[N],F=$[N];S[A]=F,Ti(F)}await d.onBatchEnd(g,S),FB(S),g++,x++}if(s?x>=n.batchesPerEpoch:y.done){if(r){let b;CA(n.validationData)?b=ot(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=ot(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?Vfe:n.validationBatchSize,verbose:0}));for(let C=0;C<t.metricsNames.length;++C)v[`val_${t.metricsNames[C]}`]=b[C]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(p,v),p++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Wfe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function CA(t){return typeof t.iterator=="function"}function Ufe(t){return typeof t.next=="function"}async function Gfe(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new Ve("Verbose mode is not implemented yet.");D(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=Ufe(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=K(()=>{if(c.value){const{xs:u,ys:h}=KB(t,c.value),d=u.concat(h),f=K(()=>r(d));if(Xe(d),l===0)for(let m=0;m<f.length;++m)i.push(st(0));const p=d[0].shape[0];for(let m=0;m<f.length;++m){const v=f[m],x=i[m];i[m]=K(()=>ue(i[m],B(p,v))),l>0&&Xe(x)}Xe(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=Re(i[c],a),Xe(u)}return ls(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vb(t){D(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function ah(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>sl(s,e,n-e)):sl(t,e,n-e)}function Z1(t,e){return K(()=>t==null?null:Array.isArray(t)?t.map(n=>Z1(n,e)):wB(t,e.dtype==="int32"?e:ve(e,"int32")))}function yb(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function XB(t){const e=[];t instanceof on&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(ep(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Er(t,e){if(t==null)return;const n=[];if(e instanceof on)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof on)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hfe(t){return t instanceof on}function J1(t){return Array.isArray(t)}function SA(t){return!Hfe(t)&&!J1(t)}function kA(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(J1(t)&&t.length>0)o=!0;else if(SA(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new V(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(SA(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new V(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(J1(t)){if(t=t,t.length!==e.length)throw new V(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new V(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=XB(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new V(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new V(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function Kfe(t,e,n){const s=qo(t.map(i=>i.shape[0]));s.sort();const r=qo(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new V(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new V(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!rt(s,r))throw new V(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function Xfe(t,e,n){const s=[Ev,Rv,Id];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===Id&&i.shape[i.shape.length-1]===1)throw new V(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=l[u],d=c[u];if(d!=null&&h!==d)throw new V(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function TA(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new V(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new V(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new V(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new V(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function qfe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const Yfe="layers-model";class Bc extends Dr{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new V("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Dfe(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Afe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ka))throw new V("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new V(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(xb(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new V(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>xb(a))}else{const o=xb(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],nl("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=qfe(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};nl("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let h,d,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const v=this.internalOutputShapes[o];v[v.length-1]===1||this.lossFunctions[o]===Rv?["accuracy","acc"].indexOf(p)!==-1?d=zB:["crossentropy","ce"].indexOf(p)!==-1&&(d=wfe):this.lossFunctions[o]===ex?["accuracy","acc"].indexOf(p)!==-1?d=Cfe:["crossentropy","ce"].indexOf(p)!==-1&&(d=jB):["accuracy","acc"].indexOf(p)!==-1?d=VB:["crossentropy","ce"].indexOf(p)!==-1&&(d=BB);let x;["accuracy","acc"].indexOf(p)!==-1?x="acc":["crossentropy","ce"].indexOf(p)!==-1&&(x="ce"),f=d,h=u+x}else f=Rfe(p),h=u+am(p);let m;nl(h,()=>{m=f}),i(o,h,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;vb(r);const i=!0,o=this.standardizeUserDataXY(e,n,i,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return ls(c)}finally{Er(o[0],e),Er(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Gfe(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new V(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new V(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new V("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new Po;if(e instanceof on&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new V(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new V(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=wh(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=$l(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new V(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return K(()=>{const r=this.checkNumSamples(e);if(s)throw new Ve("Verbose predictLoop() is not implemented yet.");const i=yb(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)K(()=>{const c=i[a][0],u=i[a][1],h=ah(e,c,u),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new Po(d);return wh(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return ls(o.map(a=>us(a,0)))})}predict(e,n={}){const s=XB(e);TA(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return vb(r),this.predictLoop(s,r)}finally{Er(s,e)}}predictOnBatch(e){TA(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new fr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===ex?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=kA(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=kA(n,this.feedOutputNames,i,!1,"target"),Kfe(e,n),Xfe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new V(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=GB(r,this.outputNames);c=[];for(let h=0;h<u.length;++h)c.push(await HB(l[h],null,u[h]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return K(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new Ve("Verbose mode is not implemented yet.");if(i!=null)throw new Ve("steps mode in testLoop() is not implemented yet");{const l=yb(o,s),c=ks(qr(0,o));for(let u=0;u<l.length;++u){const h=l[u][0],d=l[u][1],f=sl(c,h,d-h),p=Z1(n,f),m=e(p);if(u===0)for(let v=0;v<m.length;++v)a.push(st(0));for(let v=0;v<m.length;++v){const x=m[v];a[v]=ue(a[v],B(d-h,x))}}for(let u=0;u<a.length;++u)a[u]=Re(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(cA(e,r)>1){const o=cA(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let m=0;m<this.inputs.length;++m)h.push({key:this.inputs[m],value:s[m]});const d=new Po(h),f=wh(this.outputs,d,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const v=this.lossFunctions[m];let x=v(r[m],f[m]);i[m]!=null&&(x=zfe(x,i[m]));const g=en(x);n.push(g),m===0?p=x:p=ue(p,x)}for(let m=0;m<this.metricsTensors.length;++m){let v;if(this.outputs.length>1&&m<this.outputs.length)v=n[m];else{const x=this.metricsTensors[m][0],g=this.metricsTensors[m][1];v=en(x(r[g],f[g]))}Ti(v),o.push(v)}return p=en(p),this.calculateLosses().forEach(m=>{p=ue(p,m)}),p},l=this.collectedTrainableWeights.map(h=>h.read()),c=!0;return[this.optimizer_.minimize(a,c,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>K(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new Po(o),l=wh(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],h=en(u(i[c],l[c]));c===0?s=h:s=ue(s,h),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],h=this.metricsTensors[c][1],d=en(u(i[h],l[h]));n.push(d)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,h,d;try{const f=s.batchSize==null?32:s.batchSize;vb(f);const p=!1,m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,p,f);r=m[0],i=m[1],d=m[2];let v=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Ve("validationData including sample weights is not supported yet."):new V(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=!0,N=await this.standardizeUserData(l,c,null,null,$,f);u=N[0],h=N[1],x=u.concat(h)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const $=Math.floor(r[0].shape[0]*(1-s.validationSplit)),N=r[0].shape[0];u=ah(r,$,N),o=r,r=ah(r,0,$),h=ah(i,$,N),a=i,i=ah(i,0,$),x=u.concat(h)}else s.validationSteps!=null&&(v=!0);const g=r.concat(i).concat(d);this.checkTrainableWeightsConsistency();const y=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let C,S;v?(this.makeTestFunction(),C=this.testFunction,S=b.slice().concat(b.map($=>"val_"+$))):(C=null,x=[],S=b.slice());const T=OB(s.callbacks,s.yieldEvery);return await this.fitLoop(y,g,b,f,s.epochs,s.verbose,T,C,x,s.shuffle,S,s.initialEpoch,null,null)}finally{this.isTraining=!1,Er(r,e),Er(i,n),Er(o,e),Er(a,n),Er(u,l),Er(h,c),d!=null&&Xe(d)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,h,d,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),d==null&&(d=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new V("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(n,r,f,"steps_per_epoch");let x;v!=null&&(x=qr(0,v)),o==null&&(o=1);const{callbackList:g,history:y}=MB(a,o,i,d,v,f,r,m,h);g.setModel(this),this.history=y,await g.onTrainBegin(),this.stopTraining_=!1;for(let b=d;b<i;++b){await g.onEpochBegin(b);const C={};if(f!=null)throw new Ve("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Ve("batch shuffling is not implemneted yet");u&&Fse(x);const S=ks(x),T=yb(v,r);for(let I=0;I<T.length;++I){const $={};if(await g.onBatchBegin(I,$),K(()=>{const N=T[I][0],A=T[I][1],F=sl(S,N,A-N);$.batch=I,$.size=A-N;const E=Z1(n,F),R=e(E);for(let O=0;O<s.length;++O){const P=s[O],z=R[O];$[P]=z,Ti(z)}if(I===T.length-1&&m){const O=this.testLoop(l,c,r);for(let P=0;P<s.length;++P){const z=s[P],_=O[P];Ti(_),C["val_"+z]=_}}}),await g.onBatchEnd(I,$),FB($),this.stopTraining_)break}S.dispose()}if(await g.onEpochEnd(b,C),this.stopTraining_)break}return await g.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return jfe(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Xe(a),Er(s[0],e),Er(s[1],n),ls(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=P1().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-P1().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=ji(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>ji(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=ji(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[ji(am(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>ji(am(e)));{const e={};for(const n in this.metrics)e[n]=ji(am(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Y1(e.optimizer_config),s=Ji(n);let r;if(typeof e.loss=="string")r=Ba(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>Ba(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=Ba(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Ba(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Ba(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=Rre(e);if(c.length===0)throw new V(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new V(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new V("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await KR(this.getNamedWeights(n)),r=!1,i=null,a={modelTopology:this.toJSON(i,r),format:Yfe,generatedBy:`TensorFlow.js tfjs-layers v${UB}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:h}=await KR(await this.optimizer.getWeights(),c);s.specs.push(...h),s.data=Ere([s.data,u])}return this.userDefinedMetadata!=null&&(bA(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){bA(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Bc.className="Model";ae(Bc);class qB extends Bc{}qB.className="Functional";ae(qB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $d extends Bc{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Iv("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new V(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof $d||e instanceof Bc;let s;if(n){if(s=e,s.outputs.length!==1)throw new V("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new V("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new V("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Zde({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new V(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new V("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=RB(this.outputs[0])}this.inboundNodes=[],new Nv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:$l(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(et(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Bc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new V("Legacy serialization format not supported yet.");i=n}else D(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof $d))throw new Ve(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Ji(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new V("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new V("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}$d.className="Sequential";ae($d);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let jn=class extends _u{getConfig(){return{}}};class YB extends jn{apply(e,n=1){return Ode(e,n)}}YB.className="elu";ae(YB);class QB extends jn{apply(e){return pV(e)}}QB.className="selu";ae(QB);class ZB extends jn{apply(e){return jl(e)}}ZB.className="relu";ae(ZB);class JB extends jn{apply(e){return K(()=>Sd(6,jl(e)))}}JB.className="relu6";ae(JB);class ej extends jn{apply(e){return e}}ej.className="linear";ae(ej);class tj extends jn{apply(e){return Ru(e)}}tj.className="sigmoid";ae(tj);class nj extends jn{apply(e){return Lde(e)}}nj.className="hardSigmoid";ae(nj);class sj extends jn{apply(e){return Hf(e)}}sj.className="softplus";ae(sj);class rj extends jn{apply(e){return Mde(e)}}rj.className="softsign";ae(rj);class ij extends jn{apply(e){return gv(e)}}ij.className="tanh";ae(ij);let GI=class extends jn{apply(e,n=-1){return XT(e,n)}};GI.className="softmax";ae(GI);class oj extends jn{apply(e,n=-1){return iV(e,n)}}oj.className="logSoftmax";ae(oj);class aj extends jn{apply(e){return K(()=>K(()=>{const n=Math.sqrt(2),s=B(.5,ue(1,eV(Re(e,n))));return B(e,s)}))}}aj.className="gelu";ae(aj);class lj extends jn{apply(e){return K(()=>B(.5,B(e,ue(1,gv(B(Vn(Re(2,Math.PI)),ue(e,B(.044715,kl(e,3)))))))))}}lj.className="gelu_new";ae(lj);class cj extends jn{apply(e){return K(()=>B(e,gv(Hf(e))))}}cj.className="mish";ae(cj);class uj extends jn{apply(e,n=1){return K(()=>B(Ru(B(e,n)),e))}}uj.className="swish";ae(uj);function oa(t){return t.getClassName()}function bb(t,e={}){return Jf(t,lr.getMap().classNameMap,e,"activation")}function aa(t){if(t==null){const e={};return e.className="linear",e.config={},bb(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},bb(e)}else return t instanceof jn?t:bb(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qfe(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class hj extends _u{}class dj extends hj{constructor(e){super(),Qfe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return K(()=>{let n=xn([1]);return this.hasL1&&(n=ue(n,Ee(B(this.l1,qn(e))))),this.hasL2&&(n=ue(n,Ee(B(this.l2,tp(e))))),G(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}dj.className="L1L2";ae(dj);const IA={l1l2:"L1L2"};function ht(t){return AI(t)}function $A(t,e={}){return Jf(t,lr.getMap().classNameMap,e,"regularizer")}function Dt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in IA?IA[t]:t,config:{}};return $A(n)}else return t instanceof hj?t:$A(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fj extends He{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=_e(e);let s=jl(e);return this.maxValue!=null&&(s=Hs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}fj.className="ReLU";ae(fj);class pj extends He{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=_e(e);return DT(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}pj.className="LeakyReLU";ae(pj);class mj extends He{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=At(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Dt(e.alphaRegularizer),this.alphaConstraint=hn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new V(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=et(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new cn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=_e(e),LT(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Mt(this.alphaInitializer),alphaRegularizer:ht(this.alphaRegularizer),alphaConstraint:un(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}mj.className="PReLU";ae(mj);let gj=class extends He{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ve(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=_e(e);return yv(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};gj.className="ELU";ae(gj);class xj extends He{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=_e(e);return B(s,ve(qs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}xj.className="ThresholdedReLU";ae(xj);class vj extends He{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new GI().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return K(()=>{let s=_e(e);const r=n.mask;if(r!=null){const i=B(De(Sa(s.shape),ve(r,s.dtype)),st(-1e9));s=ue(s,i)}return this.axis instanceof Array?this.axis.length>1?Ai(De(s,oV(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}vj.className="Softmax";ae(vj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jc(t,e,n){if(typeof t=="number")return $l(t,e);if(t.length!==e)throw new V(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!Dde(r))throw new V(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Ur(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function hi(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+ia([n-e,0]);else if(s==="same")t=t*e;else throw new V(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HI(t,e){return K(()=>(Qt(e),e==="channelsFirst"?Qe(t,[0,2,3,1]):t))}function yj(t,e){return K(()=>(Qt(e),e==="channelsFirst"?Qe(t,[0,2,3,4,1]):t))}function Zfe(t,e,n,s=1,r="valid",i,o=1){return K(()=>{if(i==null&&(i=Yr()),Qt(i),t.shape.length!==3)throw new V(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new V(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new V(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=Qe(t,[0,2,1])),r==="causal")throw new Ve("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=qz(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=ti(a,n)),a})}function NA(t,e,n,s=[1,1],r="valid",i,o,a=null){return K(()=>{if(i==null&&(i=Yr()),Qt(i),t.rank!==3&&t.rank!==4)throw new V(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new V(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=HI(t,i);if(r==="causal")throw new Ve("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=ace({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Qe(l,[0,3,1,2])),l})}function Jfe(t,e,n,s=[1,1,1],r="valid",i,o){return K(()=>{if(i==null&&(i=Yr()),Qt(i),t.rank!==4&&t.rank!==5)throw new V(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new V(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=yj(t,i);if(r==="causal")throw new Ve("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=ooe(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=ti(a,n)),i==="channelsFirst"&&(a=Qe(a,[0,4,1,2,3])),a})}class Av extends He{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Av.verifyArgs(n),this.rank=e,yn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ve(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=jc(n.kernelSize,e,"kernelSize"),this.strides=jc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Ys(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Qt(this.dataFormat),this.activation=aa(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=At(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=hn(n.biasConstraint),this.biasRegularizer=Dt(n.biasRegularizer),this.activityRegularizer=Dt(n.activityRegularizer),this.dilationRate=jc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new V(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new V(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new V(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ui("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!DI(e.kernelSize,"number",1,3))throw new V(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:oa(this.activation),useBias:this.useBias,biasInitializer:Mt(this.biasInitializer),biasRegularizer:ht(this.biasRegularizer),activityRegularizer:ht(this.activityRegularizer),biasConstraint:un(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Pu extends Av{constructor(e,n){super(e,n),this.kernel=null,Pu.verifyArgs(n),this.filters=n.filters,yn(this.filters,"filters"),this.kernelInitializer=At(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=hn(n.kernelConstraint),this.kernelRegularizer=Dt(n.kernelRegularizer)}build(e){e=et(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new V(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return K(()=>{e=_e(e);let s;const r=this.bias==null?null:this.bias.read(),i=mB(this.activation.getClassName());if(i!=null&&this.rank===2)s=NA(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=Zfe(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=NA(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Jfe(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ve("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=et(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=Ur(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Mt(this.kernelInitializer),kernelRegularizer:ht(this.kernelRegularizer),kernelConstraint:un(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new V(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class ip extends Pu{constructor(e){super(2,e),ip.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!DI(e.kernelSize,"number",1,2))throw new V(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}ip.className="Conv2D";ae(ip);class op extends Pu{constructor(e){super(3,e),op.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new V(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}op.className="Conv3D";ae(op);class bj extends ip{constructor(e){if(super(e),this.inputSpec=[new cn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new V(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=et(e),e.length!==4)throw new V("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new V("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new cn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return K(()=>{let s=_e(e);if(s.shape.length!==4)throw new V(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=hi(l,d,u,this.padding),m=hi(c,f,h,this.padding),v=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=Qe(s,[0,2,3,1]));let x=Yz(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=Qe(x,[0,3,1,2])),this.bias!=null&&(x=ti(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=et(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=hi(n[r],l,o,this.padding),n[i]=hi(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}bj.className="Conv2DTranspose";ae(bj);class wj extends op{constructor(e){if(super(e),this.inputSpec=[new cn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new V(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=et(e),e.length!==5)throw new V("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new V("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new cn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return K(()=>{let s=_e(e);if(s.shape.length!==5)throw new V(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],h=r[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],v=this.strides[1],x=this.strides[2],g=hi(c,m,d,this.padding),y=hi(u,v,f,this.padding),b=hi(h,x,p,this.padding),C=[i,g,y,b,this.filters];this.dataFormat!=="channelsLast"&&(s=Qe(s,[0,2,3,4,1]));let S=coe(s,this.kernel.read(),C,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Qe(S,[0,4,1,2,3])),this.bias!==null&&(S=ti(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=et(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],h=this.strides[1],d=this.strides[2];return n[s]=this.filters,n[r]=hi(n[r],u,a,this.padding),n[i]=hi(n[i],h,l,this.padding),n[o]=hi(n[o],d,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}wj.className="Conv3DTranspose";ae(wj);class Cj extends Pu{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new V("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new V("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new V(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=At(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Dt(n.depthwiseRegularizer),this.depthwiseConstraint=hn(n.depthwiseConstraint),this.pointwiseInitializer=At(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Dt(n.pointwiseRegularizer),this.pointwiseConstraint=hn(n.pointwiseConstraint)}build(e){if(e=et(e),e.length<this.rank+2)throw new V(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new V(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new cn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return K(()=>{e=_e(e);let s;if(this.rank===1)throw new Ve("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Qe(e,[0,2,3,1])),s=mV(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ti(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Qe(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Mt(this.depthwiseInitializer),e.pointwiseInitializer=Mt(this.pointwiseInitializer),e.depthwiseRegularizer=ht(this.depthwiseRegularizer),e.pointwiseRegularizer=ht(this.pointwiseRegularizer),e.depthwiseConstraint=un(this.depthwiseConstraint),e.pointwiseConstraint=un(this.pointwiseConstraint),e}}Cj.className="SeparableConv";class Sj extends Cj{constructor(e){super(2,e)}}Sj.className="SeparableConv2D";ae(Sj);class Dv extends Pu{constructor(e){super(1,e),Dv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!DI(e.kernelSize,"number",1,1))throw new V(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Dv.className="Conv1D";ae(Dv);class kj extends He{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return K(()=>{if(e=_e(e),this.dataFormat==="channelsLast"){const s=om(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return om(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=om(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return om(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}kj.className="Cropping2D";ae(kj);class Tj extends He{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Ede(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return K(()=>{let s=_e(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Qe(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?qi.resizeNearestNeighbor(s,[i,o]):qi.resizeBilinear(s,[i,o]);return Qe(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?qi.resizeNearestNeighbor(s,[i,o]):qi.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}Tj.className="UpSampling2D";ae(Tj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function epe(t,e,n=[1,1],s="valid",r,i){return K(()=>{r==null&&(r=Yr()),Qt(r);let o=HI(t,r);if(t.rank!==4)throw new V(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new V(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=NT(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=Qe(o,[0,3,1,2])),o})}class Ij extends Av{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=At(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=hn(e.depthwiseConstraint),this.depthwiseRegularizer=Dt(e.depthwiseRegularizer)}build(e){if(e=et(e),e.length<4)throw new V(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new V(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{e=_e(e);let s=epe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ti(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=et(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Ur(n,this.kernelSize[0],this.padding,this.strides[0]),o=Ur(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Mt(this.depthwiseInitializer),e.depthwiseRegularizer=ht(this.depthwiseRegularizer),e.depthwiseConstraint=un(this.depthwiseRegularizer),e}}Ij.className="DepthwiseConv2D";ae(Ij);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $j(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new V("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function Nj(t,e,n,s=!1,r,i,o=!1,a=!1){return K(()=>{const l=e.shape.length;if(l<3)throw new V(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(qr(2,l));if(e=Qe(e,c),i!=null)throw new Ve("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ve(ve(r,"bool"),"float32"),r.rank===l-1&&(r=as(r,-1)),r=Qe(r,c)),s&&(e=Tl(e,0),r!=null&&(r=Tl(r,0)));const u=[];let h,d=n;const f=e.shape[0],p=Il(e);let m;r!=null&&(m=Il(r));for(let x=0;x<f;++x){const g=p[x],y=K(()=>t(g,d));if(r==null)h=y[0],d=y[1];else{const b=K(()=>{const C=m[x],S=De(wr(C),C),T=ue(B(y[0],C),B(d[0],S)),I=d.map(($,N)=>ue(B(y[1][N],C),B($,S)));return{output:T,newStates:I}});h=b.output,d=b.newStates}a&&u.push(h)}let v;return a&&(v=lo(u,1)),[h,v,d]})}class Ta extends He{constructor(e){super(e);let n;if(e.cell==null)throw new V("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new qI({cells:e.cell}):n=e.cell,n.stateSize==null)throw new V("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new cn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return qr(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){K1(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return K(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ve("Constants support is not implemented in RNN yet.");K1(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new cn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!rt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new V(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new cn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){K(()=>{if(!this.stateful)throw new ci("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new V("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>xn([s,r])):this.states_=[xn([s,this.cell.stateSize])];else if(e==null)Xe(this.states_),this.keptStates!=null&&(Xe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>xn([s,r])):this.states_[0]=xn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new V(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Xe(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!rt(i.shape,a))throw new V(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>Ti(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=$j(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new cn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof _i){const c=[e].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return K(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=_e(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new V(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=Nj((p,m)=>{const v=this.cell.call([p].concat(m),a);return[v[0],v.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],h=c[1],d=c[2];this.stateful&&this.resetStates(d,r);const f=this.returnSequences?h:u;return this.returnState?[f].concat(d):f})}getInitialState(e){return K(()=>{let n=xn(e.shape);return n=Ee(n,[1,2]),n=ep(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?G1(n,[1,s]):n):this.cell.stateSize>1?[G1(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Ta.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=Ji(r,s);return new e(Object.assign(n,{cell:i}))}}Ta.className="RNN";ae(Ta);class _v extends He{}class KI extends _v{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,yn(this.units,"units"),this.activation=aa(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Dt(e.kernelRegularizer),this.recurrentRegularizer=Dt(e.recurrentRegularizer),this.biasRegularizer=Dt(e.biasRegularizer),this.kernelConstraint=hn(e.kernelConstraint),this.recurrentConstraint=hn(e.recurrentConstraint),this.biasConstraint=hn(e.biasConstraint),this.dropout=uu([1,ia([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=uu([1,ia([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=et(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{if(e=e,e.length!==2)throw new V(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>wr(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>wr(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=Ni(B(e,o),this.kernel.read()):i=Ni(e,this.kernel.read()),this.bias!=null&&(i=ti(i,this.bias.read())),a!=null&&(s=B(s,a));let l=ue(i,Ni(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:ht(this.kernelRegularizer),recurrentRegularizer:ht(this.recurrentRegularizer),biasRegularizer:ht(this.biasRegularizer),activityRegularizer:ht(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),recurrentConstraint:un(this.recurrentConstraint),biasConstraint:un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}KI.className="SimpleRNNCell";ae(KI);class Ej extends Ta{constructor(e){e.cell=new KI(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}Ej.className="SimpleRNN";ae(Ej);class XI extends _v{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new V("GRUCell does not support reset_after parameter set to true.");this.units=e.units,yn(this.units,"units"),this.activation=aa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=aa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Dt(e.kernelRegularizer),this.recurrentRegularizer=Dt(e.recurrentRegularizer),this.biasRegularizer=Dt(e.biasRegularizer),this.kernelConstraint=hn(e.kernelConstraint),this.recurrentConstraint=hn(e.recurrentConstraint),this.biasConstraint=hn(e.biasConstraint),this.dropout=uu([1,ia([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=uu([1,ia([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=et(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{if(e=e,e.length!==2)throw new V(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>wr(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>wr(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=B(e,i[0]));let u=Ni(e,this.kernel.read());this.useBias&&(u=ti(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=B(r,o[0]));const h=this.recurrentKernel.read(),[d,f]=js(h,[2*this.units,this.units],h.rank-1),p=Ni(r,d),[m,v,x]=js(u,3,u.rank-1),[g,y]=js(p,2,p.rank-1);a=this.recurrentActivation.apply(ue(m,g)),l=this.recurrentActivation.apply(ue(v,y));const b=Ni(B(l,r),f);c=this.activation.apply(ue(x,b));const C=ue(B(a,r),B(ue(1,Xt(a)),c));return[C,C]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),recurrentActivation:oa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:ht(this.kernelRegularizer),recurrentRegularizer:ht(this.recurrentRegularizer),biasRegularizer:ht(this.biasRegularizer),activityRegularizer:ht(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),recurrentConstraint:un(this.recurrentConstraint),biasConstraint:un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}XI.className="GRUCell";ae(XI);class Rj extends Ta{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new XI(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}Rj.className="GRU";ae(Rj);class Pv extends _v{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,yn(this.units,"units"),this.activation=aa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=aa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Dt(e.kernelRegularizer),this.recurrentRegularizer=Dt(e.recurrentRegularizer),this.biasRegularizer=Dt(e.biasRegularizer),this.kernelConstraint=hn(e.kernelConstraint),this.recurrentConstraint=hn(e.recurrentConstraint),this.biasConstraint=hn(e.biasConstraint),this.dropout=uu([1,ia([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=uu([1,ia([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=et(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends kr{apply(l,c){const u=i.apply([o]),h=new PI().apply([o]),d=i.apply([o*2]);return hA(hA(u,h),d)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return K(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new V(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>wr(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>wr(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,h;0<this.dropout&&this.dropout<1&&(e=B(e,o[0]));let d=Ni(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=B(r,a[0])),d=ue(d,Ni(r,this.recurrentKernel.read())),this.useBias&&(d=ti(d,this.bias.read()));const[f,p,m,v]=js(d,4,d.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=ue(B(c,i),B(l,this.activation.apply(m))),h=this.recurrentActivation.apply(v);const x=B(h,this.activation.apply(u));return[x,x,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),recurrentActivation:oa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ht(this.kernelRegularizer),recurrentRegularizer:ht(this.recurrentRegularizer),biasRegularizer:ht(this.biasRegularizer),activityRegularizer:ht(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),recurrentConstraint:un(this.recurrentConstraint),biasConstraint:un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Pv.className="LSTMCell";ae(Pv);class Aj extends Ta{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Pv(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}Aj.className="LSTM";ae(Aj);class qI extends _v{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return K(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){K1(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{nl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(Ji(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return X1(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}BI(n)}}qI.className="StackedRNNCells";ae(qI);function la(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):CB(e(),n),a=()=>np(o,e,s);return!r||r<=1?Ti(a().clone()):Array(r).fill(void 0).map(a).map(c=>Ti(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var tpe=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class Dj extends Ta{constructor(e){if(e.unroll)throw new Ve("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ve("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new cn({ndim:5})]}call(e,n){return K(()=>{if(this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new V("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return K(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=xn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){K(()=>{if(!this.stateful)throw new ci("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new V("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>xn(i)):this.states_=[xn(i)];else if(e==null)Xe(this.states_),this.keptStates!=null&&(Xe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>xn(i)):this.states_[0]=xn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new V(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Xe(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!rt(l.shape,c))throw new V(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Ti(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],h=Ur(c,r[0],i,o[0],a[0]),d=Ur(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,h,d]:[h,d,s]]}}Dj.className="ConvRNN2D";class YI extends Pv{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,yn(this.filters,"filters"),this.kernelSize=jc(s,2,"kernelSize"),this.kernelSize.forEach(l=>yn(l,"kernelSize")),this.strides=jc(r||1,2,"strides"),this.strides.forEach(l=>yn(l,"strides")),this.padding=i||"valid",Ys(this.padding),this.dataFormat=o||"channelsLast",Qt(this.dataFormat),this.dilationRate=jc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>yn(l,"dilationRate"))}build(e){var n;e=et(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new V(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends kr{apply(d,f){const p=c.apply([u]),m=Sa([u]),v=c.apply([u*2]);return _I([p,m,v])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return K(()=>{if(e.length!==3)throw new V(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=la({ones:()=>wr(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(U,W,X)=>!W||!W[X]?U:B(W[X],U);let u=c(r,l,0),h=c(r,l,1),d=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=la({ones:()=>wr(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(i,p,0),v=c(i,p,1),x=c(i,p,2),g=c(i,p,3);const y=3,[b,C,S,T]=js(this.kernel.read(),a,y),[I,$,N,A]=this.useBias?js(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,b,I,this.padding),h=this.inputConv(h,C,$,this.padding),d=this.inputConv(d,S,N,this.padding),f=this.inputConv(f,T,A,this.padding);const[F,E,R,O]=js(this.recurrentKernel.read(),a,y);m=this.recurrentConv(m,F),v=this.recurrentConv(v,E),x=this.recurrentConv(x,R),g=this.recurrentConv(g,O);const P=this.recurrentActivation.apply(ue(u,m)),z=this.recurrentActivation.apply(ue(h,v)),_=ue(B(z,o),B(P,this.activation.apply(ue(d,x)))),M=B(this.recurrentActivation.apply(ue(f,g)),this.activation.apply(_));return[M,M,_]})}getConfig(){const e=super.getConfig(),n=tpe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const i=Sl(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ti(i,s,this.dataFormat):i}recurrentConv(e,n){return Sl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}YI.className="ConvLSTM2DCell";ae(YI);class _j extends Dj{constructor(e){const n=new YI(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}_j.className="ConvLSTM2D";ae(_j);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QI extends He{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return np(()=>CB(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}QI.className="Dropout";ae(QI);class Pj extends QI{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}Pj.className="SpatialDropout1D";ae(Pj);class Fj extends He{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,yn(this.units,"units"),this.activation=aa(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=hn(e.kernelConstraint),this.biasConstraint=hn(e.biasConstraint),this.kernelRegularizer=Dt(e.kernelRegularizer),this.biasRegularizer=Dt(e.biasRegularizer),this.activityRegularizer=Dt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=et(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=et(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e),r=mB(this.activation.getClassName());let i;return r!=null?i=Ni(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Ni(s,this.kernel.read()),this.bias!=null&&(i=ti(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:oa(this.activation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:ht(this.kernelRegularizer),biasRegularizer:ht(this.biasRegularizer),activityRegularizer:ht(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),biasConstraint:un(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}Fj.className="Dense";ae(Fj);class Oj extends He{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=et(e);for(const n of e.slice(1))if(n==null)throw new V(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Yo(e,1)]}call(e,n){return K(()=>{this.invokeCallHook(e,n);let s=_e(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=Qe(s,r)}return Fde(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}Oj.className="Flatten";ae(Oj);class Mj extends He{constructor(e){super(e),this.supportsMasking=!0,this.activation=aa(e.activation)}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e);return this.activation.apply(s)})}getConfig(){const e={activation:oa(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}Mj.className="Activation";ae(Mj);class Lj extends He{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return K(()=>(e=_e(e),_de(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}Lj.className="RepeatVector";ae(Lj);class zj extends He{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new V("Can only specifiy one unknown dimension.");else i*=c}const a=Yo(e);if(o!==null){if(i===0||a%i!==0)throw new V(s);r[o]=a/i}else if(a!==i)throw new V(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return G(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}zj.className="Reshape";ae(zj);class Vj extends He{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=qr(1,e.dims.length+1);if(!rt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new cn({ndim:this.dims.length+1})]}computeOutputShape(e){e=et(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return Qe(_e(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}Vj.className="Permute";ae(Vj);class Bj extends He{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=_e(e),r=-1;return L1(Hg(s,this.maskValue),r)}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e),r=-1,i=!0,o=L1(Hg(s,this.maskValue),r,i);return B(s,ve(o,s.dtype))})}}Bj.className="Masking";ae(Bj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jj extends He{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ot(e.inputLength))}this.inputDim=e.inputDim,yn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,yn(this.outputDim,"outputDim"),this.embeddingsInitializer=At(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Dt(e.embeddingsRegularizer),this.activityRegularizer=Dt(e.activityRegularizer),this.embeddingsConstraint=hn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return K(()=>this.maskZero?(e=_e(e),Hg(e,Ze(e))):null)}computeOutputShape(e){if(e=et(e),this.inputLength==null)return[...e,this.outputDim];const n=ot(this.inputLength);if(n.length!==e.length-1)throw new V(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new V(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return K(()=>{this.invokeCallHook(e,n);let s=_e(e);s.dtype!=="int32"&&(s=$i(s,"int32"));const r=wB(this.embeddings.read(),G(s,[s.size]));return G(r,et(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Mt(this.embeddingsInitializer),embeddingsRegularizer:ht(this.embeddingsRegularizer),activityRegularizer:ht(this.activityRegularizer),embeddingsConstraint:un(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}jj.className="Embedding";ae(jj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Gl extends He{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ve}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new V("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[et(e)]),e=e,e.length<2)throw new V(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=qo(n),n.length>1)throw new V(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&qo(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return K(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=ia(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=ep(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,h=u[0],d=u.slice(1).concat([h]);let f=G(l,[h].concat(Yo(u.slice(1))));f=Qe(f,[1,0]),f=G(f,d),s.push(f),i=!0}else if(c>1){const u=qr(1,c).concat([0]);s.push(Qe(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],h=[u].concat(l.slice(0,l.length-1));o=G(Qe(G(o,[-1,u]),[1,0]),h)}else if(a>1){const l=[a-1].concat(qr(0,a-1));o=Qe(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=qo(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return K(()=>{if(n==null)return null;if(!Array.isArray(n))throw new V("`mask` should be an Array");if(!Array.isArray(e))throw new V("`inputs` should be an Array");if(n.length!==e.length)throw new V(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:as(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=ao(s,n[r]);return s})}}class Wj extends Gl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ue(n,e[s]);return n})}}Wj.className="Add";ae(Wj);class Uj extends Gl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=B(n,e[s]);return n})}}Uj.className="Multiply";ae(Uj);class Gj extends Gl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ue(n,e[s]);return B(1/e.length,n)})}}Gj.className="Average";ae(Gj);class Hj extends Gl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Ca(n,e[s]);return n})}}Hj.className="Maximum";ae(Hj);class Kj extends Gl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Sd(n,e[s]);return n})}}Kj.className="Minimum";ae(Kj);class Xj extends Gl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new V("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(rt(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new V("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return K(()=>_I(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new V("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new V("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new V("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new V(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return K(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(ve(wr(e[o]),"bool")):n[o].rank<e[o].rank?r.push(as(n[o],-1)):r.push(n[o]);const i=us(r,this.axis);return Xz(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}Xj.className="Concatenate";ae(Xj);function lh(t,e){for(;t<0;)t+=e;return t}function npe(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ve("batchDot is not implemented for tensors of 4D or higher rank yet");if(D(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),D(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ve("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return K(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=G(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=G(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Ee(B(t,e),i[0]):a=Ee(B(Qe(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=nt(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=Xf(a,c)}return a.shape.length===1&&(a=as(a,1)),a})}class qj extends Gl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ve("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new V(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new V(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>lh(i,e[o].shape.length)):r=[lh(this.axes,n.shape.length),lh(this.axes,s.shape.length)],this.normalize&&(n=Jg(n,r[0]),s=Jg(s,r[1])),npe(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[lh(this.axes,e.length),lh(this.axes,n.length)],s}computeOutputShape(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ve("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}qj.className="Dot";ae(qj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Yj extends He{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e);return np(()=>ue($v(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}Yj.className="GaussianNoise";ae(Yj);class Qj extends He{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=_e(e);return this.rate>0&&this.rate<1?np(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return B(s,$v(s.shape,1,i))},()=>s,n.training||!1):s})}}Qj.className="GaussianDropout";ae(Qj);class Zj extends He{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||_e(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return K(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return np(()=>{const i=_e(e),o=1.6732632423543772,a=1.0507009873554805,l=-o*a;let c=Vl(Kf(s),this.rate);c=$i(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,d=ue(B(i,c),B(ue(c,-1),l));return ue(B(d,u),h)},()=>_e(e),n.training||!1)}return e})}}Zj.className="AlphaDropout";ae(Zj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nd(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=Oie(t,e,n,s,r,i);else if(t.rank===3)o=Lie(t,e,n,s,r,i);else if(t.rank===4)o=Vie(t,e,n,s,r,i);else throw new Ve(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function spe(t,e,n,s,r=.001){return K(()=>{const i=FT(t,s),o=i.mean,a=i.variance;return[Nd(t,o,a,n,e,r),o,a]})}function rpe(t,e,n,s,r=.001){return K(()=>{const i=FT(t,s),o=i.mean,a=i.variance,l=[];for(const p of qr(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=G(o,l),u=G(a,l),h=e==null?null:G(e,l),d=n==null?null:G(n,l);return[Nd(t,c,u,d,h,r),o,a]})}function ipe(t,e,n,s,r=.001){return rt(s.slice().sort(),qr(0,t.rank-1))?spe(t,e,n,s,r):rpe(t,e,n,s,r)}class Jj extends He{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=At(e.betaInitializer||"zeros"),this.gammaInitializer=At(e.gammaInitializer||"ones"),this.movingMeanInitializer=At(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=At(e.movingVarianceInitializer||"ones"),this.betaConstraint=hn(e.betaConstraint),this.gammaConstraint=hn(e.gammaConstraint),this.betaRegularizer=Dt(e.betaRegularizer),this.gammaRegularizer=Dt(e.gammaRegularizer)}build(e){e=et(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new V(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new cn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return K(()=>{const s=n.training==null?!1:n.training,r=_e(e),i=r.shape,o=i.length,a=qr(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=$l(1,o);c[l]=i[l];const u=a.slice();u.sort();const h=!rt(u,qr(0,o).slice(0,o-1)),d=()=>{if(h){const g=G(this.movingMean.read(),c),y=G(this.movingVariance.read(),c),b=this.center?G(this.beta.read(),c):null,C=this.scale?G(this.gamma.read(),c):null;return Nd(r,g,y,b,C,this.epsilon)}else return Nd(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return d();const[f,p,m]=ipe(r,this.gamma.read(),this.beta.read(),a,this.epsilon),v=(g,y,b)=>{K(()=>{const C=1-b,S=g.read(),T=B(De(S,y),C);g.write(De(S,T))})};return(()=>{v(this.movingMean,p,this.momentum),v(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Mt(this.betaInitializer),gammaInitializer:Mt(this.gammaInitializer),movingMeanInitializer:Mt(this.movingMeanInitializer),movingVarianceInitializer:Mt(this.movingVarianceInitializer),betaRegularizer:ht(this.betaRegularizer),gammaRegularizer:ht(this.gammaRegularizer),betaConstraint:un(this.betaConstraint),gammaConstraint:un(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}Jj.className="BatchNormalization";ae(Jj);class e4 extends He{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=At(e.betaInitializer||"zeros"),this.gammaInitializer=At(e.gammaInitializer||"ones"),this.betaRegularizer=Dt(e.betaRegularizer),this.gammaRegularizer=Dt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=et(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==qo(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=_e(e),r=s.shape,i=r.length;return K(()=>{let{mean:a,variance:l}=FT(s,this.axis,!0);const c=$l(1,i);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==i?G(m,c):m;let h=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=zr(a,f),l=zr(l,f),h!=null&&(h=zr(h,p)),d!=null&&(d=zr(d,p)),Nd(s,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Mt(this.betaInitializer),gammaInitializer:Mt(this.gammaInitializer),betaRegularizer:ht(this.betaRegularizer),gammaRegularizer:ht(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}e4.className="LayerNormalization";ae(e4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ope(t,e,n){return K(()=>{if(t.rank!==4)throw new V(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new V("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Yr()),n!=="channelsLast"&&n!=="channelsFirst")throw new V(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],OT(t,s)})}class t4 extends He{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Yr():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new V(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new V(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new V(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new cn({ndim:4})]}computeOutputShape(e){e=et(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return K(()=>ope(_e(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}t4.className="ZeroPadding2D";ae(t4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fv(t,e,n,s,r,i){return K(()=>{Qt(r),xB(i),Ys(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Yr()),i==null&&(i="max"),t=HI(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=PT(t,e,n,a):o=kT(t,e,n,a),r==="channelsFirst"&&(o=Qe(o,[0,3,1,2])),o})}function n4(t,e,n,s,r,i){return K(()=>{Qt(r),xB(i),Ys(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Yr()),i==null&&(i="max"),t=yj(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=kae(t,e,n,a):o=Iie(t,e,n,a),r==="channelsFirst"&&(o=Qe(o,[0,4,1,2,3])),o})}class s4 extends He{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new V(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(yn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new V(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);yn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ys(this.padding),this.inputSpec=[new cn({ndim:3})]}computeOutputShape(e){e=et(e);const n=Ur(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return K(()=>{this.invokeCallHook(e,n),e=ep(_e(e),2);const s=this.poolingFunction(_e(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Xf(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class r4 extends s4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Qt(i),Ys(r),Fv(e,n,s,r,i,"max")}}r4.className="MaxPooling1D";ae(r4);class i4 extends s4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Qt(i),Ys(r),Fv(e,n,s,r,i,"avg")}}i4.className="AveragePooling1D";ae(i4);class o4 extends He{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new V(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];yn(this.poolSize,"poolSize"),yn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),Ys(this.padding),this.inputSpec=[new cn({ndim:4})]}computeOutputShape(e){e=et(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Ur(n,this.poolSize[0],this.padding,this.strides[0]),s=Ur(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return K(()=>(this.invokeCallHook(e,n),this.poolingFunction(_e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class a4 extends o4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Qt(i),Ys(r),Fv(e,n,s,r,i,"max")}}a4.className="MaxPooling2D";ae(a4);class l4 extends o4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Qt(i),Ys(r),Fv(e,n,s,r,i,"avg")}}l4.className="AveragePooling2D";ae(l4);class c4 extends He{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new V(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];yn(this.poolSize,"poolSize"),yn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),Ys(this.padding),this.inputSpec=[new cn({ndim:5})]}computeOutputShape(e){e=et(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Ur(n,this.poolSize[0],this.padding,this.strides[0]),s=Ur(s,this.poolSize[1],this.padding,this.strides[1]),r=Ur(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return K(()=>(this.invokeCallHook(e,n),this.poolingFunction(_e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class u4 extends c4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Qt(i),Ys(r),n4(e,n,s,r,i,"max")}}u4.className="MaxPooling3D";ae(u4);class h4 extends c4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Qt(i),Ys(r),n4(e,n,s,r,i,"avg")}}h4.className="AveragePooling3D";ae(h4);class d4 extends He{constructor(e){super(e),this.inputSpec=[new cn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ve}}class f4 extends d4{constructor(e){super(e||{})}call(e,n){return K(()=>{const s=_e(e);return en(s,1)})}}f4.className="GlobalAveragePooling1D";ae(f4);class p4 extends d4{constructor(e){super(e||{})}call(e,n){return K(()=>{const s=_e(e);return Wr(s,1)})}}p4.className="GlobalMaxPooling1D";ae(p4);class m4 extends He{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),this.inputSpec=[new cn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ve}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class g4 extends m4{call(e,n){return K(()=>{const s=_e(e);return this.dataFormat==="channelsLast"?en(s,[1,2]):en(s,[2,3])})}}g4.className="GlobalAveragePooling2D";ae(g4);class x4 extends m4{call(e,n){return K(()=>{const s=_e(e);return this.dataFormat==="channelsLast"?Wr(s,[1,2]):Wr(s,[2,3])})}}x4.className="GlobalMaxPooling2D";ae(x4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class v4 extends He{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=Ji(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class y4 extends v4{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=et(e),e.length<3)throw new V(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=et(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return K(()=>(e=_e(e),Nj((o,a)=>[_e(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}y4.className="TimeDistributed";ae(y4);function ape(t){Ul(Nde,"BidirectionalMergeMode",t)}const lpe="concat";class b4 extends v4{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Ji(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Ji(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?lpe:e.mergeMode,ape(this.mergeMode),e.weights)throw new Ve("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):ls(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=$j(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new V("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(h=>new cn({shape:h.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Ve("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof _i;for(const c of o)if(c instanceof _i!==l)throw new V("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return K(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=Tl(i,1));let a;return this.mergeMode==="concat"?a=_I([r,i]):this.mergeMode==="sum"?a=ue(r,i):this.mergeMode==="ave"?a=B(.5,ue(r,i)):this.mergeMode==="mul"?a=B(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){nl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),nl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Ji(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ve("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}b4.className="Bidirectional";ae(b4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class w4 extends He{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return K(()=>(e=_e(e),e.dtype!=="float32"&&(e=$i(e,"float32")),ue(B(e,this.scale),this.offset)))}}w4.className="Rescaling";ae(w4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:cpe,cropAndResize:upe}=qi;class C4 extends He{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return K(()=>{let c,u=!1;const h=n/o,d=s/a,f=(r+n)/o,p=(i+s)/a,m=[h,d,f,p],v=[];e.rank===3?(u=!0,c=lo([e])):c=e;for(let C=0;C<c.shape[0];C++)v.push(m);const x=Lz(v,[v.length,4]),g=kd(0,v.length,1,"int32"),b=upe(c,x,g,[r,i],"nearest");return $i(u?_e(Il(b)):b,l)})}upsize(e,n,s,r){return K(()=>{const i=cpe(e,[n,s]);return $i(i,r)})}call(e,n){return K(()=>{const s=_e(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=et(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}C4.className="CenterCrop";ae(C4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hpe(t,e,n,s){let r=_e(t);if(r.dtype!=="int32"&&(r=$i(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=as(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=as(r,-1)),r.rank>2)throw new V(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=YR(a,s,n,o):l=YR(a,[],n,o),e!=="tfIdf")return l;if(s)return B(l,s);throw new V("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class S4 extends He{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=et(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return K(()=>{e=_e(e),e.dtype!=="int32"&&(e=$i(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new V(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=_e(n.countWeights)}const r=Wr(e),i=Ug(e),o=qs(this.numTokens,r).bufferSync().get(0),a=Vl(i,0).bufferSync().get(0);if(!(o&&a))throw new V(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return hpe(e,this.outputMode,this.numTokens,s)})}}S4.className="CategoryEncoding";ae(S4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dpe=["bilinear","nearest"],EA=new Set(dpe);class k4 extends He{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(EA.has(e.interpolation))this.interpolation=e.interpolation;else throw new V(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=et(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return K(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return qi.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return qi.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...EA]} are supported`)})}}k4.className="Resizing";ae(k4);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T4{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}T4.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class I4 extends He{constructor(e){super(e),this.randomGenerator=new T4(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}I4.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fpe=["bilinear","nearest"],RA=new Set(fpe);class $4 extends I4{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new V(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new V(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new V(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(RA.has(s))this.interpolation=s;else throw new V(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=et(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return K(()=>{const s=_e(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Kf([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return qi.resizeBilinear(e,o);case"nearest":return qi.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...RA]} are supported`)}})}}$4.className="RandomWidth";ae($4);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe=Y();ppe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var AA;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(AA||(AA={}));var DA;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(DA||(DA={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _A;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(_A||(_A={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Se(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mpe=SV;class Ov extends $k{nextDataId(){return Ov.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new j3(this,ai())}write(e,n,s){this.firstUse&&(this.firstUse=!1,Y().get("IS_NODE")&&Ms(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Xd(s[0])){const i=s.map(o=>Xo(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return co(r,i)}return Bse(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>ra(r));return Ue(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ue(e.shape,e.dtype,n)}makeOutput(e,n,s){return ai().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=os();return e(),{kernelMs:os()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Se([e],"where");const n=this.readSync(e.dataId);return mpe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Ov.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const gpe=t=>{const{x:e}=t.inputs,n=t.backend;Se(e,"abs");let s=new Float32Array(ne(e.shape));const r=n.data.get(e.dataId).values;return s=N4(r),n.makeOutput(s,e.shape,e.dtype)},xpe={kernelName:f0,backendName:"cpu",kernelFunc:gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(t){return(e,n,s,r,i)=>{const o=Me(e,n),a=o.length,l=$e(o),c=ne(o),u=Ln(i,c),h=e.length,d=n.length,f=$e(e),p=$e(n),m=lu(e,o),v=lu(n,o);if(m.length+v.length===0)for(let x=0;x<u.length;++x)u[x]=t(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const g=$u(x,a,l),y=g.slice(-h);m.forEach(T=>y[T]=0);const b=ki(y,h,f),C=g.slice(-d);v.forEach(T=>C[T]=0);const S=ki(C,d,p);u[x]=t(s[b],r[S])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const vpe={kernelName:Vk,backendName:"cpu",kernelFunc:ws};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rx(t,e,n="float32"){if(n==="complex64"){const r=rx(t,e,"float32"),i=rx(t,e,"float32");return ws({inputs:{real:r,imag:i},backend:t})}const s=zn(ne(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const ype={kernelName:gf,backendName:"cpu",kernelFunc:Pi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nl(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const bpe={kernelName:uT,backendName:"cpu",kernelFunc:Nl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=zl([0],n),[i,o]=Zt((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function ca(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Pi({inputs:{x:r},backend:n});const u=rx(n,r.shape,r.dtype),h=ca({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),d=ws({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}if(r.dtype==="complex64"){const u=Nl({inputs:{input:r},backend:n}),h=ca({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),h}if(!G3(r.dtype,i)){const u=Pi({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=E4(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const wpe={kernelName:nf,backendName:"cpu",kernelFunc:ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fn(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;Se([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=o.dtype==="string"?uo(c):c,d=o.dtype==="string"?uo(u):u,f=s||o.dtype,[p,m]=e(o.shape,a.shape,h,d,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=ca({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,m=ca({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(m.dataId),x=v.complexTensorInfos.real,g=v.complexTensorInfos.imag,y=l.data.get(x.dataId).values,b=l.data.get(g.dataId).values,[C,S,T]=n(o.shape,a.shape,f,p,y,b),I=l.makeTensorInfo(T,"float32",C),$=l.makeTensorInfo(T,"float32",S),N=ws({inputs:{real:I,imag:$},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo($),N}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=s||o.dtype,[d,f]=e(o.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,d)}}}function ZI(t){return(e,n,s,r,i,o)=>{const a=Me(e,n),l=ne(a),c=a.length,u=$e(a),h=Ln("float32",l),d=Ln("float32",l),f=lu(e,a),p=lu(n,a),m=co(s,r),v=co(i,o),x=e.length,g=$e(e),y=n.length,b=$e(n);if(f.length+p.length===0)for(let C=0;C<h.length;C++){const S=C%m.length,T=C%v.length,I=t(m[S*2],m[S*2+1],v[T*2],v[T*2+1]);h[C]=I.real,d[C]=I.imag}else for(let C=0;C<h.length;C++){const S=$u(C,c,u),T=S.slice(-x);f.forEach(F=>T[F]=0);const I=ki(T,x,g),$=S.slice(-y);p.forEach(F=>$[F]=0);const N=ki($,y,b),A=t(m[I*2],m[I*2+1],v[N*2],v[N*2+1]);h[C]=A.real,d[C]=A.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R4=Zt((t,e)=>t+e),Cpe=ZI((t,e,n,s)=>({real:t+n,imag:e+s})),hu=fn(Nu,R4,Cpe),Spe={kernelName:Nu,backendName:"cpu",kernelFunc:hu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JI(t,e,n,s,r){const i=ne(s),o=zn(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function A4(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=Ue([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4=Zt((t,e)=>t&e),kpe=fn(zk,D4),Tpe={kernelName:zk,backendName:"cpu",kernelFunc:kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mi(t){return(e,n,s)=>{const r=Kt(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function at(t,e,n){const s=Mi(e);return Ia(t,s,n)}function Ia(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;Se(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=uo(l)}else c=l;const u=n||o.dtype,h=e(c,u,r);return a.makeTensorInfo(o.shape,u,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _4=Mi(t=>Math.ceil(t)),Ipe=Ia(sf,_4),$pe={kernelName:sf,backendName:"cpu",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(t,e,n,s){const r=Kt(n,ne(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=ne(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?uo(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let h=0;h<o.shape[1];++h)r[u+h]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F4=Zt((t,e)=>t===e?1:0),O4=fn(N0,F4,null,"bool"),Npe={kernelName:N0,backendName:"cpu",kernelFunc:O4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M4=Mi(t=>Math.exp(t)),L4=Ia(hf,M4,"float32"),Epe={kernelName:hf,backendName:"cpu",kernelFunc:L4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z4=Mi(t=>Math.expm1(t)),Rpe=Ia(df,z4),Ape={kernelName:df,backendName:"cpu",kernelFunc:Rpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V4=Mi(t=>Math.floor(t)),Dpe=Ia(ff,V4),_pe={kernelName:ff,backendName:"cpu",kernelFunc:Dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B4=Zt((t,e)=>Math.floor(t/e)),Ppe=fn(pf,B4,null,"int32"),Fpe={kernelName:pf,backendName:"cpu",kernelFunc:Ppe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4(t,e,n,s,r,i,o,a,l){const c=Ue([s,i],n);for(let u=0;u<s;u++){const h=[];let d=0;for(let f=0;f<r;f++){const p=t[u*r+f];d+=p*o[f],h.push(p)}if(d<0||d>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(d*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4(t,e,n){const s=Ue(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U4=Zt((t,e)=>t>e?1:0),Ope=fn(D0,U4,null,"bool"),Mpe={kernelName:D0,backendName:"cpu",kernelFunc:Ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4=Zt((t,e)=>t>=e?1:0),Lpe=fn(mf,G4,null,"bool"),zpe={kernelName:mf,backendName:"cpu",kernelFunc:Lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H4=Zt((t,e)=>t<e?1:0),Vpe=fn(P0,H4,null,"bool"),Bpe={kernelName:P0,backendName:"cpu",kernelFunc:Vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K4=Zt((t,e)=>t<=e?1:0),jpe=fn(F0,K4,null,"bool"),Wpe={kernelName:F0,backendName:"cpu",kernelFunc:jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(t,e,n){const s=(e-t)/(n-1),r=zn(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q4=Mi(t=>Math.log(t)),Upe=Ia(bf,q4),Gpe={kernelName:bf,backendName:"cpu",kernelFunc:Upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4(t,e,n,s){const r=Ln(s,ne(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4=Zt((t,e)=>Math.max(t,e)),Hpe=fn(Cf,Q4),Kpe={kernelName:Cf,backendName:"cpu",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z4=Zt((t,e)=>Math.min(t,e)),Xpe=fn(Sf,Z4),qpe={kernelName:Sf,backendName:"cpu",kernelFunc:Xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$=Zt((t,e)=>t*e),Ype=ZI((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),Mv=fn(Tf,e$,Ype),Qpe={kernelName:Tf,backendName:"cpu",kernelFunc:Mv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J4(t,e,n){const s=ya(-1,n);return e$([],e,s,t,n)}function Zpe(t){const{inputs:e,backend:n}=t,{x:s}=e;Se(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=J4(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const Jpe={kernelName:H0,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eW=Zt((t,e)=>t!==e?1:0),eme=fn(K0,eW,null,"bool"),tme={kernelName:K0,backendName:"cpu",kernelFunc:eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$(t,e,n,s,r){const i=e.length,o=ne(e),a=$e(e),l=$e(r),c=Ln(n,ne(r));for(let u=0;u<o;++u){const h=$u(u,i,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[s[p]];const f=ki(d,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;Se(r,"transpose");const o=r.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=r.shape[i[h]];const l=s.data.get(r.dataId).values,c=t$(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const nme={kernelName:zc,backendName:"cpu",kernelFunc:fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(t,e,n,s){const[r,i]=Cn(t,s),o=Rs(e,"int32"),a=zn(ne(r),o),l=ne(i);for(let c=0;c<a.length;++c){const u=c*l;let h=1;for(let d=0;d<l;++d)h*=n[u+d];a[c]=h}return{outVals:a,outShape:r,outDtype:o}}function sme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Se(r,"prod");const a=r.shape.length,l=Ge(i,r.shape),c=Lt(l,a);let u=l,h=r;const d=[];c!=null&&(h=fs({inputs:{x:r},backend:n,attrs:{perm:c}}),d.push(h),u=Yt(u.length,a));const f=n.data.get(h.dataId).values,{outVals:p,outShape:m,outDtype:v}=tW(h.shape,h.dtype,f,u);let x=m;return o&&(x=nn(m,l)),d.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(x,v,p)}const rme={kernelName:J0,backendName:"cpu",kernelFunc:sme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ime(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=$u(r,e.length,$e(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function ome(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function ame(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);ome(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let h=1;h<l+1;++h)a[c].push(h*u)}for(let c=0;c<t.length;++c){let u=t[c],h=t[c]+1;for(let d=0;d<n.length;++d){const f=n[d],p=d+e.length-1;if(p>=0){const m=a[p],v=m[m.length-1]-f[u];for(let x=u;x<h;++x)a[p].push(f[x+1]+v)}u=f[u],h=f[h]}h!==u&&(r.push([u,h]),i+=h-u)}return{outSplits:a,valueSlices:r,numValues:i}}function lme(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Kt("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function PA(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function cme(t,e,n,s,r,i){const o=PA(e,2)[1],a=PA(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let h=0;h<s;++h)r[l*a+h]=t[u*o+h];++l}}function ume(t,e,n,s,r){const i=e.slice();i[0]=r;const o=Kt(n,ne(i)),a=t.length,l=a===0?0:a/e[0];return cme(t,e,s,l,o,i),[o,i]}function nW(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(ime(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:h,numValues:d}=ame(i,o,t,c),f=lme(u),p=ume(n,s,r,h,d);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FA=2147483647;function sW(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let v=1;v<u.length;++v)if(u[v]!==u[v-1])throw new Error("starts, limits, and deltas must have the same shape");const h=u.length===0?1:u[0],d=Kt("int32",h+1);d[0]=0;for(let v=0;v<h;++v){const x=a?t[0]:t[v],g=l?s[0]:s[v],y=c?i[0]:i[v];if(y===0)throw new Error("Requires delta != 0");let b;if(y>0&&g<x||y<0&&g>x)b=0;else if(b=Math.ceil(Math.abs((g-x)/y)),b>FA)throw new Error(`Requires ((limit - start) / delta) <= ${FA}`);d[v+1]=d[v]+b}const f=d[h],p=Kt(n,f);let m=0;for(let v=0;v<h;++v){const x=d[v+1]-d[v];let g=a?t[0]:t[v];const y=c?i[0]:i[v];for(let b=0;b<x;++b)p[m++]=g,g+=y}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var er=Mr;class ix{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=jV(u),this.raggedRank=WV(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===er.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===er.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case er.VALUE_ROWIDS:return ix.getMaxWidthValueRowID(n);case er.ROW_SPLITS:return ix.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${er[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return MA(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;UV(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=BV(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return D(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let h=0;h<c;++h)o.push(u),u+=s;for(let h=0;h<l-c;++h)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const h=e[u];if(h===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case er.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case er.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${er[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case er.FIRST_DIM_SIZE:return e[0];case er.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case er.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${er[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=MA(s,!1),o=Kt(this.valuesDType,ne(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=ne(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;K(()=>{const m=G(u,p);u=jh(m,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(d<f){const v=i.subarray(h*l),x=o.subarray(d*l),g=(f-d)*l;OA(x,v,g)}if(p>=c){const v=s.length;m=Math.floor(v/l)}if(m>f)if(this.defaultValue.length===1)o.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const v=o.slice(f*l);OA(v,u,l),++f}m<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function OA(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function MA(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function rW(t,e,n,s,r,i,o,a,l,c){return new ix(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iW(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return zn(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=zn(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oW=Mi(t=>1/Math.sqrt(t)),hme=Ia(Af,oW),dme={kernelName:Af,backendName:"cpu",kernelFunc:hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ya(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],h=t.values,d=e.values;if(s===0)return Ue(n,e.dtype);const f=l instanceof Nn?l:Ue(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const m=[];let v=0;for(let x=0;x<o;x++){const g=h[p*o+x];m.push(g),v+=g*a[x]}if(v<0||v>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let x=0;x<r;x++)c?f.values[v*r+x]+=d[p*r+x]:f.values[v*r+x]=e.rank===0?d[0]:d[p*r+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme=Mi(t=>1/(1+Math.exp(-t))),aW=at(Of,t=>1/(1+Math.exp(-t))),pme={kernelName:Of,backendName:"cpu",kernelFunc:aW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lW(t,e,n,s,r){const i=lI(s,e,n),o=ne(n),a=$e(s);if(i){const h=cI(e,a);return r==="string"?t.slice(h,h+o):t.subarray(h,h+o)}const l=r==="string"?uo(t):t,c=Ue(s,r,l),u=Ue(n,r);for(let h=0;h<u.size;++h){const d=u.indexToLoc(h),f=d.map((p,m)=>p+e[m]);u.set(c.get(...f),...d)}return r==="string"?uB(u.values):u.values}function El(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;Se(r,"slice");const[a,l]=Cv(r,i,o);oI(r,a,l);const c=n.data.get(r.dataId).values,u=lW(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const mme={kernelName:iv,backendName:"cpu",kernelFunc:El};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(QV(a));const v=Kt(n,0),x=Kt(r,0);return[v,[0,h],x,c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let v=0;v<a;++v){const x=t[v*h];if(x<0)throw new Error(ZV(v,x));if(x>=l)throw new Error(JV(v,x,l));++p[x],d=d&&x>=f,f=x}let m=!0;for(let v=0;v<l;++v){const x=p[v]===0;c[v]=x,m=m&&!x,p[v]=Math.max(p[v],1),v>0&&(p[v]+=p[v-1])}if(m&&d){const v=t,x=s;for(let g=0;g<a;++g)u[g]=g;return[v,[a,h],x,c,u]}else{const v=p[l-1],x=Kt(n,v*h),g=Kt(r,v),y=new Array(l).fill(0);for(let b=0;b<a;++b){const C=t[b*h],S=y[C],T=(C===0?0:p[C-1])+S;y[C]++;for(let I=0;I<h;++I)x[T*h+I]=t[b*h+I];g[T]=s[b],u[b]=T}for(let b=0;b<l;++b)if(y[b]===0){const S=b===0?0:p[b-1];x[S*h+0]=b;for(let T=1;T<h;++T)x[S*h+T]=0;g[S]=o}return[x,[v,h],g,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(t,e,n,s,r){const i=ne(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let v=0;v<a;++v){const x=r[v];if(x===-1){if(u!==-1)throw new Error(eB(u,v));u=v,l.push(1)}else{if(x<0)throw new Error(tB(v,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(nB());const v=Math.trunc(i/c);if(c*v!==i)throw new Error(sB(s,l));l[u]=v}if(ne(l)!==i)throw new Error(rB(s,l));const d=s.length,f=[];if(d>0){f[d-1]=1;for(let v=d-2;v>=0;--v)f[v]=f[v+1]*s[v+1]}const p=[];if(a>0){p[a-1]=1;for(let v=a-2;v>=0;--v)p[v]=p[v+1]*l[v+1]}const m=Kt(n,o*a);for(let v=0;v<o;++v){let x=0;for(let g=0;g<d;++g)x+=t[v*d+g]*f[g];for(let g=0;g<a;++g)m[v*a+g]=Math.trunc(x/p[g]),x%=p[g]}return[m,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],h=a>0?r[a-1]+1:0;if(h<0)throw new Error(W1());const d=e.slice();d[0]=h;const f=d.reduce((y,b)=>y*b,1),p=Kt(n,f);if(a===0)return h>0&&p.fill(o),[p,d];if(h<=0)throw new Error(W1());let m=0,v=1,x=0,g=r[m];for(;;){let y=0;if(v<a){if(y=r[v],g===y){++v;continue}if(g>=y)throw new Error(iB())}if(g<0||g>=h)throw new Error(oB(g,h));g>x&&p.fill(o,x*c,g*c);for(let b=m;b<v;++b){const C=s[b];if(C<0||C>=l[0])throw new Error(aB(b,s[b],l[0]));for(let S=0;S<c;S++)p[g*c+S]+=t[C*c+S]}if(i)for(let b=0;b<c;b++)p[g*c+b]/=v-m;if(m=v,++v,x=g+1,g=y,v>a)break}return x<h&&p.fill(o,x*c,h*c),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme=Mi(t=>Math.sqrt(t)),xme=at(Lf,t=>Math.sqrt(t)),vme={kernelName:Lf,backendName:"cpu",kernelFunc:xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hW=Zt((t,e)=>{const n=t-e;return n*n}),yme=fn(zf,hW),bme={kernelName:zf,backendName:"cpu",kernelFunc:yme};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dW=Mi((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),wme=Ia(pT,dW),Cme={kernelName:pT,backendName:"cpu",kernelFunc:wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(t,e,n,s){const r=Ue(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sme{constructor(e,n,s,r,i,o){this.separator=Xo(e),this.nGramWidths=n,this.leftPad=Xo(s),this.rightPad=Xo(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),h=o-(c+u),d=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let g=0;g<h;++g)f+=e[d+g].length;f+=u*this.rightPad.length;const p=c+u+h-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let v=0;const x=g=>g.forEach(y=>m[v++]=y);for(let g=0;g<c;++g)x(this.leftPad),x(this.separator);for(let g=0;g<h-1;++g)x(e[d+g]),x(this.separator);if(h>0){x(e[d+h-1]);for(let g=0;g<u;++g)x(this.separator),x(this.rightPad)}else{for(let g=0;g<u-1;++g)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=Kt("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(h=>{u+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(e,c,a,u,f,h),u+=f}),this.preserveShort&&u===o[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth,f=1;this.createNGrams(e,c,a,u,f,d)}}return[a,o]}}function pW(t,e,n,s,r,i,o,a){return new Sme(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kme(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function mW(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let d=0;d<s;++d){const f=r.length;kme(t[d],e,n,r);const p=r.length-f;a[d]=p,i+=p,o=Math.max(o,p)}const l=Kt("int32",i*2),c=new Array(i),u=[s,o];let h=0;for(let d=0;d<s;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,c[h]=r[h],++h;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e){const n=Kt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=ore(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xW=Zt((t,e)=>t-e),Tme=ZI((t,e,n,s)=>({real:t-n,imag:e-s})),s$=fn(Vf,xW,Tme),Ime={kernelName:Vf,backendName:"cpu",kernelFunc:s$};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Ue(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ch=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function yW(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(e-l*u/a+h)),f=Math.min(s,Math.floor(e+(a-l)*u/a+h));yW(t,e,d,f)}const r=t[e];let i=n,o=s;for(ic(t,n,e),Ch(t[s],r)>0&&ic(t,n,s);i<o;){for(ic(t,i,o),i++,o--;Ch(t[i],r)<0;)i=i+1;for(;Ch(t[o],r)>0;)o=o-1}Ch(t[n],r)===0?ic(t,n,o):(o=o+1,ic(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function bW(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Ln(n,o*s),c=Ln("int32",o*s);for(let h=0;h<o;h++){const d=h*a,f=t.subarray(d,d+a);let p=new Array(f.length);f.forEach((g,y)=>p[y]={value:g,index:y}),s<p.length&&(yW(p,s),p=p.slice(0,s)),r&&p.sort(Ch);const m=h*s,v=l.subarray(m,m+s),x=c.subarray(m,m+s);for(let g=0;g<s;g++)v[g]=p[g].value,x[g]=p[g].index}const u=e.slice();return u[u.length-1]=s,[Ue(u,n,l),Ue(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(t,e,n,s){const r=Ge(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new Nn(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=t[p].toString();else{const x=[];for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)x.push(l.get(g,p,y));m=x.join(",")}const v=o.get(m);if(v!=null)a[p]=v;else{const x=o.size;o.set(m,x),a[p]=x,c.push(p)}}const h=i.slice();h[1]=o.size;const d=new Nn(h,s);c.forEach((p,m)=>{for(let v=0;v<i[0];v++)for(let x=0;x<i[2];x++)d.set(l.get(v,p,x),v,m,x)});const f=n.slice();return f[r]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $me=Object.freeze(Object.defineProperty({__proto__:null,addImpl:R4,bincountImpl:JI,bincountReduceImpl:A4,bitwiseAndImpl:D4,castImpl:E4,ceilImpl:_4,concatImpl:P4,equalImpl:F4,expImpl:M4,expm1Impl:z4,floorDivImpl:B4,floorImpl:V4,gatherNdImpl:j4,gatherV2Impl:W4,greaterEqualImpl:G4,greaterImpl:U4,lessEqualImpl:K4,lessImpl:H4,linSpaceImpl:X4,logImpl:q4,maxImpl:Y4,maximumImpl:Q4,minimumImpl:Z4,multiplyImpl:e$,negImpl:J4,notEqualImpl:eW,prodImpl:tW,raggedGatherImpl:nW,raggedRangeImpl:sW,raggedTensorToTensorImpl:rW,rangeImpl:iW,rsqrtImpl:oW,scatterImpl:Ya,sigmoidImpl:fme,simpleAbsImpl:N4,sliceImpl:lW,sparseFillEmptyRowsImpl:cW,sparseReshapeImpl:uW,sparseSegmentReductionImpl:n$,sqrtImpl:gme,squaredDifferenceImpl:hW,staticRegexReplaceImpl:dW,stridedSliceImpl:fW,stringNGramsImpl:pW,stringSplitImpl:mW,stringToHashBucketFastImpl:gW,subImpl:xW,tileImpl:vW,topKImpl:bW,transposeImpl:t$,uniqueImpl:wW},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */zz("cpu",()=>new Ov,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CW=at(cf,t=>t>=0?t:Math.exp(t)-1),Nme={kernelName:cf,backendName:"cpu",kernelFunc:CW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;Se([r],"leakyRelu");const o=ne(r.shape),a=n.data.get(r.dataId).values,l=Ln("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const Eme={kernelName:_0,backendName:"cpu",kernelFunc:SW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rme=Zt((t,e)=>t<0?e*t:t);function kW(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Se([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=Rme(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const Ame={kernelName:Z0,backendName:"cpu",kernelFunc:kW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TW=at(Nf,t=>Math.max(0,t)),Dme={kernelName:Nf,backendName:"cpu",kernelFunc:TW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW=at(Ef,t=>Math.min(Math.max(0,t),6)),_me={kernelName:Ef,backendName:"cpu",kernelFunc:IW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ox(t,e,n,s,r){if(n==="linear")return Pi({inputs:{x:e},backend:t});if(n==="relu")return TW({inputs:{x:e},backend:t});if(n==="elu")return CW({inputs:{x:e},backend:t});if(n==="relu6")return IW({inputs:{x:e},backend:t});if(n==="prelu")return kW({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return SW({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return aW({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=ne(r.shape),a=U3(i,o),l=ne(a);D(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const Pme={kernelName:ev,backendName:"cpu",kernelFunc:xt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;Se([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],h=a?i.shape[c-1]:i.shape[c-2],d=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),m=i.shape.slice(0,-2),v=ne(p),x=ne(m),y=Me(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);D(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const b=o?[v,u,d]:[v,d,u],C=a?[x,f,h]:[x,h,f],S=xt({inputs:{x:r},backend:n,attrs:{shape:b}}),T=xt({inputs:{x:i},backend:n,attrs:{shape:C}}),I=o?S.shape[1]:S.shape[2],$=o?S.shape[2]:S.shape[1],N=a?T.shape[1]:T.shape[2],A=Math.max(v,x),F=n.data.get(S.dataId).values,E=n.data.get(T.dataId).values,R=$e(S.shape),O=$e(T.shape),[P,z,_]=o?[R[0],1,R[1]]:[R[0],R[1],1],[M,U,W]=a?[1,O[1],O[0]]:[O[1],1,O[0]],X=$*N,J=Ue([A,$,N],S.dtype),Z=J.values,re=n.blockSize;for(let Q=0;Q<A;Q++){const te=Q%v,le=Q%x;for(let q=0;q<$;q+=re){const ie=Math.min(q+re,$);for(let ce=0;ce<N;ce+=re){const we=Math.min(ce+re,N);for(let se=0;se<I;se+=re){const ye=Math.min(se+re,I);for(let ge=q;ge<ie;ge++)for(let me=ce;me<we;me++){let Ae=0;for(let Fe=se;Fe<ye;Fe++){const it=F[te*P+ge*z+Fe*_],vt=E[Fe*M+me*U+le*W];Ae+=it*vt}Z[Q*X+(ge*N+me)]+=Ae}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(T),n.makeTensorInfo(y,J.dtype,J.values)}const Fme={kernelName:v0,backendName:"cpu",kernelFunc:$W};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ome(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;let d,f,p;const m=[];d=$W({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=hu({inputs:{a:d,b:o},backend:n}),m.push(d),d=f),u&&(p=ox(n,d,u,a,h),m.push(d),d=p);for(const x of m)n.disposeIntermediateTensorInfo(x);return d}const Mme={kernelName:zg,backendName:"cpu",kernelFunc:Ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme=at(qd,t=>Math.acos(t)),zme={kernelName:qd,backendName:"cpu",kernelFunc:Lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vme=at(Yd,t=>Math.acosh(t)),Bme={kernelName:Yd,backendName:"cpu",kernelFunc:Vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n}=t,s=e;Se(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=Ue(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Wme={kernelName:_k,backendName:"cpu",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Se(r,"all");const a=Ge(i,r.shape);let l=a;const c=Lt(l,r.shape.length);let u=r;c!=null&&(u=fs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Yt(l.length,r.shape.length)),Rn("all",l,u.shape.length);const[h,d]=Cn(u.shape,l),f=ne(d),p=zn(ne(h),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const g=x*f;let y=m[g];for(let b=0;b<f;++b){const C=m[g+b];y=y&&C}p[x]=y}c!=null&&n.disposeIntermediateTensorInfo(u);const v=n.makeTensorInfo(h,u.dtype,p);if(o){const x=nn(h,a),g=xt({inputs:{x:v},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(v),g}return v}const Gme={kernelName:Pk,backendName:"cpu",kernelFunc:Ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Se(r,"any");const a=Ge(i,r.shape);let l=a;const c=Lt(l,r.shape.length);let u=r;c!=null&&(u=fs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Yt(l.length,r.shape.length)),Rn("any",l,u.shape.length);const[h,d]=Cn(u.shape,l),f=ne(d),p=zn(ne(h),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const g=x*f;let y=m[g];for(let b=0;b<f;++b){const C=m[g+b];y=y||C}p[x]=y}c!=null&&n.disposeIntermediateTensorInfo(u);const v=n.makeTensorInfo(h,u.dtype,p);if(o){const x=nn(h,a),g=xt({inputs:{x:v},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(v),g}return v}const Kme={kernelName:Fk,backendName:"cpu",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Se(r,"argMax");let o=Ge(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=fs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),o=[o[0]],Rn("argMax",o,l.shape.length);const[u,h]=Cn(l.shape,o),d=ne(u),f=zn(d,"int32"),p=ne(h),m=n.data.get(l.dataId).values;for(let v=0;v<f.length;++v){const x=v*p;let g=m[x],y=0;for(let b=0;b<p;++b){const C=m[x+b];C>g&&(g=C,y=b)}f[v]=y}return c.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(u,"int32",f)}const qme={kernelName:p0,backendName:"cpu",kernelFunc:Xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Se(r,"argMin");let o=Ge(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=fs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),o=[o[0]],Rn("argMin",o,l.shape.length);const[u,h]=Cn(l.shape,o),d=ne(u),f=zn(d,"int32"),p=ne(h),m=n.data.get(l.dataId).values;for(let v=0;v<f.length;++v){const x=v*p;let g=m[x],y=0;for(let b=0;b<p;++b){const C=m[x+b];C<g&&(g=C,y=b)}f[v]=y}return c.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(u,"int32",f)}const Qme={kernelName:m0,backendName:"cpu",kernelFunc:Yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme=at(Qd,t=>Math.asin(t)),Jme={kernelName:Qd,backendName:"cpu",kernelFunc:Zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ege=at(Zd,t=>Math.asinh(t)),tge={kernelName:Zd,backendName:"cpu",kernelFunc:ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nge=at(Jd,t=>Math.atan(t)),sge={kernelName:Jd,backendName:"cpu",kernelFunc:nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rge=Zt((t,e)=>Math.atan2(t,e)),ige=fn(tf,rge),oge={kernelName:tf,backendName:"cpu",kernelFunc:ige};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const age=at(ef,t=>Math.atanh(t)),lge={kernelName:ef,backendName:"cpu",kernelFunc:age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ue(r.outShape,n),v=m.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],g=r.outShape[2]*r.outShape[3],y=r.outShape[3];for(let b=0;b<r.batchSize;++b){const C=b*x,S=b*s[0];for(let T=0;T<r.inChannels;++T)for(let I=0;I<r.outHeight;++I){const $=I*o-d,N=Math.max(0,$),A=Math.min(r.inHeight,u+$),F=C+I*g;for(let E=0;E<r.outWidth;++E){const R=E*a-f,O=Math.max(0,R),P=Math.min(r.inWidth,h+R);let z=p,_=0,M=0;for(let W=N;W<A;W+=l){const X=S+W*s[1];for(let J=O;J<P;J+=c){const Z=X+J*s[2],re=t[Z+T];i==="max"&&re>z?z=re:i==="avg"&&(_+=re,M++)}if(isNaN(z))break}const U=F+E*y+T;v[U]=i==="avg"?_/M:z}}}return m}function NW(t,e,n,s,r=!1,i=!1){const o=Ue(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=Ue(e,n,t);for(let v=0;v<s.batchSize;++v)for(let x=0;x<s.inChannels;++x)for(let g=0;g<s.outHeight;++g){const y=g*a-f;let b=y;for(;b<0;)b+=c;const C=Math.min(s.inHeight,h+y);for(let S=0;S<s.outWidth;++S){const T=S*l-p;let I=T;for(;I<0;)I+=u;const $=Math.min(s.inWidth,d+T);let N=Number.NEGATIVE_INFINITY,A=-1;for(let F=b;F<C;F+=c){const E=F-y;for(let R=I;R<$;R+=u){const O=R-T,P=m.get(v,F,R,x);P>N&&(N=P,r?A=i?((v*s.inHeight+F)*s.inWidth+R)*s.inChannels+x:(F*s.inWidth+R)*s.inChannels+x:A=E*d+O)}}o.set(A,v,g,S,x)}}return o}function EW(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,v=r.padInfo.top,x=r.padInfo.left,g=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=Ue(r.outShape,n),b=y.values,C=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let $=0;$<r.batchSize;++$){const N=$*C,A=$*s[0];for(let F=0;F<r.inChannels;++F)for(let E=0;E<r.outDepth;++E){const R=E*o-m;let O=R;for(;O<0;)O+=c;const P=Math.min(r.inDepth,d+R),z=N+E*S;for(let _=0;_<r.outHeight;++_){const M=_*a-v;let U=M;for(;U<0;)U+=u;const W=Math.min(r.inHeight,f+M),X=z+_*T;for(let J=0;J<r.outWidth;++J){const Z=J*l-x;let re=Z;for(;re<0;)re+=h;const Q=Math.min(r.inWidth,p+Z),te=X+J*I;let le=g,q=0,ie=0;for(let we=O;we<P;we+=c){const se=A+we*s[1];for(let ye=U;ye<W;ye+=u){const ge=se+ye*s[2];for(let me=re;me<Q;me+=h){const Ae=ge+me*s[3],Fe=t[Ae+F];if(i==="max"&&Fe>le?le=Fe:i==="avg"&&(q+=Fe,ie++),isNaN(le))break}if(isNaN(le))break}if(isNaN(le))break}const ce=te+F;b[ce]=i==="avg"?q/Math.max(ie,1):le}}}}return y}function cge(t,e){const n=Ue(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let v=0;v<e.inChannels;++v)for(let x=0;x<e.outDepth;++x){const g=x*s-d;let y=g;for(;y<0;)y+=o;const b=Math.min(e.inDepth,c+g);for(let C=0;C<e.outHeight;++C){const S=C*r-f;let T=S;for(;T<0;)T+=a;const I=Math.min(e.inHeight,u+S);for(let $=0;$<e.outWidth;++$){const N=$*i-p;let A=N;for(;A<0;)A+=l;const F=Math.min(e.inWidth,h+N);let E=Number.NEGATIVE_INFINITY,R=-1;for(let O=y;O<b;O+=o){const P=O-g;for(let z=T;z<I;z+=a){const _=z-S;for(let M=A;M<F;M+=l){const U=M-N,W=t.get(m,O,z,M,v);W>=E&&(E=W,R=P*u*h+_*u+U)}}}n.set(R,m,x,C,$,v)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Se(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Bn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Sr(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&rt(u.inShape,u.outShape))h=Pi({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=$e(r.shape),p=r$(d,r.shape,r.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const hge={kernelName:g0,backendName:"cpu",kernelFunc:uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Se(r,"avgPool3d");const u=po(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=EW(h,r.shape,r.dtype,$e(r.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const fge={kernelName:x0,backendName:"cpu",kernelFunc:dge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Se([r,i],"avgPool3DGrad");const u=po(i.shape,o,a,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,v=u.filterWidth,x=u.dilationDepth,g=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,C=u.effectiveFilterHeight,S=u.effectiveFilterWidth,T=b-1-u.padInfo.front,I=S-1-u.padInfo.left,$=C-1-u.padInfo.top,N=Ue(i.shape,"float32"),A=1/(p*m*v),F=n.bufferSync(r);for(let E=0;E<u.batchSize;++E)for(let R=0;R<u.inChannels;++R)for(let O=0;O<u.inDepth;++O)for(let P=0;P<u.inHeight;++P)for(let z=0;z<u.inWidth;++z){const _=O-T,M=P-$,U=z-I;let W=0;for(let X=0;X<b;X+=x){const J=(_+X)/h;if(!(J<0||J>=u.outDepth||Math.floor(J)!==J))for(let Z=0;Z<C;Z+=g){const re=(M+Z)/d;if(!(re<0||re>=u.outHeight||Math.floor(re)!==re))for(let Q=0;Q<S;Q+=y){const te=(U+Q)/f;if(te<0||te>=u.outWidth||Math.floor(te)!==te)continue;const le=F.get(E,J,re,te,R);W+=le}}}N.set(W*A,E,O,P,z,R)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const mge={kernelName:Mk,backendName:"cpu",kernelFunc:pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Se([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Sr(o.shape,a,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,v=u.dilationWidth,x=u.effectiveFilterHeight,g=u.effectiveFilterWidth,y=g-1-u.padInfo.left,b=x-1-u.padInfo.top,C=Ue(o.shape,"float32"),S=1/(f*p),T=n.data.get(r.dataId).values,I=Ue(r.shape,"float32",T);for(let $=0;$<u.batchSize;++$)for(let N=0;N<u.inChannels;++N)for(let A=0;A<u.inHeight;++A)for(let F=0;F<u.inWidth;++F){const E=A-b,R=F-y;let O=0;for(let P=0;P<x;P+=m){const z=(E+P)/h;if(!(z<0||z>=u.outHeight||Math.floor(z)!==z))for(let _=0;_<g;_+=v){const M=(R+_)/d;if(M<0||M>=u.outWidth||Math.floor(M)!==M)continue;const U=I.get($,z,M,N);O+=U}}C.set(O*S,$,A,F,N)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const xge={kernelName:Ok,backendName:"cpu",kernelFunc:gge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;D(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Se([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),v=p.length,x=f.length,g=d.length,y=h.length;let b=0,C=0,S=0,T=0;for(let I=0;I<u.length;++I)m[I]=p[b++]+(u[I]-h[C++])*f[S++]/Math.sqrt(d[T++]+c),b>=v&&(b=0),C>=y&&(C=0),S>=x&&(S=0),T>=g&&(T=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const yge={kernelName:R0,backendName:"cpu",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;Se([r],"batchToSpaceND");const a=i.reduce((x,g)=>x*g),l=Yf(r.shape,i,a),c=Qf(l.length,i.length),u=Zf(r.shape,i,a),h=pI(o,i.length),d=mI(u,o,i.length),f=xt({inputs:{x:r},backend:n,attrs:{shape:l}}),p=fs({inputs:{x:f},backend:n,attrs:{perm:c}}),m=xt({inputs:{x:p},backend:n,attrs:{shape:u}}),v=El({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),v}const wge={kernelName:y0,backendName:"cpu",kernelFunc:bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=JI(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Sge={kernelName:Lk,backendName:"cpu",kernelFunc:Cge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kge(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=Me(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Tge={kernelName:Y3,backendName:"cpu",kernelFunc:kge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ige=at(rf,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),$ge={kernelName:rf,backendName:"cpu",kernelFunc:Ige};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(ne(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],h=l[c];s[c]=Math.hypot(u,h)}return n.makeOutput(s,e.shape,"float32")},Ege={kernelName:b0,backendName:"cpu",kernelFunc:Nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function du(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Rge={kernelName:nT,backendName:"cpu",kernelFunc:du};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fu(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Ge(r,e[0].shape)[0],o=e.map(m=>m.shape);hI(o,i);let a=Ii(e.map(m=>m.shape),i);if(ne(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>ne(m.shape)>0);if(l.length===1)return Pi({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(b=>Nl({inputs:{input:b},backend:n})),v=l.map(b=>du({inputs:{input:b},backend:n})),x=fu({inputs:m,backend:n,attrs:{axis:i}}),g=fu({inputs:v,backend:n,attrs:{axis:i}}),y=ws({inputs:{real:x,imag:g},backend:n});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),v.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),y}const c=l.map(m=>{const x=[-1,ne(m.shape.slice(i))];return xt({inputs:{x:m},backend:n,attrs:{shape:x}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=Ii(c.map(m=>m.shape),1);const h=c[0].shape[0]===1,d=P4(u,a,e[0].dtype,h),f=Ii(l.map(m=>m.shape),i),p=n.makeTensorInfo(f,e[0].dtype,d);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Age={kernelName:w0,backendName:"cpu",kernelFunc:fu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Se([r,i],"conv2d");const h=mo(l),d=En(r.shape,i.shape,o,c,a,u,!1,h),f=d.filterHeight,p=d.filterWidth,m=d.dilationHeight,v=d.dilationWidth,x=d.padInfo.left,g=d.padInfo.top,y=d.dataFormat==="channelsLast",b=new Nn(d.outShape,r.dtype),C=$e(r.shape),S=$e(i.shape),T=C[0],I=y?C[1]:C[2],$=y?C[2]:1,N=y?1:C[1],A=b.strides[0],F=y?b.strides[1]:b.strides[2],E=y?b.strides[2]:1,R=y?1:b.strides[1],O=n.data.get(r.dataId).values,P=n.data.get(i.dataId).values,z=b.values;for(let _=0;_<d.batchSize;++_){const M=_*T,U=_*A;for(let W=0;W<d.outHeight;++W){const X=U+W*F,J=W*d.strideHeight-g;for(let Z=0;Z<f;++Z){const re=J+Z*m;if(re<0||re>=d.inHeight)continue;const Q=Z*S[0],te=M+re*I;for(let le=0;le<d.outWidth;++le){const q=X+le*E,ie=le*d.strideWidth-x;for(let ce=0;ce<p;++ce){const we=ie+ce*v;if(we<0||we>=d.inWidth)continue;const se=Q+ce*S[1],ye=te+we*$;let ge=se;for(let me=0;me<d.inChannels;++me){const Ae=O[ye+me*N];for(let Fe=0;Fe<d.outChannels;++Fe)z[q+Fe*R]+=Ae*P[ge+Fe];ge+=d.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,z)}const Dge={kernelName:C0,backendName:"cpu",kernelFunc:RW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Se([r,i],"conv2dBackpropFilter");const h=mo(l),d=En(r.shape,u,o,1,a,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:v}=d,x=d.dataFormat==="channelsLast",g=new Nn(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,C=n.data.get(r.dataId).values,S=n.data.get(i.dataId).values,T=new Nn(r.shape,r.dtype,C),I=new Nn(i.shape,i.dtype,S);for(let $=0;$<m;++$){const N=Math.max(0,Math.ceil((b-$)/f)),A=Math.min(d.outHeight,(d.inHeight+b-$)/f);for(let F=0;F<v;++F){const E=Math.max(0,Math.ceil((y-F)/p)),R=Math.min(d.outWidth,(d.inWidth+y-F)/p);for(let O=0;O<d.inChannels;++O)for(let P=0;P<d.outChannels;++P){let z=0;for(let _=0;_<d.batchSize;++_)for(let M=N;M<A;++M){const U=$+M*f-b;for(let W=E;W<R;++W){const X=F+W*p-y;x?z+=T.get(_,U,X,O)*I.get(_,M,W,P):z+=T.get(_,O,U,X)*I.get(_,P,M,W)}}g.set(z,$,F,O,P)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Pge={kernelName:Bk,backendName:"cpu",kernelFunc:_ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Se([r,i],"conv2dBackpropInput");const h=$e(i.shape),d=$e(r.shape);let f=mo(c);const p=En(o,i.shape,a,1,l,u,!1,f),m=new Nn(p.inShape,"float32"),v=m.values,x=n.data.get(r.dataId).values,g=n.data.get(i.dataId).values,[y,b,C]=h,{batchSize:S,filterHeight:T,filterWidth:I,inChannels:$,inHeight:N,inWidth:A,outChannels:F,outHeight:E,outWidth:R,strideHeight:O,strideWidth:P}=p;f=p.dataFormat;const z=T-1-p.padInfo.top,_=I-1-p.padInfo.left,M=f==="channelsLast",U=m.strides[0],W=M?m.strides[1]:m.strides[2],X=M?m.strides[2]:1,J=M?1:m.strides[1],Z=d[0],re=M?d[1]:d[2],Q=M?d[2]:1,te=M?1:d[1];for(let le=0;le<S;++le)for(let q=0;q<$;++q)for(let ie=0;ie<N;++ie){const ce=ie-z,we=Math.max(0,Math.ceil(ce/O)),se=Math.min(E,(T+ce)/O);for(let ye=0;ye<A;++ye){const ge=ye-_,me=Math.max(0,Math.ceil(ge/P)),Ae=Math.min(R,(I+ge)/P);let Fe=0;for(let vt=we;vt<se;++vt){const Dn=vt*O-ce;for(let Ut=me;Ut<Ae;++Ut){const kt=Ut*P-ge,zt=Z*le+re*vt+Q*Ut,_n=y*(T-1-Dn)+b*(I-1-kt)+C*q;for(let dt=0;dt<F;++dt){const Un=x[zt+te*dt],Qs=g[_n+dt];Fe+=Un*Qs}}}const it=U*le+W*ie+X*ye+J*q;v[it]=Fe}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Oge={kernelName:S0,backendName:"cpu",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;Se([r,i],"conv3d");const c=ba(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:v}=c,x=v.front,g=v.left,y=v.top,b=new Nn(c.outShape,r.dtype),C=n.data.get(r.dataId).values,S=n.data.get(i.dataId).values,T=b.values,I=$e(r.shape),$=$e(i.shape);for(let N=0;N<c.batchSize;++N){const A=N*I[0],F=N*b.strides[0];for(let E=0;E<c.outDepth;++E){const R=F+E*b.strides[1],O=E*c.strideDepth-x;for(let P=0;P<u;++P){const z=O+P*f;if(z<0||z>=c.inDepth)continue;const _=P*$[0],M=A+z*I[1];for(let U=0;U<c.outHeight;++U){const W=R+U*b.strides[2],X=U*c.strideHeight-y;for(let J=0;J<h;++J){const Z=X+J*p;if(Z<0||Z>=c.inHeight)continue;const re=_+J*$[1],Q=M+Z*I[2];for(let te=0;te<c.outWidth;++te){const le=W+te*c.outChannels,q=te*c.strideWidth-g;for(let ie=0;ie<d;++ie){const ce=q+ie*m;if(ce<0||ce>=c.inWidth)continue;const we=re+ie*$[2],se=Q+ce*c.inChannels;let ye=we;for(let ge=0;ge<c.inChannels;++ge){const me=C[se+ge];for(let Ae=0;Ae<c.outChannels;++Ae)T[le+Ae]+=me*S[ye+Ae];ye+=c.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Lge={kernelName:k0,backendName:"cpu",kernelFunc:Mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;Se([r,i],"conv3dBackpropFilterV2");const c=$e(r.shape),u=$e(i.shape),h=ba(r.shape,l,o,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,m=h.filterDepth,v=h.filterHeight,x=h.filterWidth,g=new Nn(h.filterShape,"float32"),y=g.values,[b,C,S,T]=g.strides,I=n.data.get(i.dataId).values,[$,N,A,F]=u,E=n.data.get(r.dataId).values,[R,O,P,z]=c,_=h.padInfo.front,M=h.padInfo.left,U=h.padInfo.top;for(let W=0;W<m;++W){const X=Math.max(0,Math.ceil((_-W)/d)),J=Math.min(h.outDepth,(h.inDepth+_-W)/d),Z=W*b;for(let re=0;re<v;++re){const Q=Math.max(0,Math.ceil((U-re)/f)),te=Math.min(h.outHeight,(h.inHeight+U-re)/f),le=re*C+Z;for(let q=0;q<x;++q){const ie=Math.max(0,Math.ceil((M-q)/p)),ce=Math.min(h.outWidth,(h.inWidth+M-q)/p),we=q*S+le;for(let se=0;se<h.inChannels;++se){const ye=se*T+we;for(let ge=0;ge<h.outChannels;++ge){let me=0;for(let Ae=0;Ae<h.batchSize;++Ae){const Fe=Ae*R,it=Ae*$;for(let vt=X;vt<J;++vt){const Ut=(W+vt*d-_)*O+Fe,kt=vt*N+it;for(let zt=Q;zt<te;++zt){const dt=(re+zt*f-U)*P+Ut,Un=zt*A+kt;for(let Qs=ie;Qs<ce;++Qs){const Ne=(q+Qs*p-M)*z+dt,Oe=Qs*F+Un;me+=E[Ne+se]*I[Oe+ge]}}}}y[ye+ge]=me}}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Vge={kernelName:jk,backendName:"cpu",kernelFunc:zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;Se([r],"conv3dBackpropInputV2");const c=$e(r.shape),u=$e(i.shape),h=ba(l,i.shape,a,1,o),d=new Nn(h.inShape,"float32"),f=d.values,[p,m,v,x]=d.strides,g=n.data.get(r.dataId).values,[y,b,C,S]=c,T=n.data.get(i.dataId).values,[I,$,N,A]=u,{batchSize:F,filterDepth:E,filterHeight:R,filterWidth:O,inChannels:P,inDepth:z,inHeight:_,inWidth:M,outChannels:U,outDepth:W,outHeight:X,outWidth:J,strideDepth:Z,strideHeight:re,strideWidth:Q}=h,te=E-1-h.padInfo.front,le=R-1-h.padInfo.top,q=O-1-h.padInfo.left;for(let ie=0;ie<F;++ie)for(let ce=0;ce<P;++ce)for(let we=0;we<z;++we){const se=we-te,ye=Math.max(0,Math.ceil(se/Z)),ge=Math.min(W,(E+se)/Z);for(let me=0;me<_;++me){const Ae=me-le,Fe=Math.max(0,Math.ceil(Ae/re)),it=Math.min(X,(R+Ae)/re);for(let vt=0;vt<M;++vt){const Dn=vt-q,Ut=Math.max(0,Math.ceil(Dn/Q)),kt=Math.min(J,(O+Dn)/Q);let zt=0;for(let _n=ye;_n<ge;++_n){const dt=_n*Z-se;for(let Un=Fe;Un<it;++Un){const Qs=Un*re-Ae;for(let Ir=Ut;Ir<kt;++Ir){const Ne=Ir*Q-Dn,Oe=y*ie+b*_n+C*Un+S*Ir,Ke=I*(E-1-dt)+$*(R-1-Qs)+N*(O-1-Ne)+A*ce;for(let je=0;je<U;++je){const ut=g[Oe+je],Tt=T[Ke+je];zt+=ut*Tt}}}}f[p*ie+m*we+v*me+x*vt+ce]=zt}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const jge={kernelName:Wk,backendName:"cpu",kernelFunc:Bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wge=at(of,t=>Math.cos(t)),Uge={kernelName:of,backendName:"cpu",kernelFunc:Wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gge=at(af,t=>Math.cosh(t)),Hge={kernelName:af,backendName:"cpu",kernelFunc:Gge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kge(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,h,d,f]=r.shape,p=i.shape[0],[m,v]=a,x=Ue([p,m,v,f],"float32"),g=n.data.get(i.dataId).values,y=n.data.get(o.dataId).values,b=n.data.get(r.dataId).values,C=$e(r.shape),S=$e(x.shape);for(let T=0;T<p;T++){const I=T*4,$=g[I],N=g[I+1],A=g[I+2],F=g[I+3],E=y[T];if(E>=u)continue;const R=m>1?(A-$)*(h-1)/(m-1):0,O=v>1?(F-N)*(d-1)/(v-1):0;for(let P=0;P<m;P++){const z=m>1?$*(h-1)+P*R:.5*($+A)*(h-1);if(z<0||z>h-1){for(let _=0;_<v;_++)for(let M=0;M<f;M++){const U=M+_*S[2]+P*S[1]+T*S[0];x.values[U]=c}continue}if(l==="bilinear"){const _=Math.floor(z),M=Math.ceil(z),U=z-_;for(let W=0;W<v;W++){const X=v>1?N*(d-1)+W*O:.5*(N+F)*(d-1);if(X<0||X>d-1){for(let Q=0;Q<f;Q++){const te=Q+W*S[2]+P*S[1]+T*S[0];x.values[te]=c}continue}const J=Math.floor(X),Z=Math.ceil(X),re=X-J;for(let Q=0;Q<f;Q++){let te=Q+J*C[2]+_*C[1]+E*C[0];const le=b[te];te=Q+Z*C[2]+_*C[1]+E*C[0];const q=b[te];te=Q+J*C[2]+M*C[1]+E*C[0];const ie=b[te];te=Q+Z*C[2]+M*C[1]+E*C[0];const ce=b[te],we=le+(q-le)*re,se=ie+(ce-ie)*re;te=Q+W*S[2]+P*S[1]+T*S[0],x.values[te]=we+(se-we)*U}}}else for(let _=0;_<v;++_){const M=v>1?N*(d-1)+_*O:.5*(N+F)*(d-1);if(M<0||M>d-1){for(let X=0;X<f;X++){const J=X+_*S[2]+P*S[1]+T*S[0];x.values[J]=c}continue}const U=Math.round(M),W=Math.round(z);for(let X=0;X<f;X++){const J=X+U*C[2]+W*C[1]+E*C[0],Z=X+_*S[2]+P*S[1]+T*S[0];x.values[Z]=b[J]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Xge={kernelName:Gk,backendName:"cpu",kernelFunc:Kge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Se(r,"cumprod");const l=Lt([i],r.shape.length);let c=r;l!=null&&(c=fs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Yt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=Rs(c.dtype,"int32"),d=Rk(ne(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(x,g)=>x+p-g-1:(x,g)=>x+g;for(let x=0;x<f.length;x+=p)for(let g=0;g<p;g++){const y=m(x,g);if(g===0)d[y]=o?1:f[y];else{const b=m(x,g-1);d[y]=o?f[b]*d[b]:f[y]*d[b]}}const v=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=wa(l),g=fs({inputs:{x:v},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(c),g}return v}const Yge={kernelName:Uk,backendName:"cpu",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Se(r,"cumsum");const l=Lt([i],r.shape.length);let c=r;l!=null&&(c=fs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Yt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=Rs(c.dtype,"int32"),d=zn(ne(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(x,g)=>x+p-g-1:(x,g)=>x+g;for(let x=0;x<f.length;x+=p)for(let g=0;g<p;g++){const y=m(x,g);if(g===0)d[y]=o?0:f[y];else{const b=m(x,g-1);d[y]=o?f[b]+d[b]:f[y]+d[b]}}const v=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=wa(l),g=fs({inputs:{x:v},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(c),g}return v}const Zge={kernelName:T0,backendName:"cpu",kernelFunc:Qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=JI(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=A4(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const exe={kernelName:Hk,backendName:"cpu",kernelFunc:Jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function txe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;D(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],h=l*i,d=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,m=new Float32Array(a*h*d*f);let v=0;for(let x=0;x<a;++x)for(let g=0;g<h;++g){const y=Math.floor(g/i),b=g%i;for(let C=0;C<d;++C){const S=Math.floor(C/i),T=C%i,I=(b*i+T)*f;for(let $=0;$<f;++$){const A=$+I+u*(S+c*(y+l*x));m[v++]=p[A]}}}return n.makeTensorInfo([a,h,d,f],r.dtype,m)}const nxe={kernelName:Kk,backendName:"cpu",kernelFunc:txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;Se([r,i],"depthwiseConv2DNative");const u=$e(r.shape),h=$e(i.shape);let d=l;d==null&&(d=[1,1]),D(Bn(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const f=En(r.shape,i.shape,o,d,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:v,dilationWidth:x,padInfo:g}=f,y=g.left,b=g.top,C=f.outChannels/f.inChannels,S=new Nn(f.outShape,r.dtype),T=n.data.get(r.dataId).values,I=n.data.get(i.dataId).values,$=S.values;for(let N=0;N<f.batchSize;++N){const A=N*u[0],F=N*S.strides[0];for(let E=0;E<f.outHeight;++E){const R=F+E*S.strides[1],O=E*f.strideHeight-b;for(let P=0;P<p;++P){const z=O+P*v;if(z<0||z>=f.inHeight)continue;const _=P*h[0],M=A+z*u[1];for(let U=0;U<f.outWidth;++U){const W=R+U*S.strides[2],X=U*f.strideWidth-y;for(let J=0;J<m;++J){const Z=X+J*x;if(Z<0||Z>=f.inWidth)continue;const re=_+J*h[1],Q=M+Z*f.inChannels;let te=W,le=re;for(let q=0;q<f.inChannels;++q){const ie=T[Q+q];for(let ce=0;ce<C;++ce)$[te+ce]+=ie*I[le+ce];te+=C,le+=C}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const sxe={kernelName:I0,backendName:"cpu",kernelFunc:AW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Se([r,i],"depthwiseConv2dNativeBackpropFilter");const h=En(r.shape,u,o,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:m}=h,v=new Nn(h.filterShape,"float32"),x=h.padInfo.left,g=h.padInfo.top,y=h.outChannels/h.inChannels,b=n.data.get(r.dataId).values,C=new Nn(r.shape,r.dtype,b),S=n.data.get(i.dataId).values,T=new Nn(i.shape,i.dtype,S);for(let I=0;I<p;++I){const $=Math.max(0,Math.ceil((g-I)/d)),N=Math.min(h.outHeight,(h.inHeight+g-I)/d);for(let A=0;A<m;++A){const F=Math.max(0,Math.ceil((x-A)/f)),E=Math.min(h.outWidth,(h.inWidth+x-A)/f);for(let R=0;R<h.outChannels;++R){const O=Math.trunc(R/y),P=R%y;let z=0;for(let _=0;_<h.batchSize;++_)for(let M=$;M<N;++M){const U=I+M*d-g;for(let W=F;W<E;++W){const X=A+W*f-x;z+=C.get(_,U,X,O)*T.get(_,M,W,R)}}v.set(z,I,A,O,P)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const ixe={kernelName:Xk,backendName:"cpu",kernelFunc:rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oxe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Se([r,i],"depthwiseConv2DNativeBackpropInput");const h=$e(r.shape),d=$e(i.shape),f=En(u,i.shape,o,a,l,c,!0),p=new Nn(f.inShape,"float32"),m=p.values,[v,x,g]=p.strides,y=n.data.get(r.dataId).values,[b,C,S]=h,T=n.data.get(i.dataId).values,[I,$,N]=d,{batchSize:A,filterHeight:F,filterWidth:E,inChannels:R,inHeight:O,inWidth:P,outChannels:z,outHeight:_,outWidth:M,strideHeight:U,strideWidth:W}=f,X=F-1-f.padInfo.top,J=E-1-f.padInfo.left,Z=z/R;for(let re=0;re<A;++re)for(let Q=0;Q<R;++Q)for(let te=0;te<O;++te){const le=te-X,q=Math.max(0,Math.ceil(le/U)),ie=Math.min(_,(F+le)/U);for(let ce=0;ce<P;++ce){const we=ce-J,se=Math.max(0,Math.ceil(we/W)),ye=Math.min(M,(E+we)/W);let ge=0;for(let me=q;me<ie;++me){const Ae=me*U-le;for(let Fe=se;Fe<ye;++Fe){const it=Fe*W-we,vt=b*re+C*me+S*Fe,Dn=I*(F-1-Ae)+$*(E-1-it)+N*Q;for(let Ut=0;Ut<Z;++Ut){const kt=Q*Z+Ut,zt=y[vt+kt],_n=T[Dn+Ut];ge+=zt*_n}}}m[v*re+x*te+g*ce+Q]=ge}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const axe={kernelName:qk,backendName:"cpu",kernelFunc:oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lxe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=ne(s.shape),i=n.data.get(s.dataId).values,o=Ue([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const cxe={kernelName:Q3,backendName:"cpu",kernelFunc:lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uxe={kernelName:$0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,h=l.data.get(r.dataId).values,d=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:v,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:C,filterHeight:S,filterWidth:T,dilationHeight:I,dilationWidth:$,outShape:N}=Gf(s.shape,r.shape,i,o,"NHWC",a),A=ne(N),F=N.length,E=Kt(s.dtype,A);for(let O=0;O<f;++O)for(let P=0;P<x;++P){const z=P*b-y.top;for(let _=0;_<g;++_){const M=_*C-y.left;for(let U=0;U<v;++U){let W=Number.MIN_SAFE_INTEGER;for(let J=0;J<S;++J){const Z=z+J*I;if(Z>=0&&Z<p)for(let re=0;re<T;++re){const Q=M+re*$;if(Q>=0&&Q<m){const te=ki([O,Z,Q,U],u,$e(s.shape)),le=ki([J,re,U],d,$e(r.shape)),q=c[te]+h[le];q>W&&(W=q)}}}const X=ki([O,P,_,U],F,$e(N));E[X]=W}}}return{dataId:l.write(zl(E,s.dtype),N,s.dtype),shape:N,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hxe={kernelName:I1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=jr(s.shape,c.data.get(s.dataId).values),h=jr(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:m,outHeight:v,outWidth:x,padInfo:g,strideHeight:y,strideWidth:b,filterHeight:C,filterWidth:S,dilationHeight:T,dilationWidth:I,outShape:$}=Gf(s.shape,r.shape,o,a,"NHWC",l);D(i.rank===$.length,()=>`Error in ${I1}, dy must have the same rank as output ${$.length}, but got ${i.rank}`);const N=jr($,c.data.get(i.dataId).values),A=K3(r.shape,r.dtype);for(let E=0;E<d;++E)for(let R=0;R<v;++R){const O=R*y-g.top;for(let P=0;P<x;++P){const z=P*b-g.left;for(let _=0;_<m;++_){let M=Number.MIN_SAFE_INTEGER,U=0,W=0;for(let X=0;X<C;++X){const J=O+X*T;if(J>=0&&J<f)for(let Z=0;Z<S;++Z){const re=z+Z*I;if(re>=0&&re<p){const Q=u[E][J][re][_]+h[X][Z][_];Q>M&&(M=Q,U=X,W=Z)}}}A[U][W][_]+=N[E][R][P][_]}}}return{dataId:c.write(zl(A,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dxe={kernelName:T1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=jr(s.shape,c.data.get(s.dataId).values),h=jr(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:m,outHeight:v,outWidth:x,padInfo:g,strideHeight:y,strideWidth:b,filterHeight:C,filterWidth:S,dilationHeight:T,dilationWidth:I,outShape:$}=Gf(s.shape,r.shape,o,a,"NHWC",l);D(i.rank===$.length,()=>`Error in ${T1}, dy must have the same rank as output ${$.length}, but got ${i.rank}`);const N=jr($,c.data.get(i.dataId).values),A=K3(s.shape,s.dtype);for(let E=0;E<d;++E)for(let R=0;R<v;++R){const O=R*y-g.top;for(let P=0;P<x;++P){const z=P*b-g.left;for(let _=0;_<m;++_){let M=Number.MIN_SAFE_INTEGER,U=O<0?0:O,W=z<0?0:z;for(let X=0;X<C;++X){const J=O+X*T;if(J>=0&&J<f)for(let Z=0;Z<S;++Z){const re=z+Z*I;if(re>=0&&re<p){const Q=u[E][J][re][_]+h[X][Z][_];Q>M&&(M=Q,U=J,W=re)}}}A[E][U][W][_]+=N[E][R][P][_]}}}return{dataId:c.write(zl(A,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${u} type.`);const[d,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,v=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*d*4);for(let y=0;y<d*f;++y){const b=[0,0,0,255*c];for(let S=0;S<p;S++){const T=m[y*p+S];if(r.dtype==="float32"){if(T<0||T>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${T}.`)}else if(r.dtype==="int32"&&(T<0||T>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${T}.`);p===1?(b[0]=T*v,b[1]=T*v,b[2]=T*v):b[S]=T*v}const C=y*4;x[C+0]=Math.round(b[0]),x[C+1]=Math.round(b[1]),x[C+2]=Math.round(b[2]),x[C+3]=Math.round(b[3])}i.width=f,i.height=d;const g=new ImageData(x,f,d);return h.putImageData(g,0,0),r}const pxe={kernelName:qse,backendName:"cpu",kernelFunc:fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ap(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Se(r,"sum");let a;r.dtype==="bool"?a=ca({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Pi({inputs:{x:r},backend:n});const l=a.shape.length,c=Ge(i,a.shape),u=Lt(c,l);let h=c,d=a;u!=null&&(d=fs({inputs:{x:a},backend:n,attrs:{perm:u}}),h=Yt(h.length,l)),Rn("sum",h,d.shape.length);const[f,p]=Cn(d.shape,h),m=Rs(d.dtype,"int32");let v=rx(n,f,m);const x=ne(p),g=n.data.get(v.dataId).values,y=n.data.get(d.dataId).values;for(let b=0;b<g.length;++b){const C=b*x;let S=0;for(let T=0;T<x;++T)S+=y[C+T];g[b]=S}if(o){const b=nn(v.shape,c),C=v;v=xt({inputs:{x:v},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(d),v}const mxe={kernelName:ov,backendName:"cpu",kernelFunc:ap};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=SI(r,i.length);TI(o.length,l,i);const{path:c,steps:u}=II(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let m=0;m<h;++m){for(const v of u[m]){const{permutationIndices:x,expandDims:g}=kI(f,l[v]);let y;$I(x)?y=i[v]:(y=fs({inputs:{x:i[v]},backend:n,attrs:{perm:x}}),p.push(y));const b=y.shape.slice();for(let C=0;C<g.length;++C)b.splice(g[C],0,1);rt(y.shape,b)||(y=xt({inputs:{x:y},backend:n,attrs:{shape:b}}),p.push(y)),d===null?d=y:(d=Mv({inputs:{a:y,b:d},backend:n}),p.push(d))}m<h-1&&(c[m]>=0&&(d=ap({inputs:{x:d},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const xxe={kernelName:Yk,backendName:"cpu",kernelFunc:gxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Se([s,r],"eluGrad");const i=new Float32Array(ne(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const yxe={kernelName:Qk,backendName:"cpu",kernelFunc:vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bxe=gI,wxe=xI,Cxe=vI,Sxe=yI,kxe=bI,Txe=wI,Ixe=at(uf,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+bxe*n);return e*(1-((((Txe*s+kxe)*s+Sxe)*s+Cxe)*s+wxe)*s*Math.exp(-n*n))}),$xe={kernelName:uf,backendName:"cpu",kernelFunc:Ixe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ax(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(D(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),xt({inputs:{x:r},backend:n,attrs:{shape:a}})}const Nxe={kernelName:E0,backendName:"cpu",kernelFunc:ax};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Exe=Zt((t,e)=>t/e),i$=fn(lf,Exe),eC={kernelName:lf,backendName:"cpu",kernelFunc:i$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=ne(c),h=Ln("float32",u),d=Ln("float32",u);for(let v=0;v<r;v++){const x=El({inputs:{x:a},backend:n,attrs:{begin:[v,0],size:[1,i]}}),g=El({inputs:{x:l},backend:n,attrs:{begin:[v,0],size:[1,i]}}),y=ws({inputs:{real:x,imag:g},backend:n}),{real:b,imag:C}=Rxe(y,e,n),S=co(b,C);for(let T=0;T<i;T++){const I=CI(S,T);h[v*i+T]=I.real,d[v*i+T]=I.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),m=ws({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Rxe(t,e,n){const s=ne(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Axe(s)){const a=tC(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",ya(s,"float32")),d=Pi({inputs:{x:h},backend:n}),f=eC.kernelFunc({inputs:{a:c,b:h},backend:n}),p=eC.kernelFunc({inputs:{a:u,b:d},backend:n}),m=n.data.get(f.dataId).values,v=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:v}}return a}else{const a=co(i,o),l=Dxe(a,s,e);return GV(l)}}function Axe(t){return(t&t-1)===0}function tC(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=co(t,e),o=n/2,a=HV(i),l=a.real,c=a.imag,u=[l.length],h=r.makeTensorInfo(u,"float32",l),d=r.makeTensorInfo(u,"float32",c),f=ws({inputs:{real:h,imag:d},backend:r}),p=KV(i),m=p.real,v=p.imag,x=[m.length],g=r.makeTensorInfo(x,"float32",m),y=r.makeTensorInfo(x,"float32",v),b=ws({inputs:{real:g,imag:y},backend:r}),C=tC(l,c,o,s,r),S=C.real,T=C.imag,I=[S.length],$=r.makeTensorInfo(I,"float32",S),N=r.makeTensorInfo(I,"float32",T),A=ws({inputs:{real:$,imag:N},backend:r}),F=tC(m,v,o,s,r),E=F.real,R=F.imag,O=[E.length],P=r.makeTensorInfo(O,"float32",E),z=r.makeTensorInfo(O,"float32",R),_=ws({inputs:{real:P,imag:z},backend:r}),M=qV(n,s),U=[M.real.length],W=r.makeTensorInfo(U,"float32",M.real),X=r.makeTensorInfo(U,"float32",M.imag),J=ws({inputs:{real:W,imag:X},backend:r}),Z=Mv({inputs:{a:J,b:_},backend:r}),re=hu({inputs:{a:A,b:Z},backend:r}),Q=s$({inputs:{a:A,b:Z},backend:r}),te=Nl({inputs:{input:re},backend:r}),le=Nl({inputs:{input:Q},backend:r}),q=du({inputs:{input:re},backend:r}),ie=du({inputs:{input:Q},backend:r}),ce=fu({inputs:[te,le],backend:r,attrs:{axis:0}}),we=fu({inputs:[q,ie],backend:r,attrs:{axis:0}}),se=r.data.get(ce.dataId).values,ye=r.data.get(we.dataId).values;return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(le),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(we),{real:se,imag:ye}}function Dxe(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=YV(r*a,e,n),c=CI(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),XV(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _xe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ne(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=xt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=DW(a,!1,n),c=xt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Pxe={kernelName:Zk,backendName:"cpu",kernelFunc:_xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Iu(r),a=Kt(o,ne(s));return Oxe(a,r,o),e.makeTensorInfo(s,o,a)}const Fxe={kernelName:Jk,backendName:"cpu",kernelFunc:o$};function Oxe(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mxe={kernelName:eT,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=Ln(s.dtype,ne(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let d=0;d<o;d++){const f=d*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let v=0;v<l;v++){const x=v*c;for(let g=0;g<c;g++){const y=Math.round(l-v-1),b=f+m+x+g;let C=u[b];if(y>=0&&y<l){const S=y*c,T=f+m+S+g;C=u[T]}i[b]=C}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let m=RW({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const v=m;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const x=xt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=hu({inputs:{a:m,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else m=hu({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(v)}if(f){const v=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=xt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=ox(n,m,f,x,p),n.disposeIntermediateTensorInfo(x)}else m=ox(n,m,f,a,p);n.disposeIntermediateTensorInfo(v)}return m}const zxe={kernelName:Vg,backendName:"cpu",kernelFunc:Lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let m=AW({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const v=m;m=hu({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(f){const v=m;m=ox(n,m,f,a,p),n.disposeIntermediateTensorInfo(v)}return m}const Bxe={kernelName:gz,backendName:"cpu",kernelFunc:Vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=ne(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,h]=iI(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const d=n.data.get(r.dataId).values,f=n.bufferSync(s),p=j4(d,f,s.dtype,c,a,u,h,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const Wxe={kernelName:Z3,backendName:"cpu",kernelFunc:jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;Se([r,i],"gatherV2");const l=Ge(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let b=0;b<c.length;++b){const C=c[b];D(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let h=a;a==null&&(h=0);const d=ne(i.shape),f=EI(r,i,l,h),p=xt({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=xt({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),v=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],x=n.bufferSync(m),g=n.bufferSync(p),y=W4(g,x,v);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,y.dtype,y.values)}const Gxe={kernelName:A0,backendName:"cpu",kernelFunc:Uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ne(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=xt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=DW(a,!0,n),c=xt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Kxe={kernelName:tT,backendName:"cpu",kernelFunc:Hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxe=at(xf,t=>Number.isFinite(t)?1:0,"bool"),qxe={kernelName:xf,backendName:"cpu",kernelFunc:Xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yxe=at(vf,t=>Math.abs(t)===1/0?1:0,"bool"),Qxe={kernelName:vf,backendName:"cpu",kernelFunc:Yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zxe=at(yf,t=>Number.isNaN(t)?1:0,"bool"),Jxe={kernelName:yf,backendName:"cpu",kernelFunc:Zxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0e(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=X4(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const t0e={kernelName:J3,backendName:"cpu",kernelFunc:e0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n0e=at(wf,t=>Math.log1p(t)),s0e={kernelName:wf,backendName:"cpu",kernelFunc:n0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r0e=Zt((t,e)=>t&&e),i0e=fn(O0,r0e,null,"bool"),o0e={kernelName:O0,backendName:"cpu",kernelFunc:i0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0e=at(M0,t=>t?0:1,"bool"),l0e={kernelName:M0,backendName:"cpu",kernelFunc:a0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c0e=Zt((t,e)=>t||e),u0e=fn(L0,c0e,null,"bool"),h0e={kernelName:L0,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;Se(r,"LRN");const c=r.shape[3],u=c-1,h=n.data.get(r.dataId).values,d=ne(r.shape),f=new Float32Array(d);function p(m){const v=m%c;let x=m-v+Math.max(0,v-i);const g=m-v+Math.min(v+i,u);let y=0;for(;x<=g;x++){const b=h[x];y+=b*b}return y}for(let m=0;m<d;m++){const v=p(m),x=h[m]*Math.pow(o+a*v,-l);f[m]=x}return n.makeTensorInfo(r.shape,r.dtype,f)}const f0e={kernelName:z0,backendName:"cpu",kernelFunc:d0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Se(o,"LRNGrad");const h=ne(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,v=new Float32Array(h),x=h;for(let g=0;g<x;g++){const y=g%d,b=g-y+Math.max(0,y-a),C=g-y+Math.min(d,y+a+1);let S=0;for(let T=b;T<C;T++)S+=Math.pow(p[T],2);S=c*S+l;for(let T=b;T<C;T++){let I=-2*c*u*p[T]*m[g]/S;g===T&&(I+=Math.pow(S,-u)),I*=f[g],v[T]+=I}}return n.makeTensorInfo(o.shape,r.dtype,v)}const m0e={kernelName:sT,backendName:"cpu",kernelFunc:p0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=Ge(i,l);let h=u;const d=Lt(h,c);let f=a.data.get(r.dataId).values;if(d!=null){const b=new Array(c);for(let C=0;C<b.length;C++)b[C]=l[d[C]];f=t$(f,l,r.dtype,d,b),h=Yt(h.length,c),l=b}Se(r,"max"),Rn("max",h,c);const[p,m]=Cn(l,h),v=ne(m),x=Y4(f,v,p,r.dtype),g=a.write(x,p,r.dtype);let y=p;return o&&(y=nn(p,u)),{dataId:g,shape:y,dtype:r.dtype}}const g0e={kernelName:V0,backendName:"cpu",kernelFunc:_W};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Se(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Bn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Sr(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&rt(u.inShape,u.outShape))h=Pi({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=$e(r.shape),p=r$(d,r.shape,r.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const v0e={kernelName:B0,backendName:"cpu",kernelFunc:x0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Se(r,"maxPool3d");const u=po(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=EW(h,r.shape,r.dtype,$e(r.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const b0e={kernelName:j0,backendName:"cpu",kernelFunc:y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Se([r,i],"maxPool3DGrad");const u=po(i.shape,o,a,1,l,c),h=n.bufferSync(i),d=cge(h,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,v=u.dilationDepth,x=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterDepth,b=u.effectiveFilterHeight,C=u.effectiveFilterWidth,S=y-1-u.padInfo.front,T=C-1-u.padInfo.left,I=b-1-u.padInfo.top,$=Ue(i.shape,"float32"),N=n.bufferSync(r);for(let A=0;A<u.batchSize;++A)for(let F=0;F<u.inChannels;++F)for(let E=0;E<u.inDepth;++E)for(let R=0;R<u.inHeight;++R)for(let O=0;O<u.inWidth;++O){const P=E-S,z=R-I,_=O-T;let M=0;for(let U=0;U<y;U+=v){const W=(P+U)/f;if(!(W<0||W>=u.outDepth||Math.floor(W)!==W))for(let X=0;X<b;X+=x){const J=(z+X)/p;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let Z=0;Z<C;Z+=g){const re=(_+Z)/m;if(re<0||re>=u.outWidth||Math.floor(re)!==re)continue;const Q=y*b*C-1-d.get(A,W,J,re,F),te=U*b*C+X*C+Z,le=Q===te?1:0;if(le===0)continue;const q=N.get(A,W,J,re,F);M+=q*le}}}$.set(M,A,E,R,O,F)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const C0e={kernelName:iT,backendName:"cpu",kernelFunc:w0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Se([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Sr(a.shape,l,c,1,u,h),f=n.data.get(a.dataId).values,p=Ue(d.outShape,a.dtype,NW(f,a.shape,a.dtype,d).values),m=d.strideHeight,v=d.strideWidth,x=d.dilationHeight,g=d.dilationWidth,y=d.effectiveFilterHeight,b=d.effectiveFilterWidth,C=b-1-d.padInfo.left,S=y-1-d.padInfo.top,T=Ue(a.shape,"float32"),I=n.data.get(r.dataId).values,$=Ue(r.shape,"float32",I);for(let N=0;N<d.batchSize;++N)for(let A=0;A<d.inChannels;++A)for(let F=0;F<d.inHeight;++F)for(let E=0;E<d.inWidth;++E){const R=F-S,O=E-C;let P=0;for(let z=0;z<y;z+=x){const _=(R+z)/m;if(!(_<0||_>=d.outHeight||Math.floor(_)!==_))for(let M=0;M<b;M+=g){const U=(O+M)/v;if(U<0||U>=d.outWidth||Math.floor(U)!==U)continue;const W=y*b-1-p.get(N,_,U,A),X=z*b+M,J=W===X?1:0;if(J===0)continue;const Z=$.get(N,_,U,A);P+=Z*J}}T.set(P,N,F,E,A)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const k0e={kernelName:rT,backendName:"cpu",kernelFunc:S0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(t,e,n,s,r){const i=$e(e),o=r$(t,e,n,i,r,"max"),a=NW(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I0e={kernelName:ez,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;Se(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Sr(s.shape,r,i,[1,1],o),[h,d]=T0e(c,s.shape,s.dtype,a,u),f=l.write(h,u.outShape,s.dtype),p=l.write(d,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=Ge(i,r.shape),c=Cn(r.shape,a)[1],u=ne(c),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));h.push(d);const f=ca({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=i$({inputs:{a:f,b:d},backend:n});h.push(p);const m=ap({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),m}const N0e={kernelName:W0,backendName:"cpu",kernelFunc:$0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Se(r,"min");const a=Ge(i,r.shape);let l=a;const c=Lt(l,r.shape.length);let u=r;c!=null&&(u=fs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Yt(l.length,r.shape.length)),Rn("min",l,u.shape.length);const[h,d]=Cn(u.shape,l),f=ne(d),p=zn(ne(h),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const g=x*f;let y=m[g];for(let b=0;b<f;++b){const C=m[g+b];(Number.isNaN(C)||C<y)&&(y=C)}p[x]=y}c!=null&&n.disposeIntermediateTensorInfo(u);const v=n.makeTensorInfo(h,u.dtype,p);if(o){const x=nn(h,a),g=xt({inputs:{x:v},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(v),g}return v}const R0e={kernelName:U0,backendName:"cpu",kernelFunc:E0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;Se(r,"mirrorPad");const a=i.map((y,b)=>y[0]+r.shape[b]+y[1]),l=i.map(y=>y[0]),c=i.map((y,b)=>y[0]+r.shape[b]),u=o==="reflect"?0:1,h=n.data.get(r.dataId).values,d=r.shape.length,f=$e(r.shape),p=ne(a),m=a.length,v=$e(a),x=Ln(r.dtype,p);for(let y=0;y<p;y++){let b=$u(y,m,v);for(let S=0;S<m;S++)b[S]<l[S]?b[S]=l[S]*2-b[S]-u:b[S]>=c[S]&&(b[S]=(c[S]-1)*2-b[S]+u);b=b.map((S,T)=>S-l[T]);const C=ki(b,d,f);x[y]=h[C]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const D0e={kernelName:G0,backendName:"cpu",kernelFunc:A0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _0e=Zt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),P0e=fn(kf,_0e),F0e={kernelName:kf,backendName:"cpu",kernelFunc:P0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Ge([a],r.shape),c=_W({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=nn(c.shape,l),h=xt({inputs:{x:c},backend:n,attrs:{shape:u}}),d=s$({inputs:{a:r,b:h},backend:n}),f=L4({inputs:{x:d},backend:n}),p=ap({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=xt({inputs:{x:p},backend:n,attrs:{shape:u}}),v=i$({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),v}const O0e={kernelName:cv,backendName:"cpu",kernelFunc:PW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;Se(r,"multinomial");const l=a?r:PW({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,i],f=zn(ne(d),"int32");for(let p=0;p<c;++p){const m=p*u,v=new Float32Array(u-1);v[0]=h[m];for(let y=1;y<v.length;++y)v[y]=v[y-1]+h[m+y];const x=GT.alea(o.toString()),g=p*i;for(let y=0;y<i;++y){const b=x();f[g+y]=v.length;for(let C=0;C<v.length;C++)if(b<v[C]){f[g+y]=C;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const L0e={kernelName:tz,backendName:"cpu",kernelFunc:M0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z0e=eI;function V0e(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;Se(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:h}=z0e(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const B0e={kernelName:oT,backendName:"cpu",kernelFunc:V0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j0e=tI;function W0e(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Se(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=j0e(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const U0e={kernelName:aT,backendName:"cpu",kernelFunc:W0e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G0e=nI;function H0e(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Se(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,d=o,f=a,p=l,m=c,{selectedIndices:v,selectedScores:x}=G0e(u,h,d,f,p,m);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const K0e={kernelName:lT,backendName:"cpu",kernelFunc:H0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;Se(r,"oneHot");const c=ne(r.shape),u=new Float32Array(c*o);u.fill(l);const h=n.data.get(r.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<o&&(u[d*o+h[d]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const q0e={kernelName:q0,backendName:"cpu",kernelFunc:X0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Nl({inputs:{input:s},backend:n}),i=lx({inputs:{x:r},backend:n}),o=du({inputs:{input:s},backend:n}),a=lx({inputs:{x:o},backend:n}),l=ws({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return o$({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const Y0e={kernelName:dv,backendName:"cpu",kernelFunc:lx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Nl({inputs:{input:s},backend:n}),i=FW({inputs:{x:r},backend:n}),o=du({inputs:{input:s},backend:n}),a=lx({inputs:{x:o},backend:n}),l=ws({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return o$({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Q0e={kernelName:X0,backendName:"cpu",kernelFunc:FW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return ax({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Ek(i,u.shape,"All tensors passed to stack must have matching shapes"),D(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=ax({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=fu({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const Z0e={kernelName:Y0,backendName:"cpu",kernelFunc:OW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;Se(r,"pad");const a=i.map((g,y)=>g[0]+r.shape[y]+g[1]),l=i.map(g=>g[0]),c=n.data.get(r.dataId).values,u=ne(r.shape),h=r.shape.length,d=$e(r.shape),f=ne(a),p=a.length,m=$e(a),v=Ln(r.dtype,f);o!==0&&v.fill(o);for(let g=0;g<u;g++){const b=$u(g,h,d).map((S,T)=>S+l[T]),C=ki(b,p,m);v[C]=c[g]}return{dataId:n.write(v,a,r.dtype),shape:a,dtype:r.dtype}}const MW={kernelName:Q0,backendName:"cpu",kernelFunc:J0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eve=Zt((t,e)=>Math.pow(t,e)),tve=fn(If,eve),nve={kernelName:If,backendName:"cpu",kernelFunc:tve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,a=r.map(v=>n.data.get(v.dataId).values),l=r.map(v=>v.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[h,d,f]=nW(a,l,c,i.shape,i.dtype,u,o.shape),p=h.map(v=>n.makeTensorInfo([v.length],"int32",v)),m=n.makeTensorInfo(f,i.dtype,d);return p.concat([m])}const rve={kernelName:nz,backendName:"cpu",kernelFunc:sve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=sW(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const ove={kernelName:sz,backendName:"cpu",kernelFunc:ive};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ave(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=a.map(v=>n.data.get(v.dataId).values),f=a.map(v=>v.shape),[p,m]=rW(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,m)}const lve={kernelName:rz,backendName:"cpu",kernelFunc:ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cve(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=iW(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const uve={kernelName:cT,backendName:"cpu",kernelFunc:cve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hve=at($f,t=>1/t),dve={kernelName:$f,backendName:"cpu",kernelFunc:hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Se(r,"resizeBilinear");const l=$e(r.shape),[c,u]=a,[h,d,f,p]=r.shape,m=n.data.get(r.dataId).values,v=new Float32Array(ne([h,c,u,p])),x=[i&&c>1?d-1:d,i&&u>1?f-1:f],g=[i&&c>1?c-1:c,i&&u>1?u-1:u];let y=0;const b=x[0]/g[0],C=x[1]/g[1];for(let S=0;S<h;S++)for(let T=0;T<c;T++){let I;o?I=b*(T+.5)-.5:I=b*T;const $=Math.max(0,Math.floor(I)),N=I-$,A=Math.min(d-1,Math.ceil(I)),F=S*l[0]+$*l[1],E=S*l[0]+A*l[1];for(let R=0;R<u;R++){let O;o?O=C*(R+.5)-.5:O=C*R;const P=Math.max(0,Math.floor(O)),z=O-P,_=Math.min(f-1,Math.ceil(O)),M=F+P*l[2],U=E+P*l[2],W=F+_*l[2],X=E+_*l[2];for(let J=0;J<p;J++){const Z=m[M+J],re=m[U+J],Q=m[W+J],te=m[X+J],le=Z+(Q-Z)*z,q=re+(te-re)*z,ie=le+(q-le)*N;v[y++]=ie}}}return n.makeTensorInfo([h,c,u,p],"float32",v)}const pve={kernelName:nv,backendName:"cpu",kernelFunc:fve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Se([i,r],"resizeBilinearGrad");const a=$e(r.shape),[l,c,u,h]=r.shape,[,d,f]=i.shape,p=new Float32Array(l*c*u*h),m=[o&&d>1?c-1:c,o&&f>1?u-1:u],v=[o&&d>1?d-1:d,o&&f>1?f-1:f],x=m[0]/v[0],g=m[1]/v[1],y=n.data.get(i.dataId).values;let b=0;for(let C=0;C<l;C++){const S=C*a[0];for(let T=0;T<d;T++){const I=T*x,$=Math.floor(I),N=Math.min(Math.ceil(I),c-1),A=S+$*a[1],F=S+N*a[1],E=I-$,R=1-E;for(let O=0;O<f;O++){const P=O*g,z=Math.floor(P),_=Math.min(Math.ceil(P),u-1),M=P-z,U=1-M,W=A+z*a[2],X=A+_*a[2],J=F+z*a[2],Z=F+_*a[2],re=R*U,Q=R*M,te=E*U,le=E*M;for(let q=0;q<h;q++){const ie=y[b++];p[W+q]+=ie*re,p[X+q]+=ie*Q,p[J+q]+=ie*te,p[Z+q]+=ie*le}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}const gve={kernelName:dT,backendName:"cpu",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xve(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Se(r,"resizeNearestNeighbor");const l=$e(r.shape),[c,u]=a,[h,d,f,p]=r.shape,m=n.data.get(r.dataId).values,v=new Float32Array(h*c*u*p),x=[i&&c>1?d-1:d,i&&u>1?f-1:f],g=[i&&c>1?c-1:c,i&&u>1?u-1:u],y=x[0]/g[0],b=x[1]/g[1];let C=0;for(let S=0;S<h;S++){const T=S*l[0];for(let I=0;I<c;I++){const $=o?y*(I+.5):y*I;let N=Math.min(d-1,i?Math.round($):Math.floor($));o&&(N=Math.max(0,N));const A=T+N*l[1];for(let F=0;F<u;F++){const E=o?b*(F+.5):b*F;let R=Math.min(f-1,i?Math.round(E):Math.floor(E));o&&(R=Math.max(0,R));const O=A+R*l[2];for(let P=0;P<p;P++){const z=m[O+P];v[C++]=z}}}}return n.makeTensorInfo([h,c,u,p],r.dtype,v)}const vve={kernelName:tv,backendName:"cpu",kernelFunc:xve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Se([i,r],"resizeNearestNeighborGrad");const a=$e(r.shape),l=$e(i.shape),[c,u,h,d]=r.shape,[,f,p]=i.shape,m=new Float32Array(c*u*h*d),v=n.data.get(i.dataId).values,x=[o&&f>1?u-1:u,o&&p>1?h-1:h],g=[o&&f>1?f-1:f,o&&p>1?p-1:p],y=x[0]/g[0],b=x[1]/g[1],C=1/y,S=1/b,T=Math.ceil(C)*2+2,I=Math.ceil(S)*2+2;for(let $=0;$<c;$++){const N=$*a[0];for(let A=0;A<u;A++){const F=N+A*a[1],E=Math.floor(A*C),R=Math.floor(E-T/2);for(let O=0;O<h;O++){const P=F+O*a[2],z=Math.floor(O*S),_=Math.floor(z-I/2);for(let M=0;M<d;M++){let U=0;for(let W=0;W<T;W++){const X=W+R;if(X<0||X>=f)continue;const J=N+X*l[1],Z=X*y,re=Math.min(u-1,o?Math.round(Z):Math.floor(Z));if(A===re)for(let Q=0;Q<I;Q++){const te=Q+_;if(te<0||te>=p)continue;const le=J+te*l[2],q=te*b,ie=Math.min(h-1,o?Math.round(q):Math.floor(q));O===ie&&(U+=v[le+M])}}m[P+M]=U}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const bve={kernelName:hT,backendName:"cpu",kernelFunc:yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;Se(r,"reverse");const o=r.shape.length,a=Ge(i,r.shape);if(o===0)return Pi({inputs:{x:r},backend:n});const l=new Nn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const h=l.indexToLoc(u),d=h.slice();a.forEach(f=>d[f]=r.shape[f]-1-d[f]),l.set(c.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Cve={kernelName:sv,backendName:"cpu",kernelFunc:wve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sve={kernelName:yT,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=Ln(s.dtype,ne(s.shape)),[c,u,h,d]=s.shape,[f,p]=fI(o,u,h),m=255,v=Math.sin(r),x=Math.cos(r),g=a.data.get(s.dataId).values;for(let b=0;b<c;b++){const C=b*h*u*d;for(let S=0;S<u;S++){const T=S*(h*d);for(let I=0;I<h;I++){const $=I*d;for(let N=0;N<d;N++){const A=[c,S,I,N],F=A[2],E=A[1];let R=(F-f)*x-(E-p)*v,O=(F-f)*v+(E-p)*x;R=Math.round(R+f),O=Math.round(O+p);let P=i;if(typeof i!="number"&&(N===3?P=m:P=i[N]),R>=0&&R<h&&O>=0&&O<u){const _=O*(h*d),M=R*d,U=C+_+M+N;P=g[U]}const z=C+T+$+N;l[z]=P}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kve=at(Rf,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Tve={kernelName:Rf,backendName:"cpu",kernelFunc:kve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ive(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Wl(i,r,o),d=!0,f=n.bufferSync(r),p=n.bufferSync(i),m=Ya(f,p,o,h,c,l,a,u,0,d);return n.makeTensorInfo(o,m.dtype,m.values)}const $ve={kernelName:iz,backendName:"cpu",kernelFunc:Ive};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nve(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function Eve(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function Rve(t,e,n,s,r,i){const o=Kt("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?Nve(l,e[u+c]):Eve(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=Rve(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const Dve={kernelName:az,backendName:"cpu",kernelFunc:Ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ve(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;Se([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=Rs(r.dtype,i.dtype),h=zn(ne(r.shape),u);let d=0;const f=o===0||o>1||r.shape.length===1?1:ne(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(r.shape,u,h)}const Pve={kernelName:rv,backendName:"cpu",kernelFunc:_ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fve=kv,Ove=Tv,Mve=at(Df,t=>t>=0?Ove*t:Fve*(Math.exp(t)-1)),Lve={kernelName:Df,backendName:"cpu",kernelFunc:Mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zve=at(Ff,t=>t<0?-1:t>0?1:0),Vve={kernelName:Ff,backendName:"cpu",kernelFunc:zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bve=at(_f,t=>Math.sin(t)),jve={kernelName:_f,backendName:"cpu",kernelFunc:Bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wve=at(Pf,t=>Math.sinh(t)),Uve={kernelName:Pf,backendName:"cpu",kernelFunc:Wve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gve=11920928955078125e-23,LA=Math.log(Gve)+2,Hve=at(Mf,t=>{const e=t>-LA,n=t<LA,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),Kve={kernelName:Mf,backendName:"cpu",kernelFunc:Hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;Se([r],"spaceToBatchND");const a=ne(i),l=[[0,0]];l.push(...o);for(let S=1+i.length;S<r.shape.length;++S)l.push([0,0]);const c=MW.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=Yf(c.shape,i,a,!1),h=Qf(u.length,i.length,!1),d=Zf(c.shape,i,a,!1),m=xt({inputs:{x:c},backend:n,attrs:{shape:u}}),g=fs({inputs:{x:m},backend:n,attrs:{perm:h}}),C=xt({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),C}const qve={kernelName:av,backendName:"cpu",kernelFunc:Xve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yve(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[h,d,f,p,m]=cW(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(v=>Number(v)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const Qve={kernelName:lz,backendName:"cpu",kernelFunc:Yve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zve(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,h]=uW(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const Jve={kernelName:cz,backendName:"cpu",kernelFunc:Zve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eye(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=n$(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const tye={kernelName:uz,backendName:"cpu",kernelFunc:eye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nye(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=n$(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const sye={kernelName:hz,backendName:"cpu",kernelFunc:nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rye(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Wl(i,r,a),f=!1,p=n.bufferSync(r);let m;switch(i.dtype){case"bool":{const v=n.bufferSync(i),x=!!n.data.get(o.dataId).values[0];m=Ya(p,v,a,d,u,c,l,h,x,f);break}case"float32":{const v=n.bufferSync(i),x=n.data.get(o.dataId).values[0];m=Ya(p,v,a,d,u,c,l,h,x,f);break}case"int32":{const v=n.bufferSync(i),x=n.data.get(o.dataId).values[0];m=Ya(p,v,a,d,u,c,l,h,x,f);break}case"string":{const v=n.bufferSync(i),x=ra(n.data.get(o.dataId).values[0]);m=Ya(p,v,a,d,u,c,l,h,x,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const iye={kernelName:dz,backendName:"cpu",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Ge(o,r.shape)[0],l=NI(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(h=>{const d=[...u];d[a]=h;const f=El({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,f})}const aye={kernelName:lv,backendName:"cpu",kernelFunc:oye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye={kernelName:fT,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Se(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye=at(Uf,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),uye={kernelName:Uf,backendName:"cpu",kernelFunc:cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s;Se(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:v,isSimpleSlice:x,begin:g,end:y,strides:b}=uI(r.shape,i,o,a,l,c,u,h,d);let C;if(m)C=xt({inputs:{x:r},backend:n,attrs:{shape:p}});else if(v||x){D(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const S=aI(g,y,b),T=El({inputs:{x:r},backend:n,attrs:{begin:g,size:S}});C=xt({inputs:{x:T},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(T)}else{const S=n.bufferSync(r),T=fW(f,S,b,g);C=n.makeTensorInfo(p,T.dtype,T.values)}return C}const dye={kernelName:mT,backendName:"cpu",kernelFunc:hye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fye(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,m]=pW(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",m)]}const pye={kernelName:fz,backendName:"cpu",kernelFunc:fye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mye(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,h]=mW(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const gye={kernelName:pz,backendName:"cpu",kernelFunc:mye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xye(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=gW(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const vye={kernelName:mz,backendName:"cpu",kernelFunc:xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye=at(Bf,t=>Math.tan(t)),bye={kernelName:Bf,backendName:"cpu",kernelFunc:yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wye=at(jf,t=>Math.tanh(t)),Cye={kernelName:jf,backendName:"cpu",kernelFunc:wye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=Wl(i,r,s.shape),h=!1,d=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),m=Ya(d,f,s.shape,u,l,a,o,c,p,h);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const kye={kernelName:oz,backendName:"cpu",kernelFunc:Sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;Se(r,"tile");const o=vW(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Iye={kernelName:Wf,backendName:"cpu",kernelFunc:Tye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;Se(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=bW(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const Nye={kernelName:gT,backendName:"cpu",kernelFunc:$ye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eye(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,d,f]=r.shape,[p,m]=c??[h,d],v=[u,p,m,f],x=$e(r.shape),g=x[0],y=x[1],b=x[2],C=$e(v),S=C[0],T=C[1],I=C[2],$=Ln(r.dtype,ne(v));$.fill(l);const N=s.data.get(r.dataId).values,A=s.data.get(i.dataId).values;for(let E=0;E<u;++E){const R=i.shape[0]===1?A:A.subarray(E*8,E*8+8);for(let O=0;O<p;++O)for(let P=0;P<m;++P)for(let z=0;z<f;++z){let _;const M=R[6]*P+R[7]*O+1;if(M===0)continue;const U=(R[0]*P+R[1]*O+R[2])/M,W=(R[3]*P+R[4]*O+R[5])/M,X=zA(U,d,a),J=zA(W,h,a);switch(o){case"nearest":_=Fye(N,h,d,g,y,b,E,J,X,z,l);break;case"bilinear":_=Oye(N,h,d,g,y,b,E,J,X,z,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const Z=E*S+O*T+P*I+z;$[Z]=_}return s.makeTensorInfo(v,r.dtype,$)}return{dataId:s.write($,v,r.dtype),shape:r.shape,dtype:r.dtype}}const Rye={kernelName:xT,backendName:"cpu",kernelFunc:Eye};function zA(t,e,n){switch(n){case"reflect":return Aye(t,e);case"wrap":return Dye(t,e);case"nearest":return Pye(t,e);case"constant":default:return _ye(t)}}function Aye(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return xl(0,n,e-1)}function Dye(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return xl(0,n,e-1)}function _ye(t,e){return t}function Pye(t,e){return xl(0,t,e-1)}function Sh(t,e,n,s,r,i,o,a,l,c,u){const h=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[h]:u}function Fye(t,e,n,s,r,i,o,a,l,c,u){const h=Math.round(a),d=Math.round(l);return Sh(t,e,n,s,r,i,o,h,d,c,u)}function Oye(t,e,n,s,r,i,o,a,l,c,u){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,m=(p-l)*Sh(t,e,n,s,r,i,o,h,d,c,u)+(l-d)*Sh(t,e,n,s,r,i,o,h,p,c,u),v=(p-l)*Sh(t,e,n,s,r,i,o,f,d,c,u)+(l-d)*Sh(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*m+(a-h)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Se(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=wW(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Lye={kernelName:vT,backendName:"cpu",kernelFunc:Mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zye(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),h=r.shape.slice();h[i]=1;const d=new Array(a);for(let f=0;f<d.length;f++){u[i]=f;const p=El({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});d[f]=xt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return d}const Vye={kernelName:uv,backendName:"cpu",kernelFunc:zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;Se(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],h=a-l;let d=i;for(let p=0;p<h;++p){const m=ax({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=m,u.push(m)}for(let p=0;p<o;++p){const m=ya(p,"int32"),v=n.makeTensorInfo([],"int32",m),x=O4({inputs:{a:v,b:d},backend:n}),g=ca({inputs:{x},backend:n,attrs:{dtype:"float32"}}),y=Mv({inputs:{a:g,b:r},backend:n}),b=ap({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});c.push(b),u.push(v),u.push(x),u.push(g),u.push(y),u.push(b)}const f=OW({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const jye={kernelName:hv,backendName:"cpu",kernelFunc:Bye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wye=[Mme,xpe,zme,Bme,Spe,Wme,Gme,Kme,qme,Qme,Jme,tge,sge,oge,lge,hge,fge,mge,xge,Fme,yge,wge,Sge,Tpe,Tge,wpe,$pe,$ge,vpe,Ege,Age,Dge,Pge,Oge,Lge,Vge,jge,Uge,Hge,Xge,Yge,Zge,exe,nxe,sxe,ixe,axe,cxe,uxe,hxe,dxe,pxe,xxe,Nme,yxe,Npe,$xe,Epe,Nxe,Ape,Pxe,Fxe,Mxe,_pe,Fpe,zxe,Bxe,Wxe,Gxe,Mpe,zpe,ype,Kxe,Rge,qxe,Qxe,Jxe,Eme,Bpe,Wpe,t0e,Gpe,s0e,o0e,l0e,h0e,f0e,m0e,g0e,Kpe,v0e,b0e,C0e,k0e,I0e,N0e,R0e,qpe,D0e,F0e,L0e,Qpe,Jpe,B0e,U0e,K0e,tme,q0e,Q0e,Z0e,MW,nve,Ame,rme,rve,ove,lve,uve,bpe,eC,dve,Dme,_me,Pme,pve,gve,vve,bve,Cve,Sve,Tve,dme,$ve,Dve,Pve,Lve,pme,Vve,jve,Uve,mme,O0e,Kve,qve,Qve,Jve,tye,sye,iye,aye,vme,lye,bme,Cme,uye,dye,pye,gye,vye,Ime,mxe,bye,Cye,kye,Iye,Nye,Rye,nme,Lye,Vye,jye,Y0e];for(const t of Wye)xz(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ja={},lm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Uye(t,e){ja[t]=e}function Qr(t,e){if(!(t in ja)||e!=null){const s=Hye(t,e);if(s!==null)ja[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=ja[t];return n==null||n.isContextLost()?(delete ja[t],Qr(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ja[t])}function Gye(t){if(!Y().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Hye(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Gye(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete ja[t]},!1),Y().getBool("SOFTWARE_WEBGL_ENABLED")&&(lm.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",lm)||n.getContext("experimental-webgl",lm):n.getContext("webgl2",lm)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ed;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Ed||(Ed={}));var zs;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(zs||(zs={}));var In;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(In||(In={}));function lp(t,e){return[e,t]}function Kye(t,e){return t*e}function cm(t){const e=ne(t),n=Math.ceil(e/4);return w1(n)}function Fu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Xye(t,e){const[n,s]=Fu(t,e);return n*s*4}function a$(t,e){const n=t;let s,r,i,o,a,l,c,u,h,d;return Y().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,h=e!=null?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xe(t,e){const n=e();return Y().getBool("DEBUG")&&qye(t),n}function qye(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Jye(t,e))}const Yye=596e-10,Qye=65504;function Zye(t){return!!(Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Yye<Math.abs(t)&&Math.abs(t)<Qye)}function Jye(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function um(t,e){return go(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function ebe(t,e){const n=go(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(xe(t,()=>t.shaderSource(n,e)),xe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function tbe(t,e){const n=go(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(xe(t,()=>t.shaderSource(n,e)),xe(t,()=>t.compileShader(n)),Y().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw LW(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const nbe=/ERROR: [0-9]+:([0-9]+):/g;function LW(t,e){const n=nbe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((h,d)=>Lc((d+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Lc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function sbe(t){return go(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function rbe(t,e){if(xe(t,()=>t.linkProgram(e)),!Y().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function wb(t,e){if(xe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ibe(t,e){const n=go(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),xe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function obe(t,e){const n=go(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return xe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),xe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function abe(t){return go(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function lbe(t,e){const n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function cbe(t){return go(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function VA(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),xe(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),xe(t,()=>t.enableVertexAttribArray(a)),!0)}function ube(t,e,n){mbe(t,n),xe(t,()=>t.activeTexture(t.TEXTURE0+n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function hbe(t,e,n){return go(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function dbe(t,e,n){return t.getUniformLocation(e,n)}function fbe(t,e,n,s){xe(t,()=>ube(t,e,s)),xe(t,()=>t.uniform1i(n,s))}function Cb(t,e,n){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),xe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function BA(t,e){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),xe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function hm(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+pbe(t,e))}function pbe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function go(t,e,n){const s=xe(t,()=>e());if(s==null)throw new Error(n);return s}function mbe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function pu(t,e=2){return ne(t.slice(0,t.length-e))}function mu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function dm(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[pu(t),...mu(t)]),e}function gbe(t,e=!1){let n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=Y().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&Y().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?Nk(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=va(t).newShape);let r=ne(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=pu(t);let l=2,c=2;t.length&&([l,c]=mu(t)),r=a*(l/2)*(c/2),i=w1(r).map(u=>u*2)}else i=w1(r);return i}function fm(t){return t%2===0}function cx(t,e){if(t=t.slice(-2),e=e.slice(-2),rt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||fm(n)&&fm(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&fm(t[0])&&fm(e[0])}let Sb,kb;function xbe(t){if(Sb==null){const e=Qr(t);Sb=e.getParameter(e.MAX_TEXTURE_SIZE)}return Sb}function vbe(t){if(kb==null){const e=Qr(t);kb=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,kb)}function ybe(t){if(t===0)return 0;let e;const n=Qr(t);return pr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:pr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function pr(t,e){return t.getExtension(e)!=null}function jA(t){try{if(Qr(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function bbe(t){if(t===0)return!1;const e=Qr(t);if(t===1){if(!pr(e,"OES_texture_float"))return!1}else if(!pr(e,"EXT_color_buffer_float"))return!1;return nC(e)}function wbe(t){if(t===0)return!1;const e=Qr(t);if(t===1){if(!pr(e,"OES_texture_float")||!pr(e,"WEBGL_color_buffer_float"))return!1}else{if(pr(e,"EXT_color_buffer_float"))return nC(e);const s="EXT_color_buffer_half_float";if(pr(e,s)){const r=e.getExtension(s);return Cbe(e,r)}return!1}return nC(e)}function nC(t){const e=a$(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const s=1,r=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,s,r,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Cbe(t,e){const n=a$(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=1,i=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,r,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function Sbe(t){return t!==2?!1:Qr(t).fenceSync!=null}function cp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ke=Y();ke.registerFlag("HAS_WEBGL",()=>ke.getNumber("WEBGL_VERSION")>0);ke.registerFlag("WEBGL_VERSION",()=>jA(2)?2:jA(1)?1:0);ke.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ke.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ke.get("WEBGL_VERSION")===2);ke.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ke.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ke.registerFlag("WEBGL_PACK",()=>ke.getBool("HAS_WEBGL"));ke.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_CLIP",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_REDUCE",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_LAZILY_UNPACK",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_CONV_IM2COL",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>ke.getBool("WEBGL_PACK"));ke.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>xbe(ke.getNumber("WEBGL_VERSION")));ke.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>vbe(ke.getNumber("WEBGL_VERSION")));ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=ke.getNumber("WEBGL_VERSION");return t===0?0:ybe(t)});ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ke.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Pz());ke.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>bbe(ke.getNumber("WEBGL_VERSION")));ke.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ke.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ke.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ke.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>wbe(ke.getNumber("WEBGL_VERSION")));ke.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Sbe(ke.getNumber("WEBGL_VERSION")));ke.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ke.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ke.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});ke.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Pz()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});ke.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ke.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ke.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ke.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ke.registerFlag("WEBGL_EXP_CONV",()=>!1);ke.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ke.getBool("IS_TEST"));ke.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ke.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ke.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);ke.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ns(){let t,e,n,s,r,i,o,a,l,c;return Y().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=Y().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hl(t,e,n="index"){const s=$e(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function Lv(t,e,n="index"){const s=$e(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function kbe(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function Tbe(t,e,n="index"){const s=t.map((i,o)=>o),r=kbe(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function l$(t){const e=$e(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function c$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const zW=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:VW}=mue;function Ibe(t,e,n){const s=[];if(t.forEach(f=>{const p=ne(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=u$(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>$be(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=ns(),l=Rbe(a);let c,u,h=_be(a);return e.isPacked?(c=Nbe(e.logicalShape,o,n.enableShapeUniforms),u=Dbe(a)):(c=Ebe(e.logicalShape,o,n.enableShapeUniforms),u=Abe(a)),n.packedInputs&&(h+=Mbe),[h,l,u,r,c,i,n.userCode].join(`
`)}function Ou(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return qbe(t,e);case 1:return Qbe(t,e);case 2:return Jbe(t,e);case 3:return twe(t,e);case 4:return swe(t,e);case 5:return rwe(t);case 6:return iwe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function BW(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Xbe(t);case 1:return Ybe(t,e);case 2:return Zbe(t,e);case 3:return ewe(t,e);default:return nwe(t,e)}}function $be(t,e,n=!1,s){let r="";n?r+=BW(t,s):r+=Ou(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=owe(t,e):r+=awe(t,e)),r}function Nbe(t,e,n){switch(t.length){case 0:return jW();case 1:return Lbe(t,e,n);case 2:return Hbe(t,e,n);case 3:return Vbe(t,e,n);default:return jbe(t,e,n)}}function Ebe(t,e,n){switch(t.length){case 0:return jW();case 1:return zbe(t,e,n);case 2:return Kbe(t,e,n);case 3:return Bbe(t,e,n);case 4:return Wbe(t,e,n);case 5:return Ube(t,e);case 6:return Gbe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Rbe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Abe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Dbe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function _be(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Pbe}
    ${Fbe}
    ${Obe}
  `}const Pbe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Fbe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Obe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Mbe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function jW(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Lbe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function zbe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Vbe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Bbe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Lv(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Hl(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function jbe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Wbe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Lv(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Hl(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Ube(t,e){const n=Hl(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Gbe(t,e){const n=Hl(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Hbe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(rt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Kbe(t,e,n){return rt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Kl(t){return`offset${t}`}function Xbe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=ns();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function qbe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Kl(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function Ybe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=ns();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function Qbe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Mu(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Kl(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function Zbe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=ns();if(i!=null&&rt(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Jbe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&rt(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const d=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=va(n),l=o;if(l.length<n.length){const d=Lu(t,l),f=["row","col"];return`
      ${Ou(d,e)}
      float ${r}(int row, int col) {
        return ${r}(${zu(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Mu(t)}
      }
    `;const c=i[0],u=i[1],h=Kl(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function ewe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],p=Lu(t,d),m=["b","row","col"];return`
        ${BW(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${zu(m,f)});
        }
      `}const a=ns();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function twe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=va(n),c=a;if(c.length<n.length){const m=Lu(t,c),v=["row","col","depth"];return`
        ${Ou(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${zu(v,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Mu(t)}
      }
    `;const u=t.shapeInfo.texShape,h=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(d===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Kl(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${s}, uv);
      }
  `}function nwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=ns();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let m=2;m<o-1;m++)f=`int b${m}, `+f,d*=i[o-m-1],p=`b${m} * ${d} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function swe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=va(n);if(l.length<n.length){const g=Lu(t,l),y=["row","col","depth","depth2"];return`
      ${Ou(g,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${zu(y,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Mu(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=Kl(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function rwe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=va(e);if(l.length<e.length){const m=Lu(t,l),v=["row","col","depth","depth2","depth3"];return`
      ${Ou(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${zu(v,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${Mu(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Kl(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function iwe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=va(e);if(r.length<e.length){const v=Lu(t,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${Ou(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${zu(x,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Mu(t)}
      }
    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Kl(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Mu(t){const e=t.name,n=ne(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function owe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=VW(t.shapeInfo.logicalShape,e.logicalShape),l=ct(o),c=o-i;let u;const h=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(g=>`coords.${h[g+c]} = 0;`).join(`
`);let d="";o<2&&i>0?d="coords":d=t.shapeInfo.logicalShape.map((g,y)=>`coords.${h[y+c]}`).join(", ");let f="return outputValue;";const m=ne(t.shapeInfo.logicalShape)===1,x=ne(e.logicalShape)===1;if(i===1&&!m&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!x)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const g=i-2,y=i-1;a.indexOf(g)>-1&&a.indexOf(y)>-1?f="return vec4(outputValue.x);":a.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(y)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${d});
      ${f}
    }
  `}function awe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&rt(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=ct(l),u=VW(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(m=>`coords.${f[m+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,v)=>`coords.${f[v+h]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${s}(${p});
    }
  `}function ct(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function u$(t,e,n){const{newShape:s,keptDims:r}=va(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!rt(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function Lu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function zu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(t,e,n,s){const r=n.map((u,h)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Ibe(r,o,e),l=tbe(t.gl,a),c=t.createProgram(l);return Y().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},WW(t,e,c)))}function WW(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),Y().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of e.variableNames){const d={name:h,uniform:t.getUniformLocation(n,h,u),offset:t.getUniformLocation(n,`offset${h}`,u)};e.enableShapeUniforms&&(d.shape=t.getUniformLocation(n,`${h}Shape`,u),d.texShape=t.getUniformLocation(n,`${h}TexShape`,u)),s.push(d)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const h of e.customUniforms)r.push(t.getUniformLocation(n,h.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function WA(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!rt(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!rt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function cwe(t,e,n,s,r){e.program.enableShapeUniforms||(WA(e.inShapeInfos,n),WA([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),Y().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:h,shape:d,texShape:f}=e.variablesLocations[l];if(d){const{uniformShape:p}=u$(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(d,new Int32Array(p));break;case 2:t.gl.uniform2iv(d,new Int32Array(p));break;case 3:t.gl.uniform3iv(d,new Int32Array(p));break;case 4:t.gl.uniform4iv(d,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(ne(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=$e(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],h=r[l];if(c.type==="float")t.gl.uniform1fv(u,h);else if(c.type==="vec2")t.gl.uniform2fv(u,h);else if(c.type==="vec3")t.gl.uniform3fv(u,h);else if(c.type==="vec4")t.gl.uniform4fv(u,h);else if(c.type==="int")t.gl.uniform1iv(u,h);else if(c.type==="ivec2")t.gl.uniform2iv(u,h);else if(c.type==="ivec3")t.gl.uniform3iv(u,h);else if(c.type==="ivec4")t.gl.uniform4iv(u,h);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function uwe(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=u$(t.packedInputs,o.shape,l);let d="",f="",p="";if(u.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const C=$e(u);p=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const m=o.shape.length,v=u.length===2&&rt(o.shape,l),x=ne(o.shape)===1,g=lu(o.shape,n.shape),y=!t.packedInputs&&m===n.shape.length&&rt(l,n.texData.texShape),b=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${y}_${c?h:""}_${u.length}_${x}_${g}_${v}_${d}_${f}_${p}_${b}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${Y().getNumber("WEBGL_VERSION")}`,i}function Wn(t){return Y().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hwe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ed.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ns();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Lv(["r","c","d"],e):Hl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dwe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ed.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ns();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Lv(["r","c","d"],e):Hl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fwe{constructor(e){this.variableNames=["A"],this.outTexUsage=zs.DOWNLOAD;const n=ns();this.outputShape=e,this.userCode=`
      ${zW}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pwe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zs.DOWNLOAD;const n=ns();this.outputShape=e,this.userCode=`
      ${zW}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mwe={R:0,G:1,B:2,A:3};class UA{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ns();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${mwe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?c$():l$(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gwe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ns();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?c$():l$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xwe(t){const e=ns(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return ebe(t,n)}function vwe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ibe(t,e)}function ywe(t){const e=new Uint16Array([0,1,2,2,1,3]);return obe(t,e)}function up(t,e,n,s,r,i){lbe(e,n);const o=abe(t),a=t.TEXTURE_2D;return xe(t,()=>t.bindTexture(a,o)),xe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),xe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),xe(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),xe(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),Y().getNumber("WEBGL_VERSION")===1?xe(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):xe(t,()=>t.texStorage2D(a,1,s,e,n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function UW(t){return t.internalFormatFloat}function bwe(t,e,n,s){const[r,i]=lp(e,n);return up(t,r,i,UW(s),s.textureFormatFloat,t.FLOAT)}function GW(t){return t.internalFormatHalfFloat}function wwe(t,e,n,s){const[r,i]=lp(e,n);return up(t,r,i,GW(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function HW(t){return t.downloadTextureFormat}function Cwe(t,e,n,s){const[r,i]=lp(e,n);return up(t,r,i,HW(s),t.RGBA,t.UNSIGNED_BYTE)}function KW(t){return t.internalFormatPackedFloat}function Swe(t,e,n,s){const[r,i]=Fu(e,n);return up(t,r,i,KW(s),t.RGBA,t.FLOAT)}function XW(t){return t.internalFormatPackedHalfFloat}function kwe(t,e,n,s){const[r,i]=Fu(e,n);return up(t,r,i,XW(s),t.RGBA,s.textureTypeHalfFloat)}function Twe(t,e,n){return xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),VA(t,e,"clipSpacePos",n,3,20,0)&&VA(t,e,"uv",n,2,20,12)}function Iwe(t,e,n,s,r,i){xe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),Y().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function $we(t,e,n){xe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?Y().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):Y().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Nwe(t,e,n,s){const r=t.createBuffer();xe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return xe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),xe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),xe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Ewe(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Rwe(t,e,n,s){const[r,i]=lp(e,n),o=4,a=new Uint8Array(Kye(e*n,o));return xe(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Awe(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(Xye(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Dwe(t,e,n){const s=new Float32Array(e*n*4);return xe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tb{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=Y().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Uye(n,e)):this.gl=Qr(n),e=this.gl,Y().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>xe(i,()=>i.createVertexArray()),this.bindVertexArray=o=>xe(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>xe(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>xe(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>xe(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>xe(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>xe(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>xe(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Y().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=um(this.gl,i),pr(this.gl,o))this.textureHalfFloatExtension=um(this.gl,o);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),pr(this.gl,r))this.colorBufferHalfFloatExtension=um(this.gl,r);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",pr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(pr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=vwe(this.gl),this.indexBuffer=ywe(this.gl),this.framebuffer=cbe(this.gl),this.textureConfig=a$(this.gl,this.textureHalfFloatExtension)}get debug(){return Y().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;xe(e,()=>e.finish()),xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),xe(e,()=>e.deleteFramebuffer(this.framebuffer)),xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),xe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),xe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),bwe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),wwe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Cwe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),$we(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Iwe(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),kwe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Swe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(BA(this.gl,this.framebuffer),this.outputTexture=null),xe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Rwe(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return Awe(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Ewe(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=Nwe(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(Y().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Dwe(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=xwe(n));const s=sbe(n);xe(n,()=>n.attachShader(s,this.vertexShader)),xe(n,()=>n.attachShader(s,e)),rbe(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&wb(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;xe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Twe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(xe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&wb(this.gl,this.program),xe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?hbe(this.gl,e,n):dbe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),xe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),fbe(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Fu(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&wb(this.gl,this.program),hm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}xe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),xe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=um(this.gl,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await AR(()=>this.disposed||this.isQueryAvailable(e,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=_we(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in Y().platform&&(s=Y().platform.setTimeoutCustom.bind(Y().platform)),AR(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Cb(this.gl,e,this.framebuffer),this.debug&&hm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Cb(this.gl,this.outputTexture,this.framebuffer),this.debug&&hm(this.gl)):BA(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;Cb(r,e,this.framebuffer),this.debug&&hm(r),this.outputTexture=e,xe(r,()=>r.viewport(0,0,n,s)),xe(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),xe(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function _we(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Pwe,bincountImpl:qW,bincountReduceImpl:Fwe,bitwiseAndImpl:Owe,castImpl:Mwe,ceilImpl:Lwe,concatImpl:zwe,equalImpl:Vwe,expImpl:Bwe,expm1Impl:jwe,floorImpl:Wwe,gatherNdImpl:Uwe,gatherV2Impl:Gwe,greaterImpl:Hwe,greaterEqualImpl:Kwe,lessImpl:Xwe,lessEqualImpl:qwe,linSpaceImpl:Ywe,logImpl:Qwe,maxImpl:Zwe,maximumImpl:Jwe,minimumImpl:e1e,multiplyImpl:t1e,negImpl:n1e,notEqualImpl:s1e,prodImpl:r1e,raggedGatherImpl:i1e,raggedRangeImpl:o1e,raggedTensorToTensorImpl:a1e,rangeImpl:l1e,rsqrtImpl:c1e,scatterImpl:u1e,sigmoidImpl:h1e,simpleAbsImpl:YW,sliceImpl:d1e,sparseFillEmptyRowsImpl:f1e,sparseReshapeImpl:p1e,sparseSegmentReductionImpl:QW,sqrtImpl:m1e,staticRegexReplaceImpl:g1e,stridedSliceImpl:x1e,stringNGramsImpl:v1e,stringSplitImpl:y1e,stringToHashBucketFastImpl:b1e,subImpl:w1e,tileImpl:C1e,topKImpl:S1e,transposeImpl:h$,uniqueImpl:k1e}=$me;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Zn(t,e){return e===1?[t]:ZW(t,e)}function T1e(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I1e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Wn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Zn("rc",this.rank),s=ct(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JW{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${$1e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?c$():l$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function $1e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Tbe(["r","c","d"],"inputShape"):Hl(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N1e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=HA(n,s),i=KA(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=GA(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===In.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===In.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===In.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===In.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===In.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=HA(s,r),o=KA(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=GA(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=Y().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function E1e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function GA(t,e,n,s,r){const i=R1e(e,s);let o;if(r){const[l,c]=Fu(t[0],t[1]);o=l*c}else{const[l,c]=lp(t[0],t[1]);o=l*c}const a=E1e(n,i);return o*a}function R1e(t,e){switch(t){case In.PACKED_2X2_FLOAT32:return KW(e);case In.PACKED_2X2_FLOAT16:return XW(e);case In.UNPACKED_FLOAT32:return UW(e);case In.UNPACKED_FLOAT16:return GW(e);case In.PACKED_4X1_UNSIGNED_BYTE:return HW(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function A1e(t){return Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?In.PACKED_2X2_FLOAT32:In.UNPACKED_FLOAT32:t?In.PACKED_2X2_FLOAT16:In.UNPACKED_FLOAT16}function HA(t,e){if(t===zs.UPLOAD)return In.PACKED_2X2_FLOAT32;if(t===zs.RENDER||t==null)return A1e(e);if(t===zs.DOWNLOAD||t===zs.PIXELS)return In.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function KA(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xi{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Tr="if (isnan(x)) return x;",D1e="return x;",XA="return abs(x);",_1e="return (x >= 0.0) ? x : (exp(x) - 1.0);",P1e=Tr+`
  return (x < 0.0) ? 0.0 : x;
`,F1e=Tr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,$o="return x;",O1e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M1e="return x;",L1e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,z1e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,V1e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,B1e="return 1.0 / (1.0 + exp(-1.0 * x));";class Fo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j1e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);const n=e.length,s=Zn("rc",n),r=ct(n),i=T1e(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1e=SV,U1e=1e-7,G1e=1e-4,pm={};function H1e(t){return t in pm||(pm[t]={}),pm[t]}const K1e=Y().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),X1e=600;function q1e(){return Y().global.screen==null?1024:Y().global.screen.height*Y().global.screen.width*window.devicePixelRatio*X1e/1024/1024}class zv extends $k{nextDataId(){return zv.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Y().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Tb)n=e;else{const s=Qr(Y().getNumber("WEBGL_VERSION"),e);n=new Tb(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Qr(Y().getNumber("WEBGL_VERSION"));n=new Tb(s),this.binaryCache=H1e(Y().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new N1e(this.gpgpu),this.numMBBeforeWarning=q1e(),this.texData=new j3(this,ai())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=dm(n),u=new UA(c,!1,o),h=this.runWebGLProgram(u,[a],s,[[r,i]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,n,s){if((Y().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Y().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:zs.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:zs.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let d;l?d=new Fo(a,$o):d=new xi(a,$o);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=os());let h;if(r==="complex64"){const d=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);h=co(d,f)}else h=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=os()-u),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new Fo(r,$o):p=new xi(r,$o);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),v=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(Y().getBool("DEBUG")&&!Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Y().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&Y().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...cm(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],v=p[1];h=co(m,v)}else if(c==null)h=this.getValuesFromTexture(e);else{const p=ne(r);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;xe(p,()=>p.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ai().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new Fo(i,$o):f=new xi(i,$o);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),h=ai().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>ra(r));return Ue(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ue(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!Zye(s))throw Y().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=ne(n);if(Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...cm(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),p}const o=Y().getBool("WEBGL_PACK")&&r===!0,a=o?dm(n):n,l=o?new pwe(a):new fwe(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=vl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=vl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=Ose(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:os(),endMs:null}}endTimer(e){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=os(),e)}async getQueryTime(e){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=K1e){return Y().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ne(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Ms("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return W1e(e.shape,n)}packedUnaryOp(e,n,s){const r=new Fo(e.shape,n),i=this.compileAndRun(r,[e],s);return ai().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=YW(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,XA,e.dtype);const n=new xi(e.shape,XA),s=this.compileAndRun(n,[e]);return ai().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Xd(s[0])){const i=s.map(o=>Xo(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return ai().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new j1e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new I1e(e.shape),s=!0;return this.runWebGLProgram(n,[e],e.dtype,null,s)}packedReshape(e,n){const s=[pu(e.shape),...mu(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[pu(n),...mu(n)],o=new JW(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const d=ne(i),f=n[0]*n[1]*4;D(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=dm(i);let l;r?l=new dwe(a):l=new hwe(a);const c=!0,u=[n??cm(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Ed.DENSE){const x=o??cm(e.outputShape);l.texShape=x.map(g=>g*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),ne(a.shape)===0)return l.values=Ln(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let g=this.texData.get(x.dataId);if(g.texture==null){if(!e.packedInputs&&ne(x.shape)<=Y().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:g.values};e.packedInputs&&(g.isPacked=!0,g.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!g.isPacked!=!!e.packedInputs)x=g.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),g=this.texData.get(x.dataId);else if(g.isPacked&&!cx(g.shape,x.shape)){const y=x,b=x.shape;x.shape=g.shape,x=this.packedReshape(x,b),c.push(x),g=this.texData.get(x.dataId),y.shape=b}return{shape:x.shape,texData:g,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=uwe(e,u,h),f=this.getAndSaveBinary(d,()=>lwe(this.gpgpu,e,u,h)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),Y().get("ENGINE_COMPILE_ONLY")||cwe(this.gpgpu,f,u,h,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const v=Y().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const x=os();x-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!Y().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Y().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=K(()=>{if(!Y().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Y().getBool("DEBUG");Y().set("DEBUG",!1);const n=this.abs(st(1e-8)).dataSync()[0];if(Y().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?U1e:G1e}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=os());let h=n.texShape;if(h==null&&(h=gbe(s,l),n.texShape=h),i!=null){const d=dm(s);let f,p=h[1],m=h[0];const v=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!v)&&([p,m]=Fu(h[0],h[1])),l?f=new gwe(d,v):f=new UA(d,v);const x=v?[m,p]:h,g=this.makeTensorInfo(x,r),y=this.texData.get(g.dataId);v?y.usage=zs.PIXELS:y.usage=zs.UPLOAD,y.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),p,m,i);const b=[[m,p]],C=!0,S=this.runWebGLProgram(f,[g],r,b,C),T=this.texData.get(S.dataId);n.texShape=T.texShape,n.isPacked=T.isPacked,n.usage=T.usage,Y().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=T.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(g),c&&(this.uploadWaitMs+=os()-u)}else{const d=this.acquireTexture(h,a,r,l);n.texture=d}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=Y1e(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*Lg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await VV(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(LW(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=WW(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=ai().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return ai().makeTensorFromDataId(c,n,s,l)}}zv.nextDataId=0;function Y1e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Fz()&&zz("webgl",()=>new zv,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Rl{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Me(n,s),this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Vu{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Me(n,s);const i=this.outputShape.length;this.enableShapeUniforms=Wn(i);let o="";if(r)if(i===0||ne(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${ct(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Zn("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ds(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Q1e={kernelName:gf,backendName:"webgl",kernelFunc:Ds};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $a(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=Ds({inputs:{x:s},backend:n}),l=Ds({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const Z1e={kernelName:Vk,backendName:"webgl",kernelFunc:$a};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eU="return (a < 0.) ? b * a : a;",tU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function J1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",ya(i,"float32")),a=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vu(tU,r.shape,o.shape):new Rl(eU,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const eCe={kernelName:_0,backendName:"webgl",kernelFunc:J1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nU="return (a < 0.) ? b * a : a;",sU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function tCe(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vu(sU,s.shape,r.shape):new Rl(nU,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const nCe={kernelName:Z0,backendName:"webgl",kernelFunc:tCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bu="if (isnan(x)) return x;";function Je({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const h=a.texData.get(o.dataId),d=n(h.values,l);return a.makeTensorInfo(o.shape,l,d)}const c=Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Fo(o.shape,e):u=new xi(o.shape,t),a.runWebGLProgram(u,[o],l)}}function An({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[v,x]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(y=>{const[b,C]=y,S={dataId:b.dataId,dtype:b.dtype,shape:l.shape},T={dataId:C.dataId,dtype:C.dtype,shape:c.shape},I=new Rl(t,l.shape,c.shape);return u.runWebGLProgram(I,[S,T],Rs(b.dtype,C.dtype))}),g=$a({inputs:{real:v,imag:x},backend:u});return u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(x),g}const h=i||Rs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,v=l.dtype==="string"?uo(p):p,x=l.dtype==="string"?uo(m):m,[g,y]=r(l.shape,c.shape,v,x,h),b=u.makeTensorInfo(y,h),C=u.texData.get(b.dataId);return C.values=g,b}const d=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new Vu(e,l.shape,c.shape,n):f=new Rl(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function Rd(t,e=!1){if(t==="linear")return e?M1e:D1e;if(t==="relu")return e?z1e:P1e;if(t==="elu")return e?L1e:_1e;if(t==="relu6")return e?V1e:F1e;if(t==="prelu")return e?sU:nU;if(t==="leakyrelu")return e?tU:eU;if(t==="sigmoid")return e?B1e:O1e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rU{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Wn(this.outputShape.length);const u=r?e[1]:e[2],h=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",x="";a&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const g=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let y="rc.x",b="rc.x";e[0]<n[0]?y=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(b=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${y};
        int batchB = ${b};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${g}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qA={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class YA{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Me(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QA="return a * b;";function f$(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=Rs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new YA(qA.REAL,s.shape,r.shape),u=new YA(qA.IMAG,s.shape,r.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=$a({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=t1e(s.shape,r.shape,a.values,l.values,i),h=n.makeTensorInfo(u,i),d=n.texData.get(h.dataId);return d.values=c,h}let o;return Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Vu(QA,s.shape,r.shape):o=new Rl(QA,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const sCe={kernelName:Tf,backendName:"webgl",kernelFunc:f$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(t,e,n){const s=[pu(t.shape),...mu(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[pu(e),...mu(e)],o=new JW(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=ne(r.shape),l=U3(i,a),c=ne(l);D(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!cx(r.shape,l)&&!(u.texture!==null&&cx(u.shape,l))?rCe(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const iCe={kernelName:ev,backendName:"webgl",kernelFunc:fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZA{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const h=1/n;c=`sumValue += dot(values * ${ru(h)?h.toPrecision(2):h}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oCe{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,h=s%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Sv(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function ql(t,e,n,s){const r=aCe(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,h;n==="mean"?u=o===0?new ZA({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new ZA({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new oCe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),h=i,i=s.runWebGLProgram(u,[i],e),h.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lCe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=ct(this.rank),i=cCe(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function cCe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uCe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=ct(this.rank),i=ZW("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vv(t,e,n){const s=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uCe(t.shape,e):new lCe(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hCe(t,e,n,s){const r=e,i=t.shape.length,o=Ge(r,t.shape);let a=o;const l=Lt(a,i),c=l!=null;let u=t;c&&(u=Vv(t,l,s),a=Yt(a.length,i)),Rn("sum",a,i);const[h,d]=Cn(u.shape,a);let f=h;n&&(f=nn(h,o));const p=ne(d),v=ne(t.shape)/p,x=fe({inputs:{x:u},attrs:{shape:[v,p]},backend:s}),g=wT(t.dtype),y=ql(x,g,"sum",s),b=fe({inputs:{x:y},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(y),c&&s.disposeIntermediateTensorInfo(u),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return hCe(r,i,o,n)}const dCe={kernelName:ov,backendName:"webgl",kernelFunc:Bv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ts(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const h=o.texData.get(r.dataId).values,d=h$(h,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=d}else c=Vv(r,i,o);return c}const fCe={kernelName:zc,backendName:"webgl",kernelFunc:ts};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iU=1e3;function ux({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,h=n?t.shape[c-2]:t.shape[c-1],d=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),v=e.shape.slice(0,-2),x=ne(m),g=ne(v),b=Me(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);D(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const C=n?[x,h,f]:[x,f,h],S=s?[g,p,d]:[g,d,p],T=fe({inputs:{x:t},backend:r,attrs:{shape:C}}),I=fe({inputs:{x:e},backend:r,attrs:{shape:S}}),$=[T,I],N=Math.max(x,g),A=n?T.shape[1]:T.shape[2],F=i!=null,E=o!=null,R=l==="leakyrelu",O=l!=null?Rd(l,!0):null,P=F||E||R||O!=null;let z;if((f===1||p===1)&&A>iU&&P===!1){let M=T,U=I;n&&(M=ts({inputs:{x:T},backend:r,attrs:{perm:[0,2,1]}}),$.push(M)),s&&(U=ts({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),$.push(U));const W=p!==1,X=p===1;let J=M;W&&(J=fe({inputs:{x:M},backend:r,attrs:{shape:[N,A,1]}}),$.push(J));const Z=p===1?2:1;let re=U;X&&(re=fe({inputs:{x:U},backend:r,attrs:{shape:[N,1,A]}}),$.push(re));const Q=f$({inputs:{a:J,b:re},backend:r});z=Bv({inputs:{x:Q},backend:r,attrs:{axis:Z,keepDims:!0}}),$.push(Q)}else{const M=Rs(t.dtype,e.dtype),U=new rU(C,S,[N,f,p],n,s,F,O,E,R),W=[T,I];if(i!=null&&W.push(i),E&&W.push(o),R){const X=r.makeTensorInfo([],"float32",ya(a,"float32"));W.push(X),$.push(X)}z=r.runWebGLProgram(U,W,M)}const _=fe({inputs:{x:z},backend:r,attrs:{shape:b}});$.push(z);for(const M of $)r.disposeIntermediateTensorInfo(M);return _}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pCe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;return ux({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}const mCe={kernelName:zg,backendName:"webgl",kernelFunc:pCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JA="return abs(x);";function gCe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=YW(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Fo(s.shape,JA):r=new xi(s.shape,JA),n.runWebGLProgram(r,[s],s.dtype)}const xCe={kernelName:f0,backendName:"webgl",kernelFunc:gCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCe=Tr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,yCe=Je({opSnippet:vCe}),bCe={kernelName:qd,backendName:"webgl",kernelFunc:yCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wCe=Tr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,CCe=Je({opSnippet:wCe}),SCe={kernelName:Yd,backendName:"webgl",kernelFunc:CCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD="return a + b;",kCe=An({opSnippet:eD,packedOpSnippet:eD,supportsComplex:!0,cpuKernelImpl:Pwe}),TCe={kernelName:Nu,backendName:"webgl",kernelFunc:kCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ICe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ce{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vm(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return Ds({inputs:{x:s[0]},backend:n});if(s.length>Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Vm({inputs:s.slice(0,l),backend:n}),u=Vm({inputs:s.slice(l),backend:n});return Vm({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>Rs(l,c)),i=s.map(l=>l.shape),a=Y().getBool("WEBGL_PACK")?new $Ce(s[0].shape,i):new ICe(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const NCe={kernelName:_k,backendName:"webgl",kernelFunc:Vm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Ge(i,r.shape);let c=l;const u=Lt(c,a);let h=r;u!=null&&(h=ts({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Yt(c.length,a)),Rn("all",c,a);const[d,f]=Cn(h.shape,c),p=ne(f),m=fe({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),v=ql(m,m.dtype,"all",n);let x;if(o){const g=nn(d,l);x=fe({inputs:{x:v},backend:n,attrs:{shape:g}})}else x=fe({inputs:{x:v},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),u!=null&&n.disposeIntermediateTensorInfo(h),x}const RCe={kernelName:Pk,backendName:"webgl",kernelFunc:ECe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Ge(i,r.shape);let c=l;const u=Lt(c,a);let h=r;u!=null&&(h=ts({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Yt(c.length,a)),Rn("any",c,a);const[d,f]=Cn(h.shape,c),p=ne(f),m=fe({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),v=ql(m,m.dtype,"any",n);let x;if(o){const g=nn(d,l);x=fe({inputs:{x:v},backend:n,attrs:{shape:g}})}else x=fe({inputs:{x:v},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),u!=null&&n.disposeIntermediateTensorInfo(h),x}const DCe={kernelName:Fk,backendName:"webgl",kernelFunc:ACe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ce{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PCe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,D(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=ct(l),u=Zn("coords",l);let h,d;if(o===1){d=l+1;const I=ct(d);h=`
        ${I} sourceLocR = ${I}(${u.join()}, 0);
        ++${u[l-1]};
        ${I} sourceLocG = ${I}(${u.join()}, 0);
        ++${u[l-2]};
        ${I} sourceLocA = ${I}(${u.join()}, 0);
        --${u[l-1]};
        ${I} sourceLocB = ${I}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],m=f.map(I=>"int "+I),v=Zn("sourceLocR",d-1).concat("inIdx.r"),x=Zn("sourceLocG",d-1).concat("inIdx.g"),g=Zn("sourceLocB",d-1).concat("inIdx.b"),y=Zn("sourceLocA",d-1).concat("inIdx.a"),b=s==="max"?"greaterThan":"lessThan",C=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()})));`,S=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${g.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${y.join()}) : 0.)`,T=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${T}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=Sv(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new _Ce(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const h=oU(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function aU(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=Sv(i),a=new PCe(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=aU(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function lU(t,e,n,s){const r=[n];if(Rn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!Y().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=Cn(l.shape,r),h=ne(u),d=fe({inputs:{x:l},backend:t,attrs:{shape:[-1,h]}});i.push(d);const f=oU(t,d,s);i.push(f);const p=fe({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return aU(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Ge(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=ts({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),Rn("argMax",[o[0]],l.shape.length);const u=lU(n,l,o[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const OCe={kernelName:p0,backendName:"webgl",kernelFunc:FCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Ge(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=ts({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),Rn("argMin",[o[0]],l.shape.length);const u=lU(n,l,o[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const LCe={kernelName:m0,backendName:"webgl",kernelFunc:MCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zCe=Tr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,VCe=Je({opSnippet:zCe}),BCe={kernelName:Qd,backendName:"webgl",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jCe=Tr+"return log(x + sqrt(x * x + 1.0));",WCe=Je({opSnippet:jCe}),UCe={kernelName:Zd,backendName:"webgl",kernelFunc:WCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GCe=Tr+`
  return atan(x);
`,HCe=Je({opSnippet:GCe}),KCe={kernelName:Jd,backendName:"webgl",kernelFunc:HCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XCe=d$+`
  return atan(a, b);
`,qCe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,YCe=An({opSnippet:XCe,packedOpSnippet:qCe}),QCe={kernelName:tf,backendName:"webgl",kernelFunc:YCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZCe=Tr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,JCe=Je({opSnippet:ZCe}),eSe={kernelName:ef,backendName:"webgl",kernelFunc:JCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ad{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let g="0.0";if(m||(g="-1.0 / 1e-20"),s){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?v:x:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const y="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / max(count, 1.0)");const C=Math.floor(o/4)*4,S=o%4,T=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${y}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${g};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${g});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${T}
          }

          int xC = xCCorner + ${C};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${T}
          }
        }
        setOutput(${b});
      }
    `}}class p${constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,v=e.padInfo.front,x=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg";let b="0.0";if(y||(b="-1.0 / 1e-20"),s){const N=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${v}, ${x}, ${g});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${N} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const T=Math.floor(o/4)*4,I=o%4,$=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${v}, ${x}, ${g});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${T}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${$}
            }

            int xC = xCCorner + ${T};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${$}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;cp(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Bn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Sr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&rt(u.inShape,u.outShape))return Ds({inputs:{x:r},backend:n});const h=new Ad(u,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const nSe={kernelName:g0,backendName:"webgl",kernelFunc:tSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],h=po(r.shape,i,o,u,a,l,c),d=new p$(h,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const rSe={kernelName:x0,backendName:"webgl",kernelFunc:sSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iSe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,h=c-1-e.padInfo.left,d=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class oSe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=h-1-e.padInfo.front,m=d-1-e.padInfo.top,v=f-1-e.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${v});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=po(o.shape,a,l,h,c,u),f=new oSe(d);return n.runWebGLProgram(f,[r],o.dtype)}const lSe={kernelName:Mk,backendName:"webgl",kernelFunc:aSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;cp([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Sr(o.shape,a,l,1,c),h=new iSe(u);return n.runWebGLProgram(h,[r],o.dtype)}const uSe={kernelName:Ok,backendName:"webgl",kernelFunc:cSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return ux({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const dSe={kernelName:v0,backendName:"webgl",kernelFunc:hSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fSe{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Me(e,n),Me(e,s);let a="0.0";r!=null&&(Me(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Me(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pSe{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Me(e,n),Me(e,s);let a="vec4(0.0)";r!=null&&(Me(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Me(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mSe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;D(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let h=null;a!=null&&(h=a.shape,c.push(a));const d=Y().getBool("WEBGL_PACK_NORMALIZATION")?new pSe(s.shape,r.shape,i.shape,u,h,l):new fSe(s.shape,r.shape,i.shape,u,h,l);return e.runWebGLProgram(d,c,c[0].dtype)},gSe={kernelName:R0,backendName:"webgl",kernelFunc:mSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xSe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=ct(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=vSe(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${sC[a]} = start[${a}] + coords.${sC[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const sC=["x","y","z","w","u","v"];function vSe(t){if(t===1)return"sourceLoc";if(t<=6)return sC.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ySe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=ct(this.rank),s=Zn("coords",this.rank),r=Zn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,h)=>`start[${h}]`).join()});`:e.map((u,h)=>`${r[h]} = ${s[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bSe(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=cI(e,$e(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function ju(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=Cv(r,i,o);if(oI(r,a,l),ne(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const h=n.texData.get(r.dataId),d=d1e(h.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,d)}const{isPacked:c}=n.texData.get(r.dataId),u=lI(r.shape,a,l);if(c||!u){const h=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ySe(l):new xSe(l),d=[a];return n.runWebGLProgram(h,[r],r.dtype,d)}return n.uploadToGPU(r.dataId),bSe(r,a,l,n)}const wSe={kernelName:iv,backendName:"webgl",kernelFunc:ju};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CSe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;D(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((g,y)=>g*y),l=Yf(r.shape,i,a),c=Qf(l.length,i.length),u=Zf(r.shape,i,a),h=pI(o,i.length),d=mI(u,o,i.length),f=[],p=fe({inputs:{x:r},backend:n,attrs:{shape:l}}),m=ts({inputs:{x:p},backend:n,attrs:{perm:c}}),v=fe({inputs:{x:m},backend:n,attrs:{shape:u}}),x=ju({inputs:{x:v},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(m),f.push(v),f.forEach(g=>n.disposeIntermediateTensorInfo(g)),x},SSe={kernelName:y0,backendName:"webgl",kernelFunc:CSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=qW(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const TSe={kernelName:Lk,backendName:"webgl",kernelFunc:kSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,$Se=`
  return float(int(a.r) & int(b.r));
`;function NSe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Y().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,h]=Owe(s.shape,r.shape,l,c,s.dtype),d=n.makeTensorInfo(h,s.dtype),f=n.texData.get(d.dataId);return f.values=u,d}let a;return i?a=new Vu(ISe,s.shape,r.shape,!1):a=new Rl($Se,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const ESe={kernelName:zk,backendName:"webgl",kernelFunc:NSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=Me(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const ASe={kernelName:Y3,backendName:"webgl",kernelFunc:RSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe="return float(a != b);",cU=An({opSnippet:DSe,cpuKernelImpl:s1e,dtype:"bool"}),_Se={kernelName:K0,backendName:"webgl",kernelFunc:cU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hp(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ds({inputs:{x:r.complexTensorInfos.real},backend:n})}const PSe={kernelName:uT,backendName:"webgl",kernelFunc:hp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FSe="return float(int(x));";function OSe(t,e){const n=new xi(t.shape,FSe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rC(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ds({inputs:{x:r},backend:n});const o=xn(r.shape),a=rC({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=$a({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=hp({inputs:{input:r},backend:n}),a=rC({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!G3(r.dtype,i)){const o=Ds({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=Mwe(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return OSe(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Ln("bool",1)),l=cU({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const MSe={kernelName:nf,backendName:"webgl",kernelFunc:rC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD="return ceil(x);",LSe=Je({opSnippet:tD,packedOpSnippet:tD,cpuKernelImpl:Lwe}),zSe={kernelName:sf,backendName:"webgl",kernelFunc:LSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VSe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BSe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;Y().getBool("WEBGL_PACK_CLIP")?a=new BSe(r.shape):a=new VSe(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const WSe={kernelName:rf,backendName:"webgl",kernelFunc:jSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class USe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nD(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function GSe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new USe(s.shape),o=[nD(s,r.complexTensorInfos.real),nD(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const HSe={kernelName:b0,backendName:"webgl",kernelFunc:GSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KSe{constructor(e){this.outputShape=[],this.outputShape=Ii(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XSe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ii(e,n);const s=this.outputShape,r=s.length,i=ct(r),o=Zn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),h=a.join();let d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const v=l[m-1];d+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${mm(a,c,v)}),
            vec2(${mm(u,c,v)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${mm(a,c,p)}),
          vec2(${mm(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function mm(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jv(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ds({inputs:{x:r.complexTensorInfos.imag},backend:n})}const qSe={kernelName:nT,backendName:"webgl",kernelFunc:jv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kh(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(g=>hp({inputs:{input:g},backend:n})),p=t.map(g=>jv({inputs:{input:g},backend:n})),m=kh(f,e,n),v=kh(p,e,n),x=$a({inputs:{real:m,imag:v},backend:n});return f.forEach(g=>n.disposeIntermediateTensorInfo(g)),p.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),x}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(b=>{const S=[-1,ne(b.shape.slice(e))];return fe({inputs:{x:b},backend:n,attrs:{shape:S}})}),p=f.map(b=>({vals:n.readSync(b.dataId),shape:b.shape})),m=Ii(f.map(b=>b.shape),1),v=f[0].shape[0]===1,x=zwe(p,m,s,v),g=Ii(t.map(b=>b.shape),e),y=n.makeTensorInfo(g,s,x);return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}const i=t.filter(f=>ne(f.shape)>0),o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new xi(t[0].shape,$o):new Fo(t[0].shape,$o);return n.runWebGLProgram(f,t,s)}const a=Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let m=0;m<i.length;m+=a){const v=i.slice(m,m+a);f.push(kh(v,e,n))}const p=kh(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(o){const f=new XSe(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=YSe(i,e,n),u=new KSe(l.map(f=>f.shape)),h=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const d=fe({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function YSe(t,e,n){const s=Ii(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>fe({inputs:{x:i},attrs:{shape:[-1,ne(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Ge(r,e[0].shape)[0],o=e.map(c=>c.shape);hI(o,i);const a=Ii(e.map(c=>c.shape),i);if(ne(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>ne(c.shape)>0);return l.length===1?Ds({inputs:{x:l[0]},backend:n}):kh(l,i,n)}const QSe={kernelName:w0,backendName:"webgl",kernelFunc:uU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hU{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,v=e.dataFormat==="channelsLast",x=v?1:2,g=v?2:3,y=v?3:1;let b="",C="";s&&(r?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`
          float activation(float x) {
            ${s}
          }
        `,C="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${y}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${g}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${C}
        setOutput(result);
      }
    `}}class ZSe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dU{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wn(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<u;v++)d+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<u;v++)d+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(h+1)/2;v++){const x=v*2;if(d+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?d+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const g=o%2===0?Nk(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${g};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:d+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):g===1?d+=`
                     xC${x+1} = xTexelC${x};
                     `:d+=`
                     xCOffset = xC + ${g};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(d+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(d+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(d+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JSe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);const{dataFormat:s}=n,r=ns(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hx(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function fU({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let v;const x=[];if(i!=null){const b=hx(i.shape,f);b!=null&&(i=fe({inputs:{x:i},backend:s,attrs:{shape:b}}),x.push(i))}if(r!=null){const b=hx(r.shape,f);b!=null&&(r=fe({inputs:{x:r},backend:s,attrs:{shape:b}}),x.push(r))}if(!((h===1||d===1)&&u>iU)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&rt(c.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,D(cx(c.shape,C.shape),()=>`packed reshape ${c.shape} to ${C.shape} isn't free`);const T=fe({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(T);const I=ux({a:C,b:T,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),$=s.texData.get(I.dataId);D($.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=S,$.shape=n.outShape,v=Ds({inputs:{x:I},backend:s}),v.shape=n.outShape,x.push(I)}else{const b=n.outHeight*n.outWidth,C=fe({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),S=fe({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),T=ux({a:f?C:S,b:f?S:C,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});v=fe({inputs:{x:T},backend:s,attrs:{shape:n.outShape}}),x.push(C),x.push(S),x.push(T)}for(const b of x)s.disposeIntermediateTensorInfo(b);return v}function pU({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:d,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,v=d*h,x=[n.batchSize,m,v],g=!0,y=!1,b=[];if(i!=null){const _=hx(i.shape,p);_!=null&&(i=fe({inputs:{x:i},backend:s,attrs:{shape:_}}),b.push(i))}if(r!=null){const _=hx(r.shape,p);_!=null&&(r=fe({inputs:{x:r},backend:s,attrs:{shape:_}}),b.push(r))}const C=fe({inputs:{x:e},backend:s,attrs:{shape:[1,m,ne(e.shape)/m]}});b.push(C);const S=new JSe(x,n),T=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=s.runWebGLProgram(S,[t],"float32",T),$=fe({inputs:{x:I},backend:s,attrs:{shape:x}});b.push(I),b.push($);const N=r!=null,A=i!=null,F=a==="leakyrelu",E=a?Rd(a,!0):null,R=new rU(p?$.shape:C.shape,p?C.shape:$.shape,p?[n.batchSize,v,n.outChannels]:[n.batchSize,n.outChannels,v],g,y,N,E,A,F),O=p?[$,C]:[C,$];if(r&&O.push(r),A&&O.push(i),F){const _=s.makeTensorInfo([],"float32",ya(o,"float32"));O.push(_),b.push(_)}const P=s.runWebGLProgram(R,O,"float32"),z=fe({inputs:{x:P},backend:s,attrs:{shape:n.outShape}});b.push(P);for(const _ of b)s.disposeIntermediateTensorInfo(_);return z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,h=mo(l),d=En(r.shape,i.shape,o,c,a,u,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=fU({x:r,filter:i,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const m=new dU(d),v=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(m,[r,i],"float32",v)}else if(Y().getBool("WEBGL_CONV_IM2COL"))f=pU({x:r,filter:i,convInfo:d,backend:n});else{const m=new hU(d);f=n.runWebGLProgram(m,[r,i],"float32")}const p=fe({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}const tke={kernelName:C0,backendName:"webgl",kernelFunc:eke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ske{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class rke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ike{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,h=mo(l),d=En(r.shape,u,o,1,a,c,!1,h),f=new nke(d);return n.runWebGLProgram(f,[r,i],"float32")}const ake={kernelName:Bk,backendName:"webgl",kernelFunc:oke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lke{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Wn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,h=mo(c),d=En(o,i.shape,a,1,l,u,!1,h);if(Y().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],p=new lke(d);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new ske(d);return n.runWebGLProgram(f,[r,i],"float32")}}const uke={kernelName:S0,backendName:"webgl",kernelFunc:cke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=ba(r.shape,i.shape,o,l,a),u=new ZSe(c);return n.runWebGLProgram(u,[r,i],"float32")}const dke={kernelName:k0,backendName:"webgl",kernelFunc:hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=ba(r.shape,l,o,1,a),u=new rke(c);return n.runWebGLProgram(u,[r,i],"float32")}const pke={kernelName:jk,backendName:"webgl",kernelFunc:fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=ba(l,i.shape,a,1,o),u=new ike(c);return n.runWebGLProgram(u,[r,i],"float32")}const gke={kernelName:Wk,backendName:"webgl",kernelFunc:mke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xke=Bu+`
  return cos(x);
`,vke=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Xl}
  return result;
`,yke=Je({opSnippet:xke,packedOpSnippet:vke}),bke={kernelName:of,backendName:"webgl",kernelFunc:yke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wke=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Cke=Je({opSnippet:wke}),Ske={kernelName:af,backendName:"webgl",kernelFunc:Cke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kke{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[h,d]=s;this.outputShape=[u,h,d,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[v,x,g]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[y,b,C]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${y});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${b};

        float in_y = ${g};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tke=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new kke(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},Ike={kernelName:Gk,backendName:"webgl",kernelFunc:Tke};var Dd;(function(t){t.Prod="*",t.Sum="+"})(Dd||(Dd={}));class sD{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Dd.Prod?"1.0":"0.0",a=s?o:`getX(${rD(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${ct(i)} coords = getOutputCoords();
        int end = ${iD(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${iD(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${rD(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function rD(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function iD(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(t,e,n,s,r,i){const o=e.shape.length,a=Lt([s],o);let l=e;a!=null&&(l=ts({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Yt(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let h=Ds({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const f=new sD(t,l.shape,!1,i),p=[[d]],m=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const d=new sD(t,l.shape,r,i),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=wa(a),f=ts({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return mU(Dd.Prod,r,n,i,o,a)}const Nke={kernelName:Uk,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return mU(Dd.Sum,r,n,i,o,a)}const Rke={kernelName:T0,backendName:"webgl",kernelFunc:Eke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=qW(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=Fwe(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Dke={kernelName:Hk,backendName:"webgl",kernelFunc:Ake};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ke{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],h=l*i,d=c*i,f=u/(i*i),p=o==="NHWC"?[a,h,d,f]:[a,f,h,d],m=new _ke(p,i,o);return n.runWebGLProgram(m,[r],r.dtype)}const Fke={kernelName:Kk,backendName:"webgl",kernelFunc:Pke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gU{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wn(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xU{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wn(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<h;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<h;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(d+1)/2;x++){const g=x*2;if(f+=`
          xC = xCCorner + ${g*c};
          `,l===1){if(g<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                  xTexelC${g} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${g}.zw = vec2(0.0);
                  }
                  xTexelC${g}Ready = 1;
                }
              `,c===1&&g>0?f+=`
                xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                  } else {
                    xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                  xTexelC${g} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${g}.zw = vec2(0.0);
                  }
                  xTexelC${g}Ready = 1;
                }

                xC${g} = xTexelC${g};
                `,g+1<h)){const y=a%2===0?Nk(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${y};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                    xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${g+1}.zw = vec2(0.0);
                    }
                    xTexelC${g+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                    } else {
                     xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                    }
                    `:f+=`
                    xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                    `):y===1?f+=`
                    xC${g+1} = xTexelC${g};
                    `:f+=`
                    xCOffset = xC + ${y};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                      xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${g+1}.zw = vec2(0.0);
                      }
                      xTexelC${g+1}Ready = 1;
                    }

                    xC${g+1} = xTexelC${g+1};
                    `}}else g<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                  xTexelC${g} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${g}.zw = vec2(0.0);
                  }
                  xTexelC${g}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                  xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${g+1}.zw = vec2(0.0);
                  }
                  xTexelC${g+1}Ready = 1;
                }

                xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
              `,g+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                  xTexelC${g} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${g}.zw = vec2(0.0);
                  }
                  xTexelC${g}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                  xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${g+1}.zw = vec2(0.);
                  }
                  xTexelC${g+1}Ready = 1;
                }

                xC${g} = vec4(
                  xTexelC${g}.xy, xTexelC${g+1}.xy);
              `,g+1<h&&(f+=`
                  xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                `)));g<h&&(f+=`
            wTexel = getW(r, ${g}, d1, q);
            dotProd += xC${g} * vec4(wTexel.xz, wTexel.xz);
          `,g+1<h&&(f+=`
              wTexel = getW(r, ${g+1}, d1, q);
              dotProd += xC${g+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),D(Bn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const h=En(r.shape,i.shape,o,u,a,c,!0);let d;Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new xU(h):d=new gU(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[r,i],"float32",f)}const Mke={kernelName:I0,backendName:"webgl",kernelFunc:Oke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class zke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,h=En(r.shape,u,o,a,l,c,!0),d=new Lke(h);return n.runWebGLProgram(d,[r,i],"float32")}const Bke={kernelName:Xk,backendName:"webgl",kernelFunc:Vke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,h=En(u,i.shape,o,a,l,c,!0),d=new zke(h);return n.runWebGLProgram(d,[r,i],"float32")}const Wke={kernelName:qk,backendName:"webgl",kernelFunc:jke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uke{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gke(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=ne(s.shape),o=fe({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new Uke(i),l=n.runWebGLProgram(a,[o],o.dtype),c=fe({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const Hke={kernelName:Q3,backendName:"webgl",kernelFunc:Gke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:h,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Gf(r.shape,i.shape,o,a,"NHWC",l);let u;const h=new Kke(c);u=n.runWebGLProgram(h,[r,i],"float32");const d=fe({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}const qke={kernelName:$0,backendName:"webgl",kernelFunc:Xke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yke(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=SI(r,i.length);TI(o.length,l,i);const{path:c,steps:u}=II(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let m=0;m<h;++m){for(const v of u[m]){const{permutationIndices:x,expandDims:g}=kI(f,l[v]);let y;$I(x)?y=i[v]:(y=ts({inputs:{x:i[v]},backend:n,attrs:{perm:x}}),p.push(y));const b=y.shape.slice();for(let C=0;C<g.length;++C)b.splice(g[C],0,1);rt(y.shape,b)||(y=fe({inputs:{x:y},backend:n,attrs:{shape:b}}),p.push(y)),d===null?d=y:(d=f$({inputs:{a:y,b:d},backend:n}),p.push(d))}m<h-1&&(c[m]>=0&&(d=Bv({inputs:{x:d},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const Qke={kernelName:Yk,backendName:"webgl",kernelFunc:Yke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zke="return (x >= 0.0) ? x : (exp(x) - 1.0);",Jke=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,eTe=Je({opSnippet:Zke,packedOpSnippet:Jke}),tTe={kernelName:cf,backendName:"webgl",kernelFunc:eTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nTe="return (b >= 0.0) ? a : a * (b + 1.0);",sTe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,rTe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vu(sTe,s.shape,r.shape):new Rl(nTe,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},iTe={kernelName:Qk,backendName:"webgl",kernelFunc:rTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oTe=`
  return vec4(equal(a, b));
`,aTe="return float(a == b);",lTe=An({opSnippet:aTe,packedOpSnippet:oTe,dtype:"bool",cpuKernelImpl:Vwe}),cTe={kernelName:N0,backendName:"webgl",kernelFunc:lTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uTe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${gI};
  float a1 = ${xI};
  float a2 = ${vI};
  float a3 = ${yI};
  float a4 = ${bI};
  float a5 = ${wI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,hTe=Je({opSnippet:uTe}),dTe={kernelName:uf,backendName:"webgl",kernelFunc:hTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fTe=Bu+`
  return exp(x);
`,pTe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vU=Je({opSnippet:fTe,packedOpSnippet:pTe,cpuKernelImpl:Bwe,dtype:"float32"}),mTe={kernelName:hf,backendName:"webgl",kernelFunc:vU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iC(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(D(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),fe({inputs:{x:i},backend:s,attrs:{shape:a}})}const gTe={kernelName:E0,backendName:"webgl",kernelFunc:iC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD="return exp(x) - 1.0;",xTe=Je({opSnippet:oD,packedOpSnippet:oD,cpuKernelImpl:jwe}),vTe={kernelName:df,backendName:"webgl",kernelFunc:xTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aD{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(t,e,n){const s=n.texData.get(t.dataId),r=ne(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=fe({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new aD("real",l,e),u=new aD("imag",l,e),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=$a({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const m=fe({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yTe(t){const{inputs:e,backend:n}=t,{input:s}=e;return yU(s,!1,n)}const bTe={kernelName:Zk,backendName:"webgl",kernelFunc:yTe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wTe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dp(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Iu(r),i==="string"){const o=Kt(i,ne(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new wTe(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const CTe={kernelName:Jk,backendName:"webgl",kernelFunc:dp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class STe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTe={kernelName:eT,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new STe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lD="return floor(x);",TTe=Je({opSnippet:lD,packedOpSnippet:lD,cpuKernelImpl:Wwe}),ITe={kernelName:ff,backendName:"webgl",kernelFunc:TTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Te=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,NTe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,ETe=An({opSnippet:$Te,packedOpSnippet:NTe,dtype:"int32"}),RTe={kernelName:pf,backendName:"webgl",kernelFunc:ETe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ATe{constructor(e){this.variableNames=["A"];const n=ns(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DTe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ns(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Te={kernelName:Qse,backendName:"webgl",kernelFunc:PTe};let rc,Ib=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function PTe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],h=[c,l,i];if(a||o){const m=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(rc==null||m!==Ib)&&(Ib=m,rc=document.createElement("canvas").getContext("2d",{willReadFrequently:Ib})),rc.canvas.width=l,rc.canvas.height=c,rc.drawImage(r,0,0,l,c),r=rc.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=zs.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),r);const f=Y().getBool("WEBGL_PACK")?new DTe(h):new ATe(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s,m=mo(u),v=En(r.shape,i.shape,l,h,c,d,!1,m);let x;const g=[],y=o!=null,b=a!=null,C=f==="leakyrelu",S=()=>{const I=[r,i],$=(N,A)=>{if(A==="NCHW"&&N.shape.length===1&&N.shape[0]!==1){const F=fe({inputs:{x:N},backend:n,attrs:{shape:[N.shape[0],1,1]}});return g.push(F),F}return N};if(y&&I.push($(o,u)),b&&I.push($(a,u)),C){const N=n.makeTensorInfo([],"float32",ya(p,"float32"));I.push(N),g.push(N)}return I};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))x=fU({x:r,filter:i,convInfo:v,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(v.strideWidth<=2&&m==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const I=f?Rd(f,!0):null,$=new dU(v,y,I,b,C),N=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],A=S();x=n.runWebGLProgram($,A,"float32",N)}else if(Y().getBool("WEBGL_CONV_IM2COL"))x=pU({x:r,filter:i,convInfo:v,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const I=f?Rd(f,!1):null,$=new hU(v,y,I,b,C),N=S();x=n.runWebGLProgram($,N,"float32")}const T=fe({inputs:{x},backend:n,attrs:{shape:v.outShape}});return g.push(x),g.forEach(I=>n.disposeIntermediateTensorInfo(I)),T}const OTe={kernelName:Vg,backendName:"webgl",kernelFunc:FTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),D(Bn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const v=En(r.shape,i.shape,l,m,c,h,!0),x=Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,g=d?Rd(d,x):null,y=[r,i],b=o!=null,C=a!=null,S=d==="leakyrelu";if(b&&y.push(o),C&&y.push(a),S){const N=n.makeTensorInfo([],"float32",ya(f,"float32"));y.push(N),p.push(N)}let T;x?T=new xU(v,b,g,C,S):T=new gU(v,b,g,C,S);const I=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],$=n.runWebGLProgram(T,y,"float32",I);return p.forEach(N=>n.disposeIntermediateTensorInfo(N)),$}const LTe={kernelName:gz,backendName:"webgl",kernelFunc:MTe};class zTe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=ct(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=ne(s.shape),[l,c,u,h]=iI(s,r),d=fe({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=fe({inputs:{x:s},backend:n,attrs:{shape:[ne(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),g=n.bufferSync(s),y=Uwe(x,g,s.dtype,c,o,u,h,s.shape,a);return n.makeTensorInfo(l,s.dtype,y.values)}const p=new zTe(o,h,[c,u],s.shape),m=n.runWebGLProgram(p,[f,d],f.dtype),v=fe({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),v}const BTe={kernelName:Z3,backendName:"webgl",kernelFunc:VTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jTe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=ct(this.rank),r=WTe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function WTe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=Ge(o,r.shape)[0];if(Y().get("DEBUG")){const g=n.readSync(i.dataId),y=r.shape[l];for(let b=0;b<g.length;++b){const C=g[b];D(C<=y-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${y-1}]`)}}const c=EI(r,i,l,a),u=ne(i.shape),h=[],d=fe({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=fe({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const g=n.bufferSync(f),y=n.bufferSync(d),b=Gwe(y,g,p);return h.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(c.outputShape,b.dtype,b.values)}const m=new jTe(d.shape,p),v=n.runWebGLProgram(m,[d,f],d.dtype);h.push(v);const x=fe({inputs:{x:v},backend:n,attrs:{shape:c.outputShape}});return h.forEach(g=>n.disposeIntermediateTensorInfo(g)),x}const UTe={kernelName:A0,backendName:"webgl",kernelFunc:bU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTe="return float(a > b);",HTe=`
  return vec4(greaterThan(a, b));
`,KTe=An({opSnippet:GTe,packedOpSnippet:HTe,cpuKernelImpl:Hwe,dtype:"bool"}),XTe={kernelName:D0,backendName:"webgl",kernelFunc:KTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qTe="return float(a >= b);",YTe=`
  return vec4(greaterThanEqual(a, b));
`,QTe=An({opSnippet:qTe,packedOpSnippet:YTe,dtype:"bool",cpuKernelImpl:Kwe}),ZTe={kernelName:mf,backendName:"webgl",kernelFunc:QTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(t){const{inputs:e,backend:n}=t,{input:s}=e;return yU(s,!0,n)}const eIe={kernelName:tT,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tIe="return float(!isnan(x) && !isinf(x));",nIe=Je({opSnippet:tIe,dtype:"bool"}),sIe={kernelName:xf,backendName:"webgl",kernelFunc:nIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rIe="return float(isinf(x));",iIe=Je({opSnippet:rIe,dtype:"bool"}),oIe={kernelName:vf,backendName:"webgl",kernelFunc:iIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aIe="return float(isnan(x));",lIe=Je({opSnippet:aIe,dtype:"bool"}),cIe={kernelName:yf,backendName:"webgl",kernelFunc:lIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uIe="return float(a < b);",hIe=`
  return vec4(lessThan(a, b));
`,dIe=An({opSnippet:uIe,packedOpSnippet:hIe,cpuKernelImpl:Xwe,dtype:"bool"}),fIe={kernelName:P0,backendName:"webgl",kernelFunc:dIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pIe="return float(a <= b);",mIe=`
  return vec4(lessThanEqual(a, b));
`,gIe=An({opSnippet:pIe,packedOpSnippet:mIe,cpuKernelImpl:qwe,dtype:"bool"}),xIe={kernelName:F0,backendName:"webgl",kernelFunc:gIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vIe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=Ywe(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const yIe={kernelName:J3,backendName:"webgl",kernelFunc:vIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bIe=Bu+`
  return x < 0.0 ? 0./0. : log(x);
`,wIe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,CIe=Je({opSnippet:bIe,packedOpSnippet:wIe,cpuKernelImpl:Qwe}),SIe={kernelName:bf,backendName:"webgl",kernelFunc:CIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIe=Bu+`
  return log(1.0 + x);
`,TIe=Je({opSnippet:kIe}),IIe={kernelName:wf,backendName:"webgl",kernelFunc:TIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ie="return float(a >= 1.0 && b >= 1.0);",NIe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,EIe=An({opSnippet:$Ie,packedOpSnippet:NIe,dtype:"bool"}),RIe={kernelName:O0,backendName:"webgl",kernelFunc:EIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AIe="return float(!(x >= 1.0));",DIe=Je({opSnippet:AIe}),_Ie={kernelName:M0,backendName:"webgl",kernelFunc:DIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIe="return float(a >= 1.0 || b >= 1.0);",FIe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,OIe=An({opSnippet:PIe,packedOpSnippet:FIe,dtype:"bool"}),MIe={kernelName:L0,backendName:"webgl",kernelFunc:OIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LIe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zIe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=Y().getBool("WEBGL_PACK_NORMALIZATION")?new zIe(r.shape,i,o,a,l):new LIe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},BIe={kernelName:z0,backendName:"webgl",kernelFunc:VIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jIe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,h=new jIe(r.shape,a,l,c,u);return n.runWebGLProgram(h,[r,i,o],r.dtype)},UIe={kernelName:sT,backendName:"webgl",kernelFunc:WIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(t,e,n,s){const r=ne(e),o=ne(t.shape)/r,a=fe({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=ql(a,t.dtype,"max",s),c=fe({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=Ge(i,r.shape);let c=l;const u=Lt(c,a),h=u!=null,d=n.shouldExecuteOnCPU([r]);let f=r;if(h){if(d){const y=n.texData.get(f.dataId).values,b=new Array(a);for(let T=0;T<b.length;T++)b[T]=r.shape[u[T]];const C=h$(y,r.shape,r.dtype,u,b);f=n.makeTensorInfo(b,r.dtype);const S=n.texData.get(f.dataId);S.values=C}else f=Vv(r,u,n);c=Yt(c.length,a)}Rn("max",c,a);const[p,m]=Cn(f.shape,c);let v=p;o&&(v=nn(p,l));let x;if(d){const y=n.texData.get(f.dataId).values,b=Zwe(y,ne(m),v,r.dtype);x=n.makeTensorInfo(v,r.dtype);const C=n.texData.get(x.dataId);C.values=b}else x=GIe(f,m,v,n);return h&&n.disposeIntermediateTensorInfo(f),x}const HIe={kernelName:V0,backendName:"webgl",kernelFunc:wU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KIe=d$+`
  return max(a, b);
`,XIe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,qIe=An({opSnippet:KIe,packedOpSnippet:XIe,cpuKernelImpl:Jwe}),YIe={kernelName:Cf,backendName:"webgl",kernelFunc:qIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;cp(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Bn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Sr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&rt(u.inShape,u.outShape))return Ds({inputs:{x:r},backend:n});const h=new Ad(u,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const ZIe={kernelName:B0,backendName:"webgl",kernelFunc:QIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],h=po(r.shape,i,o,u,a,c,l),d=new p$(h,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const e$e={kernelName:j0,backendName:"webgl",kernelFunc:JIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t$e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class n$e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=po(o.shape,a,l,h,c,u),f=new p$(d,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new n$e(d),v=n.runWebGLProgram(m,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),v}const r$e={kernelName:iT,backendName:"webgl",kernelFunc:s$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;cp([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Sr(a.shape,l,c,1,u,h),f=!0,p=new Ad(d,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),v=new t$e(d),x=n.runWebGLProgram(v,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),x}const o$e={kernelName:rT,backendName:"webgl",kernelFunc:i$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$e(t,e,n,s){let r=new Ad(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new Ad(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$e={kernelName:ez,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;D(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];D(Bn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Sr(s.shape,r,i,c,o),[h,d]=a$e(s,a,u,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$e(t,e,n,s){const r=ne(e),o=ne(t.shape)/r,a=fe({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=ql(a,"float32","mean",s),c=fe({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u$e={kernelName:W0,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=Ge(i,s.shape);let c=l;const u=Lt(c,a),h=u!=null,d=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(h){if(d){const b=o.texData.get(p.dataId).values,C=new Array(a);for(let I=0;I<C.length;I++)C[I]=s.shape[u[I]];const S=h$(b,s.shape,s.dtype,u,C);p=o.makeTensorInfo(C,s.dtype);const T=o.texData.get(p.dataId);T.values=S}else p=Vv(s,u,o);f.push(p),c=Yt(c.length,a)}Rn("sum",c,a);const[m,v]=Cn(p.shape,c);let x=m;r&&(x=nn(m,l));const g=c$e(p,v,x,o);for(const y of f)o.disposeIntermediateTensorInfo(y);return g}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Ge(i,r.shape);let c=l;const u=Lt(c,a);let h=r;u!=null&&(h=ts({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Yt(c.length,r.shape.length)),Rn("min",c,a);const[d,f]=Cn(h.shape,c),p=ne(f),m=fe({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),v=ql(m,m.dtype,"min",n);let x;if(o){const g=nn(d,l);x=fe({inputs:{x:v},backend:n,attrs:{shape:g}})}else x=fe({inputs:{x:v},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),u!=null&&n.disposeIntermediateTensorInfo(h),x}const d$e={kernelName:U0,backendName:"webgl",kernelFunc:h$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$e=d$+`
  return min(a, b);
`,p$e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,m$e=An({opSnippet:f$e,packedOpSnippet:p$e,cpuKernelImpl:e1e}),g$e={kernelName:Sf,backendName:"webgl",kernelFunc:m$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x$e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,h)=>u[0]+e[h]+u[1]);const r=e.length,i=ct(r),o=n.map(u=>u[0]).join(","),a=n.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v$e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,i=ct(r),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=Zn("rc",r),c=Zn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y$e=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new v$e(s.shape,r,i):new x$e(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},b$e={kernelName:G0,backendName:"webgl",kernelFunc:y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$e=`if (b == 0.0) return NAN;
  return mod(a, b);`,C$e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Xl+`
  return result;
`,S$e=An({opSnippet:w$e,packedOpSnippet:C$e}),k$e={kernelName:kf,backendName:"webgl",kernelFunc:S$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T$e{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$e=`
if (a == b) {
  return 1.0;
};
return a / b;`,$$e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,CU=An({opSnippet:I$e,packedOpSnippet:$$e,checkOutOfBounds:!0}),N$e={kernelName:lf,backendName:"webgl",kernelFunc:CU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cD="return a - b;",SU=An({opSnippet:cD,packedOpSnippet:cD,supportsComplex:!0,cpuKernelImpl:w1e}),E$e={kernelName:Vf,backendName:"webgl",kernelFunc:SU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=Ge([i],r.shape),a=wU({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=nn(a.shape,o),c=fe({inputs:{x:a},backend:n,attrs:{shape:l}}),u=SU({inputs:{a:r,b:c},backend:n}),h=vU({inputs:{x:u},backend:n}),d=Bv({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=fe({inputs:{x:d},backend:n,attrs:{shape:l}}),p=CU({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const R$e={kernelName:cv,backendName:"webgl",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A$e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:kU({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new T$e(c,u,i),d=[[o]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const D$e={kernelName:tz,backendName:"webgl",kernelFunc:A$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _$e=Tr+`
  return -x;
`,P$e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function F$e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=n1e(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Fo(s.shape,P$e):r=new xi(s.shape,_$e),n.runWebGLProgram(r,[s],s.dtype)}const O$e={kernelName:H0,backendName:"webgl",kernelFunc:F$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M$e=eI;function L$e(t){Ms("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:h}=M$e(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const z$e={kernelName:oT,backendName:"webgl",kernelFunc:L$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V$e=tI;function B$e(t){Ms("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=V$e(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const j$e={kernelName:aT,backendName:"webgl",kernelFunc:B$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W$e=nI;function U$e(t){Ms("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),d=o,f=a,p=l,m=c,{selectedIndices:v,selectedScores:x}=W$e(u,h,d,f,p,m);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const G$e={kernelName:lT,backendName:"webgl",kernelFunc:U$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H$e{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K$e=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=ne(r.shape),u=new H$e(c,o,a,l),h=fe({inputs:{x:r},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);const f=[...r.shape,o],p=fe({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),p},X$e={kernelName:q0,backendName:"webgl",kernelFunc:K$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dx(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=hp({inputs:{input:s},backend:n}),i=dx({inputs:{x:r},backend:n}),o=jv({inputs:{input:s},backend:n}),a=dx({inputs:{x:o},backend:n}),l=$a({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return dp({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const q$e={kernelName:dv,backendName:"webgl",kernelFunc:dx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=hp({inputs:{input:s},backend:n}),i=TU({inputs:{x:r},backend:n}),o=jv({inputs:{input:s},backend:n}),a=dx({inputs:{x:o},backend:n}),l=$a({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return dp({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const Y$e={kernelName:X0,backendName:"webgl",kernelFunc:TU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return iC({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Ek(i,u.shape,"All tensors passed to stack must have matching shapes"),D(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=iC({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=uU({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const Z$e={kernelName:Y0,backendName:"webgl",kernelFunc:Q$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J$e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=ct(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eNe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,v)=>m[0]+e[v]+m[1]);const r=e.length,i=ct(r),o=n.map(m=>m[0]).join(","),a=n.map((m,v)=>m[0]+e[v]).join(","),l=Zn("rc",r),c=Zn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,v=r===1?2:4;m<v;m++)p+=`
        ${d[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${h});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IU=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(ne(r.shape)===0){const c=i.map((u,h)=>u[0]+r.shape[h]+u[1]);return dp({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eNe(r.shape,i,o):new J$e(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},tNe={kernelName:Q0,backendName:"webgl",kernelFunc:IU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nNe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,sNe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Xl+`
  return result;
`,rNe=An({opSnippet:nNe,packedOpSnippet:sNe}),iNe={kernelName:If,backendName:"webgl",kernelFunc:rNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=Ge(i,r.shape);let u=c;const h=Lt(u,a);let d=r;h!=null&&(d=ts({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Yt(u.length,a),l.push(d)),Rn("prod",u,a);let f;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:m,outShape:v,outDtype:x}=r1e(d.shape,d.dtype,p,u);f=n.makeTensorInfo(v,x,m)}else{const[p,m]=Cn(d.shape,u),v=ne(m),x=fe({inputs:{x:d},backend:n,attrs:{shape:[-1,v]}}),g=wT(r.dtype),y=ql(x,g,"prod",n);f=fe({inputs:{x:y},backend:n,attrs:{shape:p}}),l.push(x),l.push(y)}if(o){l.push(f);const p=nn(f.shape,c);f=fe({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const aNe={kernelName:J0,backendName:"webgl",kernelFunc:oNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,p]=i1e(l,c,u,i.shape,i.dtype,h,o.shape,a),m=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),v=n.makeTensorInfo(p,i.dtype,f);return m.concat([v])}const cNe={kernelName:nz,backendName:"webgl",kernelFunc:lNe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uNe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=o1e(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const hNe={kernelName:sz,backendName:"webgl",kernelFunc:uNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dNe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=a.map(v=>n.readSync(v.dataId)),f=a.map(v=>v.shape),[p,m]=a1e(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,m)}const fNe={kernelName:rz,backendName:"webgl",kernelFunc:dNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $U=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=l1e(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},pNe={kernelName:cT,backendName:"webgl",kernelFunc:$U};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mNe="return 1.0 / x;",gNe=Je({opSnippet:mNe}),xNe={kernelName:$f,backendName:"webgl",kernelFunc:gNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vNe=Tr+`
  return (x < 0.0) ? 0.0 : x;
`,yNe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bNe=Je({opSnippet:vNe,packedOpSnippet:yNe}),wNe={kernelName:Nf,backendName:"webgl",kernelFunc:bNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNe=Tr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,SNe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kNe=Je({opSnippet:CNe,packedOpSnippet:SNe}),TNe={kernelName:Ef,backendName:"webgl",kernelFunc:kNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class INe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ne{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new $Ne(r.shape,l,c,i,o):new INe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const ENe={kernelName:nv,backendName:"webgl",kernelFunc:NNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RNe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ANe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new RNe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const DNe={kernelName:dT,backendName:"webgl",kernelFunc:ANe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ne{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PNe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new PNe(r.shape,l,c,i,o):new _Ne(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const ONe={kernelName:tv,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MNe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new MNe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const zNe={kernelName:hT,backendName:"webgl",kernelFunc:LNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VNe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=ct(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Zn("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=ct(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${h(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",d(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",d(p)}function h(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",d(p)}function d(p){const m=e.map((g,y)=>f(y,p)),v=m.join(","),x=m.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${x}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=Ge(i,r.shape);if(o===0)return Ds({inputs:{x:r},backend:n});const l=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BNe(r.shape,a):new VNe(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const WNe={kernelName:sv,backendName:"webgl",kernelFunc:jNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UNe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNe={kernelName:yT,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new UNe(s.shape,i),[c,u]=fI(o,s.shape[1],s.shape[2]),h=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HNe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,KNe=Je({opSnippet:HNe}),XNe={kernelName:Rf,backendName:"webgl",kernelFunc:KNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qNe="return inversesqrt(x);",YNe=Je({opSnippet:qNe,cpuKernelImpl:c1e}),QNe={kernelName:Af,backendName:"webgl",kernelFunc:YNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m${constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=ct(i.length),u=ct(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const v=`getDefaultValue(${m})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZNe{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=ct(i.length),u=ct(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const v=`getDefaultValue(${m})`,x=n>1?"strides[j]":"strides",g=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${g};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Wl(i,r,o),d=[h/c,c];if(h===0)return n.makeTensorInfo(o,r.dtype);const f=fe({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=fe({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let v;Y().getBool("WEBGL_PACK")?v=new ZNe(l,a,f.shape.length,p.shape.length,u,d):v=new m$(l,a,f.shape.length,p.shape.length,u,d);const x=n.runWebGLProgram(v,[p,f,m],p.dtype),g=fe({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(m),g}const eEe={kernelName:iz,backendName:"webgl",kernelFunc:JNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tEe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=Y().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nEe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new tEe(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const sEe={kernelName:az,backendName:"webgl",kernelFunc:nEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rEe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=ct(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new rEe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],Rs(r.dtype,i.dtype))}const oEe={kernelName:rv,backendName:"webgl",kernelFunc:iEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aEe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${kv};
  float scale = ${Tv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,lEe=Je({opSnippet:aEe}),cEe={kernelName:Df,backendName:"webgl",kernelFunc:lEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uEe=Bu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,hEe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dEe=Je({opSnippet:uEe,packedOpSnippet:hEe,cpuKernelImpl:h1e}),fEe={kernelName:Of,backendName:"webgl",kernelFunc:dEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pEe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,mEe=Je({opSnippet:pEe}),gEe={kernelName:Ff,backendName:"webgl",kernelFunc:mEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xEe=Bu+`
  return sin(x);
`,vEe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Xl}
  return result;
`,yEe=Je({opSnippet:xEe,packedOpSnippet:vEe}),bEe={kernelName:_f,backendName:"webgl",kernelFunc:yEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wEe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,CEe=Je({opSnippet:wEe}),SEe={kernelName:Pf,backendName:"webgl",kernelFunc:CEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kEe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,TEe=Je({opSnippet:kEe}),IEe={kernelName:Mf,backendName:"webgl",kernelFunc:TEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ee=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;D(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,g)=>x*g),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=IU({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),h=Yf(u.shape,i,a,!1),d=Qf(h.length,i.length,!1),f=Zf(u.shape,i,a,!1),p=fe({inputs:{x:u},backend:n,attrs:{shape:h}}),m=ts({inputs:{x:p},backend:n,attrs:{perm:d}}),v=fe({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),v},NEe={kernelName:av,backendName:"webgl",kernelFunc:$Ee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EEe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[h,d,f,p,m]=f1e(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(v=>Number(v)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const REe={kernelName:lz,backendName:"webgl",kernelFunc:EEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AEe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,h]=p1e(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const DEe={kernelName:cz,backendName:"webgl",kernelFunc:AEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ee(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=QW(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const PEe={kernelName:uz,backendName:"webgl",kernelFunc:_Ee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FEe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=QW(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const OEe={kernelName:hz,backendName:"webgl",kernelFunc:FEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MEe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Wl(i,r,a),f=!1;if(i.dtype==="string"){const x=n.bufferSync(r),g=n.bufferSync(i),y=ra(n.readSync(o.dataId)[0]),b=u1e(x,g,a,d,u,c,l,h,y,f);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new m$(c,l,r.shape.length,i.shape.length,h,[d,1],f),m=n.runWebGLProgram(p,[i,r,o],i.dtype),v=fe({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),v}const LEe={kernelName:dz,backendName:"webgl",kernelFunc:MEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Ge(o,r.shape)[0],l=NI(r,i,a),c=r.shape.length,u=new Array(c).fill(0),h=r.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=ju({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const VEe={kernelName:lv,backendName:"webgl",kernelFunc:zEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uD="return sqrt(x);",BEe=Je({opSnippet:uD,packedOpSnippet:uD,cpuKernelImpl:m1e}),jEe={kernelName:Lf,backendName:"webgl",kernelFunc:BEe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WEe="return x * x;",UEe=Je({opSnippet:WEe}),GEe={kernelName:fT,backendName:"webgl",kernelFunc:UEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hD="return (a - b) * (a - b);",HEe=An({opSnippet:hD,packedOpSnippet:hD}),KEe={kernelName:zf,backendName:"webgl",kernelFunc:HEe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=uo(i),a=g1e(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const qEe={kernelName:pT,backendName:"webgl",kernelFunc:XEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YEe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=Tr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new xi(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const QEe={kernelName:Uf,backendName:"webgl",kernelFunc:YEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZEe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=ct(s.length),o=ct(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:v,isSimpleSlice:x,begin:g,end:y,strides:b}=uI(r.shape,i,o,a,l,c,u,h,d);let C;if(m)C=fe({inputs:{x:r},backend:n,attrs:{shape:p}});else if(v||x){D(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const T=aI(g,y,b),I=ju({inputs:{x:r},backend:n,attrs:{begin:g,size:T}});C=fe({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([r])){const I=n.readSync(r.dataId),$=Ue(r.shape,r.dtype,I),N=x1e(f,$,b,g);C=n.makeTensorInfo(p,r.dtype,N.values)}else{const I=new ZEe(g,b,f);C=n.runWebGLProgram(I,[r],r.dtype)}const S=fe({inputs:{x:C},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(C),S}const e2e={kernelName:mT,backendName:"webgl",kernelFunc:JEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,m]=v1e(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",m)]}const n2e={kernelName:fz,backendName:"webgl",kernelFunc:t2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s2e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,h]=y1e(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const r2e={kernelName:pz,backendName:"webgl",kernelFunc:s2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=b1e(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const o2e={kernelName:mz,backendName:"webgl",kernelFunc:i2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a2e="return tan(x);",l2e=Je({opSnippet:a2e}),c2e={kernelName:Bf,backendName:"webgl",kernelFunc:l2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u2e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,h2e=Je({opSnippet:u2e}),d2e={kernelName:jf,backendName:"webgl",kernelFunc:h2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2e(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Wl(o,i,r.shape),d=[h/c,c];if(h===0)return n.makeTensorInfo(r.shape,i.dtype);const f=fe({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=fe({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=fe({inputs:{x:r},backend:n,attrs:{shape:d}}),v=new m$(l,a,f.shape.length,p.shape.length,u,d,!1,!0),x=n.runWebGLProgram(v,[p,f,m],m.dtype),g=fe({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),g}const p2e={kernelName:oz,backendName:"webgl",kernelFunc:f2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m2e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=ct(this.rank),i=g2e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function g2e(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(d=>ra(d)):l,u=Ue(r.shape,r.dtype,c),h=C1e(u,i);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new m2e(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const x2e={kernelName:Wf,backendName:"webgl",kernelFunc:NU};class v2e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class y2e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function dD(t){let e=1;for(;e<t;)e*=2;return e}function b2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=Y().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Y().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const N=n.readSync(r.dataId),[A,F]=S1e(N,c,r.dtype,i,o);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,dp({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(r.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(r):r,m=ne(c)/u,v=fe({inputs:{x:f},attrs:{shape:[m,u]},backend:n});d&&Da(n,f);const x=dD(i),g=dD(u);let y=null;const b=()=>y===null?[v,v]:[v,y],C=(N,A,F)=>{const E=b(),R=new v2e(F),P=[[u],[y===null?1:0],[Number.NEGATIVE_INFINITY],[N],[A]],z=y;y=n.runWebGLProgram(R,E,"int32",P),Da(n,z)};for(let N=1;N<x;N*=2){const A=N*2;for(let F=N;F>=1;F/=2)C(A,F,[m,g])}for(let N=g;N>x;N/=2){const A=b(),F=new y2e([m,N/2]),R=[[u],[y===null?1:0],[x]],O=y;y=n.runWebGLProgram(F,A,"int32",R),Da(n,O);const P=x/2,z=P*2;for(let _=P;_>=1;_/=2)C(z,_,y.shape)}let S=y;y=ju({inputs:{x:y},backend:n,attrs:{begin:0,size:[m,i]}}),Da(n,S);let T=bU({inputs:{x:v,indices:y},backend:n,attrs:{axis:1,batchDims:1}});Da(n,v);const I=c.slice(0,-1);I.push(i),S=y,y=fe({inputs:{x:y},attrs:{shape:I},backend:n}),Da(n,S);const $=T;return T=fe({inputs:{x:T},attrs:{shape:I},backend:n}),Da(n,$),[T,y]}const w2e={kernelName:gT,backendName:"webgl",kernelFunc:b2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C2e{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,h,d,f]=r.shape,[p,m]=c??[h,d],v=[u,p,m,f],x=new C2e(h,d,o,a,l,v);return n.runWebGLProgram(x,[r,i],"float32")}const k2e={kernelName:xT,backendName:"webgl",kernelFunc:S2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;cp(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=k1e(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const I2e={kernelName:vT,backendName:"webgl",kernelFunc:T2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==i&&(c[u++]=o.shape[m]);const h=[],d=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){d[i]=m;const v=ju({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),x=fe({inputs:{x:v},backend:n,attrs:{shape:c}});p[m]=x,h.push(v)}return h.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const N2e={kernelName:uv,backendName:"webgl",kernelFunc:$2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E2e{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,h=s%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Lt([c],a);let h=r;u!=null&&(h=ts({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(h),c=Yt(1,a)[0]);const d=cB(h.shape,c,o),f=ne([h.shape[c]]),p=fe({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=wT(r.dtype),v=(b,C,S,T,I)=>{const $=b.shape[0],N=b.shape[1],A=lB(N,I),F={windowSize:A,inSize:N,batchSize:$,numSegments:I},E=new E2e(F,C),R=n.compileAndRun(E,[b,S],T);if(l.push(R),R.shape[1]===I)return R;const O=$U({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),P=NU({inputs:{x:O},backend:n,attrs:{reps:[N/A]}});return l.push(O),l.push(P),v(R,C,P,T,I)},x=v(p,"unsortedSegmentSum",i,m,o),g=fe({inputs:{x},backend:n,attrs:{shape:d}});let y=g;if(u!=null){l.push(g);const b=wa(u);y=ts({inputs:{x:y},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}const A2e={kernelName:hv,backendName:"webgl",kernelFunc:R2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D2e=[mCe,xCe,bCe,SCe,TCe,NCe,RCe,DCe,OCe,LCe,BCe,UCe,KCe,QCe,eSe,nSe,rSe,lSe,uSe,dSe,gSe,SSe,TSe,ESe,ASe,MSe,zSe,WSe,Z1e,HSe,QSe,tke,ake,uke,dke,pke,gke,bke,Ske,Ike,Nke,Rke,Dke,Fke,Mke,Bke,Wke,Hke,qke,Qke,tTe,iTe,cTe,dTe,mTe,gTe,vTe,bTe,CTe,kTe,ITe,RTe,_Te,OTe,LTe,BTe,UTe,XTe,ZTe,Q1e,eIe,qSe,sIe,oIe,cIe,eCe,fIe,xIe,yIe,SIe,IIe,RIe,_Ie,MIe,BIe,UIe,HIe,YIe,ZIe,e$e,r$e,o$e,l$e,u$e,d$e,g$e,b$e,k$e,D$e,sCe,O$e,z$e,j$e,G$e,_Se,X$e,Y$e,Z$e,tNe,iNe,nCe,aNe,cNe,hNe,fNe,pNe,PSe,N$e,xNe,wNe,TNe,iCe,ENe,DNe,ONe,zNe,WNe,GNe,XNe,QNe,eEe,sEe,oEe,cEe,fEe,gEe,bEe,SEe,wSe,R$e,IEe,NEe,REe,DEe,PEe,OEe,LEe,VEe,jEe,GEe,KEe,qEe,QEe,e2e,n2e,r2e,o2e,E$e,dCe,c2e,d2e,p2e,x2e,w2e,k2e,fCe,I2e,N2e,A2e,q$e];for(const t of D2e)xz(t);const fD=[{id:"all",name:"All",icon:K9},{id:"options",name:"Options",icon:j9},{id:"multipliers",name:"Multipliers",icon:Ci},{id:"accumulators",name:"Accumulators",icon:Hw}],$b=[{id:"rise-fall",name:"Rise/Fall",sub:"Ups & Downs",category:"options",icons:[w.jsx(zp,{className:"h-4 w-4"}),w.jsx(Lp,{className:"h-4 w-4"})],description:"Predict if the market will rise or fall from the entry spot"},{id:"higher-lower",name:"Higher/Lower",sub:"Ups & Downs",category:"options",icons:[w.jsx(zp,{className:"h-4 w-4"}),w.jsx(Lp,{className:"h-4 w-4"})],description:"Predict if the price will be higher or lower than the previous tick"},{id:"touch-no-touch",name:"Touch/No Touch",sub:"Touch & No Touch",category:"options",icons:[w.jsx(Y9,{className:"h-4 w-4"}),w.jsx(Ci,{className:"h-4 w-4"})],description:"Predict if the price will touch or not touch a specific barrier level"},{id:"matches-differs",name:"Matches/Differs",sub:"Digits",category:"options",icons:[w.jsx(Hw,{className:"h-4 w-4"}),w.jsx(Ci,{className:"h-4 w-4"})],description:"Predict if the last digit matches or differs from a chosen digit"},{id:"even-odd",name:"Even/Odd",sub:"Digits",category:"options",icons:[w.jsx(CO,{className:"h-4 w-4"}),w.jsx(Z9,{className:"h-4 w-4"})],description:"Predict if the last digit of the price will be even or odd"},{id:"over-under",name:"Over/Under",sub:"Digits",category:"options",icons:[w.jsx(zp,{className:"h-4 w-4"}),w.jsx(Lp,{className:"h-4 w-4"})],description:"Predict if the last digit will be over or under a specific number"},{id:"call-put",name:"Call/Put",sub:"Vanillas",category:"options",icons:[w.jsx(zp,{className:"h-4 w-4"}),w.jsx(Lp,{className:"h-4 w-4"})],description:"Standard call or put options with fixed expiry"},{id:"turbos",name:"Turbos",sub:"Turbos",category:"options",icons:[w.jsx(wi,{className:"h-4 w-4"}),w.jsx(ES,{className:"h-4 w-4"})],description:"Turbo options predicting up or down relative to a barrier"},{id:"multipliers",name:"Multipliers",sub:"Multipliers",category:"multipliers",icon:w.jsx(Ci,{className:"h-4 w-4"}),description:"Amplify your exposure to market movements with multipliers"},{id:"accumulators",name:"Accumulators",sub:"Accumulators",category:"accumulators",icon:w.jsx(Hw,{className:"h-4 w-4"}),description:"Compound gains within a price range with accumulator options"}],pD=({selectedCategory:t,onCategoryChange:e,categories:n})=>w.jsx("div",{className:"space-y-1",children:n.map(s=>w.jsxs(Be,{variant:t===s.id?"secondary":"ghost",className:"w-full justify-start h-10",onClick:()=>e(s.id),children:[s.icon&&w.jsx(s.icon,{className:"h-4 w-4 mr-2"}),s.name]},s.id))}),mD=({tradeTypesBySub:t,selectedTrade:e,onSelect:n,searchTerm:s})=>{const r=i=>{switch(i){case"rise-fall":return"Predict if the market will rise or fall from the entry spot";case"higher-lower":return"Predict if the price will be higher or lower than the previous tick";case"touch-no-touch":return"Predict if the price will touch or not touch a specific barrier level";case"matches-differs":return"Predict if the last digit matches or differs from a chosen digit";case"even-odd":return"Predict if the last digit of the price will be even or odd";case"over-under":return"Predict if the last digit will be over or under a specific number";case"call-put":return"Standard call or put options with fixed expiry";case"turbos":return"Turbo options predicting up or down relative to a barrier";case"accumulators":return"Compound gains within a price range with accumulator options";case"multipliers":return"Amplify your exposure to market movements with multipliers";default:return"Select a trade type"}};return w.jsx(ise,{children:w.jsxs("div",{className:"space-y-6",children:[w.jsxs(Nt.div,{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 cursor-pointer group",whileHover:{scale:1.02},transition:{duration:.2},children:[w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx(X9,{className:"h-4 w-4 text-blue-500"}),w.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Learn more about trade types"})]}),w.jsx(Nt.div,{className:"h-4 w-4 text-gray-400 group-hover:text-blue-600 transition-colors",animate:{x:0},whileHover:{x:4},transition:{duration:.2},children:w.jsx(wi,{className:"h-4 w-4"})})]}),Object.entries(t).map(([i,o])=>w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h4",{className:"text-sm font-semibold text-gray-800 uppercase tracking-wider bg-gradient-to-r from-gray-100 to-gray-200 px-3 py-1 rounded-full",children:i}),w.jsxs("span",{className:"text-xs text-gray-500",children:["(",o.length," types)"]})]}),w.jsx("div",{className:"space-y-2",children:o.map(a=>{const l=e.id===a.id,c=a.icons||(a.icon?[a.icon]:[]);return w.jsxs(ose,{children:[w.jsx(ase,{asChild:!0,children:w.jsx(Nt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},transition:{duration:.1},children:w.jsxs(Be,{variant:"ghost",className:Ie("w-full justify-start h-12 rounded-lg px-3 py-2 transition-all duration-300 relative overflow-hidden",l?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 border border-blue-200 shadow-sm hover:shadow-md":"text-gray-700 hover:bg-gray-50 hover:border-gray-200 hover:text-gray-900 border border-transparent"),onClick:()=>n(a),children:[l&&w.jsx("div",{className:"absolute left-0 top-0 h-full w-1 bg-gradient-to-b from-blue-500 to-indigo-600"}),w.jsxs("div",{className:"flex items-center space-x-3 relative z-10",children:[w.jsx("div",{className:Ie("flex space-x-1 flex-shrink-0 p-2 rounded-lg transition-colors duration-300",l?"bg-blue-100":"bg-gray-100 hover:bg-gray-200"),children:c.map((u,h)=>w.jsx("div",{className:"flex-shrink-0",children:u},h))}),w.jsx("div",{className:"flex-1 min-w-0",children:w.jsx("span",{className:Ie("font-semibold text-left truncate",l?"text-blue-700":"text-gray-800"),children:a.name})}),l&&w.jsx("div",{className:"ml-auto flex-shrink-0",children:w.jsx("div",{className:"w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold shadow-md",children:""})})]})]})})}),w.jsx(g3,{side:"right",className:"max-w-xs bg-gray-900 text-white text-sm p-4 rounded-xl shadow-2xl border border-gray-700/50",children:w.jsxs("div",{className:"space-y-2",children:[w.jsx("strong",{className:"block text-white font-semibold",children:a.name}),w.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:r(a.id)})]})})]},a.id)})})]},i))]})})},gD=({onTradeTypeChange:t,onTrade:e,latestTick:n,selectedMarket:s,isLoggedIn:r=!0,isMobile:i=!1})=>{const[o,a]=k.useState($b.find(R=>R.id==="rise-fall")||$b[0]),[l,c]=k.useState("options"),[u,h]=k.useState(""),[d,f]=k.useState([]),[p,m]=k.useState(!1),[v,x]=k.useState(null),[g,y]=k.useState(!1),[b,C]=k.useState(!1),S=k.useRef(null),T=["Initializing predictive model...","Fetching real-time market data...","Analyzing volume spikes & volatility...","Processing moving average convergence...","Evaluating RSI and stochastic oscillators...","Running sentiment analysis...","Compiling pattern recognition results...","Calculating predictive accuracy matrix...","Finalizing market direction forecast...","Prediction generated."];k.useEffect(()=>{t(o.id)},[o,t]);const $=$b.filter(R=>{const O=l==="all"||R.category===l,P=!u||R.name.toLowerCase().includes(u.toLowerCase())||R.description.toLowerCase().includes(u.toLowerCase());return O&&P}).reduce((R,O)=>((R[O.sub]=R[O.sub]||[]).push(O),R),{}),N=async()=>{await new Promise(P=>setTimeout(P,500));const R=Math.random()>.5?"UP":"DOWN",O=70+Math.random()*25;return{direction:R,accuracy:O,timestamp:new Date().toLocaleTimeString()}},A=async()=>{m(!0),f([]);for(let O=0;O<T.length;O++)f(P=>[...P,{text:T[O],id:Date.now()+Math.random()}]),await new Promise(P=>setTimeout(P,250));const R=await N();x(R),m(!1)};k.useEffect(()=>{A();const R=setInterval(A,15e3);return()=>clearInterval(R)},[]),k.useEffect(()=>{S.current&&(S.current.scrollTop=S.current.scrollHeight)},[d]);const F=R=>{if(!r){alert("Please log in to execute trades.");return}e(R)};if(!r)return w.jsx("div",{className:"flex flex-col h-full justify-center items-center bg-gradient-to-br from-blue-50 to-indigo-100",children:w.jsx(Nt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center p-8 max-w-md mx-auto",children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-200",children:[w.jsx(ZE,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),w.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Welcome Back"}),w.jsx("p",{className:"mb-6 text-gray-600",children:"Log in to access advanced trading features and AI predictions."}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs(Be,{className:"w-full h-12 text-lg font-semibold bg-blue-600 hover:bg-blue-700 shadow-lg",children:[w.jsx(ZE,{className:"mr-2 h-5 w-5"}),"Log In"]}),w.jsxs(Be,{variant:"outline",className:"w-full h-12 text-lg font-semibold border-gray-300",children:[w.jsx(e7,{className:"mr-2 h-5 w-5"}),"Sign Up"]})]})]})})});const E=()=>i?w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[w.jsx("span",{className:"text-xs font-semibold uppercase text-gray-600 tracking-wide",children:"All Trades"}),w.jsx(YE,{className:"h-4 w-4 text-gray-500"})]}),w.jsx(pD,{selectedCategory:l,onCategoryChange:c,categories:fD}),w.jsxs("div",{className:"relative",children:[w.jsx(Ig,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),w.jsx(mi,{placeholder:"Search trade types...",className:"pl-10 pr-4 py-2 text-sm bg-white border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 rounded-lg",value:u,onChange:R=>h(R.target.value)})]}),w.jsx(mD,{tradeTypesBySub:$,selectedTrade:o,onSelect:a,searchTerm:u})]}):w.jsxs("div",{className:"flex h-full",children:[w.jsxs("div",{className:"w-48 border-r border-gray-200 p-4 flex flex-col",children:[w.jsx("div",{className:"mb-4 pb-2 border-b border-gray-100",children:w.jsxs("span",{className:"text-xs font-semibold uppercase text-gray-600 tracking-wide flex items-center justify-between",children:["All Trades",w.jsx(YE,{className:"h-4 w-4 text-gray-500"})]})}),w.jsx(pD,{selectedCategory:l,onCategoryChange:c,categories:fD})]}),w.jsxs("div",{className:"flex-1 p-4 overflow-auto",children:[w.jsxs("div",{className:"relative mb-4",children:[w.jsx(Ig,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),w.jsx(mi,{placeholder:"Search trade types...",className:"pl-10 pr-4 py-2 text-sm bg-white border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 rounded-lg",value:u,onChange:R=>h(R.target.value)})]}),w.jsx(mD,{tradeTypesBySub:$,selectedTrade:o,onSelect:a,searchTerm:u})]})]});return w.jsxs("div",{className:"flex flex-col h-full bg-gradient-to-br from-gray-50 via-white to-gray-100 overflow-hidden",children:[w.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg p-4 flex items-center justify-between z-10",children:[w.jsxs("div",{className:"flex items-center space-x-3",children:[w.jsx(Tg,{className:"h-5 w-5"}),w.jsx("h2",{className:"text-lg font-bold truncate",children:o.name})]}),w.jsx(Be,{variant:"ghost",size:"icon",onClick:()=>y(!g),className:"text-white hover:bg-white/20 rounded-full",children:i?g?w.jsx(Ci,{className:"h-5 w-5"}):w.jsx(bO,{className:"h-5 w-5"}):w.jsx(Gw,{className:`h-5 w-5 transition-transform ${g?"rotate-180":"rotate-0"}`})})]}),w.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[w.jsx(Pc,{children:g&&w.jsxs(Nt.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{duration:.3,ease:"easeInOut"},className:`absolute inset-y-0 left-0 z-50 bg-white/95 backdrop-blur-xl border-r border-gray-200 shadow-2xl overflow-hidden ${i?"w-full":"w-96"}`,children:[w.jsx("div",{className:"flex justify-end p-4 bg-gradient-to-b from-gray-50 to-white border-b border-gray-100",children:w.jsx(Be,{variant:"ghost",size:"icon",onClick:()=>y(!1),className:"hover:bg-gray-200 rounded-full",children:w.jsx(Ci,{className:"h-5 w-5"})})}),w.jsx(Do,{className:"h-full",children:E()})]})}),g&&i&&w.jsx(Nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-40 bg-black/30 backdrop-blur-sm",onClick:()=>y(!1)}),w.jsx("div",{className:"flex-1 overflow-hidden relative z-0 w-full",children:w.jsx(Do,{className:"h-full",children:w.jsx("div",{className:"p-4 space-y-6",children:w.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 w-full",children:w.jsx(Dse,{tradeType:o,onTrade:F,latestTick:n,selectedMarket:s,showPayout:b})})})})})]}),w.jsxs("div",{className:"h-64 md:h-72 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 text-slate-200 font-mono text-sm p-4 border-t border-slate-700 shadow-2xl flex-shrink-0 relative overflow-hidden",children:[w.jsx("div",{className:"absolute inset-0 opacity-5",children:w.jsx("div",{className:"absolute inset-0 bg-grid-slate-700/[0.1] bg-[size:40px_40px]"})}),w.jsxs("div",{className:"relative z-10 flex items-center justify-between pb-3 border-b border-slate-600 mb-3",children:[w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx(Nt.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"h-5 w-5 bg-green-500 rounded-full flex items-center justify-center",children:w.jsx(Ww,{className:"h-3 w-3 text-slate-900"})}),w.jsx("span",{className:"font-semibold text-sm text-green-400 tracking-wide",children:"XtradingAI v2.1 - Neural Predictor"})]}),w.jsxs("div",{className:"flex items-center space-x-1 text-xs text-slate-500",children:[w.jsx(XE,{className:"h-3 w-3 animate-pulse"}),w.jsx("span",{children:"ML Active"})]})]}),w.jsxs("div",{className:"flex flex-col h-full",children:[w.jsxs("div",{className:"flex-1 max-h-32 md:max-h-40 overflow-y-auto pr-2 mb-3 scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800",ref:S,children:[w.jsx(Pc,{mode:"popLayout",children:d.slice(-8).map(R=>w.jsxs(Nt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},className:"mb-1.5 flex items-start",children:[w.jsxs("span",{className:"text-slate-500 mr-3 text-xs flex-shrink-0",children:["[",new Date().toLocaleTimeString("en-US",{hour12:!1}),"] "]}),w.jsx("span",{className:"text-xs text-slate-300 flex-1 leading-relaxed",children:R.text})]},R.id))}),p&&w.jsxs("div",{className:"flex items-center text-yellow-400 text-xs mt-2 animate-pulse",children:[w.jsx(XE,{className:"h-3 w-3 mr-2"}),w.jsx("span",{children:"Recomputing neural weights..."})]})]}),w.jsx("div",{className:"sticky bottom-0 bg-slate-900/95 backdrop-blur-sm pt-3 pb-2 border-t border-slate-600",children:v&&!p?w.jsxs(Nt.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.4,type:"spring"},className:"bg-slate-800/80 p-3 md:p-4 rounded-lg border border-slate-600 shadow-lg ring-1 ring-slate-700/50",children:[w.jsxs("div",{className:"text-xs text-slate-400 mb-2 opacity-90",children:["Forecast: ",v.timestamp]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsxs("div",{className:`flex items-center space-x-2 text-lg md:text-xl font-bold p-2 rounded-lg transition-all duration-300 ${v.direction==="UP"?"text-green-400 bg-green-900/20 ring-1 ring-green-500/30":"text-red-400 bg-red-900/20 ring-1 ring-red-500/30"}`,children:[v.direction==="UP"?w.jsx(wi,{className:"h-4 w-4 animate-bounce"}):w.jsx(ES,{className:"h-4 w-4 animate-bounce"}),w.jsx("span",{children:v.direction})]}),w.jsxs("div",{className:"text-right space-y-1",children:[w.jsx("span",{className:"text-xs text-slate-400",children:"Confidence"}),w.jsxs("div",{className:"flex items-center justify-end space-x-1",children:[w.jsx("div",{className:"w-16 bg-slate-700 rounded-full h-2",children:w.jsx(Nt.div,{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-2 rounded-full",initial:{width:0},animate:{width:`${v.accuracy}%`},transition:{duration:1.5,ease:"easeOut"}})}),w.jsxs("span",{className:"text-sm font-bold text-blue-400",children:[v.accuracy.toFixed(1),"%"]})]})]})]})]},v.timestamp):w.jsx("div",{className:"text-center text-xs text-slate-500 py-4",children:"Initializing prediction..."})})]})]})]})};class _2e extends oe.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n)}render(){return this.state.hasError?w.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded-lg",children:w.jsxs("div",{className:"text-center p-4",children:[w.jsx("h1",{className:"text-xl font-bold text-red-600 mb-2",children:"Something went wrong."}),w.jsx("p",{className:"text-gray-700",children:"There was an error loading the chart. Please try refreshing the page."})]})}):this.props.children}}const P2e=(t,e=60)=>{const[n,s]=k.useState([]),[r,i]=k.useState(!1),[o,a]=k.useState(null),[l,c]=k.useState(null),u=k.useRef(null),h=k.useRef(null),d=k.useRef(null),f=k.useRef(null),p=k.useRef(!1),m=k.useCallback(()=>{const x={}.VITE_DERIV_APP_ID||"1089";u.current&&u.current.readyState===WebSocket.OPEN||(u.current=new WebSocket(`wss://ws.derivws.com/websockets/v3?app_id=${x}`),u.current.onopen=()=>{i(!0),a(null);const g=localStorage.getItem("deriv_token")||{}.VITE_DERIV_TOKEN||"jou0fybwR6nu3Qs";g?u.current.send(JSON.stringify({authorize:g})):(p.current=!0,v())},u.current.onmessage=g=>{const y=JSON.parse(g.data);if(y.error){y.error.code!=="AlreadySubscribed"&&(console.error("Deriv API Error:",y.error.message),a(y.error.message),gt({title:"API Error",description:y.error.message,variant:"destructive"}));return}if(y.msg_type==="proposal"&&gt({title:"Trade Proposal Received",description:`Buy price: ${y.proposal.display_value}. Payout: ${y.proposal.payout}.`}),y.msg_type==="buy"&&gt({title:"Trade Executed Successfully",description:`Contract ID: ${y.buy.contract_id}. Price: ${y.buy.buy_price}`}),y.msg_type==="authorize"&&(y.authorize?(p.current=!0,v()):a("Authorization failed")),y.msg_type==="candles"){const b=y.candles.map(C=>({time:C.epoch,open:parseFloat(C.open),high:parseFloat(C.high),low:parseFloat(C.low),close:parseFloat(C.close)}));s(b)}if(y.msg_type==="tick"){h.current=y.subscription.id;const b=y.tick,C=parseFloat(b.quote);c(S=>({price:C,change:S?C-S.price:0,percentChange:S&&S.price!==0?(C-S.price)/S.price*100:0,id:b.id})),s(S=>{if(S.length===0)return[];const T={...S[S.length-1]},I=Math.floor(b.epoch/e)*e;if(e===0){const A={time:b.epoch,open:C,high:C,low:C,close:C};return[...S,A].slice(-1e3)}const $=Math.floor(T.time/e)*e,N=$+e;if(I>=$&&I<N)return T.close=C,T.high=Math.max(T.high,C),T.low=Math.min(T.low,C),[...S.slice(0,-1),T];if(I>=N){const A={time:I,open:C,high:C,low:C,close:C};return[...S,A].slice(-500)}return S})}},u.current.onerror=g=>{console.error("WebSocket connection error",g),a("WebSocket connection error. Check console for details."),i(!1)},u.current.onclose=()=>{i(!1),p.current=!1,d.current&&clearTimeout(d.current),d.current=setTimeout(m,5e3)})},[t,e]),v=k.useCallback(()=>{h.current&&u.current.send(JSON.stringify({forget:h.current})),u.current.send(JSON.stringify({ticks_history:t,adjust_start_time:1,count:1e3,end:"latest",start:1,style:"candles",granularity:e})),u.current.send(JSON.stringify({ticks:t,subscribe:1}))},[t,e]);return k.useEffect(()=>{m();const x=g=>{u.current&&u.current.readyState===WebSocket.OPEN&&u.current.send(JSON.stringify(g))};return f.current={sendRequest:x},()=>{d.current&&clearTimeout(d.current),u.current&&(u.current.onclose=null,u.current.readyState===WebSocket.OPEN&&h.current&&u.current.send(JSON.stringify({forget:h.current})),u.current.close(),u.current=null)}},[m]),{marketData:n,isConnected:r,error:o,latestTick:l,api:f.current}};var Wv="Dialog",[EU,YAe]=_s(Wv),[F2e,ni]=EU(Wv),RU=t=>{const{__scopeDialog:e,children:n,open:s,defaultOpen:r,onOpenChange:i,modal:o=!0}=t,a=k.useRef(null),l=k.useRef(null),[c,u]=Gs({prop:s,defaultProp:r??!1,onChange:i,caller:Wv});return w.jsx(F2e,{scope:e,triggerRef:a,contentRef:l,contentId:gr(),titleId:gr(),descriptionId:gr(),open:c,onOpenChange:u,onOpenToggle:k.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};RU.displayName=Wv;var AU="DialogTrigger",DU=k.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,r=ni(AU,n),i=Le(e,r.triggerRef);return w.jsx(Te.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":v$(r.open),...s,ref:i,onClick:be(t.onClick,r.onOpenToggle)})});DU.displayName=AU;var g$="DialogPortal",[O2e,_U]=EU(g$,{forceMount:void 0}),PU=t=>{const{__scopeDialog:e,forceMount:n,children:s,container:r}=t,i=ni(g$,e);return w.jsx(O2e,{scope:e,forceMount:n,children:k.Children.map(s,o=>w.jsx(gs,{present:n||i.open,children:w.jsx(Gd,{asChild:!0,container:r,children:o})}))})};PU.displayName=g$;var fx="DialogOverlay",FU=k.forwardRef((t,e)=>{const n=_U(fx,t.__scopeDialog),{forceMount:s=n.forceMount,...r}=t,i=ni(fx,t.__scopeDialog);return i.modal?w.jsx(gs,{present:s||i.open,children:w.jsx(L2e,{...r,ref:e})}):null});FU.displayName=fx;var M2e=fl("DialogOverlay.RemoveScroll"),L2e=k.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,r=ni(fx,n);return w.jsx(hk,{as:M2e,allowPinchZoom:!0,shards:[r.contentRef],children:w.jsx(Te.div,{"data-state":v$(r.open),...s,ref:e,style:{pointerEvents:"auto",...s.style}})})}),Al="DialogContent",OU=k.forwardRef((t,e)=>{const n=_U(Al,t.__scopeDialog),{forceMount:s=n.forceMount,...r}=t,i=ni(Al,t.__scopeDialog);return w.jsx(gs,{present:s||i.open,children:i.modal?w.jsx(z2e,{...r,ref:e}):w.jsx(V2e,{...r,ref:e})})});OU.displayName=Al;var z2e=k.forwardRef((t,e)=>{const n=ni(Al,t.__scopeDialog),s=k.useRef(null),r=Le(e,n.contentRef,s);return k.useEffect(()=>{const i=s.current;if(i)return uk(i)},[]),w.jsx(MU,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:be(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:be(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:be(t.onFocusOutside,i=>i.preventDefault())})}),V2e=k.forwardRef((t,e)=>{const n=ni(Al,t.__scopeDialog),s=k.useRef(!1),r=k.useRef(!1);return w.jsx(MU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(s.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&r.current&&i.preventDefault()}})}),MU=k.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:i,...o}=t,a=ni(Al,n),l=k.useRef(null),c=Le(e,l);return QS(),w.jsxs(w.Fragment,{children:[w.jsx(Kx,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:i,children:w.jsx(bu,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":v$(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),w.jsxs(w.Fragment,{children:[w.jsx(B2e,{titleId:a.titleId}),w.jsx(W2e,{contentRef:l,descriptionId:a.descriptionId})]})]})}),x$="DialogTitle",LU=k.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,r=ni(x$,n);return w.jsx(Te.h2,{id:r.titleId,...s,ref:e})});LU.displayName=x$;var zU="DialogDescription",VU=k.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,r=ni(zU,n);return w.jsx(Te.p,{id:r.descriptionId,...s,ref:e})});VU.displayName=zU;var BU="DialogClose",jU=k.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,r=ni(BU,n);return w.jsx(Te.button,{type:"button",...s,ref:e,onClick:be(t.onClick,()=>r.onOpenChange(!1))})});jU.displayName=BU;function v$(t){return t?"open":"closed"}var WU="DialogTitleWarning",[QAe,UU]=IZ(WU,{contentName:Al,titleName:x$,docsSlug:"dialog"}),B2e=({titleId:t})=>{const e=UU(WU),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return k.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},j2e="DialogDescriptionWarning",W2e=({contentRef:t,descriptionId:e})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${UU(j2e).contentName}}.`;return k.useEffect(()=>{var i;const r=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(s))},[s,t,e]),null},GU=RU,U2e=DU,HU=PU,y$=FU,b$=OU,w$=LU,C$=VU,KU=jU,XU=oe.createContext({drawerRef:{current:null},overlayRef:{current:null},scaleBackground:()=>{},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},visible:!1,closeDrawer:()=>{},setVisible:()=>{},direction:"bottom"}),S$=()=>oe.useContext(XU);function G2e(t,{insertAt:e}={}){if(!t||typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}G2e(`[vaul-drawer]{touch-action:none;transition:transform .5s cubic-bezier(.32,.72,0,1)}[vaul-drawer][vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[vaul-drawer][vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[vaul-drawer][vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[vaul-drawer][vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}.vaul-dragging .vaul-scrollable [vault-drawer-direction=top],.vaul-dragging .vaul-scrollable [vault-drawer-direction=bottom]{overflow-y:hidden!important}.vaul-dragging .vaul-scrollable [vault-drawer-direction=left],.vaul-dragging .vaul-scrollable [vault-drawer-direction=right]{overflow-x:hidden!important}[vaul-drawer][vaul-drawer-visible=true][vaul-drawer-direction=top],[vaul-drawer][vaul-drawer-visible=true][vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height, 0),0)}[vaul-drawer][vaul-drawer-visible=true][vaul-drawer-direction=left],[vaul-drawer][vaul-drawer-visible=true][vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height, 0),0,0)}[vaul-overlay]{opacity:0;transition:opacity .5s cubic-bezier(.32,.72,0,1)}[vaul-overlay][vaul-drawer-visible=true]{opacity:1}[vaul-drawer]:after{content:"";position:absolute;background:inherit;background-color:inherit}[vaul-drawer][vaul-drawer-direction=top]:after{top:initial;bottom:100%;left:0;right:0;height:200%}[vaul-drawer][vaul-drawer-direction=bottom]:after{top:100%;bottom:initial;left:0;right:0;height:200%}[vaul-drawer][vaul-drawer-direction=left]:after{left:initial;right:100%;top:0;bottom:0;width:200%}[vaul-drawer][vaul-drawer-direction=right]:after{left:100%;right:initial;top:0;bottom:0;width:200%}[vaul-overlay][vaul-snap-points=true]:not([vaul-snap-points-overlay="true"]):not([data-state="closed"]){opacity:0}[vaul-overlay][vaul-snap-points-overlay=true]:not([vaul-drawer-visible="false"]){opacity:1}@keyframes fake-animation{}@media (hover: hover) and (pointer: fine){[vaul-drawer]{user-select:none}}
`);var H2e=typeof window<"u"?k.useLayoutEffect:k.useEffect;function oC(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}function K2e(){return k$(/^Mac/)}function X2e(){return k$(/^iPhone/)}function q2e(){return k$(/^iPad/)||K2e()&&navigator.maxTouchPoints>1}function qU(){return X2e()||q2e()}function k$(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}var Nb=typeof document<"u"&&window.visualViewport;function xD(t){let e=window.getComputedStyle(t);return/(auto|scroll)/.test(e.overflow+e.overflowX+e.overflowY)}function YU(t){for(xD(t)&&(t=t.parentElement);t&&!xD(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}var Y2e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]),gm=0,Eb;function Q2e(t={}){let{isDisabled:e}=t;H2e(()=>{if(!e)return gm++,gm===1&&(qU()?Eb=J2e():Eb=Z2e()),()=>{gm--,gm===0&&Eb()}},[e])}function Z2e(){return oC(QU(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`))}function J2e(){let t,e=0,n=h=>{t=YU(h.target),!(t===document.documentElement&&t===document.body)&&(e=h.changedTouches[0].pageY)},s=h=>{if(!t||t===document.documentElement||t===document.body){h.preventDefault();return}let d=h.changedTouches[0].pageY,f=t.scrollTop,p=t.scrollHeight-t.clientHeight;p!==0&&((f<=0&&d>e||f>=p&&d<e)&&h.preventDefault(),e=d)},r=h=>{let d=h.target;px(d)&&d!==document.activeElement&&(h.preventDefault(),d.style.transform="translateY(-2000px)",d.focus(),requestAnimationFrame(()=>{d.style.transform=""}))},i=h=>{let d=h.target;px(d)&&(d.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{d.style.transform="",Nb&&(Nb.height<window.innerHeight?requestAnimationFrame(()=>{vD(d)}):Nb.addEventListener("resize",()=>vD(d),{once:!0}))}))},o=()=>{window.scrollTo(0,0)},a=window.pageXOffset,l=window.pageYOffset,c=oC(QU(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let u=oC(ch(document,"touchstart",n,{passive:!1,capture:!0}),ch(document,"touchmove",s,{passive:!1,capture:!0}),ch(document,"touchend",r,{passive:!1,capture:!0}),ch(document,"focus",i,!0),ch(window,"scroll",o));return()=>{c(),u(),window.scrollTo(a,l)}}function QU(t,e,n){let s=t.style[e];return t.style[e]=n,()=>{t.style[e]=s}}function ch(t,e,n,s){return t.addEventListener(e,n,s),()=>{t.removeEventListener(e,n,s)}}function vD(t){let e=document.scrollingElement||document.documentElement;for(;t&&t!==e;){let n=YU(t);if(n!==document.documentElement&&n!==document.body&&n!==t){let s=n.getBoundingClientRect().top,r=t.getBoundingClientRect().top,i=t.getBoundingClientRect().bottom,o=n.getBoundingClientRect().bottom;i>o&&(n.scrollTop+=r-s)}t=n.parentElement}}function px(t){return t instanceof HTMLInputElement&&!Y2e.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function eRe(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function tRe(...t){return e=>t.forEach(n=>eRe(n,e))}function ZU(...t){return k.useCallback(tRe(...t),t)}var wo=null;function nRe({isOpen:t,modal:e,nested:n,hasBeenOpened:s,preventScrollRestoration:r}){let[i,o]=oe.useState(typeof window<"u"?window.location.href:""),a=oe.useRef(0);function l(){if(wo===null&&t){wo={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height};let{scrollX:u,innerHeight:h}=window;document.body.style.setProperty("position","fixed","important"),document.body.style.top=`${-a.current}px`,document.body.style.left=`${-u}px`,document.body.style.right="0px",document.body.style.height="auto",setTimeout(()=>requestAnimationFrame(()=>{let d=h-window.innerHeight;d&&a.current>=h&&(document.body.style.top=`${-(a.current+d)}px`)}),300)}}function c(){if(wo!==null){let u=-parseInt(document.body.style.top,10),h=-parseInt(document.body.style.left,10);document.body.style.position=wo.position,document.body.style.top=wo.top,document.body.style.left=wo.left,document.body.style.height=wo.height,document.body.style.right="unset",requestAnimationFrame(()=>{if(r&&i!==window.location.href){o(window.location.href);return}window.scrollTo(h,u)}),wo=null}}return oe.useEffect(()=>{function u(){a.current=window.scrollY}return u(),window.addEventListener("scroll",u),()=>{window.removeEventListener("scroll",u)}},[]),oe.useEffect(()=>{n||!s||(t?(l(),e||setTimeout(()=>{c()},500)):c())},[t,s,i]),{restorePositionSetting:c}}var JU=new WeakMap;function Pt(t,e,n=!1){if(!t||!(t instanceof HTMLElement)||!e)return;let s={};Object.entries(e).forEach(([r,i])=>{if(r.startsWith("--")){t.style.setProperty(r,i);return}s[r]=t.style[r],t.style[r]=i}),!n&&JU.set(t,s)}function uh(t,e){if(!t||!(t instanceof HTMLElement))return;let n=JU.get(t);n&&(e?t.style[e]=n[e]:Object.entries(n).forEach(([s,r])=>{t.style[s]=r}))}var rn=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function xm(t,e){let n=window.getComputedStyle(t),s=n.transform||n.webkitTransform||n.mozTransform,r=s.match(/^matrix3d\((.+)\)$/);return r?parseFloat(r[1].split(", ")[rn(e)?13:12]):(r=s.match(/^matrix\((.+)\)$/),r?parseFloat(r[1].split(", ")[rn(e)?5:4]):null)}function sRe(t){return 8*(Math.log(t+1)-2)}var ft={DURATION:.5,EASE:[.32,.72,0,1]},eG=.4;function tG(t){let e=oe.useRef(t);return oe.useEffect(()=>{e.current=t}),oe.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function rRe({defaultProp:t,onChange:e}){let n=oe.useState(t),[s]=n,r=oe.useRef(s),i=tG(e);return oe.useEffect(()=>{r.current!==s&&(i(s),r.current=s)},[s,r,i]),n}function iRe({prop:t,defaultProp:e,onChange:n=()=>{}}){let[s,r]=rRe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:s,a=tG(n),l=oe.useCallback(c=>{if(i){let u=typeof c=="function"?c(t):c;u!==t&&a(u)}else r(c)},[i,t,r,a]);return[o,l]}function oRe({activeSnapPointProp:t,setActiveSnapPointProp:e,snapPoints:n,drawerRef:s,overlayRef:r,fadeFromIndex:i,onSnapPointChange:o,direction:a="bottom"}){let[l,c]=iRe({prop:t,defaultProp:n==null?void 0:n[0],onChange:e}),u=oe.useMemo(()=>l===(n==null?void 0:n[n.length-1]),[n,l]),h=n&&n.length>0&&(i||i===0)&&!Number.isNaN(i)&&n[i]===l||!n,d=oe.useMemo(()=>{var y;return(y=n==null?void 0:n.findIndex(b=>b===l))!=null?y:null},[n,l]),f=oe.useMemo(()=>{var y;return(y=n==null?void 0:n.map(b=>{let C=typeof window<"u",S=typeof b=="string",T=0;if(S&&(T=parseInt(b,10)),rn(a)){let $=S?T:C?b*window.innerHeight:0;return C?a==="bottom"?window.innerHeight-$:-window.innerHeight+$:$}let I=S?T:C?b*window.innerWidth:0;return C?a==="right"?window.innerWidth-I:-window.innerWidth+I:I}))!=null?y:[]},[n]),p=oe.useMemo(()=>d!==null?f==null?void 0:f[d]:null,[f,d]),m=oe.useCallback(y=>{var b;let C=(b=f==null?void 0:f.findIndex(S=>S===y))!=null?b:null;o(C),Pt(s.current,{transition:`transform ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`,transform:rn(a)?`translate3d(0, ${y}px, 0)`:`translate3d(${y}px, 0, 0)`}),f&&C!==f.length-1&&C!==i?Pt(r.current,{transition:`opacity ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`,opacity:"0"}):Pt(r.current,{transition:`opacity ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`,opacity:"1"}),c(C!==null?n==null?void 0:n[C]:null)},[s.current,n,f,i,r,c]);oe.useEffect(()=>{var y;if(t){let b=(y=n==null?void 0:n.findIndex(C=>C===t))!=null?y:null;f&&b&&typeof f[b]=="number"&&m(f[b])}},[t,n,f,m]);function v({draggedDistance:y,closeDrawer:b,velocity:C,dismissible:S}){if(i===void 0)return;let T=a==="bottom"||a==="right"?p??0-y:p??0+y,I=d===i-1,$=d===0,N=y>0;if(I&&Pt(r.current,{transition:`opacity ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`}),C>2&&!N){S?b():m(f[0]);return}if(C>2&&N&&f&&n){m(f[n.length-1]);return}let A=f==null?void 0:f.reduce((E,R)=>typeof E!="number"||typeof R!="number"?E:Math.abs(R-T)<Math.abs(E-T)?R:E),F=rn(a)?window.innerHeight:window.innerWidth;if(C>eG&&Math.abs(y)<F*.4){let E=N?1:-1;if(E>0&&u){m(f[n.length-1]);return}if($&&E<0&&S&&b(),d===null)return;m(f[d+E]);return}m(A)}function x({draggedDistance:y}){if(p===null)return;let b=a==="bottom"||a==="right"?p-y:p+y;(a==="bottom"||a==="right")&&b<f[f.length-1]||(a==="top"||a==="left")&&b>f[f.length-1]||Pt(s.current,{transform:rn(a)?`translate3d(0, ${b}px, 0)`:`translate3d(${b}px, 0, 0)`})}function g(y,b){if(!n||typeof d!="number"||!f||i===void 0)return null;let C=d===i-1;if(d>=i&&b)return 0;if(C&&!b)return 1;if(!h&&!C)return null;let S=C?d+1:d-1,T=C?f[S]-f[S-1]:f[S+1]-f[S],I=y/Math.abs(T);return C?1-I:I}return{isLastSnapPoint:u,activeSnapPoint:l,shouldFade:h,getPercentageDragged:g,setActiveSnapPoint:c,activeSnapPointIndex:d,onRelease:v,onDrag:x,snapPointsOffset:f}}var aRe=.25,lRe=100,yD=8,_a=16,bD=26,wD="vaul-dragging";function nG({open:t,onOpenChange:e,children:n,shouldScaleBackground:s,onDrag:r,onRelease:i,snapPoints:o,nested:a=!1,closeThreshold:l=aRe,scrollLockTimeout:c=lRe,dismissible:u=!0,fadeFromIndex:h=o&&o.length-1,activeSnapPoint:d,setActiveSnapPoint:f,fixed:p,modal:m=!0,onClose:v,direction:x="bottom",preventScrollRestoration:g=!0}){var y;let[b=!1,C]=oe.useState(!1),[S,T]=oe.useState(!1),[I,$]=oe.useState(!1),[N,A]=oe.useState(!1),[F,E]=oe.useState(!1),[R,O]=oe.useState(!1),P=oe.useRef(null),z=oe.useRef(null),_=oe.useRef(null),M=oe.useRef(null),U=oe.useRef(null),W=oe.useRef(!1),X=oe.useRef(null),J=oe.useRef(0),Z=oe.useRef(!1),re=oe.useRef(0),Q=oe.useRef(null),te=oe.useRef(((y=Q.current)==null?void 0:y.getBoundingClientRect().height)||0),le=oe.useRef(0),q=oe.useCallback(Ne=>{o&&Ne===ye.length-1&&(z.current=new Date)},[]),{activeSnapPoint:ie,activeSnapPointIndex:ce,setActiveSnapPoint:we,onRelease:se,snapPointsOffset:ye,onDrag:ge,shouldFade:me,getPercentageDragged:Ae}=oRe({snapPoints:o,activeSnapPointProp:d,setActiveSnapPointProp:f,drawerRef:Q,fadeFromIndex:h,overlayRef:P,onSnapPointChange:q,direction:x});Q2e({isDisabled:!b||F||!m||R||!S});let{restorePositionSetting:Fe}=nRe({isOpen:b,modal:m,nested:a,hasBeenOpened:S,preventScrollRestoration:g});function it(){return(window.innerWidth-bD)/window.innerWidth}function vt(Ne){var Oe;!u&&!o||Q.current&&!Q.current.contains(Ne.target)||(te.current=((Oe=Q.current)==null?void 0:Oe.getBoundingClientRect().height)||0,E(!0),_.current=new Date,qU()&&window.addEventListener("touchend",()=>W.current=!1,{once:!0}),Ne.target.setPointerCapture(Ne.pointerId),J.current=rn(x)?Ne.screenY:Ne.screenX)}function Dn(Ne,Oe){var Ke;let je=Ne,ut=(Ke=window.getSelection())==null?void 0:Ke.toString(),Tt=Q.current?xm(Q.current,x):null,Sn=new Date;if(z.current&&Sn.getTime()-z.current.getTime()<500)return!1;if(Tt!==null&&(x==="bottom"||x==="right"?Tt>0:Tt<0))return!0;if(ut&&ut.length>0)return!1;if(U.current&&Sn.getTime()-U.current.getTime()<c&&Tt===0||Oe)return U.current=Sn,!1;for(;je;){if(je.scrollHeight>je.clientHeight){if(je.scrollTop!==0)return U.current=new Date,!1;if(je.getAttribute("role")==="dialog")return!0}je=je.parentNode}return!0}function Ut(Ne){if(Q.current&&F){let Oe=x==="bottom"||x==="right"?1:-1,Ke=(J.current-(rn(x)?Ne.screenY:Ne.screenX))*Oe,je=Ke>0;if(o&&ce===0&&!u||!W.current&&!Dn(Ne.target,je))return;if(Q.current.classList.add(wD),W.current=!0,Pt(Q.current,{transition:"none"}),Pt(P.current,{transition:"none"}),o&&ge({draggedDistance:Ke}),je&&!o){let si=sRe(Ke),gp=Math.min(si*-1,0)*Oe;Pt(Q.current,{transform:rn(x)?`translate3d(0, ${gp}px, 0)`:`translate3d(${gp}px, 0, 0)`});return}let ut=Math.abs(Ke),Tt=document.querySelector("[vaul-drawer-wrapper]"),Sn=ut/te.current,mp=Ae(ut,je);mp!==null&&(Sn=mp);let Na=1-Sn;if((me||h&&ce===h-1)&&(r==null||r(Ne,Sn),Pt(P.current,{opacity:`${Na}`,transition:"none"},!0)),Tt&&P.current&&s){let si=Math.min(it()+Sn*(1-it()),1),gp=8-Sn*8,E$=Math.max(0,14-Sn*14);Pt(Tt,{borderRadius:`${gp}px`,transform:rn(x)?`scale(${si}) translate3d(0, ${E$}px, 0)`:`scale(${si}) translate3d(${E$}px, 0, 0)`,transition:"none"},!0)}if(!o){let si=ut*Oe;Pt(Q.current,{transform:rn(x)?`translate3d(0, ${si}px, 0)`:`translate3d(${si}px, 0, 0)`})}}}oe.useEffect(()=>()=>{dt(!1),Fe()},[]),oe.useEffect(()=>{var Ne;function Oe(){var Ke;if(!Q.current)return;let je=document.activeElement;if(px(je)||Z.current){let ut=((Ke=window.visualViewport)==null?void 0:Ke.height)||0,Tt=window.innerHeight-ut,Sn=Q.current.getBoundingClientRect().height||0;le.current||(le.current=Sn);let mp=Q.current.getBoundingClientRect().top;if(Math.abs(re.current-Tt)>60&&(Z.current=!Z.current),o&&o.length>0&&ye&&ce){let Na=ye[ce]||0;Tt+=Na}if(re.current=Tt,Sn>ut||Z.current){let Na=Q.current.getBoundingClientRect().height,si=Na;Na>ut&&(si=ut-bD),p?Q.current.style.height=`${Na-Math.max(Tt,0)}px`:Q.current.style.height=`${Math.max(si,ut-mp)}px`}else Q.current.style.height=`${le.current}px`;o&&o.length>0&&!Z.current?Q.current.style.bottom="0px":Q.current.style.bottom=`${Math.max(Tt,0)}px`}}return(Ne=window.visualViewport)==null||Ne.addEventListener("resize",Oe),()=>{var Ke;return(Ke=window.visualViewport)==null?void 0:Ke.removeEventListener("resize",Oe)}},[ce,o,ye]);function kt(){Q.current&&(v==null||v(),Pt(Q.current,{transform:rn(x)?`translate3d(0, ${x==="bottom"?"100%":"-100%"}, 0)`:`translate3d(${x==="right"?"100%":"-100%"}, 0, 0)`,transition:`transform ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`}),Pt(P.current,{opacity:"0",transition:`opacity ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`}),dt(!1),setTimeout(()=>{$(!1),C(!1)},300),setTimeout(()=>{uh(document.documentElement,"scrollBehavior"),o&&we(o[0])},ft.DURATION*1e3))}oe.useEffect(()=>{if(!b&&s){let Ne=setTimeout(()=>{uh(document.body)},200);return()=>clearTimeout(Ne)}},[b,s]),oe.useEffect(()=>{t?(C(!0),T(!0)):kt()},[t]),oe.useEffect(()=>{N&&(e==null||e(b))},[b]),oe.useEffect(()=>{A(!0)},[]);function zt(){if(!Q.current)return;let Ne=document.querySelector("[vaul-drawer-wrapper]"),Oe=xm(Q.current,x);Pt(Q.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`}),Pt(P.current,{transition:`opacity ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`,opacity:"1"}),s&&Oe&&Oe>0&&b&&Pt(Ne,{borderRadius:`${yD}px`,overflow:"hidden",...rn(x)?{transform:`scale(${it()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${it()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${ft.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ft.EASE.join(",")})`},!0)}function _n(Ne){var Oe;if(!F||!Q.current)return;W.current&&px(Ne.target)&&Ne.target.blur(),Q.current.classList.remove(wD),W.current=!1,E(!1),M.current=new Date;let Ke=xm(Q.current,x);if(!Dn(Ne.target,!1)||!Ke||Number.isNaN(Ke)||_.current===null)return;let je=M.current.getTime()-_.current.getTime(),ut=J.current-(rn(x)?Ne.screenY:Ne.screenX),Tt=Math.abs(ut)/je;if(Tt>.05&&(O(!0),setTimeout(()=>{O(!1)},200)),o){se({draggedDistance:ut*(x==="bottom"||x==="right"?1:-1),closeDrawer:kt,velocity:Tt,dismissible:u}),i==null||i(Ne,!0);return}if(x==="bottom"||x==="right"?ut>0:ut<0){zt(),i==null||i(Ne,!0);return}if(Tt>eG){kt(),i==null||i(Ne,!1);return}let Sn=Math.min((Oe=Q.current.getBoundingClientRect().height)!=null?Oe:0,window.innerHeight);if(Ke>=Sn*l){kt(),i==null||i(Ne,!1);return}i==null||i(Ne,!0),zt()}oe.useEffect(()=>{b&&(Pt(document.documentElement,{scrollBehavior:"auto"}),z.current=new Date,dt(!0))},[b]),oe.useEffect(()=>{var Ne;if(Q.current&&I){let Oe=(Ne=Q==null?void 0:Q.current)==null?void 0:Ne.querySelectorAll("*");Oe==null||Oe.forEach(Ke=>{let je=Ke;(je.scrollHeight>je.clientHeight||je.scrollWidth>je.clientWidth)&&je.classList.add("vaul-scrollable")})}},[I]);function dt(Ne){let Oe=document.querySelector("[vaul-drawer-wrapper]");!Oe||!s||(Ne?(Pt(document.body,{background:"black"},!0),Pt(Oe,{borderRadius:`${yD}px`,overflow:"hidden",...rn(x)?{transform:`scale(${it()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${it()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${ft.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ft.EASE.join(",")})`})):(uh(Oe,"overflow"),uh(Oe,"transform"),uh(Oe,"borderRadius"),Pt(Oe,{transitionProperty:"transform, border-radius",transitionDuration:`${ft.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ft.EASE.join(",")})`})))}function Un(Ne){let Oe=Ne?(window.innerWidth-_a)/window.innerWidth:1,Ke=Ne?-_a:0;X.current&&window.clearTimeout(X.current),Pt(Q.current,{transition:`transform ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`,transform:`scale(${Oe}) translate3d(0, ${Ke}px, 0)`}),!Ne&&Q.current&&(X.current=setTimeout(()=>{let je=xm(Q.current,x);Pt(Q.current,{transition:"none",transform:rn(x)?`translate3d(0, ${je}px, 0)`:`translate3d(${je}px, 0, 0)`})},500))}function Qs(Ne,Oe){if(Oe<0)return;let Ke=rn(x)?window.innerHeight:window.innerWidth,je=(Ke-_a)/Ke,ut=je+Oe*(1-je),Tt=-_a+Oe*_a;Pt(Q.current,{transform:rn(x)?`scale(${ut}) translate3d(0, ${Tt}px, 0)`:`scale(${ut}) translate3d(${Tt}px, 0, 0)`,transition:"none"})}function Ir(Ne,Oe){let Ke=rn(x)?window.innerHeight:window.innerWidth,je=Oe?(Ke-_a)/Ke:1,ut=Oe?-_a:0;Oe&&Pt(Q.current,{transition:`transform ${ft.DURATION}s cubic-bezier(${ft.EASE.join(",")})`,transform:rn(x)?`scale(${je}) translate3d(0, ${ut}px, 0)`:`scale(${je}) translate3d(${ut}px, 0, 0)`})}return oe.createElement(GU,{modal:m,onOpenChange:Ne=>{if(t!==void 0){e==null||e(Ne);return}Ne?(T(!0),C(Ne)):kt()},open:b},oe.createElement(XU.Provider,{value:{visible:I,activeSnapPoint:ie,snapPoints:o,setActiveSnapPoint:we,drawerRef:Q,overlayRef:P,scaleBackground:dt,onOpenChange:e,onPress:vt,setVisible:$,onRelease:_n,onDrag:Ut,dismissible:u,isOpen:b,shouldFade:me,closeDrawer:kt,onNestedDrag:Qs,onNestedOpenChange:Un,onNestedRelease:Ir,keyboardIsOpen:Z,openProp:t,modal:m,snapPointsOffset:ye,direction:x}},n))}var sG=oe.forwardRef(function({children:t,...e},n){let{overlayRef:s,snapPoints:r,onRelease:i,shouldFade:o,isOpen:a,visible:l}=S$(),c=ZU(n,s),u=r&&r.length>0;return oe.createElement(y$,{onMouseUp:i,ref:c,"vaul-drawer-visible":l?"true":"false","vaul-overlay":"","vaul-snap-points":a&&u?"true":"false","vaul-snap-points-overlay":a&&o?"true":"false",...e})});sG.displayName="Drawer.Overlay";var rG=oe.forwardRef(function({onOpenAutoFocus:t,onPointerDownOutside:e,onAnimationEnd:n,style:s,...r},i){let{drawerRef:o,onPress:a,onRelease:l,onDrag:c,dismissible:u,keyboardIsOpen:h,snapPointsOffset:d,visible:f,closeDrawer:p,modal:m,openProp:v,onOpenChange:x,setVisible:g,direction:y}=S$(),b=ZU(i,o);return oe.useEffect(()=>{g(!0)},[]),oe.createElement(b$,{onOpenAutoFocus:C=>{var S;t?t(C):(C.preventDefault(),(S=o.current)==null||S.focus())},onPointerDown:a,onPointerDownOutside:C=>{if(e==null||e(C),!m){C.preventDefault();return}h.current&&(h.current=!1),C.preventDefault(),x==null||x(!1),!(!u||v!==void 0)&&p()},onPointerMove:c,onPointerUp:l,ref:b,style:d&&d.length>0?{"--snap-point-height":`${d[0]}px`,...s}:s,...r,"vaul-drawer":"","vaul-drawer-direction":y,"vaul-drawer-visible":f?"true":"false"})});rG.displayName="Drawer.Content";function cRe({onDrag:t,onOpenChange:e,...n}){let{onNestedDrag:s,onNestedOpenChange:r,onNestedRelease:i}=S$();if(!s)throw new Error("Drawer.NestedRoot must be placed in another drawer");return oe.createElement(nG,{nested:!0,onClose:()=>{r(!1)},onDrag:(o,a)=>{s(o,a),t==null||t(o,a)},onOpenChange:o=>{o&&r(o),e==null||e(o)},onRelease:i,...n})}var Li={Root:nG,NestedRoot:cRe,Content:rG,Overlay:sG,Trigger:U2e,Portal:HU,Close:KU,Title:w$,Description:C$};const iG=({shouldScaleBackground:t=!0,...e})=>w.jsx(Li.Root,{shouldScaleBackground:t,...e});iG.displayName="Drawer";const uRe=Li.Trigger,hRe=Li.Portal,oG=oe.forwardRef(({className:t,...e},n)=>w.jsx(Li.Overlay,{ref:n,className:Ie("fixed inset-0 z-50 bg-black/80",t),...e}));oG.displayName=Li.Overlay.displayName;const aG=oe.forwardRef(({className:t,children:e,...n},s)=>w.jsxs(hRe,{children:[w.jsx(oG,{}),w.jsxs(Li.Content,{ref:s,className:Ie("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...n,children:[w.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),e]})]}));aG.displayName="DrawerContent";const dRe=oe.forwardRef(({className:t,...e},n)=>w.jsx(Li.Title,{ref:n,className:Ie("text-lg font-semibold leading-none tracking-tight",t),...e}));dRe.displayName=Li.Title.displayName;const fRe=oe.forwardRef(({className:t,...e},n)=>w.jsx(Li.Description,{ref:n,className:Ie("text-sm text-muted-foreground",t),...e}));fRe.displayName=Li.Description.displayName;const pRe=GU,mRe=HU,lG=oe.forwardRef(({className:t,...e},n)=>w.jsx(y$,{ref:n,className:Ie("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));lG.displayName=y$.displayName;const cG=oe.forwardRef(({className:t,children:e,...n},s)=>w.jsxs(mRe,{children:[w.jsx(lG,{}),w.jsxs(b$,{ref:s,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,w.jsxs(KU,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100 data-[state=open]:text-gray-500",children:[w.jsx(Ci,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));cG.displayName=b$.displayName;const Bm=({className:t,...e})=>w.jsx("div",{className:Ie("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Bm.displayName="DialogHeader";const jm=({className:t,...e})=>w.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});jm.displayName="DialogFooter";const Wm=oe.forwardRef(({className:t,...e},n)=>w.jsx(w$,{ref:n,className:Ie("text-lg font-semibold leading-none tracking-tight",t),...e}));Wm.displayName=w$.displayName;const Um=oe.forwardRef(({className:t,...e},n)=>w.jsx(C$,{ref:n,className:Ie("text-sm text-gray-500",t),...e}));Um.displayName=C$.displayName;const gRe=({isOpen:t,onClose:e})=>{const[n,s]=k.useState(1),[r,i]=k.useState(""),[o,a]=k.useState(""),[l,c]=k.useState(""),[u,h]=k.useState(""),[d,f]=k.useState(!1),p=g=>{g.preventDefault(),f(!0),gt({title:"API Call: verify_email",description:w.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:w.jsx("code",{className:"text-white",children:JSON.stringify({verify_email:r,type:"account_opening"},null,2)})})}),setTimeout(()=>{f(!1),gt({title:" Email Sent!",description:"A verification code has been sent to your email. (Using '12345' for this demo)"}),s(2)},1500)},m=g=>{g.preventDefault(),f(!0),gt({title:"API Call: new_account_virtual",description:w.jsx("pre",{className:"mt-2 w-[340px] rounded-md bg-slate-950 p-4",children:w.jsx("code",{className:"text-white",children:JSON.stringify({new_account_virtual:1,client_password:"",verification_code:u,residence:l},null,2)})})}),setTimeout(()=>{if(f(!1),u!=="12345"){gt({title:" Error",description:"Invalid verification code. Please use '12345'.",variant:"destructive"});return}gt({title:" Demo Account Created!",description:"You've been credited with $10,000 in virtual funds."}),s(3)},1500)},v=()=>{gt({title:" Get Ready to Trade!",description:"You can now log in with your new credentials."}),e(),setTimeout(()=>{s(1),i(""),a(""),c(""),h("")},500)},x=()=>{switch(n){case 1:return w.jsxs("form",{onSubmit:p,className:"space-y-4",children:[w.jsxs(Bm,{children:[w.jsx(Wm,{children:"Create a New Account"}),w.jsx(Um,{children:"Step 1: Verify your email address."})]}),w.jsxs("div",{className:"grid gap-2",children:[w.jsx(ir,{htmlFor:"email",children:"Email"}),w.jsx(mi,{id:"email",type:"email",placeholder:"name@example.com",value:r,onChange:g=>i(g.target.value),required:!0})]}),w.jsx(jm,{children:w.jsxs(Be,{type:"submit",disabled:d,children:[d&&w.jsx(Kw,{className:"mr-2 h-4 w-4 animate-spin"}),"Verify Email"]})})]});case 2:return w.jsxs("form",{onSubmit:m,className:"space-y-4",children:[w.jsxs(Bm,{children:[w.jsx(Wm,{children:"Create a Demo Account"}),w.jsx(Um,{children:"Step 2: Enter your details to get $10,000 in virtual funds."})]}),w.jsxs("div",{className:"grid gap-2",children:[w.jsx(ir,{htmlFor:"password",children:"Password"}),w.jsx(mi,{id:"password",type:"password",value:o,onChange:g=>a(g.target.value),required:!0})]}),w.jsxs("div",{className:"grid gap-2",children:[w.jsx(ir,{htmlFor:"residence",children:"Residence (2-letter code)"}),w.jsx(mi,{id:"residence",placeholder:"e.g., us, gb",value:l,onChange:g=>c(g.target.value),required:!0,maxLength:"2"})]}),w.jsxs("div",{className:"grid gap-2",children:[w.jsx(ir,{htmlFor:"verification-code",children:"Email Verification Code"}),w.jsx(mi,{id:"verification-code",placeholder:"Enter code from email",value:u,onChange:g=>h(g.target.value),required:!0})]}),w.jsx(jm,{children:w.jsxs(Be,{type:"submit",disabled:d,children:[d&&w.jsx(Kw,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Demo Account"]})})]});case 3:return w.jsxs("div",{className:"space-y-4 text-center",children:[w.jsxs(Bm,{children:[w.jsx(Wm,{children:" Success!"}),w.jsx(Um,{children:"Your demo account is ready. You can now log in or proceed to create a real account from the cashier."})]}),w.jsx("div",{className:"flex justify-center pt-4",children:w.jsx(Nt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center",children:w.jsx("span",{className:"text-5xl",children:""})})}),w.jsx(jm,{className:"pt-4",children:w.jsx(Be,{onClick:v,className:"w-full",children:"Finish"})})]});default:return null}};return w.jsx(pRe,{open:t,onOpenChange:e,children:w.jsx(cG,{className:"sm:max-w-md",children:w.jsx(Pc,{mode:"wait",children:w.jsx(Nt.div,{initial:{x:300,opacity:0},animate:{x:0,opacity:1},exit:{x:-300,opacity:0},transition:{duration:.3},children:x()},n)})})})},uG=k.createContext(null),xRe=()=>k.useContext(uG),vRe=({children:t})=>{const[e,n]=k.useState(!1),s=()=>n(!0),r=()=>n(!1),i={openSignUp:s};return w.jsxs(uG.Provider,{value:i,children:[t,w.jsx(gRe,{isOpen:e,onClose:r})]})},yRe="/assets/logo-c219b601.jpeg",bRe=()=>{const{openSignUp:t}=xRe(),e=()=>{const s=`https://oauth.deriv.com/oauth2/authorize?app_id=${{}.VITE_DERIV_APP_ID||"106085"}&l=EN&brand=deriv`;window.location.href=s};return w.jsxs("header",{className:"flex items-center justify-between p-4 bg-white border-b border-gray-200 flex-shrink-0",children:[w.jsx("div",{className:"flex items-center gap-8",children:w.jsx("div",{className:"flex items-center gap-2",children:w.jsx("img",{src:yRe,className:"w-20 h-7 md:w-40 md:h-20",alt:"XTradingAI Logo"})})}),w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx(Be,{variant:"outline",onClick:e,children:"Log in"}),w.jsx(Be,{variant:"brand",onClick:t,children:"Sign up"})]})]})};var Rb="rovingFocusGroup.onEntryFocus",wRe={bubbles:!1,cancelable:!0},fp="RovingFocusGroup",[aC,hG,CRe]=Kd(fp),[SRe,dG]=_s(fp,[CRe]),[kRe,TRe]=SRe(fp),fG=k.forwardRef((t,e)=>w.jsx(aC.Provider,{scope:t.__scopeRovingFocusGroup,children:w.jsx(aC.Slot,{scope:t.__scopeRovingFocusGroup,children:w.jsx(IRe,{...t,ref:e})})}));fG.displayName=fp;var IRe=k.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:r=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=t,d=k.useRef(null),f=Le(e,d),p=yu(i),[m,v]=Gs({prop:o,defaultProp:a??null,onChange:l,caller:fp}),[x,g]=k.useState(!1),y=gn(c),b=hG(n),C=k.useRef(!1),[S,T]=k.useState(0);return k.useEffect(()=>{const I=d.current;if(I)return I.addEventListener(Rb,y),()=>I.removeEventListener(Rb,y)},[y]),w.jsx(kRe,{scope:n,orientation:s,dir:p,loop:r,currentTabStopId:m,onItemFocus:k.useCallback(I=>v(I),[v]),onItemShiftTab:k.useCallback(()=>g(!0),[]),onFocusableItemAdd:k.useCallback(()=>T(I=>I+1),[]),onFocusableItemRemove:k.useCallback(()=>T(I=>I-1),[]),children:w.jsx(Te.div,{tabIndex:x||S===0?-1:0,"data-orientation":s,...h,ref:f,style:{outline:"none",...t.style},onMouseDown:be(t.onMouseDown,()=>{C.current=!0}),onFocus:be(t.onFocus,I=>{const $=!C.current;if(I.target===I.currentTarget&&$&&!x){const N=new CustomEvent(Rb,wRe);if(I.currentTarget.dispatchEvent(N),!N.defaultPrevented){const A=b().filter(P=>P.focusable),F=A.find(P=>P.active),E=A.find(P=>P.id===m),O=[F,E,...A].filter(Boolean).map(P=>P.ref.current);gG(O,u)}}C.current=!1}),onBlur:be(t.onBlur,()=>g(!1))})})}),pG="RovingFocusGroupItem",mG=k.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:r=!1,tabStopId:i,children:o,...a}=t,l=gr(),c=i||l,u=TRe(pG,n),h=u.currentTabStopId===c,d=hG(n),{onFocusableItemAdd:f,onFocusableItemRemove:p,currentTabStopId:m}=u;return k.useEffect(()=>{if(s)return f(),()=>p()},[s,f,p]),w.jsx(aC.ItemSlot,{scope:n,id:c,focusable:s,active:r,children:w.jsx(Te.span,{tabIndex:h?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:be(t.onMouseDown,v=>{s?u.onItemFocus(c):v.preventDefault()}),onFocus:be(t.onFocus,()=>u.onItemFocus(c)),onKeyDown:be(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=ERe(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let y=d().filter(b=>b.focusable).map(b=>b.ref.current);if(x==="last")y.reverse();else if(x==="prev"||x==="next"){x==="prev"&&y.reverse();const b=y.indexOf(v.currentTarget);y=u.loop?RRe(y,b+1):y.slice(b+1)}setTimeout(()=>gG(y))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:m!=null}):o})})});mG.displayName=pG;var $Re={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function NRe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function ERe(t,e,n){const s=NRe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return $Re[s]}function gG(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function RRe(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var ARe=fG,DRe=mG,Uv="Tabs",[_Re,ZAe]=_s(Uv,[dG]),xG=dG(),[PRe,T$]=_Re(Uv),FRe=k.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,onValueChange:r,defaultValue:i,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=yu(a),[h,d]=Gs({prop:s,onChange:r,defaultProp:i??"",caller:Uv});return w.jsx(PRe,{scope:n,baseId:gr(),value:h,onValueChange:d,orientation:o,dir:u,activationMode:l,children:w.jsx(Te.div,{dir:u,"data-orientation":o,...c,ref:e})})});FRe.displayName=Uv;var vG="TabsList",yG=k.forwardRef((t,e)=>{const{__scopeTabs:n,loop:s=!0,...r}=t,i=T$(vG,n),o=xG(n);return w.jsx(ARe,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:w.jsx(Te.div,{role:"tablist","aria-orientation":i.orientation,...r,ref:e})})});yG.displayName=vG;var bG="TabsTrigger",wG=k.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,disabled:r=!1,...i}=t,o=T$(bG,n),a=xG(n),l=kG(o.baseId,s),c=TG(o.baseId,s),u=s===o.value;return w.jsx(DRe,{asChild:!0,...a,focusable:!r,active:u,children:w.jsx(Te.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...i,ref:e,onMouseDown:be(t.onMouseDown,h=>{!r&&h.button===0&&h.ctrlKey===!1?o.onValueChange(s):h.preventDefault()}),onKeyDown:be(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(s)}),onFocus:be(t.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!r&&h&&o.onValueChange(s)})})})});wG.displayName=bG;var CG="TabsContent",SG=k.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,forceMount:r,children:i,...o}=t,a=T$(CG,n),l=kG(a.baseId,s),c=TG(a.baseId,s),u=s===a.value,h=k.useRef(u);return k.useEffect(()=>{const d=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(d)},[]),w.jsx(gs,{present:r||u,children:({present:d})=>w.jsx(Te.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!d,id:c,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:d&&i})})});SG.displayName=CG;function kG(t,e){return`${t}-trigger-${e}`}function TG(t,e){return`${t}-content-${e}`}var IG=yG,$G=wG,NG=SG;const ORe=k.forwardRef(({className:t,...e},n)=>w.jsx(IG,{ref:n,className:Ie("inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500",t),...e}));ORe.displayName=IG.displayName;const MRe=k.forwardRef(({className:t,...e},n)=>w.jsx($G,{ref:n,className:Ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-950 data-[state=active]:shadow-sm",t),...e}));MRe.displayName=$G.displayName;const LRe=k.forwardRef(({className:t,...e},n)=>w.jsx(NG,{ref:n,className:Ie("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2",t),...e}));LRe.displayName=NG.displayName;const zRe=(t,e=14)=>{if(t.length<e)return[];const n=[],s=[];for(let a=1;a<t.length;a++){const l=t[a]-t[a-1];n.push(Math.max(l,0)),s.push(Math.max(-l,0))}const r=n.slice(-e).reduce((a,l)=>a+l,0)/e,i=s.slice(-e).reduce((a,l)=>a+l,0)/e;return[100-100/(1+r/(i||1))]},VRe=(t,e=12,n=26,s=9)=>{const r=t.slice(-e).reduce((o,a,l)=>o+a*(2/(e+1)),0)/e,i=t.slice(-n).reduce((o,a,l)=>o+a*(2/(n+1)),0)/n;return{macd:r-i,signal:0}},BRe=({data:t,indicators:e})=>({indicatorData:e.reduce((s,r)=>(r.type==="RSI"?s.rsi=zRe(t.map(i=>i.close||i.quote)):r.type==="MACD"&&(s.macd=VRe(t.map(i=>i.close||i.quote))),s),{})});var EG={},kn=bn&&bn.__assign||function(){return kn=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},kn.apply(this,arguments)},jRe=bn&&bn.__createBinding||(Object.create?function(t,e,n,s){s===void 0&&(s=n);var r=Object.getOwnPropertyDescriptor(e,n);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,s,r)}:function(t,e,n,s){s===void 0&&(s=n),t[s]=e[n]}),WRe=bn&&bn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),URe=bn&&bn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&jRe(e,t,n);return WRe(e,t),e},GRe=bn&&bn.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};Object.defineProperty(EG,"__esModule",{value:!0});var tr=URe(k),HRe=89,vm=90,KRe=77,CD=57,SD=219,kD=222,TD=192,ID=100,XRe=3e3,qRe=typeof window<"u"&&"navigator"in window&&/Win/i.test(navigator.platform),Ab=typeof window<"u"&&"navigator"in window&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),Gm="npm__react-simple-code-editor__textarea",YRe=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`.concat(Gm,`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`).concat(Gm,` {
    color: transparent !important;
  }

  .`).concat(Gm,`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`),QRe=tr.forwardRef(function(e,n){var s=e.autoFocus,r=e.disabled,i=e.form,o=e.highlight,a=e.ignoreTabKey,l=a===void 0?!1:a,c=e.insertSpaces,u=c===void 0?!0:c,h=e.maxLength,d=e.minLength,f=e.name,p=e.onBlur,m=e.onClick,v=e.onFocus,x=e.onKeyDown,g=e.onKeyUp,y=e.onValueChange,b=e.padding,C=b===void 0?0:b,S=e.placeholder,T=e.preClassName,I=e.readOnly,$=e.required,N=e.style,A=e.tabSize,F=A===void 0?2:A,E=e.textareaClassName,R=e.textareaId,O=e.value,P=GRe(e,["autoFocus","disabled","form","highlight","ignoreTabKey","insertSpaces","maxLength","minLength","name","onBlur","onClick","onFocus","onKeyDown","onKeyUp","onValueChange","padding","placeholder","preClassName","readOnly","required","style","tabSize","textareaClassName","textareaId","value"]),z=tr.useRef({stack:[],offset:-1}),_=tr.useRef(null),M=tr.useState(!0),U=M[0],W=M[1],X={paddingTop:typeof C=="object"?C.top:C,paddingRight:typeof C=="object"?C.right:C,paddingBottom:typeof C=="object"?C.bottom:C,paddingLeft:typeof C=="object"?C.left:C},J=o(O),Z=function(se,ye){return se.substring(0,ye).split(`
`)},re=tr.useCallback(function(se,ye){var ge,me,Ae;ye===void 0&&(ye=!1);var Fe=z.current,it=Fe.stack,vt=Fe.offset;if(it.length&&vt>-1){z.current.stack=it.slice(0,vt+1);var Dn=z.current.stack.length;if(Dn>ID){var Ut=Dn-ID;z.current.stack=it.slice(Ut,Dn),z.current.offset=Math.max(z.current.offset-Ut,0)}}var kt=Date.now();if(ye){var zt=z.current.stack[z.current.offset];if(zt&&kt-zt.timestamp<XRe){var _n=/[^a-z0-9]([a-z0-9]+)$/i,dt=(ge=Z(zt.value,zt.selectionStart).pop())===null||ge===void 0?void 0:ge.match(_n),Un=(me=Z(se.value,se.selectionStart).pop())===null||me===void 0?void 0:me.match(_n);if(dt!=null&&dt[1]&&(!((Ae=Un==null?void 0:Un[1])===null||Ae===void 0)&&Ae.startsWith(dt[1]))){z.current.stack[z.current.offset]=kn(kn({},se),{timestamp:kt});return}}}z.current.stack.push(kn(kn({},se),{timestamp:kt})),z.current.offset++},[]),Q=tr.useCallback(function(){var se=_.current;if(se){var ye=se.value,ge=se.selectionStart,me=se.selectionEnd;re({value:ye,selectionStart:ge,selectionEnd:me})}},[re]),te=function(se){var ye=_.current;ye&&(ye.value=se.value,ye.selectionStart=se.selectionStart,ye.selectionEnd=se.selectionEnd,y==null||y(se.value))},le=function(se){var ye=_.current,ge=z.current.stack[z.current.offset];ge&&ye&&(z.current.stack[z.current.offset]=kn(kn({},ge),{selectionStart:ye.selectionStart,selectionEnd:ye.selectionEnd})),re(se),te(se)},q=function(){var se=z.current,ye=se.stack,ge=se.offset,me=ye[ge-1];me&&(te(me),z.current.offset=Math.max(ge-1,0))},ie=function(){var se=z.current,ye=se.stack,ge=se.offset,me=ye[ge+1];me&&(te(me),z.current.offset=Math.min(ge+1,ye.length-1))},ce=function(se){if(!(x&&(x(se),se.defaultPrevented))){se.key==="Escape"&&se.currentTarget.blur();var ye=se.currentTarget,ge=ye.value,me=ye.selectionStart,Ae=ye.selectionEnd,Fe=(u?" ":"	").repeat(F);if(se.key==="Tab"&&!l&&U)if(se.preventDefault(),se.shiftKey){var it=Z(ge,me),vt=it.length-1,Dn=Z(ge,Ae).length-1,Ut=ge.split(`
`).map(function(je,ut){return ut>=vt&&ut<=Dn&&je.startsWith(Fe)?je.substring(Fe.length):je}).join(`
`);if(ge!==Ut){var kt=it[vt];le({value:Ut,selectionStart:kt!=null&&kt.startsWith(Fe)?me-Fe.length:me,selectionEnd:Ae-(ge.length-Ut.length)})}}else if(me!==Ae){var it=Z(ge,me),zt=it.length-1,_n=Z(ge,Ae).length-1,kt=it[zt];le({value:ge.split(`
`).map(function(Tt,Sn){return Sn>=zt&&Sn<=_n?Fe+Tt:Tt}).join(`
`),selectionStart:kt&&/\S/.test(kt)?me+Fe.length:me,selectionEnd:Ae+Fe.length*(_n-zt+1)})}else{var dt=me+Fe.length;le({value:ge.substring(0,me)+Fe+ge.substring(Ae),selectionStart:dt,selectionEnd:dt})}else if(se.key==="Backspace"){var Un=me!==Ae,Qs=ge.substring(0,me);if(Qs.endsWith(Fe)&&!Un){se.preventDefault();var dt=me-Fe.length;le({value:ge.substring(0,me-Fe.length)+ge.substring(Ae),selectionStart:dt,selectionEnd:dt})}}else if(se.key==="Enter"){if(me===Ae){var Ir=Z(ge,me).pop(),Ne=Ir==null?void 0:Ir.match(/^\s+/);if(Ne!=null&&Ne[0]){se.preventDefault();var Oe=`
`+Ne[0],dt=me+Oe.length;le({value:ge.substring(0,me)+Oe+ge.substring(Ae),selectionStart:dt,selectionEnd:dt})}}}else if(se.keyCode===CD||se.keyCode===SD||se.keyCode===kD||se.keyCode===TD){var Ke=void 0;se.keyCode===CD&&se.shiftKey?Ke=["(",")"]:se.keyCode===SD?se.shiftKey?Ke=["{","}"]:Ke=["[","]"]:se.keyCode===kD?se.shiftKey?Ke=['"','"']:Ke=["'","'"]:se.keyCode===TD&&!se.shiftKey&&(Ke=["`","`"]),me!==Ae&&Ke&&(se.preventDefault(),le({value:ge.substring(0,me)+Ke[0]+ge.substring(me,Ae)+Ke[1]+ge.substring(Ae),selectionStart:me,selectionEnd:Ae+2}))}else(Ab?se.metaKey&&se.keyCode===vm:se.ctrlKey&&se.keyCode===vm)&&!se.shiftKey&&!se.altKey?(se.preventDefault(),q()):(Ab?se.metaKey&&se.keyCode===vm&&se.shiftKey:qRe?se.ctrlKey&&se.keyCode===HRe:se.ctrlKey&&se.keyCode===vm&&se.shiftKey)&&!se.altKey?(se.preventDefault(),ie()):se.keyCode===KRe&&se.ctrlKey&&(!Ab||se.shiftKey)&&(se.preventDefault(),W(function(je){return!je}))}},we=function(se){var ye=se.currentTarget,ge=ye.value,me=ye.selectionStart,Ae=ye.selectionEnd;re({value:ge,selectionStart:me,selectionEnd:Ae},!0),y(ge)};return tr.useEffect(function(){Q()},[Q]),tr.useImperativeHandle(n,function(){return{get session(){return{history:z.current}},set session(se){z.current=se.history}}},[]),tr.createElement("div",kn({},P,{style:kn(kn({},hh.container),N)}),tr.createElement("pre",kn({className:T,"aria-hidden":"true",style:kn(kn(kn({},hh.editor),hh.highlight),X)},typeof J=="string"?{dangerouslySetInnerHTML:{__html:J+"<br />"}}:{children:J})),tr.createElement("textarea",{ref:function(se){return _.current=se},style:kn(kn(kn({},hh.editor),hh.textarea),X),className:Gm+(E?" ".concat(E):""),id:R,value:O,onChange:we,onKeyDown:ce,onClick:m,onKeyUp:g,onFocus:v,onBlur:p,disabled:r,form:i,maxLength:h,minLength:d,name:f,placeholder:S,readOnly:I,required:$,autoFocus:s,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),tr.createElement("style",{dangerouslySetInnerHTML:{__html:YRe}}))}),hh={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},ZRe=EG.default=QRe,RG={exports:{}};(function(t){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(s){var r=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,o={},a={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:function g(y){return y instanceof l?new l(y.type,g(y.content),y.alias):Array.isArray(y)?y.map(g):y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(g){return Object.prototype.toString.call(g).slice(8,-1)},objId:function(g){return g.__id||Object.defineProperty(g,"__id",{value:++i}),g.__id},clone:function g(y,b){b=b||{};var C,S;switch(a.util.type(y)){case"Object":if(S=a.util.objId(y),b[S])return b[S];C={},b[S]=C;for(var T in y)y.hasOwnProperty(T)&&(C[T]=g(y[T],b));return C;case"Array":return S=a.util.objId(y),b[S]?b[S]:(C=[],b[S]=C,y.forEach(function(I,$){C[$]=g(I,b)}),C);default:return y}},getLanguage:function(g){for(;g;){var y=r.exec(g.className);if(y)return y[1].toLowerCase();g=g.parentElement}return"none"},setLanguage:function(g,y){g.className=g.className.replace(RegExp(r,"gi"),""),g.classList.add("language-"+y)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT"&&1<2)return document.currentScript;try{throw new Error}catch(C){var g=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(C.stack)||[])[1];if(g){var y=document.getElementsByTagName("script");for(var b in y)if(y[b].src==g)return y[b]}return null}},isActive:function(g,y,b){for(var C="no-"+y;g;){var S=g.classList;if(S.contains(y))return!0;if(S.contains(C))return!1;g=g.parentElement}return!!b}},languages:{plain:o,plaintext:o,text:o,txt:o,extend:function(g,y){var b=a.util.clone(a.languages[g]);for(var C in y)b[C]=y[C];return b},insertBefore:function(g,y,b,C){C=C||a.languages;var S=C[g],T={};for(var I in S)if(S.hasOwnProperty(I)){if(I==y)for(var $ in b)b.hasOwnProperty($)&&(T[$]=b[$]);b.hasOwnProperty(I)||(T[I]=S[I])}var N=C[g];return C[g]=T,a.languages.DFS(a.languages,function(A,F){F===N&&A!=g&&(this[A]=T)}),T},DFS:function g(y,b,C,S){S=S||{};var T=a.util.objId;for(var I in y)if(y.hasOwnProperty(I)){b.call(y,I,y[I],C||I);var $=y[I],N=a.util.type($);N==="Object"&&!S[T($)]?(S[T($)]=!0,g($,b,null,S)):N==="Array"&&!S[T($)]&&(S[T($)]=!0,g($,b,I,S))}}},plugins:{},highlightAll:function(g,y){a.highlightAllUnder(document,g,y)},highlightAllUnder:function(g,y,b){var C={callback:b,container:g,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};a.hooks.run("before-highlightall",C),C.elements=Array.prototype.slice.apply(C.container.querySelectorAll(C.selector)),a.hooks.run("before-all-elements-highlight",C);for(var S=0,T;T=C.elements[S++];)a.highlightElement(T,y===!0,C.callback)},highlightElement:function(g,y,b){var C=a.util.getLanguage(g),S=a.languages[C];a.util.setLanguage(g,C);var T=g.parentElement;T&&T.nodeName.toLowerCase()==="pre"&&a.util.setLanguage(T,C);var I=g.textContent,$={element:g,language:C,grammar:S,code:I};function N(F){$.highlightedCode=F,a.hooks.run("before-insert",$),$.element.innerHTML=$.highlightedCode,a.hooks.run("after-highlight",$),a.hooks.run("complete",$),b&&b.call($.element)}if(a.hooks.run("before-sanity-check",$),T=$.element.parentElement,T&&T.nodeName.toLowerCase()==="pre"&&!T.hasAttribute("tabindex")&&T.setAttribute("tabindex","0"),!$.code){a.hooks.run("complete",$),b&&b.call($.element);return}if(a.hooks.run("before-highlight",$),!$.grammar){N(a.util.encode($.code));return}if(y&&s.Worker){var A=new Worker(a.filename);A.onmessage=function(F){N(F.data)},A.postMessage(JSON.stringify({language:$.language,code:$.code,immediateClose:!0}))}else N(a.highlight($.code,$.grammar,$.language))},highlight:function(g,y,b){var C={code:g,grammar:y,language:b};if(a.hooks.run("before-tokenize",C),!C.grammar)throw new Error('The language "'+C.language+'" has no grammar.');return C.tokens=a.tokenize(C.code,C.grammar),a.hooks.run("after-tokenize",C),l.stringify(a.util.encode(C.tokens),C.language)},tokenize:function(g,y){var b=y.rest;if(b){for(var C in b)y[C]=b[C];delete y.rest}var S=new h;return d(S,S.head,g),u(g,S,y,S.head,0),p(S)},hooks:{all:{},add:function(g,y){var b=a.hooks.all;b[g]=b[g]||[],b[g].push(y)},run:function(g,y){var b=a.hooks.all[g];if(!(!b||!b.length))for(var C=0,S;S=b[C++];)S(y)}},Token:l};s.Prism=a;function l(g,y,b,C){this.type=g,this.content=y,this.alias=b,this.length=(C||"").length|0}l.stringify=function g(y,b){if(typeof y=="string")return y;if(Array.isArray(y)){var C="";return y.forEach(function(N){C+=g(N,b)}),C}var S={type:y.type,content:g(y.content,b),tag:"span",classes:["token",y.type],attributes:{},language:b},T=y.alias;T&&(Array.isArray(T)?Array.prototype.push.apply(S.classes,T):S.classes.push(T)),a.hooks.run("wrap",S);var I="";for(var $ in S.attributes)I+=" "+$+'="'+(S.attributes[$]||"").replace(/"/g,"&quot;")+'"';return"<"+S.tag+' class="'+S.classes.join(" ")+'"'+I+">"+S.content+"</"+S.tag+">"};function c(g,y,b,C){g.lastIndex=y;var S=g.exec(b);if(S&&C&&S[1]){var T=S[1].length;S.index+=T,S[0]=S[0].slice(T)}return S}function u(g,y,b,C,S,T){for(var I in b)if(!(!b.hasOwnProperty(I)||!b[I])){var $=b[I];$=Array.isArray($)?$:[$];for(var N=0;N<$.length;++N){if(T&&T.cause==I+","+N)return;var A=$[N],F=A.inside,E=!!A.lookbehind,R=!!A.greedy,O=A.alias;if(R&&!A.pattern.global){var P=A.pattern.toString().match(/[imsuy]*$/)[0];A.pattern=RegExp(A.pattern.source,P+"g")}for(var z=A.pattern||A,_=C.next,M=S;_!==y.tail&&!(T&&M>=T.reach);M+=_.value.length,_=_.next){var U=_.value;if(y.length>g.length)return;if(!(U instanceof l)){var W=1,X;if(R){if(X=c(z,M,g,E),!X||X.index>=g.length)break;var Q=X.index,J=X.index+X[0].length,Z=M;for(Z+=_.value.length;Q>=Z;)_=_.next,Z+=_.value.length;if(Z-=_.value.length,M=Z,_.value instanceof l)continue;for(var re=_;re!==y.tail&&(Z<J||typeof re.value=="string");re=re.next)W++,Z+=re.value.length;W--,U=g.slice(M,Z),X.index-=M}else if(X=c(z,0,U,E),!X)continue;var Q=X.index,te=X[0],le=U.slice(0,Q),q=U.slice(Q+te.length),ie=M+U.length;T&&ie>T.reach&&(T.reach=ie);var ce=_.prev;le&&(ce=d(y,ce,le),M+=le.length),f(y,ce,W);var we=new l(I,F?a.tokenize(te,F):te,O,te);if(_=d(y,ce,we),q&&d(y,_,q),W>1){var se={cause:I+","+N,reach:ie};u(g,y,b,_.prev,M,se),T&&se.reach>T.reach&&(T.reach=se.reach)}}}}}}function h(){var g={value:null,prev:null,next:null},y={value:null,prev:g,next:null};g.next=y,this.head=g,this.tail=y,this.length=0}function d(g,y,b){var C=y.next,S={value:b,prev:y,next:C};return y.next=S,C.prev=S,g.length++,S}function f(g,y,b){for(var C=y.next,S=0;S<b&&C!==g.tail;S++)C=C.next;y.next=C,C.prev=y,g.length-=S}function p(g){for(var y=[],b=g.head.next;b!==g.tail;)y.push(b.value),b=b.next;return y}if(!s.document)return s.addEventListener&&(a.disableWorkerMessageHandler||s.addEventListener("message",function(g){var y=JSON.parse(g.data),b=y.language,C=y.code,S=y.immediateClose;s.postMessage(a.highlight(C,a.languages[b],b)),S&&s.close()},!1)),a;var m=a.util.currentScript();m&&(a.filename=m.src,m.hasAttribute("data-manual")&&(a.manual=!0));function v(){a.manual||a.highlightAll()}if(!a.manual){var x=document.readyState;x==="loading"||x==="interactive"&&m&&m.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return a}(e);t.exports&&(t.exports=n),typeof bn<"u"&&(bn.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(s){s.type==="entity"&&(s.attributes.title=s.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(r,i){var o={};o["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},o.cdata=/^<!\[CDATA\[|\]\]>$/i;var a={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:o}};a["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[r]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return r}),"i"),lookbehind:!0,greedy:!0,inside:a},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(s,r){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+s+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[r,"language-"+r],inside:n.languages[r]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(s){var r=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;s.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+r.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+r.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+r.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+r.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:r,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},s.languages.css.atrule.inside.rest=s.languages.css;var i=s.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var s="Loading",r=function(m,v){return" Error "+m+" while fetching file: "+v},i=" Error: File does not exist or is empty",o={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},a="data-src-status",l="loading",c="loaded",u="failed",h="pre[data-src]:not(["+a+'="'+c+'"]):not(['+a+'="'+l+'"])';function d(m,v,x){var g=new XMLHttpRequest;g.open("GET",m,!0),g.onreadystatechange=function(){g.readyState==4&&(g.status<400&&g.responseText?v(g.responseText):g.status>=400?x(r(g.status,g.statusText)):x(i))},g.send(null)}function f(m){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(m||"");if(v){var x=Number(v[1]),g=v[2],y=v[3];return g?y?[x,Number(y)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(m){m.selector+=", "+h}),n.hooks.add("before-sanity-check",function(m){var v=m.element;if(v.matches(h)){m.code="",v.setAttribute(a,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=s;var g=v.getAttribute("data-src"),y=m.language;if(y==="none"){var b=(/\.(\w+)$/.exec(g)||[,"none"])[1];y=o[b]||b}n.util.setLanguage(x,y),n.util.setLanguage(v,y);var C=n.plugins.autoloader;C&&C.loadLanguages(y),d(g,function(S){v.setAttribute(a,c);var T=f(v.getAttribute("data-range"));if(T){var I=S.split(/\r\n?|\n/g),$=T[0],N=T[1]==null?I.length:T[1];$<0&&($+=I.length),$=Math.max(0,Math.min($-1,I.length)),N<0&&(N+=I.length),N=Math.max(0,Math.min(N,I.length)),S=I.slice($,N).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String($+1))}x.textContent=S,n.highlightElement(x)},function(S){v.setAttribute(a,u),x.textContent=S})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(h),g=0,y;y=x[g++];)n.highlightElement(y)}};var p=!1;n.fileHighlight=function(){p||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),p=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(RG);var JRe=RG.exports;const $D=ua(JRe);Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;const eAe=()=>{const[t,e]=k.useState("frxUSDCAD"),[n,s]=k.useState("candlestick"),[r,i]=k.useState("1 minute"),[o,a]=k.useState([]),[l,c]=k.useState(!1),[u,h]=k.useState(null),[d,f]=k.useState(!1),[p,m]=k.useState(`// Write your JS indicator script here
// The function should take market data and return computed values
function calculate(data) {
  // Example: Compute percentage change
  return data.map(d => (d.close - d.open) / d.open * 100);
}`),[v,x]=k.useState([]),g=k.useRef(null),[y,b]=k.useState(!1),[C,S]=k.useState(!0),[T,I]=k.useState("rise-fall"),$=k.useMemo(()=>({"1 tick":1,"1 minute":60,"2 minutes":120,"3 minutes":180,"5 minutes":300,"10 minutes":600,"15 minutes":900,"30 minutes":1800,"1 hour":3600,"2 hours":7200,"4 hours":14400,"8 hours":28800,"1 day":86400}),[]),N=k.useMemo(()=>$[r]||60,[r,$]),{marketData:A,isConnected:F,error:E,latestTick:R,api:O}=P2e(t,N),P=["matches-differs","even-odd","over-under"].includes(T);k.useEffect(()=>{s(P?"bar":"candlestick"),S(!0)},[t,N,P]),k.useEffect(()=>{if((A.length>0||P)&&C){const q=setTimeout(()=>{S(!1)},500);return()=>clearTimeout(q)}},[A,C,P]),k.useEffect(()=>{E&&(gt({title:"Connection Error",description:E,variant:"destructive"}),S(!1))},[E]);const{indicatorData:z}=k.useMemo(()=>{if(P||A.length===0)return{indicatorData:{}};const q=o.filter(ie=>ie!=="custom");return BRe({data:A,indicators:q})},[A,o,P]),_=k.useMemo(()=>({...z,...o.includes("custom")?{custom:v}:{}}),[z,v,o]),M=k.useCallback(()=>{if(!A.length){gt({title:"Error",description:"No market data available to run script.",variant:"destructive"});return}try{const ie=new Function("data",p)(A);if(!Array.isArray(ie)||ie.length!==A.length)throw new Error("Script must return an array matching the length of market data.");x(ie),a(ce=>[...new Set([...ce,"custom"])]),gt({title:"Script Executed",description:"Custom JS indicator applied to chart."})}catch(q){gt({title:"Script Error",description:q.message,variant:"destructive"})}},[p,A]),U=q=>{var ie;return(ie=g.current)==null?void 0:ie.downloadChart(q)},W=k.useCallback(q=>{if(q==="download"){U("csv");return}if(q==="script"){f(ie=>!ie),l&&(c(!1),h(null));return}q===u?(c(!1),h(null)):(h(q),c(!0))},[u,l]),X=()=>{c(!1),h(null)},J=k.useCallback(q=>{l&&X()},[l,X]),Z=({icon:q,toolId:ie})=>w.jsx(Be,{variant:"ghost",size:"icon",onClick:()=>W(ie),className:Ie("h-10 w-10 text-gray-600 hover:bg-gray-200 rounded-md",(u===ie||ie==="script"&&d)&&"bg-blue-100 text-blue-600 hover:bg-blue-200"),children:w.jsx(q,{className:"h-5 w-5"})}),re=q=>{O?(O.sendRequest({buy:"1",price:10,...q}),gt({title:"Trade Sent",description:"Your trade has been submitted to Deriv."})):gt({title:"Error",description:"API not connected. Cannot place trade.",variant:"destructive"})},Q=k.useCallback(q=>{a(ie=>[...new Set([...ie,q])])},[]),te=k.useCallback(q=>{a(ie=>ie.filter(ce=>ce!==q))},[]),le=q=>$D.highlight(q,$D.languages.javascript,"javascript");return w.jsxs("div",{className:"h-full w-full flex flex-col overflow-hidden bg-gray-100",children:[w.jsx(bRe,{}),w.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[w.jsxs("main",{className:"flex-1 flex flex-col relative",children:[w.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 z-30 hidden md:block",children:w.jsxs("div",{className:"p-1 flex flex-col gap-1 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-lg shadow-md",children:[w.jsx(Z,{icon:Tg,toolId:"chart"}),w.jsx(Z,{icon:wi,toolId:"indicators"}),w.jsx(Z,{icon:Ww,toolId:"script"}),w.jsx(Z,{icon:QE,toolId:"templates"}),w.jsx(Z,{icon:JE,toolId:"drawing"}),w.jsx(Z,{icon:qE,toolId:"download"})]})}),w.jsx(Pc,{children:l&&u&&u!=="script"&&w.jsx(Nt.div,{initial:{x:-300},animate:{x:0},exit:{x:-300},transition:{type:"spring",stiffness:300,damping:30},className:"absolute top-0 left-14 bottom-0 z-20 hidden md:block",children:w.jsxs(Dne,{onClose:X,children:[u==="chart"&&w.jsx(Fne,{selectedType:n,onTypeChange:s,selectedInterval:r,onIntervalChange:i}),u==="indicators"&&w.jsx(One,{activeIndicators:o,onAddIndicator:Q,onRemoveIndicator:te}),u==="templates"&&w.jsx(Mne,{}),u==="drawing"&&w.jsx(zne,{})]})})}),w.jsxs("div",{className:"flex-1 flex flex-col relative",children:[w.jsx("div",{className:"absolute top-2 left-3 right-3 z-20 flex items-center justify-between flex-wrap gap-2",children:w.jsx("div",{className:"flex items-center gap-2",children:w.jsx("div",{className:"md:hidden",children:w.jsxs(uL,{children:[w.jsx(hL,{asChild:!0,children:w.jsx(Be,{variant:"ghost",size:"icon",children:w.jsx(bO,{className:"h-5 w-5"})})}),w.jsx(fk,{className:"w-auto p-1",children:w.jsxs("div",{className:"p-1 flex flex-col gap-1 bg-white border border-gray-200 rounded-lg",children:[w.jsx(Z,{icon:Tg,toolId:"chart"}),w.jsx(Z,{icon:wi,toolId:"indicators"}),w.jsx(Z,{icon:Ww,toolId:"script"}),w.jsx(Z,{icon:QE,toolId:"templates"}),w.jsx(Z,{icon:JE,toolId:"drawing"}),w.jsx(Z,{icon:qE,toolId:"download"})]})})]})})})}),w.jsxs("div",{className:"flex-1 pb-4 px-2 flex flex-col",children:[" ",w.jsx(Pc,{children:C&&w.jsx(Nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-40 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:w.jsx(Kw,{className:"h-8 w-8 text-blue-600 animate-spin"})})}),w.jsxs("div",{className:"flex-1 w-full rounded-lg border border-gray-200 bg-white shadow-sm overflow-hidden mb-2",children:[" ",w.jsx("div",{className:"flex items-center flex-wrap gap-2 p-2 border-b border-gray-200",children:w.jsx(qte,{selectedMarket:t,onMarketChange:e,latestTick:R})}),w.jsx("div",{className:"h-4/5 w-full relative cursor-pointer overflow-scroll",onClick:J,children:w.jsx(_2e,{children:P?w.jsx(Ane,{latestTick:R}):w.jsx(EL,{ref:g,data:A,chartType:n,market:t,indicators:o,indicatorData:_})})})]}),w.jsx(Pc,{children:d&&w.jsxs(Nt.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,layout:{duration:.2}},className:"border border-gray-200 bg-gray-50 p-3 rounded-lg",children:[w.jsxs("div",{className:"flex justify-between items-center mb-2",children:[w.jsx("h3",{className:"font-semibold text-sm text-gray-700",children:"JS Script Runner"}),w.jsx(Be,{variant:"ghost",size:"sm",onClick:()=>f(!1),className:"h-6 w-6 p-0",children:w.jsx(G9,{className:"h-4 w-4"})})]}),w.jsxs("div",{className:"flex gap-2 h-40",children:[" ",w.jsx(ZRe,{value:p,onValueChange:m,highlight:le,padding:10,className:"flex-1 border border-gray-300 rounded-md text-xs bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y",style:{fontFamily:'"Fira code", "Fira Code", "Consolas", "Monaco", monospace',fontSize:12,minHeight:"120px",lineHeight:1.5},placeholder:"Enter your JS script (must define a 'calculate' function that takes data and returns an array)"}),w.jsx(Be,{onClick:M,size:"sm",className:"h-full px-3 whitespace-nowrap self-start mt-2",children:"Run & Apply"})]}),v.length>0&&w.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Applied: ",v.length," data points"]})]})})]})]})]}),w.jsxs("aside",{className:"hidden md:flex flex-col flex-shrink-0 w-[420px] lg:w-[380px] relative z-40 border-l border-gray-200 bg-white h-full",children:[" ",w.jsxs("div",{className:"w-full h-full flex flex-col",children:[w.jsx(gD,{isLoggedIn:!0,isMobile:!1,onTradeTypeChange:I,onTrade:re,latestTick:R,selectedMarket:t})," "]})]}),w.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 p-4 bg-white/80 backdrop-blur-sm border-t border-gray-200",children:w.jsxs(iG,{open:y,onOpenChange:b,children:[w.jsx(uRe,{asChild:!0,children:w.jsx(Be,{className:"w-full",children:"Trade / Analyser"})}),w.jsx(aG,{children:w.jsxs("div",{className:"mx-auto w-full max-w-lg h-[90vh] flex flex-col",children:[" ",w.jsx(gD,{isLoggedIn:!0,isMobile:!0,onTradeTypeChange:I,onTrade:re,latestTick:R,selectedMarket:t})]})})]})})]})]})};var I$="ToastProvider",[$$,tAe,nAe]=Kd("Toast"),[AG,JAe]=_s("Toast",[nAe]),[sAe,Gv]=AG(I$),DG=t=>{const{__scopeToast:e,label:n="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:i=50,children:o}=t,[a,l]=k.useState(null),[c,u]=k.useState(0),h=k.useRef(!1),d=k.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${I$}\`. Expected non-empty \`string\`.`),w.jsx($$.Provider,{scope:e,children:w.jsx(sAe,{scope:e,label:n,duration:s,swipeDirection:r,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:k.useCallback(()=>u(f=>f+1),[]),onToastRemove:k.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:d,children:o})})};DG.displayName=I$;var _G="ToastViewport",rAe=["F8"],lC="toast.viewportPause",cC="toast.viewportResume",PG=k.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:s=rAe,label:r="Notifications ({hotkey})",...i}=t,o=Gv(_G,n),a=tAe(n),l=k.useRef(null),c=k.useRef(null),u=k.useRef(null),h=k.useRef(null),d=Le(e,h,o.onViewportChange),f=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;k.useEffect(()=>{const v=x=>{var y;s.length!==0&&s.every(b=>x[b]||x.code===b)&&((y=h.current)==null||y.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[s]),k.useEffect(()=>{const v=l.current,x=h.current;if(p&&v&&x){const g=()=>{if(!o.isClosePausedRef.current){const S=new CustomEvent(lC);x.dispatchEvent(S),o.isClosePausedRef.current=!0}},y=()=>{if(o.isClosePausedRef.current){const S=new CustomEvent(cC);x.dispatchEvent(S),o.isClosePausedRef.current=!1}},b=S=>{!v.contains(S.relatedTarget)&&y()},C=()=>{v.contains(document.activeElement)||y()};return v.addEventListener("focusin",g),v.addEventListener("focusout",b),v.addEventListener("pointermove",g),v.addEventListener("pointerleave",C),window.addEventListener("blur",g),window.addEventListener("focus",y),()=>{v.removeEventListener("focusin",g),v.removeEventListener("focusout",b),v.removeEventListener("pointermove",g),v.removeEventListener("pointerleave",C),window.removeEventListener("blur",g),window.removeEventListener("focus",y)}}},[p,o.isClosePausedRef]);const m=k.useCallback(({tabbingDirection:v})=>{const g=a().map(y=>{const b=y.ref.current,C=[b,...xAe(b)];return v==="forwards"?C:C.reverse()});return(v==="forwards"?g.reverse():g).flat()},[a]);return k.useEffect(()=>{const v=h.current;if(v){const x=g=>{var C,S,T;const y=g.altKey||g.ctrlKey||g.metaKey;if(g.key==="Tab"&&!y){const I=document.activeElement,$=g.shiftKey;if(g.target===v&&$){(C=c.current)==null||C.focus();return}const F=m({tabbingDirection:$?"backwards":"forwards"}),E=F.findIndex(R=>R===I);Db(F.slice(E+1))?g.preventDefault():$?(S=c.current)==null||S.focus():(T=u.current)==null||T.focus()}};return v.addEventListener("keydown",x),()=>v.removeEventListener("keydown",x)}},[a,m]),w.jsxs(YZ,{ref:l,role:"region","aria-label":r.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&w.jsx(uC,{ref:c,onFocusFromOutsideViewport:()=>{const v=m({tabbingDirection:"forwards"});Db(v)}}),w.jsx($$.Slot,{scope:n,children:w.jsx(Te.ol,{tabIndex:-1,...i,ref:d})}),p&&w.jsx(uC,{ref:u,onFocusFromOutsideViewport:()=>{const v=m({tabbingDirection:"backwards"});Db(v)}})]})});PG.displayName=_G;var FG="ToastFocusProxy",uC=k.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...r}=t,i=Gv(FG,n);return w.jsx(r0,{tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&s()}})});uC.displayName=FG;var pp="Toast",iAe="toast.swipeStart",oAe="toast.swipeMove",aAe="toast.swipeCancel",lAe="toast.swipeEnd",OG=k.forwardRef((t,e)=>{const{forceMount:n,open:s,defaultOpen:r,onOpenChange:i,...o}=t,[a,l]=Gs({prop:s,defaultProp:r??!0,onChange:i,caller:pp});return w.jsx(gs,{present:n||a,children:w.jsx(hAe,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:gn(t.onPause),onResume:gn(t.onResume),onSwipeStart:be(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:be(t.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:be(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:be(t.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});OG.displayName=pp;var[cAe,uAe]=AG(pp,{onClose(){}}),hAe=k.forwardRef((t,e)=>{const{__scopeToast:n,type:s="foreground",duration:r,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:d,onSwipeEnd:f,...p}=t,m=Gv(pp,n),[v,x]=k.useState(null),g=Le(e,R=>x(R)),y=k.useRef(null),b=k.useRef(null),C=r||m.duration,S=k.useRef(0),T=k.useRef(C),I=k.useRef(0),{onToastAdd:$,onToastRemove:N}=m,A=gn(()=>{var O;(v==null?void 0:v.contains(document.activeElement))&&((O=m.viewport)==null||O.focus()),o()}),F=k.useCallback(R=>{!R||R===1/0||(window.clearTimeout(I.current),S.current=new Date().getTime(),I.current=window.setTimeout(A,R))},[A]);k.useEffect(()=>{const R=m.viewport;if(R){const O=()=>{F(T.current),c==null||c()},P=()=>{const z=new Date().getTime()-S.current;T.current=T.current-z,window.clearTimeout(I.current),l==null||l()};return R.addEventListener(lC,P),R.addEventListener(cC,O),()=>{R.removeEventListener(lC,P),R.removeEventListener(cC,O)}}},[m.viewport,C,l,c,F]),k.useEffect(()=>{i&&!m.isClosePausedRef.current&&F(C)},[i,C,m.isClosePausedRef,F]),k.useEffect(()=>($(),()=>N()),[$,N]);const E=k.useMemo(()=>v?WG(v):null,[v]);return m.viewport?w.jsxs(w.Fragment,{children:[E&&w.jsx(dAe,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite",children:E}),w.jsx(cAe,{scope:n,onClose:A,children:Pl.createPortal(w.jsx($$.ItemSlot,{scope:n,children:w.jsx(qZ,{asChild:!0,onEscapeKeyDown:be(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||A(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:w.jsx(Te.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:g,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:be(t.onKeyDown,R=>{R.key==="Escape"&&(a==null||a(R.nativeEvent),R.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:be(t.onPointerDown,R=>{R.button===0&&(y.current={x:R.clientX,y:R.clientY})}),onPointerMove:be(t.onPointerMove,R=>{if(!y.current)return;const O=R.clientX-y.current.x,P=R.clientY-y.current.y,z=!!b.current,_=["left","right"].includes(m.swipeDirection),M=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,U=_?M(0,O):0,W=_?0:M(0,P),X=R.pointerType==="touch"?10:2,J={x:U,y:W},Z={originalEvent:R,delta:J};z?(b.current=J,ym(oAe,h,Z,{discrete:!1})):ND(J,m.swipeDirection,X)?(b.current=J,ym(iAe,u,Z,{discrete:!1}),R.target.setPointerCapture(R.pointerId)):(Math.abs(O)>X||Math.abs(P)>X)&&(y.current=null)}),onPointerUp:be(t.onPointerUp,R=>{const O=b.current,P=R.target;if(P.hasPointerCapture(R.pointerId)&&P.releasePointerCapture(R.pointerId),b.current=null,y.current=null,O){const z=R.currentTarget,_={originalEvent:R,delta:O};ND(O,m.swipeDirection,m.swipeThreshold)?ym(lAe,f,_,{discrete:!0}):ym(aAe,d,_,{discrete:!0}),z.addEventListener("click",M=>M.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),dAe=t=>{const{__scopeToast:e,children:n,...s}=t,r=Gv(pp,e),[i,o]=k.useState(!1),[a,l]=k.useState(!1);return mAe(()=>o(!0)),k.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:w.jsx(Gd,{asChild:!0,children:w.jsx(r0,{...s,children:i&&w.jsxs(w.Fragment,{children:[r.label," ",n]})})})},fAe="ToastTitle",MG=k.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return w.jsx(Te.div,{...s,ref:e})});MG.displayName=fAe;var pAe="ToastDescription",LG=k.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return w.jsx(Te.div,{...s,ref:e})});LG.displayName=pAe;var zG="ToastAction",VG=k.forwardRef((t,e)=>{const{altText:n,...s}=t;return n.trim()?w.jsx(jG,{altText:n,asChild:!0,children:w.jsx(N$,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${zG}\`. Expected non-empty \`string\`.`),null)});VG.displayName=zG;var BG="ToastClose",N$=k.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t,r=uAe(BG,n);return w.jsx(jG,{asChild:!0,children:w.jsx(Te.button,{type:"button",...s,ref:e,onClick:be(t.onClick,r.onClose)})})});N$.displayName=BG;var jG=k.forwardRef((t,e)=>{const{__scopeToast:n,altText:s,...r}=t;return w.jsx(Te.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...r,ref:e})});function WG(t){const e=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),gAe(s)){const r=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!r)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...WG(s))}}),e}function ym(t,e,n,{discrete:s}){const r=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?rM(r,i):r.dispatchEvent(i)}var ND=(t,e,n=0)=>{const s=Math.abs(t.x),r=Math.abs(t.y),i=s>r;return e==="left"||e==="right"?i&&s>n:!i&&r>n};function mAe(t=()=>{}){const e=gn(t);wn(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[e])}function gAe(t){return t.nodeType===t.ELEMENT_NODE}function xAe(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Db(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var vAe=DG,UG=PG,GG=OG,HG=MG,KG=LG,XG=VG,qG=N$;const yAe=vAe,YG=oe.forwardRef(({className:t,...e},n)=>w.jsx(UG,{ref:n,className:Ie("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));YG.displayName=UG.displayName;const bAe=pk("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),QG=oe.forwardRef(({className:t,variant:e,...n},s)=>w.jsx(GG,{ref:s,className:Ie(bAe({variant:e}),t),...n}));QG.displayName=GG.displayName;const wAe=oe.forwardRef(({className:t,...e},n)=>w.jsx(XG,{ref:n,className:Ie("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));wAe.displayName=XG.displayName;const ZG=oe.forwardRef(({className:t,...e},n)=>w.jsx(qG,{ref:n,className:Ie("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:w.jsx(Ci,{className:"h-4 w-4"})}));ZG.displayName=qG.displayName;const JG=oe.forwardRef(({className:t,...e},n)=>w.jsx(HG,{ref:n,className:Ie("text-sm font-semibold",t),...e}));JG.displayName=HG.displayName;const eH=oe.forwardRef(({className:t,...e},n)=>w.jsx(KG,{ref:n,className:Ie("text-sm opacity-90",t),...e}));eH.displayName=KG.displayName;function CAe(){const{toasts:t}=_Q();return w.jsxs(yAe,{children:[t.map(({id:e,title:n,description:s,action:r,...i})=>w.jsxs(QG,{...i,children:[w.jsxs("div",{className:"grid gap-1",children:[n&&w.jsx(JG,{children:n}),s&&w.jsx(eH,{children:s})]}),r,w.jsx(ZG,{})]},e)),w.jsx(YG,{})]})}function SAe(){return w.jsxs(w.Fragment,{children:[w.jsxs(Ew,{children:[w.jsx("title",{children:"XtradingAI - Real-time Trading Analysis"}),w.jsx("meta",{name:"description",content:"Professional chart platform with real-time market data, technical indicators, and advanced charting tools powered by Deriv API for XtradingAI."})]}),w.jsx(vRe,{children:w.jsxs("div",{className:"h-screen w-screen bg-gray-100 text-gray-900",children:[w.jsx(eAe,{}),w.jsx(CAe,{})]})})]})}_b.createRoot(document.getElementById("root")).render(w.jsx(SAe,{}));
